<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.SignAlg.RSA.TCB</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Armor.Data.X690-DER.Null.TCB.html" class="Module">Armor.Data.X690-DER.Null.TCB</a>
<a id="67" class="Keyword">open</a> <a id="72" class="Keyword">import</a> <a id="79" href="Armor.Data.X690-DER.OID.html" class="Module">Armor.Data.X690-DER.OID</a>
<a id="103" class="Keyword">open</a> <a id="108" class="Keyword">import</a> <a id="115" href="Armor.Data.X690-DER.Sequence.DefinedByOID.TCB.html" class="Module">Armor.Data.X690-DER.Sequence.DefinedByOID.TCB</a>
<a id="161" class="Keyword">open</a> <a id="166" class="Keyword">import</a> <a id="173" href="Armor.Data.X690-DER.TLV.TCB.html" class="Module">Armor.Data.X690-DER.TLV.TCB</a>
<a id="201" class="Keyword">open</a> <a id="206" class="Keyword">import</a> <a id="213" href="Armor.Data.X690-DER.OctetString.TCB.html" class="Module">Armor.Data.X690-DER.OctetString.TCB</a>
<a id="249" class="Keyword">import</a>      <a id="261" href="Armor.Data.X690-DER.Tag.html" class="Module">Armor.Data.X690-DER.Tag</a> <a id="285" class="Symbol">as</a> <a id="288" class="Module">Tag</a>
<a id="292" class="Comment">-- open import Armor.Data.X509.SignAlg.RSA.PSS.TCB</a>
<a id="343" class="Keyword">open</a> <a id="348" class="Keyword">import</a> <a id="355" href="Armor.Data.X509.SignAlg.TCB.OIDs.html" class="Module">Armor.Data.X509.SignAlg.TCB.OIDs</a>  <a id="389" class="Symbol">as</a> <a id="392" class="Module">OIDs</a>
<a id="397" class="Keyword">import</a>      <a id="409" href="Armor.Data.X509.HashAlg.RFC4055.html" class="Module">Armor.Data.X509.HashAlg.RFC4055</a>   <a id="443" class="Symbol">as</a> <a id="446" class="Module">HashAlg</a>
<a id="454" class="Keyword">import</a>      <a id="466" href="Armor.Data.X509.HashAlg.TCB.OIDs.html" class="Module">Armor.Data.X509.HashAlg.TCB.OIDs</a>  <a id="500" class="Symbol">as</a> <a id="503" class="Module">OIDs</a>
<a id="508" class="Keyword">import</a>      <a id="520" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a>
<a id="546" class="Keyword">import</a>      <a id="558" href="Armor.Grammar.Option.TCB.html" class="Module">Armor.Grammar.Option.TCB</a>
<a id="583" class="Keyword">import</a>      <a id="595" href="Armor.Grammar.Parallel.TCB.html" class="Module">Armor.Grammar.Parallel.TCB</a>
<a id="622" class="Keyword">import</a>      <a id="634" href="Armor.Grammar.Sum.TCB.html" class="Module">Armor.Grammar.Sum.TCB</a>
<a id="656" class="Keyword">open</a> <a id="661" class="Keyword">import</a> <a id="668" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>
<a id="682" class="Keyword">import</a>      <a id="694" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="703" class="Symbol">as</a> <a id="706" class="Module">Sum</a>

<a id="711" class="Keyword">module</a> <a id="718" href="Armor.Data.X509.SignAlg.RSA.TCB.html" class="Module">Armor.Data.X509.SignAlg.RSA.TCB</a> <a id="750" class="Keyword">where</a>

<a id="757" class="Keyword">open</a> <a id="762" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a>  <a id="789" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="795" class="Keyword">open</a> <a id="800" href="Armor.Grammar.Option.TCB.html" class="Module">Armor.Grammar.Option.TCB</a>   <a id="827" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="833" class="Keyword">open</a> <a id="838" href="Armor.Grammar.Parallel.TCB.html" class="Module">Armor.Grammar.Parallel.TCB</a> <a id="865" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="871" class="Keyword">open</a> <a id="876" href="Armor.Grammar.Sum.TCB.html" class="Module">Armor.Grammar.Sum.TCB</a>      <a id="903" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>

<a id="910" class="Comment">{-
https://datatracker.ietf.org/doc/html/rfc3279#section-2.2

The signature algorithm with MD2 and the RSA encryption algorithm is
defined in PKCS #1 [RFC 2313].  As defined in PKCS #1 [RFC 2313], the
ASN.1 OID used to identify this signature algorithm is:

   md2WithRSAEncryption OBJECT IDENTIFIER  ::=  {
       iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)
       pkcs-1(1) 2  }

The signature algorithm with MD5 and the RSA encryption algorithm is
defined in PKCS #1 [RFC 2313].  As defined in PKCS #1 [RFC 2313], the
ASN.1 OID used to identify this signature algorithm is:

    md5WithRSAEncryption OBJECT IDENTIFIER  ::=  {
        iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)
        pkcs-1(1) 4  }

The ASN.1 object identifier used to identify this signature algorithm
is:

      sha-1WithRSAEncryption OBJECT IDENTIFIER  ::=  {
          iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1)
          pkcs-1(1) 5  }

When any of these three OIDs appears within the ASN.1 type
AlgorithmIdentifier, the parameters component of that type SHALL be
the ASN.1 type NULL.
-}</a>

<a id="2004" class="Comment">{-
https://datatracker.ietf.org/doc/html/rfc4055#section-5

The object identifier used to identify the PKCS #1 version 1.5
   signature algorithm with SHA-224 is:

      sha224WithRSAEncryption  OBJECT IDENTIFIER  ::=  { pkcs-1 14 }

   The object identifier used to identify the PKCS #1 version 1.5
   signature algorithm with SHA-256 is:

      sha256WithRSAEncryption  OBJECT IDENTIFIER  ::=  { pkcs-1 11 }

   The object identifier used to identify the PKCS #1 version 1.5
   signature algorithm with SHA-384 is:

      sha384WithRSAEncryption  OBJECT IDENTIFIER  ::=  { pkcs-1 12 }

   The object identifier used to identify the PKCS #1 version 1.5
   signature algorithm with SHA-512 is:

      sha512WithRSAEncryption  OBJECT IDENTIFIER  ::=  { pkcs-1 13 }

   When any of these four object identifiers appears within an
   AlgorithmIdentifier, the parameters MUST be NULL.  Implementations
   MUST accept the parameters being absent as well as present.

-}</a>

<a id="2970" class="Comment">{-
https://datatracker.ietf.org/doc/html/rfc4055#section-3.1

When RSASSA-PSS is used in an AlgorithmIdentifier, the parameters
MUST employ the RSASSA-PSS-params syntax.  The parameters may be
either absent or present when used as subject public key information.
The parameters MUST be present when used in the algorithm identifier
associated with a signature value.

When signing, it is RECOMMENDED that the parameters, except for
possibly saltLength, remain fixed for all usages of a given RSA key
pair.

  id-RSASSA-PSS  OBJECT IDENTIFIER  ::=  { pkcs-1 10 }
-}</a>

<a id="SplitRSA∈"></a><a id="3536" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3536" class="Function">SplitRSA∈</a> <a id="3546" class="Symbol">:</a> <a id="3548" class="Symbol">∀</a> <a id="3550" class="Symbol">{@</a><a id="3552" class="Symbol">0</a> <a id="3554" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3554" class="Bound">bs</a><a id="3556" class="Symbol">}</a> <a id="3558" class="Symbol">(</a><a id="3559" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3559" class="Bound">o</a> <a id="3561" class="Symbol">:</a> <a id="3563" href="Armor.Data.X690-DER.OID.TCB.html#2963" class="Function">OID</a> <a id="3567" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3554" class="Bound">bs</a><a id="3569" class="Symbol">)</a> <a id="3571" class="Symbol">→</a> <a id="3573" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="3577" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3536" class="Function">SplitRSA∈</a> <a id="3587" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3587" class="Bound">o</a> <a id="3589" class="Symbol">=</a>   <a id="3593" class="Symbol">(</a><a id="3594" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="3597" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="3605" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3587" class="Bound">o</a><a id="3606" class="Symbol">)</a> <a id="3608" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="3610" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#4962" class="Function">OIDs.RSA.ExplicitNullParam</a>
              <a id="3651" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="3653" class="Symbol">(</a><a id="3654" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="3657" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="3665" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3587" class="Bound">o</a><a id="3666" class="Symbol">)</a> <a id="3668" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="3670" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#5070" class="Function">OIDs.RSA.ExplicitOrImplicitNullParam</a>
              <a id="3721" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="3723" class="Symbol">(</a><a id="3724" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="3727" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="3735" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3587" class="Bound">o</a><a id="3736" class="Symbol">)</a> <a id="3738" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="3740" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="3742" href="Armor.Prelude.html#8662" class="Function">Exists─</a> <a id="3750" class="Symbol">_</a> <a id="3752" href="Armor.Data.X690-DER.OID.TCB.html#2819" class="Function">OIDValue</a> <a id="3761" href="Armor.Prelude.html#3542" class="Function Operator">∋</a> <a id="3763" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="3766" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#4825" class="Function">OIDs.RSA.PSS</a> <a id="3779" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="splitRSA∈"></a><a id="3782" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3782" class="Function">splitRSA∈</a> <a id="3792" class="Symbol">:</a> <a id="3794" class="Symbol">∀</a> <a id="3796" class="Symbol">{@</a><a id="3798" class="Symbol">0</a> <a id="3800" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3800" class="Bound">bs</a><a id="3802" class="Symbol">}</a> <a id="3804" class="Symbol">(</a><a id="3805" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3805" class="Bound">o</a> <a id="3807" class="Symbol">:</a> <a id="3809" href="Armor.Data.X690-DER.OID.TCB.html#2963" class="Function">OID</a> <a id="3813" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3800" class="Bound">bs</a><a id="3815" class="Symbol">)</a> <a id="3817" class="Symbol">→</a> <a id="3819" class="Symbol">(</a><a id="3820" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="3823" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="3831" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3805" class="Bound">o</a><a id="3832" class="Symbol">)</a> <a id="3834" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="3836" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#5221" class="Function">OIDs.RSA.Supported</a> <a id="3855" class="Symbol">→</a> <a id="3857" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3536" class="Function">SplitRSA∈</a> <a id="3867" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3805" class="Bound">o</a>
<a id="3869" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3782" class="Function">splitRSA∈</a> <a id="3879" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3879" class="Bound">o</a> <a id="3881" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3881" class="Bound">o∈?</a> <a id="3885" class="Symbol">=</a> <a id="3887" href="Data.Sum.Base.html#1492" class="Function">Sum.map₂</a> <a id="3896" class="Symbol">(</a><a id="3897" href="Data.List.Relation.Unary.Any.Properties.html#12422" class="Function">Any.++⁻</a> <a id="3905" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#5070" class="Function">OIDs.RSA.ExplicitOrImplicitNullParam</a><a id="3941" class="Symbol">)</a> <a id="3943" class="Symbol">(</a><a id="3944" href="Data.List.Relation.Unary.Any.Properties.html#12422" class="Function">Any.++⁻</a> <a id="3952" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#4962" class="Function">OIDs.RSA.ExplicitNullParam</a> <a id="3979" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3881" class="Bound">o∈?</a><a id="3982" class="Symbol">)</a>

<a id="RSAParams“"></a><a id="3985" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3985" class="Function">RSAParams“</a> <a id="3996" class="Symbol">:</a> <a id="3998" class="Symbol">∀</a> <a id="4000" class="Symbol">{@</a><a id="4002" class="Symbol">0</a> <a id="4004" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4004" class="Bound">bs</a><a id="4006" class="Symbol">}</a> <a id="4008" class="Symbol">→</a> <a id="4010" class="Symbol">(</a><a id="4011" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4011" class="Bound">o</a> <a id="4013" class="Symbol">:</a> <a id="4015" href="Armor.Data.X690-DER.OID.TCB.html#2963" class="Function">OID</a> <a id="4019" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4004" class="Bound">bs</a><a id="4021" class="Symbol">)</a> <a id="4023" class="Symbol">→</a> <a id="4025" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3536" class="Function">SplitRSA∈</a> <a id="4035" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4011" class="Bound">o</a> <a id="4037" class="Symbol">→</a> <a id="4039" class="Symbol">@</a><a id="4040" class="Symbol">0</a> <a id="4042" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4047" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="4053" class="Symbol">→</a> <a id="4055" href="Agda.Primitive.html#326" class="Primitive">Set</a>

<a id="4060" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3985" class="Function">RSAParams“</a> <a id="4071" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4071" class="Bound">o</a> <a id="4073" class="Symbol">(</a><a id="4074" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="4079" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4079" class="Bound">x</a><a id="4080" class="Symbol">)</a> <a id="4082" class="Symbol">=</a> <a id="4084" href="Armor.Data.X690-DER.Null.TCB.html#589" class="Function">Null</a>
<a id="4089" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3985" class="Function">RSAParams“</a> <a id="4100" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4100" class="Bound">o</a> <a id="4102" class="Symbol">(</a><a id="4103" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="4108" class="Symbol">(</a><a id="4109" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="4114" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4114" class="Bound">x</a><a id="4115" class="Symbol">))</a> <a id="4118" class="Symbol">=</a> <a id="4120" href="Armor.Grammar.Option.TCB.html#175" class="Datatype">Option</a> <a id="4127" href="Armor.Data.X690-DER.Null.TCB.html#589" class="Function">Null</a>
<a id="4132" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3985" class="Function">RSAParams“</a> <a id="4143" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4143" class="Bound">o</a> <a id="4145" class="Symbol">(</a><a id="4146" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="4151" class="Symbol">(</a><a id="4152" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="4157" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4157" class="Bound">y</a><a id="4158" class="Symbol">))</a> <a id="4161" class="Symbol">=</a> <a id="4163" href="Armor.Data.X690-DER.TLV.TCB.html#534" class="Record">TLV</a> <a id="4167" href="Armor.Data.X690-DER.Tag.html#776" class="Function">Tag.Sequence</a> <a id="4180" href="Armor.Data.X690-DER.OctetString.TCB.html#2110" class="Function">OctetStringValue</a> <a id="4197" class="Comment">--PSSParamSeq</a>

<a id="RSAParamsRep"></a><a id="4212" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4212" class="Function">RSAParamsRep</a> <a id="4225" class="Symbol">:</a> <a id="4227" class="Symbol">@</a><a id="4228" class="Symbol">0</a> <a id="4230" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4235" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="4241" class="Symbol">→</a> <a id="4243" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="4247" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4212" class="Function">RSAParamsRep</a> <a id="4260" class="Symbol">=</a> <a id="4262" href="Armor.Grammar.Sum.TCB.html#177" class="Datatype">Sum</a> <a id="4266" href="Armor.Data.X690-DER.Null.TCB.html#589" class="Function">Null</a> <a id="4271" class="Symbol">(</a><a id="4272" href="Armor.Grammar.Sum.TCB.html#177" class="Datatype">Sum</a> <a id="4276" class="Symbol">(</a><a id="4277" href="Armor.Grammar.Option.TCB.html#175" class="Datatype">Option</a> <a id="4284" href="Armor.Data.X690-DER.Null.TCB.html#589" class="Function">Null</a><a id="4288" class="Symbol">)</a> <a id="4290" class="Symbol">(</a><a id="4291" href="Armor.Data.X690-DER.TLV.TCB.html#534" class="Record">TLV</a> <a id="4295" href="Armor.Data.X690-DER.Tag.html#776" class="Function">Tag.Sequence</a> <a id="4308" href="Armor.Data.X690-DER.OctetString.TCB.html#2110" class="Function">OctetStringValue</a><a id="4324" class="Symbol">))</a> <a id="4327" class="Comment">--PSSParamSeq))</a>

<a id="RawRSAParamsRep"></a><a id="4344" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4344" class="Function">RawRSAParamsRep</a> <a id="4360" class="Symbol">:</a> <a id="4362" href="Armor.Grammar.Definitions.NonMalleable.Base.html#125" class="Record">Raw</a> <a id="4366" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4212" class="Function">RSAParamsRep</a>
<a id="4379" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4344" class="Function">RawRSAParamsRep</a> <a id="4395" class="Symbol">=</a> <a id="4397" href="Armor.Grammar.Sum.TCB.html#289" class="Function">RawSum</a> <a id="4404" href="Armor.Data.X690-DER.Null.TCB.html#728" class="Function">RawNull</a> <a id="4412" class="Symbol">(</a><a id="4413" href="Armor.Grammar.Sum.TCB.html#289" class="Function">RawSum</a> <a id="4420" class="Symbol">(</a><a id="4421" href="Armor.Grammar.Option.TCB.html#896" class="Function">RawOption</a> <a id="4431" href="Armor.Data.X690-DER.Null.TCB.html#728" class="Function">RawNull</a><a id="4438" class="Symbol">)</a> <a id="4440" class="Symbol">(</a><a id="4441" href="Armor.Data.X690-DER.TLV.TCB.html#1272" class="Function">RawTLV</a> <a id="4448" class="Symbol">_</a> <a id="4450" href="Armor.Data.X690-DER.OctetString.TCB.html#2231" class="Function">RawOctetStringValue</a><a id="4469" class="Symbol">))</a> <a id="4472" class="Comment">--RawPSSParamSeq))</a>

<a id="RSAParams&#39;"></a><a id="4492" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4492" class="Function">RSAParams&#39;</a> <a id="4503" class="Symbol">:</a> <a id="4505" class="Symbol">∀</a> <a id="4507" class="Symbol">{@</a><a id="4509" class="Symbol">0</a> <a id="4511" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4511" class="Bound">bs</a><a id="4513" class="Symbol">}</a> <a id="4515" class="Symbol">→</a> <a id="4517" class="Symbol">(</a><a id="4518" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4518" class="Bound">o</a> <a id="4520" class="Symbol">:</a> <a id="4522" href="Armor.Data.X690-DER.OID.TCB.html#2963" class="Function">OID</a> <a id="4526" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4511" class="Bound">bs</a><a id="4528" class="Symbol">)</a> <a id="4530" class="Symbol">→</a> <a id="4532" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="4536" class="Symbol">((</a><a id="4538" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="4541" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="4549" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4518" class="Bound">o</a><a id="4550" class="Symbol">)</a> <a id="4552" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="4554" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#5221" class="Function">OIDs.RSA.Supported</a><a id="4572" class="Symbol">)</a> <a id="4574" class="Symbol">→</a> <a id="4576" class="Symbol">@</a><a id="4577" class="Symbol">0</a> <a id="4579" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4584" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="4590" class="Symbol">→</a> <a id="4592" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="4596" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4492" class="Function">RSAParams&#39;</a> <a id="4607" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4607" class="Bound">o</a> <a id="4609" class="Symbol">(</a><a id="4610" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="4613" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4613" class="Bound">¬p</a><a id="4615" class="Symbol">)</a> <a id="4617" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4617" class="Bound">bs</a> <a id="4620" class="Symbol">=</a> <a id="4622" href="Data.Empty.html#526" class="Datatype">⊥</a>
<a id="4624" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4492" class="Function">RSAParams&#39;</a> <a id="4635" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4635" class="Bound">o</a> <a id="4637" class="Symbol">(</a><a id="4638" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="4642" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4642" class="Bound">p</a><a id="4643" class="Symbol">)</a> <a id="4645" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4645" class="Bound">bs</a> <a id="4648" class="Symbol">=</a> <a id="4650" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3985" class="Function">RSAParams“</a> <a id="4661" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4635" class="Bound">o</a> <a id="4663" class="Symbol">(</a><a id="4664" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3782" class="Function">splitRSA∈</a> <a id="4674" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4635" class="Bound">o</a> <a id="4676" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4642" class="Bound">p</a><a id="4677" class="Symbol">)</a> <a id="4679" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4645" class="Bound">bs</a>

<a id="RSAParams"></a><a id="4683" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4683" class="Function">RSAParams</a> <a id="4693" class="Symbol">:</a> <a id="4695" href="Armor.Data.X690-DER.Sequence.DefinedByOID.TCB.html#514" class="Function">AnyDefinedByOID</a>
<a id="4711" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4683" class="Function">RSAParams</a> <a id="4721" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4721" class="Bound">o</a> <a id="4723" class="Symbol">=</a> <a id="4725" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4492" class="Function">RSAParams&#39;</a> <a id="4736" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4721" class="Bound">o</a> <a id="4738" class="Symbol">((</a><a id="4740" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="4743" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="4751" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4721" class="Bound">o</a><a id="4752" class="Symbol">)</a> <a id="4754" href="Armor.Prelude.html#11072" class="Function Operator">∈?</a> <a id="4757" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#5221" class="Function">OIDs.RSA.Supported</a><a id="4775" class="Symbol">)</a>

<a id="RawRSAParams"></a><a id="4778" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4778" class="Function">RawRSAParams</a> <a id="4791" class="Symbol">:</a> <a id="4793" href="Armor.Grammar.Definitions.NonMalleable.Base.html#229" class="Record">Raw₁</a> <a id="4798" href="Armor.Data.X690-DER.OID.TCB.html#3030" class="Function">RawOID</a> <a id="4805" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4683" class="Function">RSAParams</a>
<a id="toRawRSAParams&#39;"></a><a id="4815" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4815" class="Function">toRawRSAParams&#39;</a> <a id="4831" class="Symbol">:</a> <a id="4833" class="Symbol">∀</a> <a id="4835" class="Symbol">{@</a><a id="4837" class="Symbol">0</a> <a id="4839" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4839" class="Bound">bs</a><a id="4841" class="Symbol">}</a> <a id="4843" class="Symbol">→</a> <a id="4845" class="Symbol">(</a><a id="4846" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4846" class="Bound">o</a> <a id="4848" class="Symbol">:</a> <a id="4850" href="Armor.Data.X690-DER.OID.TCB.html#2963" class="Function">OID</a> <a id="4854" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4839" class="Bound">bs</a><a id="4856" class="Symbol">)</a> <a id="4858" class="Symbol">(</a><a id="4859" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4859" class="Bound">o∈?</a> <a id="4863" class="Symbol">:</a> <a id="4865" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="4869" class="Symbol">((</a><a id="4871" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="4874" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="4882" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4846" class="Bound">o</a><a id="4883" class="Symbol">)</a> <a id="4885" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="4887" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#5221" class="Function">OIDs.RSA.Supported</a><a id="4905" class="Symbol">))</a>
                <a id="4924" class="Symbol">→</a> <a id="4926" class="Symbol">∀</a> <a id="4928" class="Symbol">{@</a><a id="4930" class="Symbol">0</a> <a id="4932" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4932" class="Bound">bs&#39;</a><a id="4935" class="Symbol">}</a> <a id="4937" class="Symbol">→</a> <a id="4939" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4492" class="Function">RSAParams&#39;</a> <a id="4950" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4846" class="Bound">o</a> <a id="4952" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4859" class="Bound">o∈?</a> <a id="4956" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4932" class="Bound">bs&#39;</a> <a id="4960" class="Symbol">→</a> <a id="4962" href="Armor.Grammar.Definitions.NonMalleable.Base.html#341" class="Field">Raw₁.D</a> <a id="4969" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4778" class="Function">RawRSAParams</a> <a id="4982" class="Symbol">(</a><a id="4983" href="Armor.Grammar.Definitions.NonMalleable.Base.html#188" class="Field">Raw.to</a> <a id="4990" href="Armor.Data.X690-DER.OID.TCB.html#3030" class="Function">RawOID</a> <a id="4997" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4846" class="Bound">o</a><a id="4998" class="Symbol">)</a>
<a id="toRawRSAParams“"></a><a id="5000" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5000" class="Function">toRawRSAParams“</a> <a id="5016" class="Symbol">:</a> <a id="5018" class="Symbol">∀</a> <a id="5020" class="Symbol">{@</a><a id="5022" class="Symbol">0</a> <a id="5024" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5024" class="Bound">bs</a><a id="5026" class="Symbol">}</a> <a id="5028" class="Symbol">→</a> <a id="5030" class="Symbol">(</a><a id="5031" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5031" class="Bound">o</a> <a id="5033" class="Symbol">:</a> <a id="5035" href="Armor.Data.X690-DER.OID.TCB.html#2963" class="Function">OID</a> <a id="5039" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5024" class="Bound">bs</a><a id="5041" class="Symbol">)</a> <a id="5043" class="Symbol">(</a><a id="5044" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5044" class="Bound">o∈?</a> <a id="5048" class="Symbol">:</a> <a id="5050" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3536" class="Function">SplitRSA∈</a> <a id="5060" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5031" class="Bound">o</a><a id="5061" class="Symbol">)</a>
                <a id="5079" class="Symbol">→</a> <a id="5081" class="Symbol">∀</a> <a id="5083" class="Symbol">{@</a><a id="5085" class="Symbol">0</a> <a id="5087" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5087" class="Bound">bs&#39;</a><a id="5090" class="Symbol">}</a> <a id="5092" class="Symbol">→</a> <a id="5094" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3985" class="Function">RSAParams“</a> <a id="5105" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5031" class="Bound">o</a> <a id="5107" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5044" class="Bound">o∈?</a> <a id="5111" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5087" class="Bound">bs&#39;</a> <a id="5115" class="Symbol">→</a> <a id="5117" href="Armor.Grammar.Definitions.NonMalleable.Base.html#341" class="Field">Raw₁.D</a> <a id="5124" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4778" class="Function">RawRSAParams</a> <a id="5137" class="Symbol">(</a><a id="5138" href="Armor.Grammar.Definitions.NonMalleable.Base.html#188" class="Field">Raw.to</a> <a id="5145" href="Armor.Data.X690-DER.OID.TCB.html#3030" class="Function">RawOID</a> <a id="5152" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5031" class="Bound">o</a><a id="5153" class="Symbol">)</a>

<a id="5156" href="Armor.Grammar.Definitions.NonMalleable.Base.html#341" class="Field">Raw₁.D</a> <a id="5163" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4778" class="Function">RawRSAParams</a> <a id="5176" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5176" class="Bound">o</a> <a id="5178" class="Symbol">=</a> <a id="5180" href="Armor.Grammar.Definitions.NonMalleable.Base.html#176" class="Field">Raw.D</a> <a id="5186" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4344" class="Function">RawRSAParamsRep</a>
<a id="5202" href="Armor.Grammar.Definitions.NonMalleable.Base.html#363" class="Field">Raw₁.to</a> <a id="5210" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4778" class="Function">RawRSAParams</a> <a id="5223" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5223" class="Bound">o</a> <a id="5225" class="Symbol">=</a> <a id="5227" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4815" class="Function">toRawRSAParams&#39;</a> <a id="5243" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5223" class="Bound">o</a> <a id="5245" class="Symbol">((</a><a id="5247" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="5250" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="5258" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5223" class="Bound">o</a><a id="5259" class="Symbol">)</a> <a id="5261" href="Armor.Prelude.html#11072" class="Function Operator">∈?</a> <a id="5264" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#5221" class="Function">OIDs.RSA.Supported</a><a id="5282" class="Symbol">)</a>

<a id="5285" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4815" class="Function">toRawRSAParams&#39;</a> <a id="5301" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5301" class="Bound">o</a> <a id="5303" class="Symbol">(</a><a id="5304" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="5308" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5308" class="Bound">p₁</a><a id="5310" class="Symbol">)</a> <a id="5312" class="Symbol">=</a> <a id="5314" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5000" class="Function">toRawRSAParams“</a> <a id="5330" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5301" class="Bound">o</a> <a id="5332" class="Symbol">(</a><a id="5333" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3782" class="Function">splitRSA∈</a> <a id="5343" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5301" class="Bound">o</a> <a id="5345" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5308" class="Bound">p₁</a><a id="5347" class="Symbol">)</a>
<a id="5349" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5000" class="Function">toRawRSAParams“</a> <a id="5365" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5365" class="Bound">o</a> <a id="5367" class="Symbol">(</a><a id="5368" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="5373" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5373" class="Bound">x</a><a id="5374" class="Symbol">)</a> <a id="5376" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5376" class="Bound">p</a> <a id="5378" class="Symbol">=</a> <a id="5380" href="Armor.Grammar.Definitions.NonMalleable.Base.html#188" class="Field">Raw.to</a> <a id="5387" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4344" class="Function">RawRSAParamsRep</a> <a id="5403" class="Symbol">(</a><a id="5404" href="Armor.Grammar.Sum.TCB.html#236" class="InductiveConstructor">inj₁</a> <a id="5409" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5376" class="Bound">p</a><a id="5410" class="Symbol">)</a>
<a id="5412" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5000" class="Function">toRawRSAParams“</a> <a id="5428" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5428" class="Bound">o</a> <a id="5430" class="Symbol">(</a><a id="5431" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="5436" class="Symbol">(</a><a id="5437" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="5442" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5442" class="Bound">x</a><a id="5443" class="Symbol">))</a> <a id="5446" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5446" class="Bound">p</a> <a id="5448" class="Symbol">=</a> <a id="5450" href="Armor.Grammar.Definitions.NonMalleable.Base.html#188" class="Field">Raw.to</a> <a id="5457" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4344" class="Function">RawRSAParamsRep</a> <a id="5473" class="Symbol">(</a><a id="5474" href="Armor.Grammar.Sum.TCB.html#263" class="InductiveConstructor">inj₂</a> <a id="5479" class="Symbol">(</a><a id="5480" href="Armor.Grammar.Sum.TCB.html#236" class="InductiveConstructor">inj₁</a> <a id="5485" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5446" class="Bound">p</a><a id="5486" class="Symbol">))</a>
<a id="5489" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5000" class="Function">toRawRSAParams“</a> <a id="5505" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5505" class="Bound">o</a> <a id="5507" class="Symbol">(</a><a id="5508" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="5513" class="Symbol">(</a><a id="5514" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="5519" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5519" class="Bound">y</a><a id="5520" class="Symbol">))</a> <a id="5523" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5523" class="Bound">p</a> <a id="5525" class="Symbol">=</a> <a id="5527" href="Armor.Grammar.Definitions.NonMalleable.Base.html#188" class="Field">Raw.to</a> <a id="5534" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4344" class="Function">RawRSAParamsRep</a> <a id="5550" class="Symbol">(</a><a id="5551" href="Armor.Grammar.Sum.TCB.html#263" class="InductiveConstructor">inj₂</a> <a id="5556" class="Symbol">(</a><a id="5557" href="Armor.Grammar.Sum.TCB.html#263" class="InductiveConstructor">inj₂</a> <a id="5562" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5523" class="Bound">p</a><a id="5563" class="Symbol">))</a>

<a id="RSA"></a><a id="5567" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5567" class="Function">RSA</a> <a id="5571" class="Symbol">:</a> <a id="5573" class="Symbol">@</a><a id="5574" class="Symbol">0</a> <a id="5576" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5581" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="5587" class="Symbol">→</a> <a id="5589" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="5593" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5567" class="Function">RSA</a> <a id="5597" class="Symbol">=</a> <a id="5599" href="Armor.Data.X690-DER.Sequence.DefinedByOID.TCB.html#1169" class="Function">DefinedByOID</a> <a id="5612" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4683" class="Function">RSAParams</a>

<a id="RawRSA"></a><a id="5623" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5623" class="Function">RawRSA</a> <a id="5630" class="Symbol">:</a> <a id="5632" href="Armor.Grammar.Definitions.NonMalleable.Base.html#125" class="Record">Raw</a> <a id="5636" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5567" class="Function">RSA</a>
<a id="5640" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5623" class="Function">RawRSA</a> <a id="5647" class="Symbol">=</a> <a id="5649" href="Armor.Data.X690-DER.Sequence.DefinedByOID.TCB.html#1441" class="Function">RawDefinedByOID</a> <a id="5665" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4778" class="Function">RawRSAParams</a>

<a id="getOID"></a><a id="5679" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5679" class="Function">getOID</a> <a id="5686" class="Symbol">:</a> <a id="5688" class="Symbol">∀</a> <a id="5690" class="Symbol">{@</a><a id="5692" class="Symbol">0</a> <a id="5694" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5694" class="Bound">bs</a><a id="5696" class="Symbol">}</a> <a id="5698" class="Symbol">→</a> <a id="5700" class="Symbol">(</a><a id="5701" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5701" class="Bound">r</a> <a id="5703" class="Symbol">:</a> <a id="5705" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5567" class="Function">RSA</a> <a id="5709" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5694" class="Bound">bs</a><a id="5711" class="Symbol">)</a> <a id="5713" class="Symbol">→</a> <a id="5715" href="Armor.Data.X690-DER.OID.TCB.html#2963" class="Function">OID</a> <a id="5719" class="Symbol">_</a>
<a id="5721" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5679" class="Function">getOID</a> <a id="5728" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5728" class="Bound">s</a> <a id="5730" class="Symbol">=</a> <a id="5732" href="Armor.Data.X690-DER.Sequence.DefinedByOID.TCB.html#760" class="Field">DefinedByOIDFields.oid</a> <a id="5755" class="Symbol">(</a><a id="5756" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="5764" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5728" class="Bound">s</a><a id="5765" class="Symbol">)</a>
</pre></body></html>