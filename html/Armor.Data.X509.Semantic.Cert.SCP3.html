<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.Semantic.Cert.SCP3</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- open import Armor.Binary</a>
<a id="29" class="Comment">-- open import Armor.Data.X509</a>
<a id="60" class="Comment">-- import      Armor.Data.X509.Extension.TCB.OIDs as OIDs</a>
<a id="118" class="Comment">-- open import Armor.Data.X509.Semantic.Cert.Utils</a>
<a id="169" class="Comment">-- import      Armor.Grammar.Definitions</a>
<a id="210" class="Comment">-- import      Armor.Grammar.Option</a>
<a id="246" class="Comment">-- open import Armor.Grammar.IList as IList</a>
<a id="290" class="Comment">-- open import Armor.Prelude</a>

<a id="320" class="Keyword">module</a> <a id="327" href="Armor.Data.X509.Semantic.Cert.SCP3.html" class="Module">Armor.Data.X509.Semantic.Cert.SCP3</a> <a id="362" class="Keyword">where</a>

<a id="369" class="Comment">-- open Armor.Grammar.Definitions UInt8</a>
<a id="409" class="Comment">-- open Armor.Grammar.Option      UInt8</a>

<a id="450" class="Comment">-- https://datatracker.ietf.org/doc/html/rfc5280#section-4.1.2.1</a>
<a id="515" class="Comment">-- At a minimum, conforming implementations MUST recognize Version 3 certificates.</a>
<a id="598" class="Comment">-- Generation of Version 2 certificates is not expected by implementations based on this profile.</a>
<a id="696" class="Comment">-- note : but, version 1 and 2 certs can be present for CA certificates. So, we are checking whether</a>
<a id="797" class="Comment">-- the version is 1, 2, or 3 (0 - 2).</a>

<a id="836" class="Comment">-- SCP3 : ∀ {@0 bs} → Cert bs → Set</a>
<a id="872" class="Comment">-- SCP3 c = ((Cert.getVersion c ≡ TBSCert.v1) ⊎ (Cert.getVersion c ≡ TBSCert.v2)) ⊎ (Cert.getVersion c ≡  TBSCert.v3)</a>

<a id="991" class="Comment">-- scp3 : ∀ {@0 bs} (c : Cert bs) → Dec (SCP3 c)</a>
<a id="1040" class="Comment">-- scp3 c = ((Cert.getVersion c ≟ TBSCert.v1) ⊎-dec (Cert.getVersion c ≟ TBSCert.v2)) ⊎-dec (Cert.getVersion c ≟ TBSCert.v3)</a>
</pre></body></html>