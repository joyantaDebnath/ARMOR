<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.Semantic.Cert.SCP7</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Armor.Data.X509.html" class="Module">Armor.Data.X509</a>
<a id="54" class="Keyword">import</a>      <a id="66" href="Armor.Data.X509.Extension.TCB.OIDs.html" class="Module">Armor.Data.X509.Extension.TCB.OIDs</a> <a id="101" class="Symbol">as</a> <a id="104" class="Module">OIDs</a>
<a id="109" class="Keyword">open</a> <a id="114" class="Keyword">import</a> <a id="121" href="Armor.Data.X509.Semantic.Cert.Utils.html" class="Module">Armor.Data.X509.Semantic.Cert.Utils</a>
<a id="157" class="Keyword">import</a>      <a id="169" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a>
<a id="195" class="Keyword">import</a>      <a id="207" href="Armor.Grammar.Option.html" class="Module">Armor.Grammar.Option</a>
<a id="228" class="Keyword">open</a> <a id="233" class="Keyword">import</a> <a id="240" href="Armor.Grammar.IList.html" class="Module">Armor.Grammar.IList</a> <a id="260" class="Symbol">as</a> <a id="263" class="Module">IList</a>
<a id="269" class="Keyword">open</a> <a id="274" class="Keyword">import</a> <a id="281" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>
<a id="295" class="Keyword">import</a>      <a id="307" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="316" class="Symbol">as</a> <a id="319" class="Module">Sum</a>
<a id="323" class="Keyword">open</a> <a id="328" class="Keyword">import</a> <a id="335" href="Relation.Nullary.Implication.html" class="Module">Relation.Nullary.Implication</a>

<a id="365" class="Keyword">module</a> <a id="372" href="Armor.Data.X509.Semantic.Cert.SCP7.html" class="Module">Armor.Data.X509.Semantic.Cert.SCP7</a> <a id="407" class="Keyword">where</a>

<a id="414" class="Keyword">open</a> <a id="419" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a> <a id="445" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="451" class="Keyword">open</a> <a id="456" href="Armor.Grammar.Option.html" class="Module">Armor.Grammar.Option</a>      <a id="482" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>

<a id="489" class="Comment">-- https://datatracker.ietf.org/doc/html/rfc5280#section-4.1.2.8</a>
<a id="554" class="Comment">-- Unique Identifiers fields MUST only appear if the Version is 2 or 3.</a>
<a id="HasUniqueIdentifiers"></a><a id="626" href="Armor.Data.X509.Semantic.Cert.SCP7.html#626" class="Function">HasUniqueIdentifiers</a> <a id="647" class="Symbol">:</a> <a id="649" class="Symbol">∀</a> <a id="651" class="Symbol">{</a><a id="652" href="Armor.Data.X509.Semantic.Cert.SCP7.html#652" class="Bound">bs</a><a id="654" class="Symbol">}</a> <a id="656" class="Symbol">→</a> <a id="658" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="663" href="Armor.Data.X509.Semantic.Cert.SCP7.html#652" class="Bound">bs</a> <a id="666" class="Symbol">→</a> <a id="668" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="672" href="Armor.Data.X509.Semantic.Cert.SCP7.html#626" class="Function">HasUniqueIdentifiers</a> <a id="693" href="Armor.Data.X509.Semantic.Cert.SCP7.html#693" class="Bound">c</a> <a id="695" class="Symbol">=</a>
    <a id="701" class="Symbol">(</a><a id="702" href="Data.Product.html#1369" class="Function">∃</a> <a id="704" class="Symbol">λ</a> <a id="706" href="Armor.Data.X509.Semantic.Cert.SCP7.html#706" class="Bound">subUID</a> <a id="713" class="Symbol">→</a> <a id="715" href="Armor.Data.X509.Cert.TCB.html#7663" class="Function">Cert.getSubUID</a> <a id="730" href="Armor.Data.X509.Semantic.Cert.SCP7.html#693" class="Bound">c</a> <a id="732" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="734" href="Armor.Grammar.Option.TCB.html#255" class="InductiveConstructor">some</a> <a id="739" href="Armor.Data.X509.Semantic.Cert.SCP7.html#706" class="Bound">subUID</a><a id="745" class="Symbol">)</a>
  <a id="749" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="751" class="Symbol">(</a><a id="752" href="Data.Product.html#1369" class="Function">∃</a> <a id="754" class="Symbol">λ</a> <a id="756" href="Armor.Data.X509.Semantic.Cert.SCP7.html#756" class="Bound">issUID</a> <a id="763" class="Symbol">→</a> <a id="765" href="Armor.Data.X509.Cert.TCB.html#7517" class="Function">Cert.getIssUID</a> <a id="780" href="Armor.Data.X509.Semantic.Cert.SCP7.html#693" class="Bound">c</a> <a id="782" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="784" href="Armor.Grammar.Option.TCB.html#255" class="InductiveConstructor">some</a> <a id="789" href="Armor.Data.X509.Semantic.Cert.SCP7.html#756" class="Bound">issUID</a><a id="795" class="Symbol">)</a>

<a id="798" class="Comment">{- https://datatracker.ietf.org/doc/html/rfc5280#section-4.1.2.1
-- This field describes the version of the encoded certificate.  When
-- extensions are used, as expected in this profile, version MUST be 3
-- (value is 2).  If no extensions are present, but a UniqueIdentifier
-- is present, the version SHOULD be 2 (value is 1); however, the
-- version MAY be 3.  If only basic fields are present, the version
-- SHOULD be 1 (the value is omitted from the certificate as the default
-- value); however, the version MAY be 2 or 3.
--
-- Implementations SHOULD be prepared to accept any version certificate.
-- At a minimum, conforming implementations MUST recognize version 3
-- certificates.
--
-- Generation of version 2 certificates is not expected by
-- implementations based on this profile.
-}</a>
<a id="IsVersion2Or3"></a><a id="1598" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1598" class="Function">IsVersion2Or3</a> <a id="1612" class="Symbol">:</a> <a id="1614" class="Symbol">∀</a> <a id="1616" class="Symbol">{</a><a id="1617" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1617" class="Bound">bs</a><a id="1619" class="Symbol">}</a> <a id="1621" class="Symbol">→</a> <a id="1623" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="1628" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1617" class="Bound">bs</a> <a id="1631" class="Symbol">→</a> <a id="1633" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1637" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1598" class="Function">IsVersion2Or3</a> <a id="1651" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1651" class="Bound">c</a> <a id="1653" class="Symbol">=</a> <a id="1655" href="Armor.Data.X509.Cert.TCB.html#5795" class="Function">Cert.getVersion</a> <a id="1671" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1651" class="Bound">c</a> <a id="1673" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="1675" href="Armor.Data.X509.TBSCert.Version.TCB.html#1402" class="InductiveConstructor">TBSCert.v2</a> <a id="1686" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1688" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1690" href="Armor.Data.X509.TBSCert.Version.TCB.html#1405" class="InductiveConstructor">TBSCert.v3</a> <a id="1701" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="SCP7"></a><a id="1704" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1704" class="Function">SCP7</a> <a id="1709" class="Symbol">:</a> <a id="1711" class="Symbol">∀</a> <a id="1713" class="Symbol">{</a><a id="1714" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1714" class="Bound">bs</a><a id="1716" class="Symbol">}</a> <a id="1718" class="Symbol">→</a> <a id="1720" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="1725" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1714" class="Bound">bs</a> <a id="1728" class="Symbol">→</a> <a id="1730" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1734" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1704" class="Function">SCP7</a> <a id="1739" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1739" class="Bound">c</a> <a id="1741" class="Symbol">=</a> <a id="1743" href="Armor.Data.X509.Semantic.Cert.SCP7.html#626" class="Function">HasUniqueIdentifiers</a> <a id="1764" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1739" class="Bound">c</a> <a id="1766" class="Symbol">→</a> <a id="1768" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1598" class="Function">IsVersion2Or3</a> <a id="1782" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1739" class="Bound">c</a>

<a id="hasUniqueIdentifiers?"></a><a id="1785" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1785" class="Function">hasUniqueIdentifiers?</a> <a id="1807" class="Symbol">:</a> <a id="1809" class="Symbol">∀</a> <a id="1811" class="Symbol">{@</a><a id="1813" class="Symbol">0</a> <a id="1815" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1815" class="Bound">bs</a><a id="1817" class="Symbol">}</a> <a id="1819" class="Symbol">→</a> <a id="1821" class="Symbol">(</a><a id="1822" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1822" class="Bound">c</a> <a id="1824" class="Symbol">:</a> <a id="1826" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="1831" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1815" class="Bound">bs</a><a id="1833" class="Symbol">)</a> <a id="1835" class="Symbol">→</a> <a id="1837" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="1841" class="Symbol">(</a><a id="1842" href="Armor.Data.X509.Semantic.Cert.SCP7.html#626" class="Function">HasUniqueIdentifiers</a> <a id="1863" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1822" class="Bound">c</a><a id="1864" class="Symbol">)</a>
<a id="1866" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1785" class="Function">hasUniqueIdentifiers?</a> <a id="1888" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1888" class="Bound">c</a> <a id="1890" class="Symbol">=</a>
  <a id="1894" href="Armor.Prelude.html#3493" class="Function Operator">case</a> <a id="1899" href="Armor.Data.X509.Cert.TCB.html#7663" class="Function">Cert.getSubUID</a> <a id="1914" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1888" class="Bound">c</a> <a id="1916" href="Data.Product.html#1235" class="Function Operator">,′</a> <a id="1919" href="Armor.Data.X509.Cert.TCB.html#7517" class="Function">Cert.getIssUID</a> <a id="1934" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1888" class="Bound">c</a>
  <a id="1938" href="Armor.Prelude.html#3493" class="Function Operator">ret</a> <a id="1942" class="Symbol">(λ</a> <a id="1945" class="Keyword">where</a> <a id="1951" class="Symbol">(</a><a id="1952" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1952" class="Bound">s</a> <a id="1954" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1956" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1956" class="Bound">i</a><a id="1957" class="Symbol">)</a> <a id="1959" class="Symbol">→</a> <a id="1961" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="1965" class="Symbol">((</a><a id="1967" href="Data.Product.html#1369" class="Function">∃</a> <a id="1969" class="Symbol">λ</a> <a id="1971" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1971" class="Bound">subUID</a> <a id="1978" class="Symbol">→</a> <a id="1980" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1952" class="Bound">s</a> <a id="1982" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1984" href="Armor.Grammar.Option.TCB.html#255" class="InductiveConstructor">some</a> <a id="1989" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1971" class="Bound">subUID</a><a id="1995" class="Symbol">)</a> <a id="1997" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="1999" href="Data.Product.html#1369" class="Function">∃</a> <a id="2001" class="Symbol">λ</a> <a id="2003" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2003" class="Bound">issUID</a> <a id="2010" class="Symbol">→</a> <a id="2012" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1956" class="Bound">i</a> <a id="2014" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2016" href="Armor.Grammar.Option.TCB.html#255" class="InductiveConstructor">some</a> <a id="2021" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2003" class="Bound">issUID</a><a id="2027" class="Symbol">))</a>
  <a id="2032" href="Armor.Prelude.html#3493" class="Function Operator">of</a> <a id="2035" class="Symbol">λ</a> <a id="2037" class="Keyword">where</a>
    <a id="2047" class="Symbol">(</a><a id="2048" href="Armor.Grammar.Option.TCB.html#255" class="InductiveConstructor">some</a> <a id="2053" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2053" class="Bound">x</a> <a id="2055" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2057" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2057" class="Bound">i</a><a id="2058" class="Symbol">)</a> <a id="2060" class="Symbol">→</a> <a id="2062" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2066" class="Symbol">(</a><a id="2067" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="2072" class="Symbol">(</a><a id="2073" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2053" class="Bound">x</a> <a id="2075" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2077" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="2081" class="Symbol">))</a>
    <a id="2088" class="Symbol">(</a><a id="2089" href="Armor.Grammar.Option.TCB.html#235" class="InductiveConstructor">none</a> <a id="2094" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2096" href="Armor.Grammar.Option.TCB.html#255" class="InductiveConstructor">some</a> <a id="2101" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2101" class="Bound">x</a><a id="2102" class="Symbol">)</a> <a id="2104" class="Symbol">→</a> <a id="2106" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2110" class="Symbol">(</a><a id="2111" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="2116" class="Symbol">(</a><a id="2117" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2101" class="Bound">x</a> <a id="2119" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2121" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="2125" class="Symbol">))</a>
    <a id="2132" class="Symbol">(</a><a id="2133" href="Armor.Grammar.Option.TCB.html#235" class="InductiveConstructor">none</a> <a id="2138" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2140" href="Armor.Grammar.Option.TCB.html#235" class="InductiveConstructor">none</a><a id="2144" class="Symbol">)</a> <a id="2146" class="Symbol">→</a> <a id="2148" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2151" href="Data.Sum.Base.html#920" class="Function Operator">Sum.[</a> <a id="2157" class="Symbol">(λ</a> <a id="2160" class="Symbol">())</a> <a id="2164" href="Data.Sum.Base.html#920" class="Function Operator">,</a> <a id="2166" class="Symbol">(λ</a> <a id="2169" class="Symbol">())</a> <a id="2173" href="Data.Sum.Base.html#920" class="Function Operator">]</a>

<a id="isVersion2Or3?"></a><a id="2176" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2176" class="Function">isVersion2Or3?</a> <a id="2191" class="Symbol">:</a> <a id="2193" class="Symbol">∀</a> <a id="2195" class="Symbol">{@</a><a id="2197" class="Symbol">0</a> <a id="2199" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2199" class="Bound">bs</a><a id="2201" class="Symbol">}</a> <a id="2203" class="Symbol">→</a> <a id="2205" class="Symbol">(</a><a id="2206" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2206" class="Bound">c</a> <a id="2208" class="Symbol">:</a> <a id="2210" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="2215" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2199" class="Bound">bs</a><a id="2217" class="Symbol">)</a> <a id="2219" class="Symbol">→</a> <a id="2221" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="2225" class="Symbol">(</a><a id="2226" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1598" class="Function">IsVersion2Or3</a> <a id="2240" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2206" class="Bound">c</a><a id="2241" class="Symbol">)</a>
<a id="2243" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2176" class="Function">isVersion2Or3?</a> <a id="2258" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2258" class="Bound">c</a> <a id="2260" class="Symbol">=</a> <a id="2262" href="Armor.Data.X509.Cert.TCB.html#5795" class="Function">Cert.getVersion</a> <a id="2278" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2258" class="Bound">c</a> <a id="2280" href="Armor.Prelude.html#11173" class="Function Operator">∈?</a> <a id="2283" class="Symbol">_</a>

<a id="scp7"></a><a id="2286" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2286" class="Function">scp7</a> <a id="2291" class="Symbol">:</a> <a id="2293" class="Symbol">∀</a> <a id="2295" class="Symbol">{@</a><a id="2297" class="Symbol">0</a> <a id="2299" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2299" class="Bound">bs</a><a id="2301" class="Symbol">}</a> <a id="2303" class="Symbol">→</a> <a id="2305" class="Symbol">(</a><a id="2306" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2306" class="Bound">c</a> <a id="2308" class="Symbol">:</a> <a id="2310" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="2315" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2299" class="Bound">bs</a><a id="2317" class="Symbol">)</a> <a id="2319" class="Symbol">→</a> <a id="2321" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="2325" class="Symbol">(</a><a id="2326" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1704" class="Function">SCP7</a> <a id="2331" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2306" class="Bound">c</a><a id="2332" class="Symbol">)</a>
<a id="2334" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2286" class="Function">scp7</a> <a id="2339" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2339" class="Bound">c</a> <a id="2341" class="Symbol">=</a> <a id="2343" class="Symbol">(</a><a id="2344" href="Armor.Data.X509.Semantic.Cert.SCP7.html#1785" class="Function">hasUniqueIdentifiers?</a> <a id="2366" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2339" class="Bound">c</a><a id="2367" class="Symbol">)</a> <a id="2369" href="Relation.Nullary.Implication.html#885" class="Function Operator">→-dec</a> <a id="2375" class="Symbol">(</a><a id="2376" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2176" class="Function">isVersion2Or3?</a> <a id="2391" href="Armor.Data.X509.Semantic.Cert.SCP7.html#2339" class="Bound">c</a><a id="2392" class="Symbol">)</a>
</pre></body></html>