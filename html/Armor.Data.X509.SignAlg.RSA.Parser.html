<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.SignAlg.RSA.Parser</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Armor.Data.X509.SignAlg.RSA.TCB.html" class="Module">Armor.Data.X509.SignAlg.RSA.TCB</a>
<a id="70" class="Keyword">import</a>      <a id="82" href="Armor.Data.X509.SignAlg.TCB.OIDs.html" class="Module">Armor.Data.X509.SignAlg.TCB.OIDs</a> <a id="115" class="Symbol">as</a> <a id="118" class="Module">OIDs</a>
<a id="123" class="Keyword">open</a> <a id="128" class="Keyword">import</a> <a id="135" href="Armor.Data.X690-DER.OID.html" class="Module">Armor.Data.X690-DER.OID</a>
<a id="159" class="Keyword">open</a> <a id="164" class="Keyword">import</a> <a id="171" href="Armor.Data.X690-DER.Sequence.DefinedByOID.html" class="Module">Armor.Data.X690-DER.Sequence.DefinedByOID</a>
<a id="213" class="Keyword">open</a> <a id="218" class="Keyword">import</a> <a id="225" href="Armor.Data.X690-DER.TLV.html" class="Module">Armor.Data.X690-DER.TLV</a>
<a id="249" class="Keyword">open</a> <a id="254" class="Keyword">import</a> <a id="261" href="Armor.Data.X690-DER.Null.html" class="Module">Armor.Data.X690-DER.Null</a>
<a id="286" class="Keyword">import</a>      <a id="298" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a>
<a id="324" class="Keyword">import</a>      <a id="336" href="Armor.Grammar.Parallel.html" class="Module">Armor.Grammar.Parallel</a>
<a id="359" class="Keyword">import</a>      <a id="371" href="Armor.Grammar.Parser.html" class="Module">Armor.Grammar.Parser</a>
<a id="392" class="Keyword">open</a> <a id="397" class="Keyword">import</a> <a id="404" href="Armor.Grammar.Option.html" class="Module">Armor.Grammar.Option</a>
<a id="425" class="Keyword">open</a> <a id="430" class="Keyword">import</a> <a id="437" href="Armor.Data.X690-DER.OctetString.html" class="Module">Armor.Data.X690-DER.OctetString</a>
<a id="469" class="Keyword">open</a> <a id="474" class="Keyword">import</a> <a id="481" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="496" class="Keyword">module</a> <a id="503" href="Armor.Data.X509.SignAlg.RSA.Parser.html" class="Module">Armor.Data.X509.SignAlg.RSA.Parser</a> <a id="538" class="Keyword">where</a>

<a id="545" class="Keyword">open</a> <a id="550" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a> <a id="576" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="582" class="Keyword">open</a> <a id="587" href="Armor.Grammar.Parallel.html" class="Module">Armor.Grammar.Parallel</a>    <a id="613" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="619" class="Keyword">open</a> <a id="624" href="Armor.Grammar.Parser.html" class="Module">Armor.Grammar.Parser</a>      <a id="650" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>

<a id="657" class="Keyword">private</a>
  <a id="here&#39;"></a><a id="667" href="Armor.Data.X509.SignAlg.RSA.Parser.html#667" class="Function">here&#39;</a> <a id="673" class="Symbol">=</a> <a id="675" class="String">&quot;X509: SignAlg: RSA&quot;</a>

<a id="parseParams"></a><a id="697" href="Armor.Data.X509.SignAlg.RSA.Parser.html#697" class="Function">parseParams</a> <a id="709" class="Symbol">:</a> <a id="711" class="Symbol">∀</a> <a id="713" href="Armor.Data.X509.SignAlg.RSA.Parser.html#713" class="Bound">n</a> <a id="715" class="Symbol">{@</a><a id="717" class="Symbol">0</a> <a id="719" href="Armor.Data.X509.SignAlg.RSA.Parser.html#719" class="Bound">bs</a><a id="721" class="Symbol">}</a> <a id="723" class="Symbol">→</a> <a id="725" class="Symbol">(</a><a id="726" href="Armor.Data.X509.SignAlg.RSA.Parser.html#726" class="Bound">o</a> <a id="728" class="Symbol">:</a> <a id="730" href="Armor.Data.X690-DER.OID.TCB.html#2963" class="Function">OID</a> <a id="734" href="Armor.Data.X509.SignAlg.RSA.Parser.html#719" class="Bound">bs</a><a id="736" class="Symbol">)</a> <a id="738" class="Symbol">(</a><a id="739" href="Armor.Data.X509.SignAlg.RSA.Parser.html#739" class="Bound">o∈?</a> <a id="743" class="Symbol">:</a> <a id="745" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="749" class="Symbol">((</a><a id="751" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="754" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="762" href="Armor.Data.X509.SignAlg.RSA.Parser.html#726" class="Bound">o</a><a id="763" class="Symbol">)</a> <a id="765" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="767" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#5221" class="Function">OIDs.RSA.Supported</a><a id="785" class="Symbol">))</a>
              <a id="802" class="Symbol">→</a> <a id="804" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="811" class="Symbol">(</a><a id="812" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="820" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="822" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="825" class="Symbol">)</a> <a id="827" class="Symbol">(</a><a id="828" href="Armor.Grammar.Parallel.TCB.html#1532" class="Function">ExactLength</a> <a id="840" class="Symbol">(</a><a id="841" href="Armor.Data.X509.SignAlg.RSA.TCB.html#4492" class="Function">RSAParams&#39;</a> <a id="852" href="Armor.Data.X509.SignAlg.RSA.Parser.html#726" class="Bound">o</a> <a id="854" href="Armor.Data.X509.SignAlg.RSA.Parser.html#739" class="Bound">o∈?</a><a id="857" class="Symbol">)</a> <a id="859" href="Armor.Data.X509.SignAlg.RSA.Parser.html#713" class="Bound">n</a><a id="860" class="Symbol">)</a>
<a id="862" href="Armor.Data.X509.SignAlg.RSA.Parser.html#697" class="Function">parseParams</a> <a id="874" href="Armor.Data.X509.SignAlg.RSA.Parser.html#874" class="Bound">n</a> <a id="876" href="Armor.Data.X509.SignAlg.RSA.Parser.html#876" class="Bound">o</a> <a id="878" class="Symbol">(</a><a id="879" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="882" href="Armor.Data.X509.SignAlg.RSA.Parser.html#882" class="Bound">¬p</a><a id="884" class="Symbol">)</a> <a id="886" class="Symbol">=</a>
  <a id="890" href="Armor.Grammar.Parallel.Parser.html#3682" class="Function">parseExactLength</a> <a id="907" class="Symbol">(λ</a> <a id="910" class="Keyword">where</a> <a id="916" class="Symbol">_</a> <a id="918" class="Symbol">())</a> <a id="922" href="Armor.Prelude.html#14764" class="Function">silent</a> <a id="929" href="Armor.Grammar.Parser.Core.html#2514" class="Function">parseFalse</a> <a id="940" href="Armor.Data.X509.SignAlg.RSA.Parser.html#874" class="Bound">n</a>
<a id="942" href="Armor.Data.X509.SignAlg.RSA.Parser.html#697" class="Function">parseParams</a> <a id="954" href="Armor.Data.X509.SignAlg.RSA.Parser.html#954" class="Bound">n</a> <a id="956" href="Armor.Data.X509.SignAlg.RSA.Parser.html#956" class="Bound">o</a> <a id="958" class="Symbol">(</a><a id="959" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="963" href="Armor.Data.X509.SignAlg.RSA.Parser.html#963" class="Bound">p</a><a id="964" class="Symbol">)</a> <a id="966" class="Symbol">=</a>
  <a id="970" href="Armor.Prelude.html#3493" class="Function Operator">case</a> <a id="975" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3782" class="Function">splitRSA∈</a> <a id="985" href="Armor.Data.X509.SignAlg.RSA.Parser.html#956" class="Bound">o</a> <a id="987" href="Armor.Data.X509.SignAlg.RSA.Parser.html#963" class="Bound">p</a>
    <a id="993" href="Armor.Prelude.html#3493" class="Function Operator">ret</a> <a id="997" class="Symbol">(λ</a> <a id="1000" href="Armor.Data.X509.SignAlg.RSA.Parser.html#1000" class="Bound">∈?</a> <a id="1003" class="Symbol">→</a> <a id="1005" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="1012" class="Symbol">(</a><a id="1013" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="1021" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1023" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="1026" class="Symbol">)</a> <a id="1028" class="Symbol">(</a><a id="1029" href="Armor.Grammar.Parallel.TCB.html#1532" class="Function">ExactLength</a> <a id="1041" class="Symbol">(</a><a id="1042" href="Armor.Data.X509.SignAlg.RSA.TCB.html#3985" class="Function">RSAParams“</a> <a id="1053" href="Armor.Data.X509.SignAlg.RSA.Parser.html#956" class="Bound">o</a> <a id="1055" href="Armor.Data.X509.SignAlg.RSA.Parser.html#1000" class="Bound">∈?</a><a id="1057" class="Symbol">)</a> <a id="1059" href="Armor.Data.X509.SignAlg.RSA.Parser.html#954" class="Bound">n</a><a id="1060" class="Symbol">))</a>
    <a id="1067" href="Armor.Prelude.html#3493" class="Function Operator">of</a> <a id="1070" class="Symbol">λ</a> <a id="1072" class="Keyword">where</a>
    <a id="1082" class="Symbol">(</a><a id="1083" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="1088" href="Armor.Data.X509.SignAlg.RSA.Parser.html#1088" class="Bound">x</a><a id="1089" class="Symbol">)</a> <a id="1091" class="Symbol">→</a> <a id="1093" href="Armor.Grammar.Parallel.Parser.html#3682" class="Function">parseExactLength</a> <a id="1110" href="Armor.Data.X690-DER.TLV.Properties.html#592" class="Function">TLV.nosubstrings</a>
                 <a id="1144" class="Symbol">(</a><a id="1145" href="Armor.Prelude.html#14236" class="Field">tell</a> <a id="1150" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1152" href="Armor.Data.X509.SignAlg.RSA.Parser.html#667" class="Function">here&#39;</a> <a id="1158" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1168" class="String">&quot;: parameter should be null&quot;</a><a id="1196" class="Symbol">)</a> <a id="1198" href="Armor.Data.X690-DER.Null.Parser.html#473" class="Function">Null.parse</a> <a id="1209" href="Armor.Data.X509.SignAlg.RSA.Parser.html#954" class="Bound">n</a>
    <a id="1215" class="Symbol">(</a><a id="1216" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="1221" class="Symbol">(</a><a id="1222" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="1227" href="Armor.Data.X509.SignAlg.RSA.Parser.html#1227" class="Bound">x</a><a id="1228" class="Symbol">))</a> <a id="1231" class="Symbol">→</a> <a id="1233" href="Armor.Grammar.Option.Parser.html#4268" class="Function">Option.parseOption₁ExactLength</a> <a id="1264" class="Symbol">_</a> <a id="1266" href="Armor.Data.X690-DER.TLV.Properties.html#592" class="Function">TLV.nosubstrings</a>
                  <a id="1301" class="Symbol">(</a><a id="1302" href="Armor.Prelude.html#14236" class="Field">tell</a> <a id="1307" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1309" href="Armor.Data.X509.SignAlg.RSA.Parser.html#667" class="Function">here&#39;</a> <a id="1315" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1325" class="String">&quot;: parameter should be null or absent&quot;</a><a id="1363" class="Symbol">)</a> <a id="1365" href="Armor.Data.X690-DER.Null.Parser.html#473" class="Function">Null.parse</a> <a id="1376" href="Armor.Data.X509.SignAlg.RSA.Parser.html#954" class="Bound">n</a>
    <a id="1382" class="Symbol">(</a><a id="1383" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="1388" class="Symbol">(</a><a id="1389" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="1394" href="Armor.Data.X509.SignAlg.RSA.Parser.html#1394" class="Bound">y</a><a id="1395" class="Symbol">))</a> <a id="1398" class="Symbol">→</a> <a id="1400" href="Armor.Grammar.Parallel.Parser.html#3682" class="Function">parseExactLength</a> <a id="1417" href="Armor.Data.X690-DER.TLV.Properties.html#592" class="Function">TLV.nosubstrings</a>
                         <a id="1459" class="Symbol">(</a><a id="1460" href="Armor.Prelude.html#14236" class="Field">tell</a> <a id="1465" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1467" href="Armor.Data.X509.SignAlg.RSA.Parser.html#667" class="Function">here&#39;</a> <a id="1473" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1483" class="String">&quot;: parameter must be present&quot;</a><a id="1512" class="Symbol">)</a>
                         <a id="1539" class="Symbol">(</a><a id="1540" href="Armor.Data.X690-DER.TLV.Parser.html#788" class="Function">parseTLV</a> <a id="1549" class="Symbol">_</a> <a id="1551" class="String">&quot;TLV underflow&quot;</a> <a id="1567" class="Symbol">_</a> <a id="1569" href="Armor.Data.X690-DER.OctetString.Parser.html#494" class="Function">OctetString.parseValue</a><a id="1591" class="Symbol">)</a>
                         <a id="1618" href="Armor.Data.X509.SignAlg.RSA.Parser.html#954" class="Bound">n</a>
 
<a id="parse"></a><a id="1622" href="Armor.Data.X509.SignAlg.RSA.Parser.html#1622" class="Function">parse</a> <a id="1628" class="Symbol">:</a> <a id="1630" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="1637" class="Symbol">(</a><a id="1638" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="1646" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1648" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="1651" class="Symbol">)</a> <a id="1653" href="Armor.Data.X509.SignAlg.RSA.TCB.html#5567" class="Function">RSA</a>
<a id="1657" href="Armor.Data.X509.SignAlg.RSA.Parser.html#1622" class="Function">parse</a> <a id="1663" class="Symbol">=</a> <a id="1665" href="Armor.Data.X690-DER.Sequence.DefinedByOID.Parser.html#1562" class="Function">DefinedByOID.parse</a> <a id="1684" href="Armor.Data.X509.SignAlg.RSA.Parser.html#667" class="Function">here&#39;</a> <a id="1690" class="Symbol">λ</a> <a id="1692" href="Armor.Data.X509.SignAlg.RSA.Parser.html#1692" class="Bound">n</a> <a id="1694" href="Armor.Data.X509.SignAlg.RSA.Parser.html#1694" class="Bound">o</a> <a id="1696" class="Symbol">→</a> <a id="1698" href="Armor.Data.X509.SignAlg.RSA.Parser.html#697" class="Function">parseParams</a> <a id="1710" href="Armor.Data.X509.SignAlg.RSA.Parser.html#1692" class="Bound">n</a> <a id="1712" href="Armor.Data.X509.SignAlg.RSA.Parser.html#1694" class="Bound">o</a> <a id="1714" class="Symbol">(((</a><a id="1717" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="1720" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="1728" href="Armor.Data.X509.SignAlg.RSA.Parser.html#1694" class="Bound">o</a><a id="1729" class="Symbol">)</a> <a id="1731" href="Armor.Prelude.html#11173" class="Function Operator">∈?</a> <a id="1734" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#5221" class="Function">OIDs.RSA.Supported</a><a id="1752" class="Symbol">))</a>
</pre></body></html>