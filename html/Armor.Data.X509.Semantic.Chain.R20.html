<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.Semantic.Chain.R20</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--sized-types</a> <a id="27" class="Symbol">#-}</a>

<a id="32" class="Keyword">open</a> <a id="37" class="Keyword">import</a> <a id="44" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="57" class="Keyword">open</a> <a id="62" class="Keyword">import</a> <a id="69" href="Armor.Data.X509.html" class="Module">Armor.Data.X509</a>
<a id="85" class="Keyword">open</a> <a id="90" class="Keyword">import</a> <a id="97" href="Armor.Data.X509.Semantic.Cert.Utils.html" class="Module">Armor.Data.X509.Semantic.Cert.Utils</a>
<a id="133" class="Keyword">open</a> <a id="138" class="Keyword">import</a> <a id="145" href="Armor.Data.X509.Semantic.Chain.NameMatch.html" class="Module">Armor.Data.X509.Semantic.Chain.NameMatch</a>
<a id="186" class="Keyword">import</a>      <a id="198" href="Armor.Data.X509.Semantic.Chain.TCB.html" class="Module">Armor.Data.X509.Semantic.Chain.TCB</a> <a id="233" class="Symbol">as</a> <a id="236" class="Module">Chain</a>
<a id="242" class="Keyword">import</a>      <a id="254" href="Armor.Grammar.Option.html" class="Module">Armor.Grammar.Option</a>
<a id="275" class="Keyword">open</a> <a id="280" class="Keyword">import</a> <a id="287" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="302" class="Keyword">module</a> <a id="309" href="Armor.Data.X509.Semantic.Chain.R20.html" class="Module">Armor.Data.X509.Semantic.Chain.R20</a> <a id="344" class="Keyword">where</a>

<a id="351" class="Keyword">open</a> <a id="356" href="Armor.Grammar.Option.html" class="Module">Armor.Grammar.Option</a> <a id="377" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="383" class="Keyword">open</a> <a id="388" href="Armor.Data.X509.Semantic.Chain.TCB.html" class="Module">Chain</a> <a id="394" class="Keyword">using</a> <a id="400" class="Symbol">(</a><a id="401" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a><a id="406" class="Symbol">)</a>

<a id="409" class="Comment">-- https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.9</a>
<a id="474" class="Comment">-- The PathLenConstraint field is meaningful only if the CA boolean</a>
<a id="542" class="Comment">-- is asserted and the Key Usage extension, if present, asserts the KeyCertSign bit. In this case, it gives</a>
<a id="650" class="Comment">-- the maximum number of non-self-issued intermediate certificates that may follow this certificate in a valid certification path.</a>

<a id="countNextIntCACerts"></a><a id="782" href="Armor.Data.X509.Semantic.Chain.R20.html#782" class="Function">countNextIntCACerts</a> <a id="802" class="Symbol">:</a> <a id="804" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="809" class="Symbol">(</a><a id="810" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="818" class="Symbol">_</a> <a id="820" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="824" class="Symbol">)</a> <a id="826" class="Symbol">→</a> <a id="828" href="Armor.Prelude.html#853" class="Function">ℤ</a> <a id="830" class="Symbol">→</a> <a id="832" href="Armor.Prelude.html#853" class="Function">ℤ</a>
<a id="834" href="Armor.Data.X509.Semantic.Chain.R20.html#782" class="Function">countNextIntCACerts</a> <a id="854" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="857" href="Armor.Data.X509.Semantic.Chain.R20.html#857" class="Bound">n</a> <a id="859" class="Symbol">=</a> <a id="861" href="Armor.Data.X509.Semantic.Chain.R20.html#857" class="Bound">n</a>
<a id="863" href="Armor.Data.X509.Semantic.Chain.R20.html#782" class="Function">countNextIntCACerts</a> <a id="883" class="Symbol">((_</a> <a id="887" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="889" href="Armor.Data.X509.Semantic.Chain.R20.html#889" class="Bound">cert</a><a id="893" class="Symbol">)</a> <a id="895" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="897" href="Armor.Data.X509.Semantic.Chain.R20.html#897" class="Bound">certs</a><a id="902" class="Symbol">)</a> <a id="904" href="Armor.Data.X509.Semantic.Chain.R20.html#904" class="Bound">n</a> <a id="906" class="Symbol">=</a>
  <a id="910" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="915" href="Armor.Data.X509.Cert.TCB.html#8276" class="Function">Cert.isCA</a> <a id="925" href="Armor.Data.X509.Semantic.Chain.R20.html#889" class="Bound">cert</a> <a id="930" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="933" class="Symbol">λ</a> <a id="935" class="Keyword">where</a>
    <a id="945" href="Agda.Builtin.Maybe.html#195" class="InductiveConstructor">nothing</a> <a id="953" class="Symbol">→</a> <a id="955" href="Armor.Data.X509.Semantic.Chain.R20.html#782" class="Function">countNextIntCACerts</a> <a id="975" href="Armor.Data.X509.Semantic.Chain.R20.html#897" class="Bound">certs</a> <a id="981" href="Armor.Data.X509.Semantic.Chain.R20.html#904" class="Bound">n</a>
    <a id="987" class="Symbol">(</a><a id="988" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="993" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="998" class="Symbol">)</a> <a id="1000" class="Symbol">→</a> <a id="1002" href="Armor.Data.X509.Semantic.Chain.R20.html#782" class="Function">countNextIntCACerts</a> <a id="1022" href="Armor.Data.X509.Semantic.Chain.R20.html#897" class="Bound">certs</a> <a id="1028" href="Armor.Data.X509.Semantic.Chain.R20.html#904" class="Bound">n</a>
    <a id="1034" class="Symbol">(</a><a id="1035" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1040" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="1044" class="Symbol">)</a> <a id="1046" class="Symbol">→</a> <a id="1048" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="1053" href="Armor.Data.X509.Semantic.Chain.NameMatch.html#7512" class="Function">nameMatch?</a> <a id="1064" class="Symbol">(</a><a id="1065" href="Armor.Data.X509.Cert.TCB.html#7367" class="Function">Cert.getIssuer</a> <a id="1080" href="Armor.Data.X509.Semantic.Chain.R20.html#889" class="Bound">cert</a><a id="1084" class="Symbol">)</a> <a id="1086" class="Symbol">(</a><a id="1087" href="Armor.Data.X509.Cert.TCB.html#7440" class="Function">Cert.getSubject</a> <a id="1103" href="Armor.Data.X509.Semantic.Chain.R20.html#889" class="Bound">cert</a><a id="1107" class="Symbol">)</a> <a id="1109" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="1112" class="Symbol">λ</a> <a id="1114" class="Keyword">where</a>
      <a id="1126" class="Symbol">(</a><a id="1127" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a>  <a id="1131" class="Symbol">_)</a> <a id="1134" class="Symbol">→</a> <a id="1136" href="Armor.Data.X509.Semantic.Chain.R20.html#782" class="Function">countNextIntCACerts</a> <a id="1156" href="Armor.Data.X509.Semantic.Chain.R20.html#897" class="Bound">certs</a> <a id="1162" class="Symbol">(</a><a id="1163" href="Armor.Data.X509.Semantic.Chain.R20.html#904" class="Bound">n</a> <a id="1165" href="Data.Integer.Base.html#4844" class="Function Operator">ℤ.+</a> <a id="1169" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">ℤ.+</a> <a id="1173" class="Number">1</a><a id="1174" class="Symbol">)</a>
      <a id="1182" class="Symbol">(</a><a id="1183" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1187" class="Symbol">_)</a> <a id="1190" class="Symbol">→</a> <a id="1192" href="Armor.Data.X509.Semantic.Chain.R20.html#782" class="Function">countNextIntCACerts</a> <a id="1212" href="Armor.Data.X509.Semantic.Chain.R20.html#897" class="Bound">certs</a> <a id="1218" href="Armor.Data.X509.Semantic.Chain.R20.html#904" class="Bound">n</a>
<a id="1220" class="Comment">--   with isCA (Cert.getBC snd)</a>
<a id="1252" class="Comment">-- ... | false = countNextIntCACerts x₁ n</a>
<a id="1294" class="Comment">-- ... | true</a>
<a id="1308" class="Comment">--   with nameMatch? (Cert.getIssuer snd) (Cert.getSubject snd)</a>
<a id="1372" class="Comment">-- ... | no ¬p =  countNextIntCACerts x₁ (n ℤ.+ ℤ.+ 1) </a>
<a id="1428" class="Comment">-- ... | yes p =  countNextIntCACerts x₁ n</a>

<a id="PathWithinMax"></a><a id="1472" href="Armor.Data.X509.Semantic.Chain.R20.html#1472" class="Function">PathWithinMax</a> <a id="1486" class="Symbol">:</a> <a id="1488" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="1496" class="Symbol">_</a> <a id="1498" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="1503" class="Symbol">→</a> <a id="1505" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1510" class="Symbol">(</a><a id="1511" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="1519" class="Symbol">_</a> <a id="1521" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="1525" class="Symbol">)</a> <a id="1527" class="Symbol">→</a> <a id="1529" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1533" href="Armor.Data.X509.Semantic.Chain.R20.html#1472" class="Function">PathWithinMax</a> <a id="1547" class="Symbol">(_</a> <a id="1550" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1552" href="Armor.Data.X509.Semantic.Chain.R20.html#1552" class="Bound">cert</a><a id="1556" class="Symbol">)</a> <a id="1558" href="Armor.Data.X509.Semantic.Chain.R20.html#1558" class="Bound">certs</a>
  <a id="1566" class="Keyword">with</a> <a id="1571" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="1573" href="Armor.Data.X509.Semantic.Cert.Utils.html#842" class="Function">isConfirmedCA?</a> <a id="1588" href="Armor.Data.X509.Semantic.Chain.R20.html#1552" class="Bound">cert</a> <a id="1593" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a> <a id="1595" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="1597" href="Armor.Data.X509.Semantic.Cert.Utils.html#6481" class="Function">isKeyCertSignPresent</a> <a id="1618" class="Symbol">(</a><a id="1619" href="Armor.Data.X509.Cert.TCB.html#8338" class="Function">Cert.getKU</a> <a id="1630" href="Armor.Data.X509.Semantic.Chain.R20.html#1552" class="Bound">cert</a><a id="1634" class="Symbol">)</a>
<a id="1636" class="Symbol">...</a> <a id="1640" class="Symbol">|</a> <a id="1642" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="1648" class="Symbol">=</a> <a id="1650" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="1652" class="Symbol">...</a> <a id="1656" class="Symbol">|</a> <a id="1658" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
  <a id="1665" class="Keyword">with</a> <a id="1670" href="Armor.Data.X509.Semantic.Cert.Utils.html#1024" class="Function">getBCPathLen</a> <a id="1683" class="Symbol">(</a><a id="1684" href="Armor.Data.X509.Cert.TCB.html#8175" class="Function">Cert.getBC</a> <a id="1695" class="Bound">cert</a><a id="1699" class="Symbol">)</a>
<a id="1701" class="Symbol">...</a> <a id="1705" class="Symbol">|</a> <a id="1707" class="Symbol">(</a><a id="1708" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="1710" class="Symbol">_</a> <a id="1712" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1714" href="Armor.Grammar.Option.TCB.html#235" class="InductiveConstructor">none</a><a id="1718" class="Symbol">)</a> <a id="1720" class="Symbol">=</a> <a id="1722" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="1724" class="Symbol">...</a> <a id="1728" class="Symbol">|</a> <a id="1730" class="Symbol">(_</a> <a id="1733" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1735" href="Armor.Grammar.Option.TCB.html#255" class="InductiveConstructor">some</a> <a id="1740" href="Armor.Data.X509.Semantic.Chain.R20.html#1740" class="Bound">x</a><a id="1741" class="Symbol">)</a> <a id="1743" class="Symbol">=</a> <a id="1745" href="Armor.Data.X509.Semantic.Chain.R20.html#782" class="Function">countNextIntCACerts</a> <a id="1765" class="Bound">certs</a> <a id="1771" class="Symbol">(</a><a id="1772" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">ℤ.+</a> <a id="1776" class="Number">0</a><a id="1777" class="Symbol">)</a> <a id="1779" href="Data.Integer.Base.html#2024" class="Datatype Operator">ℤ.≤</a> <a id="1783" href="Armor.Data.X690-DER.Int.TCB.html#1543" class="Function">Int.getVal</a> <a id="1794" href="Armor.Data.X509.Semantic.Chain.R20.html#1740" class="Bound">x</a>

<a id="1797" class="Comment">--   with isCA (Cert.getBC snd) ∧ isKeyCertSignPresent (Cert.getKU snd)</a>
<a id="1869" class="Comment">-- ... | false = ⊤</a>
<a id="1888" class="Comment">-- ... | true</a>
<a id="1902" class="Comment">--   with (getBCPathLen (Cert.getBC snd))</a>
<a id="1944" class="Comment">-- ... | (─ .[] , none) = ⊤</a>
<a id="1972" class="Comment">-- ... | (fst , some x) = countNextIntCACerts x₁ (ℤ.+ 0) ℤ.≤ Int.getVal x</a>

<a id="AllPathWithinMax"></a><a id="2047" href="Armor.Data.X509.Semantic.Chain.R20.html#2047" class="Function">AllPathWithinMax</a> <a id="2064" class="Symbol">:</a> <a id="2066" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2071" class="Symbol">(</a><a id="2072" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="2080" class="Symbol">_</a> <a id="2082" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="2086" class="Symbol">)</a> <a id="2088" class="Symbol">→</a> <a id="2090" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2094" href="Armor.Data.X509.Semantic.Chain.R20.html#2047" class="Function">AllPathWithinMax</a> <a id="2111" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="2114" class="Symbol">=</a> <a id="2116" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="2118" href="Armor.Data.X509.Semantic.Chain.R20.html#2047" class="Function">AllPathWithinMax</a> <a id="2135" class="Symbol">(</a><a id="2136" href="Armor.Data.X509.Semantic.Chain.R20.html#2136" class="Bound">cert</a> <a id="2141" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2143" href="Armor.Data.X509.Semantic.Chain.R20.html#2143" class="Bound">certs</a><a id="2148" class="Symbol">)</a> <a id="2150" class="Symbol">=</a>  <a id="2153" href="Armor.Data.X509.Semantic.Chain.R20.html#1472" class="Function">PathWithinMax</a> <a id="2167" href="Armor.Data.X509.Semantic.Chain.R20.html#2136" class="Bound">cert</a> <a id="2172" href="Armor.Data.X509.Semantic.Chain.R20.html#2143" class="Bound">certs</a> <a id="2178" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="2180" href="Armor.Data.X509.Semantic.Chain.R20.html#2047" class="Function">AllPathWithinMax</a> <a id="2197" href="Armor.Data.X509.Semantic.Chain.R20.html#2143" class="Bound">certs</a>

<a id="pathWithinMax?"></a><a id="2204" href="Armor.Data.X509.Semantic.Chain.R20.html#2204" class="Function">pathWithinMax?</a> <a id="2219" class="Symbol">:</a> <a id="2221" class="Symbol">(</a><a id="2222" href="Armor.Data.X509.Semantic.Chain.R20.html#2222" class="Bound">c</a> <a id="2224" class="Symbol">:</a> <a id="2226" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="2234" class="Symbol">(</a><a id="2235" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2240" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="2245" class="Symbol">)</a> <a id="2247" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="2251" class="Symbol">)</a> <a id="2253" class="Symbol">→</a> <a id="2255" class="Symbol">(</a><a id="2256" href="Armor.Data.X509.Semantic.Chain.R20.html#2256" class="Bound">t</a> <a id="2258" class="Symbol">:</a> <a id="2260" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2265" class="Symbol">(</a><a id="2266" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="2274" class="Symbol">(</a><a id="2275" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2280" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="2285" class="Symbol">)</a> <a id="2287" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="2291" class="Symbol">))</a> <a id="2294" class="Symbol">→</a> <a id="2296" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="2300" class="Symbol">(</a><a id="2301" href="Armor.Data.X509.Semantic.Chain.R20.html#1472" class="Function">PathWithinMax</a> <a id="2315" href="Armor.Data.X509.Semantic.Chain.R20.html#2222" class="Bound">c</a> <a id="2317" href="Armor.Data.X509.Semantic.Chain.R20.html#2256" class="Bound">t</a><a id="2318" class="Symbol">)</a>
<a id="2320" href="Armor.Data.X509.Semantic.Chain.R20.html#2204" class="Function">pathWithinMax?</a> <a id="2335" class="Symbol">(_</a> <a id="2338" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2340" href="Armor.Data.X509.Semantic.Chain.R20.html#2340" class="Bound">cert</a><a id="2344" class="Symbol">)</a> <a id="2346" href="Armor.Data.X509.Semantic.Chain.R20.html#2346" class="Bound">certs</a>
  <a id="2354" class="Keyword">with</a> <a id="2359" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="2361" href="Armor.Data.X509.Semantic.Cert.Utils.html#842" class="Function">isConfirmedCA?</a> <a id="2376" href="Armor.Data.X509.Semantic.Chain.R20.html#2340" class="Bound">cert</a> <a id="2381" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a> <a id="2383" href="Data.Bool.Base.html#986" class="Function Operator">∧</a> <a id="2385" href="Armor.Data.X509.Semantic.Cert.Utils.html#6481" class="Function">isKeyCertSignPresent</a> <a id="2406" class="Symbol">(</a><a id="2407" href="Armor.Data.X509.Cert.TCB.html#8338" class="Function">Cert.getKU</a> <a id="2418" href="Armor.Data.X509.Semantic.Chain.R20.html#2340" class="Bound">cert</a><a id="2422" class="Symbol">)</a>
<a id="2424" class="Symbol">...</a> <a id="2428" class="Symbol">|</a> <a id="2430" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="2436" class="Symbol">=</a> <a id="2438" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2442" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
<a id="2445" class="Symbol">...</a> <a id="2449" class="Symbol">|</a> <a id="2451" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
  <a id="2458" class="Keyword">with</a> <a id="2463" href="Armor.Data.X509.Semantic.Cert.Utils.html#1024" class="Function">getBCPathLen</a> <a id="2476" class="Symbol">(</a><a id="2477" href="Armor.Data.X509.Cert.TCB.html#8175" class="Function">Cert.getBC</a> <a id="2488" class="Bound">cert</a><a id="2492" class="Symbol">)</a>
<a id="2494" class="Symbol">...</a> <a id="2498" class="Symbol">|</a> <a id="2500" class="Symbol">(</a><a id="2501" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="2503" class="DottedPattern Symbol">.</a><a id="2504" href="Agda.Builtin.List.html#185" class="DottedPattern InductiveConstructor">[]</a> <a id="2507" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2509" href="Armor.Grammar.Option.TCB.html#235" class="InductiveConstructor">none</a><a id="2513" class="Symbol">)</a> <a id="2515" class="Symbol">=</a> <a id="2517" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2521" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
<a id="2524" class="Symbol">...</a> <a id="2528" class="Symbol">|</a> <a id="2530" class="Symbol">(</a><a id="2531" href="Armor.Data.X509.Semantic.Chain.R20.html#2531" class="Bound">fst</a> <a id="2535" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2537" href="Armor.Grammar.Option.TCB.html#255" class="InductiveConstructor">some</a> <a id="2542" href="Armor.Data.X509.Semantic.Chain.R20.html#2542" class="Bound">x</a><a id="2543" class="Symbol">)</a> <a id="2545" class="Symbol">=</a> <a id="2547" href="Armor.Data.X509.Semantic.Chain.R20.html#782" class="Function">countNextIntCACerts</a> <a id="2567" class="Bound">certs</a> <a id="2573" class="Symbol">(</a><a id="2574" href="Agda.Builtin.Int.html#264" class="InductiveConstructor Operator">ℤ.+</a> <a id="2578" class="Number">0</a><a id="2579" class="Symbol">)</a> <a id="2581" href="Data.Integer.Properties.html#3624" class="Function Operator">ℤ.≤?</a> <a id="2586" href="Armor.Data.X690-DER.Int.TCB.html#1543" class="Function">Int.getVal</a> <a id="2597" href="Armor.Data.X509.Semantic.Chain.R20.html#2542" class="Bound">x</a>

<a id="2600" class="Keyword">module</a> <a id="2607" href="Armor.Data.X509.Semantic.Chain.R20.html#2607" class="Module">_</a> <a id="2609" class="Symbol">{</a><a id="2610" href="Armor.Data.X509.Semantic.Chain.R20.html#2610" class="Bound">trust</a> <a id="2616" href="Armor.Data.X509.Semantic.Chain.R20.html#2616" class="Bound">candidates</a> <a id="2627" class="Symbol">:</a> <a id="2629" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2634" class="Symbol">(</a><a id="2635" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="2643" class="Symbol">_</a> <a id="2645" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="2649" class="Symbol">)}</a> <a id="2652" class="Symbol">{@</a><a id="2654" class="Symbol">0</a> <a id="2656" href="Armor.Data.X509.Semantic.Chain.R20.html#2656" class="Bound">bs</a><a id="2658" class="Symbol">}</a> <a id="2660" class="Symbol">(</a><a id="2661" href="Armor.Data.X509.Semantic.Chain.R20.html#2661" class="Bound">issuee</a> <a id="2668" class="Symbol">:</a> <a id="2670" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="2675" href="Armor.Data.X509.Semantic.Chain.R20.html#2656" class="Bound">bs</a><a id="2677" class="Symbol">)</a> <a id="2679" class="Keyword">where</a>

  <a id="2688" href="Armor.Data.X509.Semantic.Chain.R20.html#2688" class="Function">R20</a> <a id="2692" class="Symbol">:</a>  <a id="2695" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="2701" href="Armor.Data.X509.Semantic.Chain.R20.html#2610" class="Bound">trust</a> <a id="2707" href="Armor.Data.X509.Semantic.Chain.R20.html#2616" class="Bound">candidates</a> <a id="2718" href="Armor.Data.X509.Semantic.Chain.R20.html#2661" class="Bound">issuee</a> <a id="2725" class="Symbol">→</a> <a id="2727" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="2733" href="Armor.Data.X509.Semantic.Chain.R20.html#2688" class="Function">R20</a> <a id="2737" href="Armor.Data.X509.Semantic.Chain.R20.html#2737" class="Bound">c</a> <a id="2739" class="Symbol">=</a> <a id="2741" href="Armor.Data.X509.Semantic.Chain.R20.html#2047" class="Function">AllPathWithinMax</a> <a id="2758" class="Symbol">(</a><a id="2759" href="Data.List.Base.html#9817" class="Function">reverse</a> <a id="2767" class="Symbol">(</a><a id="2768" href="Armor.Data.X509.Semantic.Chain.TCB.html#5959" class="Function">Chain.toList</a> <a id="2781" href="Armor.Data.X509.Semantic.Chain.R20.html#2737" class="Bound">c</a><a id="2782" class="Symbol">))</a>

  <a id="2788" href="Armor.Data.X509.Semantic.Chain.R20.html#2788" class="Function">r20</a> <a id="2792" class="Symbol">:</a> <a id="2794" href="Relation.Unary.html#3536" class="Function">Decidable</a> <a id="2804" href="Armor.Data.X509.Semantic.Chain.R20.html#2688" class="Function">R20</a>
  <a id="2810" href="Armor.Data.X509.Semantic.Chain.R20.html#2788" class="Function">r20</a> <a id="2814" href="Armor.Data.X509.Semantic.Chain.R20.html#2814" class="Bound">c</a> <a id="2816" class="Symbol">=</a> <a id="2818" href="Armor.Data.X509.Semantic.Chain.R20.html#2877" class="Function">allPathWithinMax?</a> <a id="2836" class="Symbol">(</a><a id="2837" href="Data.List.Base.html#9817" class="Function">reverse</a> <a id="2845" class="Symbol">(</a><a id="2846" href="Armor.Data.X509.Semantic.Chain.TCB.html#5959" class="Function">Chain.toList</a> <a id="2859" href="Armor.Data.X509.Semantic.Chain.R20.html#2814" class="Bound">c</a><a id="2860" class="Symbol">))</a>
    <a id="2867" class="Keyword">where</a>
    <a id="2877" href="Armor.Data.X509.Semantic.Chain.R20.html#2877" class="Function">allPathWithinMax?</a> <a id="2895" class="Symbol">:</a> <a id="2897" class="Symbol">(</a><a id="2898" href="Armor.Data.X509.Semantic.Chain.R20.html#2898" class="Bound">c</a> <a id="2900" class="Symbol">:</a> <a id="2902" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2907" class="Symbol">(</a><a id="2908" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="2916" class="Symbol">(</a><a id="2917" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2922" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="2927" class="Symbol">)</a> <a id="2929" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="2933" class="Symbol">))</a> <a id="2936" class="Symbol">→</a> <a id="2938" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="2942" class="Symbol">(</a><a id="2943" href="Armor.Data.X509.Semantic.Chain.R20.html#2047" class="Function">AllPathWithinMax</a> <a id="2960" href="Armor.Data.X509.Semantic.Chain.R20.html#2898" class="Bound">c</a><a id="2961" class="Symbol">)</a>
    <a id="2967" href="Armor.Data.X509.Semantic.Chain.R20.html#2877" class="Function">allPathWithinMax?</a> <a id="2985" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="2988" class="Symbol">=</a> <a id="2990" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2994" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
    <a id="3001" href="Armor.Data.X509.Semantic.Chain.R20.html#2877" class="Function">allPathWithinMax?</a> <a id="3019" class="Symbol">(</a><a id="3020" href="Armor.Data.X509.Semantic.Chain.R20.html#3020" class="Bound">x</a> <a id="3022" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="3024" href="Armor.Data.X509.Semantic.Chain.R20.html#3024" class="Bound">x₁</a><a id="3026" class="Symbol">)</a> <a id="3028" class="Symbol">=</a> <a id="3030" href="Armor.Data.X509.Semantic.Chain.R20.html#2204" class="Function">pathWithinMax?</a> <a id="3045" href="Armor.Data.X509.Semantic.Chain.R20.html#3020" class="Bound">x</a> <a id="3047" href="Armor.Data.X509.Semantic.Chain.R20.html#3024" class="Bound">x₁</a> <a id="3050" href="Relation.Nullary.Product.html#921" class="Function Operator">×-dec</a> <a id="3056" href="Armor.Data.X509.Semantic.Chain.R20.html#2877" class="Function">allPathWithinMax?</a> <a id="3074" href="Armor.Data.X509.Semantic.Chain.R20.html#3024" class="Bound">x₁</a>
</pre></body></html>