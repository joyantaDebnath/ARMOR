<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X690-DER.OID.TCB</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Armor.Data.X690-DER.TLV.TCB.html" class="Module">Armor.Data.X690-DER.TLV.TCB</a>
<a id="66" class="Keyword">import</a>      <a id="78" href="Armor.Data.X690-DER.Tag.html" class="Module">Armor.Data.X690-DER.Tag</a> <a id="102" class="Symbol">as</a> <a id="105" class="Module">Tag</a>
<a id="109" class="Keyword">open</a> <a id="114" class="Keyword">import</a> <a id="121" href="Armor.Data.X690-DER.SequenceOf.TCB.html" class="Module">Armor.Data.X690-DER.SequenceOf.TCB</a>
<a id="156" class="Keyword">import</a>      <a id="168" href="Armor.Grammar.Definitions.NonMalleable.html" class="Module">Armor.Grammar.Definitions.NonMalleable</a>
<a id="207" class="Keyword">open</a> <a id="212" class="Keyword">import</a> <a id="219" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="234" class="Keyword">module</a> <a id="241" href="Armor.Data.X690-DER.OID.TCB.html" class="Module">Armor.Data.X690-DER.OID.TCB</a> <a id="269" class="Keyword">where</a>

<a id="276" class="Keyword">open</a> <a id="281" href="Armor.Grammar.Definitions.NonMalleable.html" class="Module">Armor.Grammar.Definitions.NonMalleable</a> <a id="320" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>

<a id="327" class="Comment">-- https://www.itu.int/rec/T-REC-X.690-202102-I/en</a>
<a id="378" class="Comment">-- 8.19.1 The encoding of an object identifier value shall be primitive.</a>
<a id="451" class="Comment">-- 8.19.2 The contents octets shall be an (ordered) list of encodings of subidentifiers (see 8.19.3 and 8.19.4) concatenated</a>
<a id="576" class="Comment">-- together.</a>
<a id="589" class="Comment">-- Each subidentifier is represented as a series of (one or more) octets. Bit 8 of each octet indicates whether it is the last in the</a>
<a id="723" class="Comment">-- series: bit 8 of the last octet is zero; bit 8 of each preceding octet is one. Bits 7 to 1 of the octets in the series collectively</a>
<a id="858" class="Comment">-- encode the subidentifier. Conceptually, these groups of bits are concatenated to form an unsigned binary number whose most</a>
<a id="984" class="Comment">-- significant bit is bit 7 of the first octet and whose least significant bit is bit 1 of the last octet. The subidentifier shall be</a>
<a id="1118" class="Comment">-- encoded in the fewest possible octets, that is, the leading octet of the subidentifier shall not have the value 8016.</a>
<a id="1239" class="Comment">-- 8.19.3 The number of subidentifiers (N) shall be one less than the number of object identifier components in the object</a>
<a id="1362" class="Comment">-- identifier value being encoded.</a>
<a id="1397" class="Comment">-- 8.19.4 The numerical value of the first subidentifier is derived from the values of the first two object identifier components</a>
<a id="1527" class="Comment">-- in the object identifier value being encoded, using the formula:</a>
<a id="1595" class="Comment">-- (X*40) + Y</a>
<a id="1609" class="Comment">-- where X is the value of the first object identifier component and Y is the value of the second object identifier component.</a>
<a id="1736" class="Comment">-- NOTE – This packing of the first two object identifier components recognizes that only three values are allocated from the root node,</a>
<a id="1873" class="Comment">-- and at most 39 subsequent values from nodes reached by X = 0 and X = 1.</a>
<a id="1948" class="Comment">-- 8.19.5 The numerical value of the ith subidentifier, (2  i  N) is that of the (i + 1)th object identifier component.</a>

<a id="LeastBytes"></a><a id="2071" href="Armor.Data.X690-DER.OID.TCB.html#2071" class="Function">LeastBytes</a> <a id="2082" class="Symbol">:</a> <a id="2084" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2089" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="2095" class="Symbol">→</a> <a id="2097" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2101" href="Armor.Data.X690-DER.OID.TCB.html#2071" class="Function">LeastBytes</a> <a id="2112" class="Symbol">=</a> <a id="2114" href="Data.Maybe.Base.html#1362" class="Function">maybe</a> <a id="2120" class="Symbol">(</a><a id="2121" href="Data.Fin.Base.html#7331" class="Function Operator">Fin._&gt;</a> <a id="2128" href="Armor.Prelude.html#9247" class="Function Operator">#</a> <a id="2130" class="Number">128</a><a id="2133" class="Symbol">)</a> <a id="2135" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a> <a id="2137" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2139" href="Data.List.Base.html#7061" class="Function">head</a>

<a id="leastBytes?"></a><a id="2145" href="Armor.Data.X690-DER.OID.TCB.html#2145" class="Function">leastBytes?</a> <a id="2157" class="Symbol">:</a> <a id="2159" href="Relation.Unary.html#3536" class="Function">Decidable</a> <a id="2169" href="Armor.Data.X690-DER.OID.TCB.html#2071" class="Function">LeastBytes</a>
<a id="2180" href="Armor.Data.X690-DER.OID.TCB.html#2145" class="Function">leastBytes?</a> <a id="2192" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="2195" class="Symbol">=</a> <a id="2197" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2201" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
<a id="2204" href="Armor.Data.X690-DER.OID.TCB.html#2145" class="Function">leastBytes?</a> <a id="2216" class="Symbol">(</a><a id="2217" href="Armor.Data.X690-DER.OID.TCB.html#2217" class="Bound">b</a> <a id="2219" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2221" href="Armor.Data.X690-DER.OID.TCB.html#2221" class="Bound">bs</a><a id="2223" class="Symbol">)</a> <a id="2225" class="Symbol">=</a> <a id="2227" class="Symbol">(</a><a id="2228" href="Armor.Prelude.html#9247" class="Function Operator">#</a> <a id="2230" class="Number">128</a><a id="2233" class="Symbol">)</a> <a id="2235" href="Data.Fin.Properties.html#8185" class="Function Operator">Fin.&lt;?</a> <a id="2242" href="Armor.Data.X690-DER.OID.TCB.html#2217" class="Bound">b</a>

<a id="leastBytesUnique"></a><a id="2245" href="Armor.Data.X690-DER.OID.TCB.html#2245" class="Function">leastBytesUnique</a> <a id="2262" class="Symbol">:</a> <a id="2264" class="Symbol">∀</a> <a id="2266" class="Symbol">{</a><a id="2267" href="Armor.Data.X690-DER.OID.TCB.html#2267" class="Bound">bs</a><a id="2269" class="Symbol">}</a> <a id="2271" class="Symbol">→</a> <a id="2273" href="Relation.Nullary.html#2040" class="Function">Unique</a> <a id="2280" class="Symbol">(</a><a id="2281" href="Armor.Data.X690-DER.OID.TCB.html#2071" class="Function">LeastBytes</a> <a id="2292" href="Armor.Data.X690-DER.OID.TCB.html#2267" class="Bound">bs</a><a id="2294" class="Symbol">)</a>
<a id="2296" href="Armor.Data.X690-DER.OID.TCB.html#2245" class="Function">leastBytesUnique</a><a id="2312" class="Symbol">{</a><a id="2313" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2315" class="Symbol">}</a> <a id="2317" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a> <a id="2320" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a> <a id="2323" class="Symbol">=</a> <a id="2325" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="2330" href="Armor.Data.X690-DER.OID.TCB.html#2245" class="Function">leastBytesUnique</a><a id="2346" class="Symbol">{</a><a id="2347" href="Armor.Data.X690-DER.OID.TCB.html#2347" class="Bound">b</a> <a id="2349" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2351" href="Armor.Data.X690-DER.OID.TCB.html#2351" class="Bound">bs</a><a id="2353" class="Symbol">}</a> <a id="2355" href="Armor.Data.X690-DER.OID.TCB.html#2355" class="Bound">x₁</a> <a id="2358" href="Armor.Data.X690-DER.OID.TCB.html#2358" class="Bound">x₂</a> <a id="2361" class="Symbol">=</a> <a id="2363" href="Data.Nat.Properties.html#5055" class="Function">≤-irrelevant</a> <a id="2376" href="Armor.Data.X690-DER.OID.TCB.html#2355" class="Bound">x₁</a> <a id="2379" href="Armor.Data.X690-DER.OID.TCB.html#2358" class="Bound">x₂</a>
  <a id="2384" class="Keyword">where</a> <a id="2390" class="Keyword">open</a> <a id="2395" class="Keyword">import</a> <a id="2402" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>

<a id="2423" class="Keyword">record</a> <a id="OIDSub"></a><a id="2430" href="Armor.Data.X690-DER.OID.TCB.html#2430" class="Record">OIDSub</a> <a id="2437" class="Symbol">(@</a><a id="2439" class="Symbol">0</a> <a id="2441" href="Armor.Data.X690-DER.OID.TCB.html#2441" class="Bound">bs</a> <a id="2444" class="Symbol">:</a> <a id="2446" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2451" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="2456" class="Symbol">)</a> <a id="2458" class="Symbol">:</a> <a id="2460" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="2464" class="Keyword">where</a>
  <a id="2472" class="Keyword">constructor</a> <a id="mkOIDSub"></a><a id="2484" href="Armor.Data.X690-DER.OID.TCB.html#2484" class="InductiveConstructor">mkOIDSub</a>
  <a id="2495" class="Keyword">field</a>
    <a id="OIDSub.lₚ"></a><a id="2505" href="Armor.Data.X690-DER.OID.TCB.html#2505" class="Field">lₚ</a> <a id="2508" class="Symbol">:</a> <a id="2510" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2515" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
    <a id="2525" class="Symbol">@</a><a id="2526" class="Symbol">0</a> <a id="OIDSub.lₚ≥128"></a><a id="2528" href="Armor.Data.X690-DER.OID.TCB.html#2528" class="Field">lₚ≥128</a> <a id="2535" class="Symbol">:</a> <a id="2537" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="2541" class="Symbol">(λ</a> <a id="2544" href="Armor.Data.X690-DER.OID.TCB.html#2544" class="Bound">d</a> <a id="2546" class="Symbol">→</a> <a id="2548" href="Armor.Prelude.html#9194" class="Field">toℕ</a> <a id="2552" href="Armor.Data.X690-DER.OID.TCB.html#2544" class="Bound">d</a> <a id="2554" href="Data.Nat.Base.html#1679" class="Function Operator">≥</a> <a id="2556" class="Number">128</a><a id="2559" class="Symbol">)</a> <a id="2561" href="Armor.Data.X690-DER.OID.TCB.html#2505" class="Field">lₚ</a>
    <a id="OIDSub.lₑ"></a><a id="2568" href="Armor.Data.X690-DER.OID.TCB.html#2568" class="Field">lₑ</a>   <a id="2573" class="Symbol">:</a> <a id="2575" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
    <a id="2585" class="Symbol">@</a><a id="2586" class="Symbol">0</a> <a id="OIDSub.lₑ&lt;128"></a><a id="2588" href="Armor.Data.X690-DER.OID.TCB.html#2588" class="Field">lₑ&lt;128</a> <a id="2595" class="Symbol">:</a> <a id="2597" href="Armor.Prelude.html#9194" class="Field">toℕ</a> <a id="2601" href="Armor.Data.X690-DER.OID.TCB.html#2568" class="Field">lₑ</a> <a id="2604" href="Data.Nat.Base.html#1645" class="Function Operator">&lt;</a> <a id="2606" class="Number">128</a>
    <a id="2614" class="Symbol">@</a><a id="2615" class="Symbol">0</a> <a id="OIDSub.leastDigs"></a><a id="2617" href="Armor.Data.X690-DER.OID.TCB.html#2617" class="Field">leastDigs</a> <a id="2627" class="Symbol">:</a> <a id="2629" href="Armor.Data.X690-DER.OID.TCB.html#2071" class="Function">LeastBytes</a> <a id="2640" href="Armor.Data.X690-DER.OID.TCB.html#2505" class="Field">lₚ</a>
    <a id="2647" class="Symbol">@</a><a id="2648" class="Symbol">0</a> <a id="OIDSub.bs≡"></a><a id="2650" href="Armor.Data.X690-DER.OID.TCB.html#2650" class="Field">bs≡</a> <a id="2654" class="Symbol">:</a> <a id="2656" href="Armor.Data.X690-DER.OID.TCB.html#2441" class="Bound">bs</a> <a id="2659" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2661" href="Armor.Data.X690-DER.OID.TCB.html#2505" class="Field">lₚ</a> <a id="2664" href="Data.List.Base.html#10043" class="Function Operator">∷ʳ</a> <a id="2667" href="Armor.Data.X690-DER.OID.TCB.html#2568" class="Field">lₑ</a>

<a id="2671" class="Comment">-- TODO: sharpen this</a>
<a id="RawOIDSub"></a><a id="2693" href="Armor.Data.X690-DER.OID.TCB.html#2693" class="Function">RawOIDSub</a> <a id="2703" class="Symbol">:</a> <a id="2705" href="Armor.Grammar.Definitions.NonMalleable.Base.html#125" class="Record">Raw</a> <a id="2709" href="Armor.Data.X690-DER.OID.TCB.html#2430" class="Record">OIDSub</a>
<a id="2716" href="Armor.Grammar.Definitions.NonMalleable.Base.html#176" class="Field">Raw.D</a> <a id="2722" href="Armor.Data.X690-DER.OID.TCB.html#2693" class="Function">RawOIDSub</a> <a id="2732" class="Symbol">=</a> <a id="2734" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2739" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="2745" href="Armor.Grammar.Definitions.NonMalleable.Base.html#188" class="Field">Raw.to</a> <a id="2752" href="Armor.Data.X690-DER.OID.TCB.html#2693" class="Function">RawOIDSub</a> <a id="2762" class="Symbol">(</a><a id="2763" href="Armor.Data.X690-DER.OID.TCB.html#2484" class="InductiveConstructor">mkOIDSub</a> <a id="2772" href="Armor.Data.X690-DER.OID.TCB.html#2772" class="Bound">lₚ</a> <a id="2775" href="Armor.Data.X690-DER.OID.TCB.html#2775" class="Bound">lₚ≥128</a> <a id="2782" href="Armor.Data.X690-DER.OID.TCB.html#2782" class="Bound">lₑ</a> <a id="2785" href="Armor.Data.X690-DER.OID.TCB.html#2785" class="Bound">lₑ&lt;128</a> <a id="2792" href="Armor.Data.X690-DER.OID.TCB.html#2792" class="Bound">leastDigs</a> <a id="2802" href="Armor.Data.X690-DER.OID.TCB.html#2802" class="Bound">bs≡</a><a id="2805" class="Symbol">)</a> <a id="2807" class="Symbol">=</a> <a id="2809" href="Armor.Data.X690-DER.OID.TCB.html#2772" class="Bound">lₚ</a> <a id="2812" href="Data.List.Base.html#10043" class="Function Operator">∷ʳ</a> <a id="2815" href="Armor.Data.X690-DER.OID.TCB.html#2782" class="Bound">lₑ</a>

<a id="OIDValue"></a><a id="2819" href="Armor.Data.X690-DER.OID.TCB.html#2819" class="Function">OIDValue</a> <a id="2828" class="Symbol">:</a> <a id="2830" class="Symbol">@</a><a id="2831" class="Symbol">0</a> <a id="2833" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2838" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="2844" class="Symbol">→</a> <a id="2846" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2850" href="Armor.Data.X690-DER.OID.TCB.html#2819" class="Function">OIDValue</a> <a id="2859" class="Symbol">=</a> <a id="2861" href="Armor.Data.X690-DER.SequenceOf.TCB.html#1176" class="Function">NonEmptySequenceOf</a> <a id="2880" href="Armor.Data.X690-DER.OID.TCB.html#2430" class="Record">OIDSub</a>

<a id="RawOIDValue"></a><a id="2888" href="Armor.Data.X690-DER.OID.TCB.html#2888" class="Function">RawOIDValue</a> <a id="2900" class="Symbol">:</a> <a id="2902" href="Armor.Grammar.Definitions.NonMalleable.Base.html#125" class="Record">Raw</a> <a id="2906" href="Armor.Data.X690-DER.OID.TCB.html#2819" class="Function">OIDValue</a>
<a id="2915" href="Armor.Data.X690-DER.OID.TCB.html#2888" class="Function">RawOIDValue</a> <a id="2927" class="Symbol">=</a> <a id="2929" href="Armor.Data.X690-DER.SequenceOf.TCB.html#1645" class="Function">RawBoundedSequenceOf</a> <a id="2950" href="Armor.Data.X690-DER.OID.TCB.html#2693" class="Function">RawOIDSub</a> <a id="2960" class="Number">1</a>

<a id="OID"></a><a id="2963" href="Armor.Data.X690-DER.OID.TCB.html#2963" class="Function">OID</a> <a id="2967" class="Symbol">:</a> <a id="2969" class="Symbol">@</a><a id="2970" class="Symbol">0</a> <a id="2972" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2977" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="2983" class="Symbol">→</a> <a id="2985" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2989" href="Armor.Data.X690-DER.OID.TCB.html#2963" class="Function">OID</a> <a id="2993" class="Symbol">=</a> <a id="2995" href="Armor.Data.X690-DER.TLV.TCB.html#534" class="Record">TLV</a> <a id="2999" href="Armor.Data.X690-DER.Tag.html#293" class="Function">Tag.ObjectIdentifier</a> <a id="3020" href="Armor.Data.X690-DER.OID.TCB.html#2819" class="Function">OIDValue</a>

<a id="RawOID"></a><a id="3030" href="Armor.Data.X690-DER.OID.TCB.html#3030" class="Function">RawOID</a> <a id="3037" class="Symbol">:</a> <a id="3039" href="Armor.Grammar.Definitions.NonMalleable.Base.html#125" class="Record">Raw</a> <a id="3043" href="Armor.Data.X690-DER.OID.TCB.html#2963" class="Function">OID</a>
<a id="3047" href="Armor.Data.X690-DER.OID.TCB.html#3030" class="Function">RawOID</a> <a id="3054" class="Symbol">=</a> <a id="3056" href="Armor.Data.X690-DER.TLV.TCB.html#1272" class="Function">RawTLV</a> <a id="3063" class="Symbol">_</a> <a id="3065" href="Armor.Data.X690-DER.OID.TCB.html#2888" class="Function">RawOIDValue</a>
</pre></body></html>