<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.Semantic.Chain.R19</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--sized-types</a> <a id="27" class="Symbol">#-}</a>

<a id="32" class="Keyword">open</a> <a id="37" class="Keyword">import</a> <a id="44" href="Armor.Data.X509.html" class="Module">Armor.Data.X509</a>
<a id="60" class="Comment">-- open import Armor.Data.X509.Semantic.Cert.Utils</a>
<a id="111" class="Comment">--   using (IsConfirmedCA ; isConfirmedCA?)</a>
<a id="155" class="Keyword">import</a>      <a id="167" href="Armor.Data.X509.Semantic.Chain.TCB.html" class="Module">Armor.Data.X509.Semantic.Chain.TCB</a> <a id="202" class="Symbol">as</a> <a id="205" class="Module">Chain</a>
<a id="211" class="Keyword">open</a> <a id="216" class="Keyword">import</a> <a id="223" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="238" class="Keyword">module</a> <a id="245" href="Armor.Data.X509.Semantic.Chain.R19.html" class="Module">Armor.Data.X509.Semantic.Chain.R19</a> <a id="280" class="Keyword">where</a>

<a id="287" class="Keyword">open</a> <a id="292" href="Armor.Data.X509.Semantic.Chain.TCB.html" class="Module">Chain</a> <a id="298" class="Keyword">using</a> <a id="304" class="Symbol">(</a><a id="305" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a><a id="310" class="Symbol">)</a>

<a id="313" class="Comment">-- https://datatracker.ietf.org/doc/html/rfc5280#section-6.1.4 (k)</a>
<a id="380" class="Comment">-- Conforming implementations may choose to reject all Version 1 and Version 2 intermediate CA certificates</a>

<a id="489" class="Keyword">module</a> <a id="496" href="Armor.Data.X509.Semantic.Chain.R19.html#496" class="Module">_</a> <a id="498" class="Symbol">{</a><a id="499" href="Armor.Data.X509.Semantic.Chain.R19.html#499" class="Bound">trust</a> <a id="505" href="Armor.Data.X509.Semantic.Chain.R19.html#505" class="Bound">candidates</a> <a id="516" class="Symbol">:</a> <a id="518" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="523" class="Symbol">(</a><a id="524" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="532" class="Symbol">_</a> <a id="534" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="538" class="Symbol">)}</a> <a id="541" class="Symbol">{@</a><a id="543" class="Symbol">0</a> <a id="545" href="Armor.Data.X509.Semantic.Chain.R19.html#545" class="Bound">bs</a><a id="547" class="Symbol">}</a> <a id="549" class="Symbol">(</a><a id="550" href="Armor.Data.X509.Semantic.Chain.R19.html#550" class="Bound">issuee</a> <a id="557" class="Symbol">:</a> <a id="559" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="564" href="Armor.Data.X509.Semantic.Chain.R19.html#545" class="Bound">bs</a><a id="566" class="Symbol">)</a> <a id="568" class="Keyword">where</a>

  <a id="577" href="Armor.Data.X509.Semantic.Chain.R19.html#577" class="Function">R19</a> <a id="581" class="Symbol">:</a> <a id="583" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="589" href="Armor.Data.X509.Semantic.Chain.R19.html#499" class="Bound">trust</a> <a id="595" href="Armor.Data.X509.Semantic.Chain.R19.html#505" class="Bound">candidates</a> <a id="606" href="Armor.Data.X509.Semantic.Chain.R19.html#550" class="Bound">issuee</a> <a id="613" class="Symbol">→</a> <a id="615" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="621" href="Armor.Data.X509.Semantic.Chain.R19.html#577" class="Function">R19</a> <a id="625" href="Armor.Data.X509.Semantic.Chain.R19.html#625" class="Bound">c</a> <a id="627" class="Symbol">=</a> <a id="629" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="633" class="Symbol">(λ</a> <a id="636" class="Keyword">where</a> <a id="642" class="Symbol">(</a><a id="643" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="645" class="Symbol">_</a> <a id="647" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="649" href="Armor.Data.X509.Semantic.Chain.R19.html#649" class="Bound">cert</a><a id="653" class="Symbol">)</a> <a id="655" class="Symbol">→</a> <a id="657" href="Armor.Data.X509.Cert.TCB.html#5795" class="Function">Cert.getVersion</a> <a id="673" href="Armor.Data.X509.Semantic.Chain.R19.html#649" class="Bound">cert</a> <a id="678" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="680" href="Armor.Data.X509.TBSCert.Version.TCB.html#1405" class="InductiveConstructor">TBSCert.v3</a><a id="690" class="Symbol">)</a> <a id="692" class="Symbol">(</a><a id="693" href="Armor.Data.X509.Semantic.Chain.TCB.html#6606" class="Function">Chain.getIntermediates</a> <a id="716" href="Armor.Data.X509.Semantic.Chain.R19.html#625" class="Bound">c</a><a id="717" class="Symbol">)</a>

  <a id="722" href="Armor.Data.X509.Semantic.Chain.R19.html#722" class="Function">r19</a> <a id="726" class="Symbol">:</a> <a id="728" href="Relation.Unary.html#3536" class="Function">Decidable</a> <a id="738" href="Armor.Data.X509.Semantic.Chain.R19.html#577" class="Function">R19</a>
  <a id="744" href="Armor.Data.X509.Semantic.Chain.R19.html#722" class="Function">r19</a> <a id="748" href="Armor.Data.X509.Semantic.Chain.R19.html#748" class="Bound">c</a> <a id="750" class="Symbol">=</a> <a id="752" href="Data.List.Relation.Unary.All.html#6240" class="Function">All.all?</a> <a id="761" class="Symbol">(λ</a> <a id="764" class="Keyword">where</a> <a id="770" class="Symbol">(</a><a id="771" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="773" class="Symbol">_</a> <a id="775" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="777" href="Armor.Data.X509.Semantic.Chain.R19.html#777" class="Bound">cert</a><a id="781" class="Symbol">)</a> <a id="783" class="Symbol">→</a> <a id="785" class="Symbol">_</a> <a id="787" href="Armor.Prelude.html#10989" class="Field Operator">≟</a> <a id="789" href="Armor.Data.X509.TBSCert.Version.TCB.html#1405" class="InductiveConstructor">TBSCert.v3</a><a id="799" class="Symbol">)</a> <a id="801" class="Symbol">_</a>
</pre></body></html>