<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.Extension.BC.TCB</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Armor.Data.X690-DER.Boool.TCB.html" class="Module">Armor.Data.X690-DER.Boool.TCB</a>
<a id="68" class="Keyword">open</a> <a id="73" class="Keyword">import</a> <a id="80" href="Armor.Data.X690-DER.Boool.Eq.html" class="Module">Armor.Data.X690-DER.Boool.Eq</a>
<a id="109" class="Keyword">open</a> <a id="114" class="Keyword">import</a> <a id="121" href="Armor.Data.X690-DER.Default.TCB.html" class="Module">Armor.Data.X690-DER.Default.TCB</a>
<a id="153" class="Keyword">open</a> <a id="158" class="Keyword">import</a> <a id="165" href="Armor.Data.X690-DER.Int.TCB.html" class="Module">Armor.Data.X690-DER.Int.TCB</a>
<a id="193" class="Keyword">open</a> <a id="198" class="Keyword">import</a> <a id="205" href="Armor.Data.X690-DER.Length.TCB.html" class="Module">Armor.Data.X690-DER.Length.TCB</a>
<a id="236" class="Keyword">open</a> <a id="241" class="Keyword">import</a> <a id="248" href="Armor.Data.X690-DER.TLV.TCB.html" class="Module">Armor.Data.X690-DER.TLV.TCB</a>
<a id="276" class="Keyword">open</a> <a id="281" class="Keyword">import</a> <a id="288" href="Armor.Data.X690-DER.TLV.Properties.html" class="Module">Armor.Data.X690-DER.TLV.Properties</a>
<a id="323" class="Keyword">import</a>      <a id="335" href="Armor.Data.X690-DER.Tag.html" class="Module">Armor.Data.X690-DER.Tag</a> <a id="359" class="Symbol">as</a> <a id="362" class="Module">Tag</a>
<a id="366" class="Keyword">import</a>      <a id="378" href="Armor.Grammar.Option.html" class="Module">Armor.Grammar.Option</a>
<a id="399" class="Keyword">import</a>      <a id="411" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a>
<a id="437" class="Keyword">import</a>      <a id="449" href="Armor.Grammar.Seq.TCB.html" class="Module">Armor.Grammar.Seq.TCB</a>
<a id="471" class="Keyword">open</a> <a id="476" class="Keyword">import</a> <a id="483" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="498" class="Keyword">module</a> <a id="505" href="Armor.Data.X509.Extension.BC.TCB.html" class="Module">Armor.Data.X509.Extension.BC.TCB</a> <a id="538" class="Keyword">where</a>

<a id="545" class="Keyword">open</a> <a id="550" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a> <a id="576" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="582" class="Keyword">open</a> <a id="587" href="Armor.Grammar.Option.html" class="Module">Armor.Grammar.Option</a> <a id="608" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="614" class="Keyword">open</a> <a id="619" href="Armor.Grammar.Seq.TCB.html" class="Module">Armor.Grammar.Seq.TCB</a> <a id="641" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>

<a id="648" class="Comment">-- https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.9</a>
<a id="713" class="Comment">--    id-ce-basicConstraints OBJECT IDENTIFIER ::=  { id-ce 19 }</a>

<a id="779" class="Comment">--    BasicConstraints ::= SEQUENCE {</a>
<a id="817" class="Comment">--         cA                      BOOLEAN DEFAULT FALSE,</a>
<a id="875" class="Comment">--         pathLenConstraint       INTEGER (0..MAX) OPTIONAL }</a>

<a id="939" class="Keyword">record</a> <a id="BCFieldsSeqFields"></a><a id="946" href="Armor.Data.X509.Extension.BC.TCB.html#946" class="Record">BCFieldsSeqFields</a> <a id="964" class="Symbol">(@</a><a id="966" class="Symbol">0</a> <a id="968" href="Armor.Data.X509.Extension.BC.TCB.html#968" class="Bound">bs</a> <a id="971" class="Symbol">:</a> <a id="973" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="978" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="983" class="Symbol">)</a> <a id="985" class="Symbol">:</a> <a id="987" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="991" class="Keyword">where</a>
  <a id="999" class="Keyword">constructor</a> <a id="mkBCFieldsSeqFields"></a><a id="1011" href="Armor.Data.X509.Extension.BC.TCB.html#1011" class="InductiveConstructor">mkBCFieldsSeqFields</a>
  <a id="1033" class="Keyword">field</a>
    <a id="1043" class="Symbol">@</a><a id="1044" class="Symbol">0</a> <a id="1046" class="Symbol">{</a><a id="BCFieldsSeqFields.ca"></a><a id="1047" href="Armor.Data.X509.Extension.BC.TCB.html#1047" class="Field">ca</a> <a id="BCFieldsSeqFields.pl"></a><a id="1050" href="Armor.Data.X509.Extension.BC.TCB.html#1050" class="Field">pl</a><a id="1052" class="Symbol">}</a> <a id="1054" class="Symbol">:</a> <a id="1056" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1061" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
    <a id="BCFieldsSeqFields.bcca"></a><a id="1071" href="Armor.Data.X509.Extension.BC.TCB.html#1071" class="Field">bcca</a> <a id="1076" class="Symbol">:</a> <a id="1078" href="Armor.Data.X690-DER.Default.TCB.html#593" class="Record">Default</a> <a id="1086" href="Armor.Data.X690-DER.Boool.TCB.html#1093" class="Function">Boool</a> <a id="1092" href="Armor.Data.X690-DER.Boool.TCB.html#1283" class="Function">falseBoool</a> <a id="1103" href="Armor.Data.X509.Extension.BC.TCB.html#1047" class="Field">ca</a>
    <a id="BCFieldsSeqFields.bcpathlen"></a><a id="1110" href="Armor.Data.X509.Extension.BC.TCB.html#1110" class="Field">bcpathlen</a> <a id="1120" class="Symbol">:</a> <a id="1122" href="Armor.Grammar.Option.TCB.html#175" class="Datatype">Option</a> <a id="1129" href="Armor.Data.X690-DER.Int.TCB.html#1491" class="Function">Int</a> <a id="1133" href="Armor.Data.X509.Extension.BC.TCB.html#1050" class="Field">pl</a>
    <a id="1140" class="Symbol">@</a><a id="1141" class="Symbol">0</a> <a id="BCFieldsSeqFields.bs≡"></a><a id="1143" href="Armor.Data.X509.Extension.BC.TCB.html#1143" class="Field">bs≡</a>  <a id="1148" class="Symbol">:</a> <a id="1150" href="Armor.Data.X509.Extension.BC.TCB.html#968" class="Bound">bs</a> <a id="1153" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1155" href="Armor.Data.X509.Extension.BC.TCB.html#1047" class="Field">ca</a> <a id="1158" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="1161" href="Armor.Data.X509.Extension.BC.TCB.html#1050" class="Field">pl</a>

  <a id="BCFieldsSeqFields.isCA"></a><a id="1167" href="Armor.Data.X509.Extension.BC.TCB.html#1167" class="Function">isCA</a> <a id="1172" class="Symbol">:</a> <a id="1174" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
  <a id="1181" href="Armor.Data.X509.Extension.BC.TCB.html#1167" class="Function">isCA</a> <a id="1186" class="Symbol">=</a> <a id="1188" href="Armor.Data.X690-DER.Boool.TCB.html#1013" class="Field">BoolValue.v</a> <a id="1200" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1202" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="1210" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1212" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="1218" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1220" href="Armor.Data.X690-DER.Default.TCB.html#818" class="Function">Default.getValue</a> <a id="1237" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1239" href="Armor.Data.X509.Extension.BC.TCB.html#1071" class="Field">bcca</a>

<a id="BCFieldsSeq"></a><a id="1245" href="Armor.Data.X509.Extension.BC.TCB.html#1245" class="Function">BCFieldsSeq</a> <a id="1257" class="Symbol">:</a> <a id="1259" class="Symbol">@</a><a id="1260" class="Symbol">0</a> <a id="1262" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1267" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="1273" class="Symbol">→</a> <a id="1275" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1279" href="Armor.Data.X509.Extension.BC.TCB.html#1245" class="Function">BCFieldsSeq</a> <a id="1291" href="Armor.Data.X509.Extension.BC.TCB.html#1291" class="Bound">xs</a> <a id="1294" class="Symbol">=</a> <a id="1296" href="Armor.Data.X690-DER.TLV.TCB.html#534" class="Record">TLV</a> <a id="1300" href="Armor.Data.X690-DER.Tag.html#776" class="Function">Tag.Sequence</a>  <a id="1314" href="Armor.Data.X509.Extension.BC.TCB.html#946" class="Record">BCFieldsSeqFields</a> <a id="1332" href="Armor.Data.X509.Extension.BC.TCB.html#1291" class="Bound">xs</a>

<a id="BCFields"></a><a id="1336" href="Armor.Data.X509.Extension.BC.TCB.html#1336" class="Function">BCFields</a> <a id="1345" class="Symbol">:</a> <a id="1347" class="Symbol">@</a><a id="1348" class="Symbol">0</a> <a id="1350" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1355" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="1361" class="Symbol">→</a> <a id="1363" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1367" href="Armor.Data.X509.Extension.BC.TCB.html#1336" class="Function">BCFields</a> <a id="1376" href="Armor.Data.X509.Extension.BC.TCB.html#1376" class="Bound">xs</a> <a id="1379" class="Symbol">=</a> <a id="1381" href="Armor.Data.X690-DER.TLV.TCB.html#534" class="Record">TLV</a> <a id="1385" href="Armor.Data.X690-DER.Tag.html#229" class="Function">Tag.OctetString</a>  <a id="1402" href="Armor.Data.X509.Extension.BC.TCB.html#1245" class="Function">BCFieldsSeq</a> <a id="1414" href="Armor.Data.X509.Extension.BC.TCB.html#1376" class="Bound">xs</a>

<a id="isCA"></a><a id="1418" href="Armor.Data.X509.Extension.BC.TCB.html#1418" class="Function">isCA</a> <a id="1423" class="Symbol">:</a> <a id="1425" class="Symbol">∀</a> <a id="1427" class="Symbol">{@</a><a id="1429" class="Symbol">0</a> <a id="1431" href="Armor.Data.X509.Extension.BC.TCB.html#1431" class="Bound">bs</a><a id="1433" class="Symbol">}</a> <a id="1435" class="Symbol">→</a> <a id="1437" href="Armor.Data.X509.Extension.BC.TCB.html#1336" class="Function">BCFields</a> <a id="1446" href="Armor.Data.X509.Extension.BC.TCB.html#1431" class="Bound">bs</a> <a id="1449" class="Symbol">→</a> <a id="1451" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="1456" href="Armor.Data.X509.Extension.BC.TCB.html#1418" class="Function">isCA</a> <a id="1461" href="Armor.Data.X509.Extension.BC.TCB.html#1461" class="Bound">bcf</a> <a id="1465" class="Symbol">=</a> <a id="1467" href="Armor.Data.X509.Extension.BC.TCB.html#1167" class="Function">BCFieldsSeqFields.isCA</a> <a id="1490" class="Symbol">(</a><a id="1491" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="1499" class="Symbol">(</a><a id="1500" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="1508" href="Armor.Data.X509.Extension.BC.TCB.html#1461" class="Bound">bcf</a><a id="1511" class="Symbol">))</a>

<a id="BCFieldsSeqFieldsRep"></a><a id="1515" href="Armor.Data.X509.Extension.BC.TCB.html#1515" class="Function">BCFieldsSeqFieldsRep</a> <a id="1536" class="Symbol">=</a> <a id="1538" href="Armor.Grammar.Seq.TCB.html#474" class="Function">&amp;ₚ</a> <a id="1541" class="Symbol">(</a><a id="1542" href="Armor.Data.X690-DER.Default.TCB.html#593" class="Record">Default</a> <a id="1550" href="Armor.Data.X690-DER.Boool.TCB.html#1093" class="Function">Boool</a> <a id="1556" href="Armor.Data.X690-DER.Boool.TCB.html#1283" class="Function">falseBoool</a><a id="1566" class="Symbol">)</a> <a id="1568" class="Symbol">(</a><a id="1569" href="Armor.Grammar.Option.TCB.html#175" class="Datatype">Option</a> <a id="1576" href="Armor.Data.X690-DER.Int.TCB.html#1491" class="Function">Int</a><a id="1579" class="Symbol">)</a>

<a id="equivalentBCFieldsSeqFields"></a><a id="1582" href="Armor.Data.X509.Extension.BC.TCB.html#1582" class="Function">equivalentBCFieldsSeqFields</a> <a id="1610" class="Symbol">:</a> <a id="1612" href="Armor.Grammar.Definitions.Iso.Base.html#87" class="Function">Equivalent</a> <a id="1623" href="Armor.Data.X509.Extension.BC.TCB.html#1515" class="Function">BCFieldsSeqFieldsRep</a> <a id="1644" href="Armor.Data.X509.Extension.BC.TCB.html#946" class="Record">BCFieldsSeqFields</a>
<a id="1662" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="1668" href="Armor.Data.X509.Extension.BC.TCB.html#1582" class="Function">equivalentBCFieldsSeqFields</a> <a id="1696" class="Symbol">(</a><a id="1697" href="Armor.Grammar.Seq.TCB.html#330" class="InductiveConstructor">Armor.Grammar.Seq.TCB.mk&amp;ₚ</a> <a id="1724" href="Armor.Data.X509.Extension.BC.TCB.html#1724" class="Bound">fstₚ₁</a> <a id="1730" href="Armor.Data.X509.Extension.BC.TCB.html#1730" class="Bound">sndₚ₁</a> <a id="1736" href="Armor.Data.X509.Extension.BC.TCB.html#1736" class="Bound">bs≡</a><a id="1739" class="Symbol">)</a> <a id="1741" class="Symbol">=</a> <a id="1743" href="Armor.Data.X509.Extension.BC.TCB.html#1011" class="InductiveConstructor">mkBCFieldsSeqFields</a> <a id="1763" href="Armor.Data.X509.Extension.BC.TCB.html#1724" class="Bound">fstₚ₁</a> <a id="1769" href="Armor.Data.X509.Extension.BC.TCB.html#1730" class="Bound">sndₚ₁</a> <a id="1775" href="Armor.Data.X509.Extension.BC.TCB.html#1736" class="Bound">bs≡</a>
<a id="1779" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="1785" href="Armor.Data.X509.Extension.BC.TCB.html#1582" class="Function">equivalentBCFieldsSeqFields</a> <a id="1813" class="Symbol">(</a><a id="1814" href="Armor.Data.X509.Extension.BC.TCB.html#1011" class="InductiveConstructor">mkBCFieldsSeqFields</a> <a id="1834" href="Armor.Data.X509.Extension.BC.TCB.html#1834" class="Bound">bcca</a> <a id="1839" href="Armor.Data.X509.Extension.BC.TCB.html#1839" class="Bound">bcpathlen</a> <a id="1849" href="Armor.Data.X509.Extension.BC.TCB.html#1849" class="Bound">bs≡</a><a id="1852" class="Symbol">)</a> <a id="1854" class="Symbol">=</a> <a id="1856" href="Armor.Grammar.Seq.TCB.html#330" class="InductiveConstructor">Armor.Grammar.Seq.TCB.mk&amp;ₚ</a> <a id="1883" href="Armor.Data.X509.Extension.BC.TCB.html#1834" class="Bound">bcca</a> <a id="1888" href="Armor.Data.X509.Extension.BC.TCB.html#1839" class="Bound">bcpathlen</a> <a id="1898" href="Armor.Data.X509.Extension.BC.TCB.html#1849" class="Bound">bs≡</a>

<a id="RawBCFieldsSeqFieldsRep"></a><a id="1903" href="Armor.Data.X509.Extension.BC.TCB.html#1903" class="Function">RawBCFieldsSeqFieldsRep</a> <a id="1927" class="Symbol">:</a> <a id="1929" href="Armor.Grammar.Definitions.NonMalleable.Base.html#125" class="Record">Raw</a> <a id="1933" href="Armor.Data.X509.Extension.BC.TCB.html#1515" class="Function">BCFieldsSeqFieldsRep</a>
<a id="1954" href="Armor.Data.X509.Extension.BC.TCB.html#1903" class="Function">RawBCFieldsSeqFieldsRep</a> <a id="1978" class="Symbol">=</a> <a id="1980" href="Armor.Grammar.Seq.TCB.html#827" class="Function">Raw&amp;ₚ</a> <a id="1986" class="Symbol">(</a><a id="1987" href="Armor.Data.X690-DER.Default.TCB.html#929" class="Function">RawDefault</a> <a id="1998" href="Armor.Data.X690-DER.Boool.TCB.html#1218" class="Function">RawBoool</a> <a id="2007" href="Armor.Data.X690-DER.Boool.TCB.html#1283" class="Function">falseBoool</a><a id="2017" class="Symbol">)</a> <a id="2019" class="Symbol">(</a><a id="2020" href="Armor.Grammar.Option.TCB.html#896" class="Function">RawOption</a> <a id="2030" href="Armor.Data.X690-DER.Int.TCB.html#1814" class="Function">RawInt</a><a id="2036" class="Symbol">)</a>

<a id="RawBCFieldsSeqFields"></a><a id="2039" href="Armor.Data.X509.Extension.BC.TCB.html#2039" class="Function">RawBCFieldsSeqFields</a> <a id="2060" class="Symbol">:</a> <a id="2062" href="Armor.Grammar.Definitions.NonMalleable.Base.html#125" class="Record">Raw</a> <a id="2066" href="Armor.Data.X509.Extension.BC.TCB.html#946" class="Record">BCFieldsSeqFields</a>
<a id="2084" href="Armor.Data.X509.Extension.BC.TCB.html#2039" class="Function">RawBCFieldsSeqFields</a> <a id="2105" class="Symbol">=</a> <a id="2107" href="Armor.Grammar.Definitions.Iso.Properties.html#2456" class="Function">Iso.raw</a> <a id="2115" href="Armor.Data.X509.Extension.BC.TCB.html#1582" class="Function">equivalentBCFieldsSeqFields</a> <a id="2143" href="Armor.Data.X509.Extension.BC.TCB.html#1903" class="Function">RawBCFieldsSeqFieldsRep</a>

<a id="RawBCFields"></a><a id="2168" href="Armor.Data.X509.Extension.BC.TCB.html#2168" class="Function">RawBCFields</a> <a id="2180" class="Symbol">:</a> <a id="2182" href="Armor.Grammar.Definitions.NonMalleable.Base.html#125" class="Record">Raw</a> <a id="2186" href="Armor.Data.X509.Extension.BC.TCB.html#1336" class="Function">BCFields</a>
<a id="2195" href="Armor.Data.X509.Extension.BC.TCB.html#2168" class="Function">RawBCFields</a> <a id="2207" class="Symbol">=</a> <a id="2209" href="Armor.Data.X690-DER.TLV.TCB.html#1272" class="Function">RawTLV</a> <a id="2216" class="Symbol">_</a> <a id="2218" class="Symbol">(</a><a id="2219" href="Armor.Data.X690-DER.TLV.TCB.html#1272" class="Function">RawTLV</a> <a id="2226" class="Symbol">_</a>  <a id="2229" href="Armor.Data.X509.Extension.BC.TCB.html#2039" class="Function">RawBCFieldsSeqFields</a><a id="2249" class="Symbol">)</a>
</pre></body></html>