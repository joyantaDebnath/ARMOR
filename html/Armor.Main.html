<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Main</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--guardedness</a> <a id="27" class="Pragma">--sized-types</a> <a id="41" class="Symbol">#-}</a>

<a id="46" class="Keyword">open</a> <a id="51" class="Keyword">import</a> <a id="58" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="71" class="Keyword">import</a>      <a id="83" href="Armor.Data.Base64.html" class="Module">Armor.Data.Base64</a> <a id="101" class="Symbol">as</a> <a id="104" class="Module">Base64</a>
<a id="111" class="Keyword">import</a>      <a id="123" href="Armor.Data.PEM.html" class="Module">Armor.Data.PEM</a> <a id="138" class="Symbol">as</a> <a id="141" class="Module">PEM</a>
<a id="145" class="Keyword">open</a> <a id="150" class="Keyword">import</a> <a id="157" href="Armor.Data.X509.html" class="Module">Armor.Data.X509</a>
<a id="173" class="Comment">-- open import Armor.Data.X509.ChainBuilder.Exec</a>
<a id="222" class="Keyword">open</a> <a id="227" class="Keyword">import</a> <a id="234" href="Armor.Data.X509.Semantic.Chain.Builder.html" class="Module">Armor.Data.X509.Semantic.Chain.Builder</a>
<a id="273" class="Keyword">open</a> <a id="278" class="Keyword">import</a> <a id="285" href="Armor.Data.X509.Semantic.Chain.TCB.html" class="Module">Armor.Data.X509.Semantic.Chain.TCB</a>
<a id="320" class="Keyword">open</a> <a id="325" class="Keyword">import</a> <a id="332" href="Armor.Data.X509.Semantic.Cert.html" class="Module">Armor.Data.X509.Semantic.Cert</a>
<a id="362" class="Keyword">open</a> <a id="367" class="Keyword">import</a> <a id="374" href="Armor.Data.X509.Semantic.Chain.html" class="Module">Armor.Data.X509.Semantic.Chain</a>
<a id="405" class="Keyword">import</a>      <a id="417" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a>
<a id="443" class="Keyword">import</a>      <a id="455" href="Armor.Grammar.IList.html" class="Module">Armor.Grammar.IList</a>
<a id="475" class="Keyword">open</a> <a id="480" class="Keyword">import</a> <a id="487" href="Armor.Grammar.Parser.html" class="Module">Armor.Grammar.Parser</a>
<a id="508" class="Keyword">import</a>      <a id="520" href="Armor.IO.html" class="Module">Armor.IO</a>
<a id="529" class="Keyword">open</a> <a id="534" class="Keyword">import</a> <a id="541" href="Armor.Foreign.ByteString.html" class="Module">Armor.Foreign.ByteString</a>
  <a id="568" class="Keyword">hiding</a> <a id="575" class="Symbol">(</a><a id="576" href="Armor.Foreign.ByteString.html#492" class="Postulate">foldl</a><a id="581" class="Symbol">)</a>
<a id="583" class="Keyword">import</a>      <a id="595" href="Armor.Foreign.Time.html" class="Module">Armor.Foreign.Time</a> <a id="614" class="Symbol">as</a> <a id="617" class="Module">FFI</a>
<a id="621" class="Keyword">open</a> <a id="626" class="Keyword">import</a> <a id="633" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>
<a id="647" class="Keyword">import</a>      <a id="659" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="679" class="Symbol">as</a> <a id="682" class="Module">Nat</a>
<a id="686" class="Keyword">open</a> <a id="691" class="Keyword">import</a> <a id="698" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a> <a id="712" class="Keyword">renaming</a> <a id="721" class="Symbol">(</a><a id="722" href="Data.Nat.Show.html#1928" class="Function">show</a> <a id="727" class="Symbol">to</a> <a id="730" class="Function">showℕ</a><a id="735" class="Symbol">)</a> 
<a id="738" class="Keyword">import</a>      <a id="750" href="IO.html" class="Module">IO</a>

<a id="754" class="Keyword">module</a> <a id="761" href="Armor.Main.html" class="Module">Armor.Main</a> <a id="772" class="Keyword">where</a>

<a id="779" class="Keyword">open</a> <a id="784" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a> <a id="810" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="816" class="Keyword">open</a> <a id="821" href="Armor.Grammar.IList.html" class="Module">Armor.Grammar.IList</a>       <a id="847" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
  <a id="855" class="Keyword">renaming</a> <a id="864" class="Symbol">(</a><a id="865" href="Armor.Grammar.IList.TCB.html#986" class="Function">toList</a> <a id="872" class="Symbol">to</a> <a id="875" class="Function">ilistToList</a><a id="886" class="Symbol">)</a>

<a id="usage"></a><a id="889" href="Armor.Main.html#889" class="Function">usage</a> <a id="895" class="Symbol">:</a> <a id="897" href="Armor.Prelude.html#3078" class="Function">String</a>
<a id="904" href="Armor.Main.html#889" class="Function">usage</a> <a id="910" class="Symbol">=</a> <a id="912" class="String">&quot;usage: &#39;aeres CERTCHAIN TRUSTEDSTORE&quot;</a>

<a id="952" class="Comment">-- str2dig : String → Maybe (List Dig)</a>
<a id="991" class="Comment">-- str2dig xs = do</a>
<a id="1010" class="Comment">--   bs ← decToMaybe ∘ All.all? (_&lt;? 256) ∘ map toℕ ∘ String.toList $ xs</a>
<a id="1083" class="Comment">--   return (map (λ where (n , n&lt;256) → Fin.fromℕ&lt; n&lt;256) (All.toList bs))</a>

<a id="1159" class="Comment">-- TODO: bindings for returning error codes?</a>
<a id="parseDERCerts"></a><a id="1204" href="Armor.Main.html#1204" class="Function">parseDERCerts</a> <a id="1218" class="Symbol">:</a> <a id="1220" class="Symbol">(</a><a id="1221" href="Armor.Main.html#1221" class="Bound">fileName</a> <a id="1230" class="Symbol">:</a> <a id="1232" href="Armor.Prelude.html#3078" class="Function">String</a><a id="1238" class="Symbol">)</a> <a id="1240" class="Symbol">(</a><a id="1241" href="Armor.Main.html#1241" class="Bound">contents</a> <a id="1250" class="Symbol">:</a> <a id="1252" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1257" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="1262" class="Symbol">)</a> <a id="1264" class="Symbol">→</a> <a id="1266" href="IO.Base.html#917" class="Datatype">IO.IO</a> <a id="1272" class="Symbol">(</a><a id="1273" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="1281" class="Symbol">_</a> <a id="1283" class="Symbol">(</a><a id="1284" href="Armor.Grammar.Parser.Core.html#204" class="Record">Success</a> <a id="1292" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="1298" href="Armor.Data.X509.Cert.TCB.html#10033" class="Function">CertList</a><a id="1306" class="Symbol">))</a>
<a id="1309" href="Armor.Main.html#1204" class="Function">parseDERCerts</a> <a id="1323" href="Armor.Main.html#1323" class="Bound">fn</a> <a id="1326" href="Armor.Main.html#1326" class="Bound">contents</a> <a id="1335" class="Symbol">=</a>
  <a id="1339" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="1344" href="Armor.Grammar.Parser.Core.html#775" class="Field">runParser</a> <a id="1354" href="Armor.Data.X509.Cert.Parser.html#2855" class="Function">parseCertList</a> <a id="1368" href="Armor.Main.html#1326" class="Bound">contents</a> <a id="1377" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="1380" class="Symbol">λ</a> <a id="1382" class="Keyword">where</a>
    <a id="1392" class="Symbol">(</a><a id="1393" href="Armor.Prelude.html#14354" class="InductiveConstructor">mkLogged</a> <a id="1402" href="Armor.Main.html#1402" class="Bound">log₂</a> <a id="1407" class="Symbol">(</a><a id="1408" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a>  <a id="1412" class="Symbol">_))</a> <a id="1416" class="Symbol">→</a>
      <a id="1424" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a>
        <a id="1453" class="Symbol">(</a><a id="1454" href="Armor.Main.html#1323" class="Bound">fn</a> <a id="1457" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1467" class="String">&quot; (decoded): failed to parse bytestring as X.509&quot;</a> <a id="1517" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1527" class="String">&quot;\n&quot;</a>
         <a id="1541" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1551" class="Symbol">(</a><a id="1552" href="Data.List.Base.html#4293" class="Function">foldl</a> <a id="1558" href="Data.String.Base.html#2366" class="Function Operator">String._++_</a> <a id="1570" class="String">&quot;-- &quot;</a> <a id="1576" href="Armor.Main.html#1402" class="Bound">log₂</a><a id="1580" class="Symbol">))</a>
      <a id="1589" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a> <a id="1595" href="System.Exit.html#929" class="Function">Armor.IO.exitFailure</a>
    <a id="1620" class="Symbol">(</a><a id="1621" href="Armor.Prelude.html#14354" class="InductiveConstructor">mkLogged</a> <a id="1630" href="Armor.Main.html#1630" class="Bound">log₂</a> <a id="1635" class="Symbol">(</a><a id="1636" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1640" class="Symbol">(</a><a id="1641" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="1649" href="Armor.Main.html#1649" class="Bound">prefix</a> <a id="1656" href="Armor.Main.html#1656" class="Bound">read</a> <a id="1661" href="Armor.Main.html#1661" class="Bound">read≡</a> <a id="1667" href="Armor.Main.html#1667" class="Bound">chainX509</a> <a id="1677" href="Armor.Main.html#1677" class="Bound">suf</a><a id="1680" class="Symbol">@(_</a> <a id="1684" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1686" class="Symbol">_)</a> <a id="1689" href="Armor.Main.html#1689" class="Bound">ps≡</a><a id="1692" class="Symbol">)))</a> <a id="1696" class="Symbol">→</a>
      <a id="1704" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a>
        <a id="1733" class="Symbol">(</a><a id="1734" href="Armor.Main.html#1323" class="Bound">fn</a> <a id="1737" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1747" class="String">&quot; (decoded): incomplete read\n&quot;</a>
         <a id="1788" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1798" class="String">&quot;-- only read &quot;</a>
           <a id="1825" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1835" class="Symbol">(</a><a id="1836" href="Armor.Main.html#730" class="Function">showℕ</a> <a id="1842" class="Symbol">(</a><a id="1843" href="Armor.Grammar.IList.TCB.html#1703" class="Function">Armor.Grammar.IList.lengthIList</a> <a id="1875" class="Symbol">_</a> <a id="1877" href="Armor.Main.html#1667" class="Bound">chainX509</a><a id="1886" class="Symbol">))</a>
           <a id="1900" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1910" class="String">&quot; certificate(s), but more bytes remain\n&quot;</a>
         <a id="1962" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1972" class="String">&quot;-- attempting to parse remainder&quot;</a><a id="2006" class="Symbol">)</a>
      <a id="2014" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a> <a id="2020" class="Symbol">((</a><a id="2022" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="2027" href="Armor.Grammar.Parser.Core.html#775" class="Field">runParser</a> <a id="2037" href="Armor.Data.X509.Cert.Parser.html#2765" class="Function">parseCert</a> <a id="2047" href="Armor.Main.html#1677" class="Bound">suf</a> <a id="2051" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="2054" class="Symbol">λ</a> <a id="2056" class="Keyword">where</a>
        <a id="2070" class="Symbol">(</a><a id="2071" href="Armor.Prelude.html#14354" class="InductiveConstructor">mkLogged</a> <a id="2080" href="Armor.Main.html#2080" class="Bound">log₃</a> <a id="2085" class="Symbol">(</a><a id="2086" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2090" class="Symbol">_))</a> <a id="2094" class="Symbol">→</a>
          <a id="2106" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> <a id="2127" class="Symbol">(</a><a id="2128" href="Armor.Main.html#1323" class="Bound">fn</a> <a id="2131" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="2141" class="String">&quot; (decoded): parse remainder success (SHOULD NOT HAPPEN)&quot;</a><a id="2198" class="Symbol">)</a>
          <a id="2210" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a> <a id="2216" href="System.Exit.html#929" class="Function">Armor.IO.exitFailure</a>
        <a id="2245" class="Symbol">(</a><a id="2246" href="Armor.Prelude.html#14354" class="InductiveConstructor">mkLogged</a> <a id="2255" href="Armor.Main.html#2255" class="Bound">log₃</a> <a id="2260" class="Symbol">(</a><a id="2261" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2264" class="Symbol">_))</a> <a id="2268" class="Symbol">→</a>
          <a id="2280" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> <a id="2301" class="Symbol">(</a><a id="2302" href="Armor.Main.html#1323" class="Bound">fn</a> <a id="2305" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="2315" class="String">&quot; (decoded): &quot;</a>
            <a id="2342" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="2352" href="Armor.Prelude.html#12433" class="Field">show</a> <a id="2357" class="Symbol">(</a><a id="2358" href="Data.List.Base.html#1544" class="Function">map</a> <a id="2362" href="Armor.Prelude.html#9295" class="Field">toℕ</a> <a id="2366" class="Symbol">(</a><a id="2367" href="Data.List.Base.html#7307" class="Function">take</a> <a id="2372" class="Number">10</a> <a id="2375" href="Armor.Main.html#1677" class="Bound">suf</a><a id="2378" class="Symbol">))</a>
            <a id="2393" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="2403" href="Data.List.Base.html#4293" class="Function">foldl</a> <a id="2409" href="Data.String.Base.html#2366" class="Function Operator">String._++_</a> <a id="2421" class="String">&quot;&quot;</a> <a id="2424" href="Armor.Main.html#2255" class="Bound">log₃</a><a id="2428" class="Symbol">)</a>
          <a id="2440" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a> <a id="2446" href="System.Exit.html#929" class="Function">Armor.IO.exitFailure</a><a id="2466" class="Symbol">))</a>
    <a id="2473" class="CatchallClause Symbol">(</a><a id="2474" href="Armor.Prelude.html#14354" class="CatchallClause InductiveConstructor">mkLogged</a><a id="2482" class="CatchallClause"> </a><a id="2483" href="Armor.Main.html#2483" class="CatchallClause Bound">log₂</a><a id="2487" class="CatchallClause"> </a><a id="2488" class="CatchallClause Symbol">(</a><a id="2489" href="Relation.Nullary.html#1648" class="CatchallClause InductiveConstructor">yes</a><a id="2492" class="CatchallClause"> </a><a id="2493" href="Armor.Main.html#2493" class="CatchallClause Bound">schain</a><a id="2499" class="CatchallClause Symbol">))</a> <a id="2502" class="Symbol">→</a> <a id="2504" href="IO.Base.html#988" class="InductiveConstructor">IO.return</a> <a id="2514" class="Symbol">(_</a> <a id="2517" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2519" href="Armor.Main.html#2493" class="Bound">schain</a><a id="2525" class="Symbol">)</a>

<a id="parseCerts"></a><a id="2528" href="Armor.Main.html#2528" class="Function">parseCerts</a> <a id="2539" class="Symbol">:</a> <a id="2541" class="Symbol">(</a><a id="2542" href="Armor.Main.html#2542" class="Bound">fileName</a> <a id="2551" class="Symbol">:</a> <a id="2553" href="Armor.Prelude.html#3078" class="Function">String</a><a id="2559" class="Symbol">)</a> <a id="2561" class="Symbol">(</a><a id="2562" href="Armor.Main.html#2562" class="Bound">contents</a> <a id="2571" class="Symbol">:</a> <a id="2573" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2578" href="Armor.Prelude.html#329" class="Function">Char</a><a id="2582" class="Symbol">)</a> <a id="2584" class="Symbol">→</a> <a id="2586" href="IO.Base.html#917" class="Datatype">IO.IO</a> <a id="2592" class="Symbol">(</a><a id="2593" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="2601" class="Symbol">_</a> <a id="2603" class="Symbol">(</a><a id="2604" href="Armor.Grammar.Parser.Core.html#204" class="Record">Success</a> <a id="2612" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="2618" href="Armor.Data.X509.Cert.TCB.html#10033" class="Function">CertList</a><a id="2626" class="Symbol">))</a>
<a id="2629" href="Armor.Main.html#2528" class="Function">parseCerts</a> <a id="2640" href="Armor.Main.html#2640" class="Bound">fn</a> <a id="2643" href="Armor.Main.html#2643" class="Bound">input</a> <a id="2649" class="Symbol">=</a>
  <a id="2653" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="2658" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="2664" class="Symbol">(</a><a id="2665" href="Armor.Grammar.Parser.Maximal.html#907" class="Function">LogDec.runMaximalParser</a> <a id="2689" href="Armor.Prelude.html#329" class="Function">Char</a> <a id="2694" href="Armor.Data.PEM.Parser.html#1085" class="Function">PEM.parseCertList</a> <a id="2712" href="Armor.Main.html#2643" class="Bound">input</a><a id="2717" class="Symbol">)</a> <a id="2719" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="2722" class="Symbol">λ</a> <a id="2724" class="Keyword">where</a>
    <a id="2734" class="Symbol">(</a><a id="2735" href="Armor.Prelude.html#14354" class="InductiveConstructor">mkLogged</a> <a id="2744" href="Armor.Main.html#2744" class="Bound">log₁</a> <a id="2749" class="Symbol">(</a><a id="2750" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2753" href="Armor.Main.html#2753" class="Bound">¬p</a><a id="2755" class="Symbol">))</a> <a id="2758" class="Symbol">→</a>
      <a id="2766" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> <a id="2787" class="Symbol">(</a><a id="2788" href="Data.List.Base.html#4293" class="Function">foldl</a> <a id="2794" href="Data.String.Base.html#2366" class="Function Operator">String._++_</a> <a id="2806" class="String">&quot;&quot;</a> <a id="2809" href="Armor.Main.html#2744" class="Bound">log₁</a><a id="2813" class="Symbol">)</a>
      <a id="2821" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a> <a id="2827" href="System.Exit.html#929" class="Function">Armor.IO.exitFailure</a>
    <a id="2852" class="Symbol">(</a><a id="2853" href="Armor.Prelude.html#14354" class="InductiveConstructor">mkLogged</a> <a id="2862" href="Armor.Main.html#2862" class="Bound">log₁</a> <a id="2867" class="Symbol">(</a><a id="2868" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2872" class="Symbol">(</a><a id="2873" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="2881" href="Armor.Main.html#2881" class="Bound">prefix</a> <a id="2888" href="Armor.Main.html#2888" class="Bound">read</a> <a id="2893" href="Armor.Main.html#2893" class="Bound">read≡</a> <a id="2899" href="Armor.Main.html#2899" class="Bound">chain</a> <a id="2905" href="Armor.Main.html#2905" class="Bound">suf</a><a id="2908" class="Symbol">@(_</a> <a id="2912" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2914" class="Symbol">_)</a> <a id="2917" href="Armor.Main.html#2917" class="Bound">ps≡</a><a id="2920" class="Symbol">)))</a> <a id="2924" class="Symbol">→</a>
      <a id="2932" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> 
        <a id="2962" class="Symbol">(</a><a id="2963" href="Armor.Main.html#2640" class="Bound">fn</a> <a id="2966" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="2976" class="String">&quot;: incomplete read\n&quot;</a>
         <a id="3007" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="3017" class="String">&quot;-- only read &quot;</a> <a id="3033" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="3043" class="Symbol">(</a><a id="3044" href="Armor.Main.html#730" class="Function">showℕ</a> <a id="3050" class="Symbol">(</a><a id="3051" href="Armor.Grammar.IList.TCB.html#1703" class="Function">Armor.Grammar.IList.lengthIList</a> <a id="3083" class="Symbol">_</a> <a id="3085" href="Armor.Main.html#2899" class="Bound">chain</a><a id="3090" class="Symbol">))</a>
         <a id="3102" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="3112" class="String">&quot; certificate(s), but &quot;</a> <a id="3136" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="3146" class="Symbol">(</a><a id="3147" href="Armor.Main.html#730" class="Function">showℕ</a> <a id="3153" class="Symbol">(</a><a id="3154" href="Data.List.Base.html#4864" class="Function">length</a> <a id="3161" href="Armor.Main.html#2905" class="Bound">suf</a><a id="3164" class="Symbol">))</a> <a id="3167" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="3177" class="String">&quot; byte(s) remain&quot;</a><a id="3194" class="Symbol">)</a>
      <a id="3202" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a> <a id="3208" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> <a id="3229" class="String">&quot;-- attempting to parse remainder&quot;</a>
      <a id="3270" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a> <a id="3276" class="Symbol">(</a><a id="3277" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="3282" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="3288" class="Symbol">(</a><a id="3289" href="Armor.Grammar.Parser.Maximal.html#907" class="Function">LogDec.runMaximalParser</a> <a id="3313" href="Armor.Prelude.html#329" class="Function">Char</a> <a id="3318" href="Armor.Data.PEM.Parser.html#797" class="Function">PEM.parseCert</a> <a id="3332" href="Armor.Main.html#2905" class="Bound">suf</a><a id="3335" class="Symbol">)</a> <a id="3337" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="3340" class="Symbol">λ</a> <a id="3342" class="Keyword">where</a>
        <a id="3356" class="Symbol">(</a><a id="3357" href="Armor.Prelude.html#14354" class="InductiveConstructor">mkLogged</a> <a id="3366" href="Armor.Main.html#3366" class="Bound">log₂</a> <a id="3371" class="Symbol">(</a><a id="3372" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3376" class="Symbol">_))</a> <a id="3380" class="Symbol">→</a>
          <a id="3392" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> <a id="3413" class="String">&quot;-- parse remainder success (SHOULD NOT HAPPEN!)&quot;</a>
          <a id="3473" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a> <a id="3479" href="System.Exit.html#929" class="Function">Armor.IO.exitFailure</a>
        <a id="3508" class="Symbol">(</a><a id="3509" href="Armor.Prelude.html#14354" class="InductiveConstructor">mkLogged</a> <a id="3518" href="Armor.Main.html#3518" class="Bound">log₂</a> <a id="3523" class="Symbol">(</a><a id="3524" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a>  <a id="3528" class="Symbol">_))</a> <a id="3532" class="Symbol">→</a>
          <a id="3544" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> <a id="3565" class="Symbol">(</a><a id="3566" href="Data.List.Base.html#4293" class="Function">foldl</a> <a id="3572" href="Data.String.Base.html#2366" class="Function Operator">String._++_</a> <a id="3584" class="String">&quot;-- &quot;</a> <a id="3590" href="Armor.Main.html#3518" class="Bound">log₂</a><a id="3594" class="Symbol">)</a>
          <a id="3606" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a> <a id="3612" href="System.Exit.html#929" class="Function">Armor.IO.exitFailure</a><a id="3632" class="Symbol">)</a>
    <a id="3638" class="Symbol">(</a><a id="3639" href="Armor.Prelude.html#14354" class="InductiveConstructor">mkLogged</a> <a id="3648" href="Armor.Main.html#3648" class="Bound">log₁</a> <a id="3653" class="Symbol">(</a><a id="3654" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="3658" class="Symbol">(</a><a id="3659" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="3667" href="Armor.Main.html#3667" class="Bound">prefix</a> <a id="3674" href="Armor.Main.html#3674" class="Bound">read</a> <a id="3679" href="Armor.Main.html#3679" class="Bound">read≡</a> <a id="3685" href="Armor.Main.html#3685" class="Bound">chain</a> <a id="3691" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="3694" href="Armor.Main.html#3694" class="Bound">ps≡</a><a id="3697" class="Symbol">)))</a> <a id="3701" class="Symbol">→</a>
      <a id="3709" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="3714" href="Armor.Grammar.Parser.Core.html#775" class="Field">runParser</a> <a id="3724" href="Armor.Data.X509.Cert.Parser.html#2855" class="Function">parseCertList</a> <a id="3738" class="Symbol">(</a><a id="3739" href="Armor.Data.PEM.TCB.html#1231" class="Function">PEM.extractCerts</a> <a id="3756" href="Armor.Main.html#3685" class="Bound">chain</a><a id="3761" class="Symbol">)</a> <a id="3763" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="3766" class="Symbol">λ</a> <a id="3768" class="Keyword">where</a>
        <a id="3782" class="Symbol">(</a><a id="3783" href="Armor.Prelude.html#14354" class="InductiveConstructor">mkLogged</a> <a id="3792" href="Armor.Main.html#3792" class="Bound">log₂</a> <a id="3797" class="Symbol">(</a><a id="3798" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a>  <a id="3802" class="Symbol">_))</a> <a id="3806" class="Symbol">→</a>
          <a id="3818" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a>
            <a id="3851" class="Symbol">(</a><a id="3852" href="Armor.Main.html#2640" class="Bound">fn</a> <a id="3855" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="3865" class="String">&quot; (decoded): failed to parse PEM as X.509&quot;</a> <a id="3908" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="3918" class="String">&quot;\n&quot;</a>
             <a id="3936" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="3946" class="Symbol">(</a><a id="3947" href="Data.List.Base.html#4293" class="Function">foldl</a> <a id="3953" href="Data.String.Base.html#2366" class="Function Operator">String._++_</a> <a id="3965" class="String">&quot;-- &quot;</a> <a id="3971" href="Armor.Main.html#3792" class="Bound">log₂</a><a id="3975" class="Symbol">))</a>
          <a id="3988" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a> <a id="3994" href="System.Exit.html#929" class="Function">Armor.IO.exitFailure</a>
        <a id="4023" class="Symbol">(</a><a id="4024" href="Armor.Prelude.html#14354" class="InductiveConstructor">mkLogged</a> <a id="4033" href="Armor.Main.html#4033" class="Bound">log₂</a> <a id="4038" class="Symbol">(</a><a id="4039" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="4043" class="Symbol">(</a><a id="4044" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="4052" href="Armor.Main.html#4052" class="Bound">prefix</a> <a id="4059" href="Armor.Main.html#4059" class="Bound">read</a> <a id="4064" href="Armor.Main.html#4064" class="Bound">read≡</a> <a id="4070" href="Armor.Main.html#4070" class="Bound">chainX509</a> <a id="4080" href="Armor.Main.html#4080" class="Bound">suf</a><a id="4083" class="Symbol">@(_</a> <a id="4087" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="4089" class="Symbol">_)</a> <a id="4092" href="Armor.Main.html#4092" class="Bound">ps≡</a><a id="4095" class="Symbol">)))</a> <a id="4099" class="Symbol">→</a>
          <a id="4111" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a>
            <a id="4144" class="Symbol">(</a><a id="4145" href="Armor.Main.html#2640" class="Bound">fn</a> <a id="4148" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="4158" class="String">&quot; (decoded): incomplete read\n&quot;</a>
             <a id="4203" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="4213" class="String">&quot;-- only read &quot;</a>
               <a id="4244" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="4254" class="Symbol">(</a><a id="4255" href="Armor.Main.html#730" class="Function">showℕ</a> <a id="4261" class="Symbol">(</a><a id="4262" href="Armor.Grammar.IList.TCB.html#1703" class="Function">Armor.Grammar.IList.lengthIList</a> <a id="4294" class="Symbol">_</a> <a id="4296" href="Armor.Main.html#4070" class="Bound">chainX509</a><a id="4305" class="Symbol">))</a>
               <a id="4323" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="4333" class="String">&quot; certificate(s), but more bytes remain\n&quot;</a>
             <a id="4389" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="4399" class="String">&quot;-- attempting to parse remainder&quot;</a><a id="4433" class="Symbol">)</a>
          <a id="4445" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a> <a id="4451" class="Symbol">((</a><a id="4453" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="4458" href="Armor.Grammar.Parser.Core.html#775" class="Field">runParser</a> <a id="4468" href="Armor.Data.X509.Cert.Parser.html#2765" class="Function">parseCert</a> <a id="4478" href="Armor.Main.html#4080" class="Bound">suf</a> <a id="4482" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="4485" class="Symbol">λ</a> <a id="4487" class="Keyword">where</a>
            <a id="4505" class="Symbol">(</a><a id="4506" href="Armor.Prelude.html#14354" class="InductiveConstructor">mkLogged</a> <a id="4515" href="Armor.Main.html#4515" class="Bound">log₃</a> <a id="4520" class="Symbol">(</a><a id="4521" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="4525" class="Symbol">_))</a> <a id="4529" class="Symbol">→</a>
              <a id="4545" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> <a id="4566" class="Symbol">(</a><a id="4567" href="Armor.Main.html#2640" class="Bound">fn</a> <a id="4570" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="4580" class="String">&quot; (decoded): parse remainder success (SHOULD NOT HAPPEN)&quot;</a><a id="4637" class="Symbol">)</a>
              <a id="4653" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a> <a id="4659" href="System.Exit.html#929" class="Function">Armor.IO.exitFailure</a>
            <a id="4692" class="Symbol">(</a><a id="4693" href="Armor.Prelude.html#14354" class="InductiveConstructor">mkLogged</a> <a id="4702" href="Armor.Main.html#4702" class="Bound">log₃</a> <a id="4707" class="Symbol">(</a><a id="4708" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="4711" class="Symbol">_))</a> <a id="4715" class="Symbol">→</a>
              <a id="4731" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> <a id="4752" class="Symbol">(</a><a id="4753" href="Armor.Main.html#2640" class="Bound">fn</a> <a id="4756" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="4766" class="String">&quot; (decoded): &quot;</a>
                <a id="4797" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="4807" href="Armor.Prelude.html#12433" class="Field">show</a> <a id="4812" class="Symbol">(</a><a id="4813" href="Data.List.Base.html#1544" class="Function">map</a> <a id="4817" href="Armor.Prelude.html#9295" class="Field">toℕ</a> <a id="4821" class="Symbol">(</a><a id="4822" href="Data.List.Base.html#7307" class="Function">take</a> <a id="4827" class="Number">10</a> <a id="4830" href="Armor.Main.html#4080" class="Bound">suf</a><a id="4833" class="Symbol">))</a>
                <a id="4852" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="4862" href="Data.List.Base.html#4293" class="Function">foldl</a> <a id="4868" href="Data.String.Base.html#2366" class="Function Operator">String._++_</a> <a id="4880" class="String">&quot;&quot;</a> <a id="4883" href="Armor.Main.html#4702" class="Bound">log₃</a><a id="4887" class="Symbol">)</a>
              <a id="4903" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a> <a id="4909" href="System.Exit.html#929" class="Function">Armor.IO.exitFailure</a><a id="4929" class="Symbol">))</a>
        <a id="4940" class="CatchallClause Symbol">(</a><a id="4941" href="Armor.Prelude.html#14354" class="CatchallClause InductiveConstructor">mkLogged</a><a id="4949" class="CatchallClause"> </a><a id="4950" href="Armor.Main.html#4950" class="CatchallClause Bound">log₂</a><a id="4954" class="CatchallClause"> </a><a id="4955" class="CatchallClause Symbol">(</a><a id="4956" href="Relation.Nullary.html#1648" class="CatchallClause InductiveConstructor">yes</a><a id="4959" class="CatchallClause"> </a><a id="4960" href="Armor.Main.html#4960" class="CatchallClause Bound">schain</a><a id="4966" class="CatchallClause Symbol">))</a> <a id="4969" class="Symbol">→</a> <a id="4971" href="IO.Base.html#988" class="InductiveConstructor">IO.return</a> <a id="4981" class="Symbol">(_</a> <a id="4984" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4986" href="Armor.Main.html#4960" class="Bound">schain</a><a id="4992" class="Symbol">)</a>

<a id="4995" class="Comment">-- CertListToList : ∀ {@0 bs} → CertList bs  → List (Exists─ (List UInt8) Cert)</a>
<a id="5075" class="Comment">-- CertListToList nil = []</a>
<a id="5102" class="Comment">-- CertListToList (cons (mkIListCons h t bs≡)) = (_ , h) ∷ helper t</a>
<a id="5170" class="Comment">--   where</a>
<a id="5181" class="Comment">--   helper : ∀ {@0 bs} → IList Cert bs → List (Exists─ (List UInt8) Cert)</a>
<a id="5256" class="Comment">--   helper nil = []</a>
<a id="5277" class="Comment">--   helper (cons (mkIListCons h t bs≡)) = (_ , h) ∷ helper t</a>

<a id="main"></a><a id="5340" href="Armor.Main.html#5340" class="Function">main</a> <a id="5345" class="Symbol">:</a> <a id="5347" href="IO.Base.html#2195" class="Function">IO.Main</a>
<a id="5355" href="Armor.Main.html#5340" class="Function">main</a> <a id="5360" class="Symbol">=</a> <a id="5362" href="IO.Base.html#1884" class="Function">IO.run</a> <a id="5369" href="Function.Base.html#1919" class="Function Operator">$</a>
  <a id="5373" href="Armor.IO.html#1908" class="Function">Armor.IO.getArgs</a> <a id="5390" href="IO.Base.html#1404" class="Function Operator">IO.&gt;&gt;=</a> <a id="5397" class="Symbol">λ</a> <a id="5399" href="Armor.Main.html#5399" class="Bound">args</a> <a id="5404" class="Symbol">→</a>
  <a id="5408" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="5413" href="Armor.Main.html#5399" class="Bound">args</a> <a id="5418" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="5421" class="Symbol">λ</a> <a id="5423" class="Keyword">where</a>
    <a id="5433" class="Symbol">(</a><a id="5434" class="String">&quot;--DER&quot;</a> <a id="5442" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5444" href="Armor.Main.html#5444" class="Bound">certName</a> <a id="5453" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5455" href="Armor.Main.html#5455" class="Bound">rootName</a> <a id="5464" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="5466" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="5468" class="Symbol">)</a> <a id="5470" class="Symbol">→</a>
      <a id="5478" href="Armor.IO.html#1791" class="Function">Armor.IO.openFile</a> <a id="5496" href="Armor.Main.html#5444" class="Bound">certName</a> <a id="5505" href="Armor.IO.html#617" class="Postulate">Armor.IO.Primitive.readMode</a>
      <a id="5539" href="IO.Base.html#1404" class="Function Operator">IO.&gt;&gt;=</a> <a id="5546" class="Symbol">λ</a> <a id="5548" href="Armor.Main.html#5548" class="Bound">h</a> <a id="5550" class="Symbol">→</a> <a id="5552" href="Armor.IO.html#2209" class="Function">Armor.IO.hGetByteStringContents</a> <a id="5584" href="Armor.Main.html#5548" class="Bound">h</a>
      <a id="5592" href="IO.Base.html#1404" class="Function Operator">IO.&gt;&gt;=</a> <a id="5599" class="Symbol">λ</a> <a id="5601" href="Armor.Main.html#5601" class="Bound">contentBS</a> <a id="5611" class="Symbol">→</a> <a id="5613" class="Keyword">let</a> <a id="5617" href="Armor.Main.html#5617" class="Bound">bs</a> <a id="5620" class="Symbol">=</a> <a id="5622" href="Armor.Foreign.ByteString.html#552" class="Function">Armor.Foreign.ByteString.toUInt8</a> <a id="5655" href="Armor.Main.html#5601" class="Bound">contentBS</a> <a id="5665" class="Keyword">in</a>
      <a id="5674" href="Armor.Main.html#1204" class="Function">parseDERCerts</a> <a id="5688" href="Armor.Main.html#5444" class="Bound">certName</a> <a id="5697" href="Armor.Main.html#5617" class="Bound">bs</a>
      <a id="5706" href="IO.Base.html#1404" class="Function Operator">IO.&gt;&gt;=</a> <a id="5713" class="Symbol">λ</a> <a id="5715" href="Armor.Main.html#5715" class="Bound">certS</a> <a id="5721" class="Symbol">→</a> <a id="5723" class="Keyword">let</a> <a id="5727" class="Symbol">(_</a> <a id="5730" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5732" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="5740" href="Armor.Main.html#5740" class="Bound">pre₁</a> <a id="5745" href="Armor.Main.html#5745" class="Bound">r₁</a> <a id="5748" href="Armor.Main.html#5748" class="Bound">r₁≡</a> <a id="5752" href="Armor.Main.html#5752" class="Bound">cert</a> <a id="5757" href="Armor.Main.html#5757" class="Bound">suf₁</a> <a id="5762" href="Armor.Main.html#5762" class="Bound">ps≡₁</a><a id="5766" class="Symbol">)</a> <a id="5768" class="Symbol">=</a> <a id="5770" href="Armor.Main.html#5715" class="Bound">certS</a> <a id="5776" class="Keyword">in</a>
      <a id="5785" href="IO.html#2616" class="Function">IO.readFiniteFile</a> <a id="5803" href="Armor.Main.html#5455" class="Bound">rootName</a>
      <a id="5818" href="IO.Base.html#1404" class="Function Operator">IO.&gt;&gt;=</a> <a id="5825" class="Symbol">(</a><a id="5826" href="Armor.Main.html#2528" class="Function">parseCerts</a> <a id="5837" href="Armor.Main.html#5455" class="Bound">rootName</a> <a id="5846" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="5848" href="Data.String.Base.html#1493" class="Primitive">String.toList</a><a id="5861" class="Symbol">)</a>
      <a id="5869" href="IO.Base.html#1404" class="Function Operator">IO.&gt;&gt;=</a> <a id="5876" class="Symbol">λ</a> <a id="5878" href="Armor.Main.html#5878" class="Bound">rootS</a> <a id="5884" class="Symbol">→</a> <a id="5886" class="Keyword">let</a> <a id="5890" class="Symbol">(_</a> <a id="5893" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5895" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="5903" href="Armor.Main.html#5903" class="Bound">pre₂</a> <a id="5908" href="Armor.Main.html#5908" class="Bound">r₂</a> <a id="5911" href="Armor.Main.html#5911" class="Bound">r₂≡</a> <a id="5915" href="Armor.Main.html#5915" class="Bound">trustedRoot</a> <a id="5927" href="Armor.Main.html#5927" class="Bound">suf₂</a> <a id="5932" href="Armor.Main.html#5932" class="Bound">ps≡₂</a><a id="5936" class="Symbol">)</a> <a id="5938" class="Symbol">=</a> <a id="5940" href="Armor.Main.html#5878" class="Bound">rootS</a> <a id="5946" class="Keyword">in</a>
      <a id="5955" href="Armor.Main.html#11396" class="Function">runCertChecks</a> <a id="5969" class="Symbol">(</a><a id="5970" href="Armor.Main.html#875" class="Function">ilistToList</a> <a id="5982" href="Armor.Main.html#5915" class="Bound">trustedRoot</a><a id="5993" class="Symbol">)</a> <a id="5995" class="Symbol">(</a><a id="5996" href="Armor.Main.html#875" class="Function">ilistToList</a> <a id="6008" href="Armor.Main.html#5752" class="Bound">cert</a><a id="6012" class="Symbol">)</a>
    <a id="6018" class="CatchallClause Symbol">(</a><a id="6019" href="Armor.Main.html#6019" class="CatchallClause Bound">certName</a><a id="6027" class="CatchallClause"> </a><a id="6028" href="Agda.Builtin.List.html#200" class="CatchallClause InductiveConstructor Operator">∷</a><a id="6029" class="CatchallClause"> </a><a id="6030" href="Armor.Main.html#6030" class="CatchallClause Bound">rootName</a><a id="6038" class="CatchallClause"> </a><a id="6039" href="Agda.Builtin.List.html#200" class="CatchallClause InductiveConstructor Operator">∷</a><a id="6040" class="CatchallClause"> </a><a id="6041" href="Agda.Builtin.List.html#185" class="CatchallClause InductiveConstructor">[]</a><a id="6043" class="CatchallClause Symbol">)</a> <a id="6045" class="Symbol">→</a>
      <a id="6053" href="IO.html#2616" class="Function">IO.readFiniteFile</a> <a id="6071" href="Armor.Main.html#6019" class="Bound">certName</a>
      <a id="6086" href="IO.Base.html#1404" class="Function Operator">IO.&gt;&gt;=</a> <a id="6093" class="Symbol">(</a><a id="6094" href="Armor.Main.html#2528" class="Function">parseCerts</a> <a id="6105" href="Armor.Main.html#6019" class="Bound">certName</a> <a id="6114" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="6116" href="Data.String.Base.html#1493" class="Primitive">String.toList</a><a id="6129" class="Symbol">)</a>
      <a id="6137" href="IO.Base.html#1404" class="Function Operator">IO.&gt;&gt;=</a> <a id="6144" class="Symbol">λ</a> <a id="6146" href="Armor.Main.html#6146" class="Bound">certS</a> <a id="6152" class="Symbol">→</a> <a id="6154" class="Keyword">let</a> <a id="6158" class="Symbol">(_</a> <a id="6161" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6163" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="6171" href="Armor.Main.html#6171" class="Bound">pre₁</a> <a id="6176" href="Armor.Main.html#6176" class="Bound">r₁</a> <a id="6179" href="Armor.Main.html#6179" class="Bound">r₁≡</a> <a id="6183" href="Armor.Main.html#6183" class="Bound">cert</a> <a id="6188" href="Armor.Main.html#6188" class="Bound">suf₁</a> <a id="6193" href="Armor.Main.html#6193" class="Bound">ps≡₁</a><a id="6197" class="Symbol">)</a> <a id="6199" class="Symbol">=</a> <a id="6201" href="Armor.Main.html#6146" class="Bound">certS</a> <a id="6207" class="Keyword">in</a>
      <a id="6216" href="IO.html#2616" class="Function">IO.readFiniteFile</a> <a id="6234" href="Armor.Main.html#6030" class="Bound">rootName</a>
      <a id="6249" href="IO.Base.html#1404" class="Function Operator">IO.&gt;&gt;=</a> <a id="6256" class="Symbol">(</a><a id="6257" href="Armor.Main.html#2528" class="Function">parseCerts</a> <a id="6268" href="Armor.Main.html#6030" class="Bound">rootName</a> <a id="6277" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="6279" href="Data.String.Base.html#1493" class="Primitive">String.toList</a><a id="6292" class="Symbol">)</a>
      <a id="6300" href="IO.Base.html#1404" class="Function Operator">IO.&gt;&gt;=</a> <a id="6307" class="Symbol">λ</a> <a id="6309" href="Armor.Main.html#6309" class="Bound">rootS</a> <a id="6315" class="Symbol">→</a> <a id="6317" class="Keyword">let</a> <a id="6321" class="Symbol">(_</a> <a id="6324" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6326" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="6334" href="Armor.Main.html#6334" class="Bound">pre₂</a> <a id="6339" href="Armor.Main.html#6339" class="Bound">r₂</a> <a id="6342" href="Armor.Main.html#6342" class="Bound">r₂≡</a> <a id="6346" href="Armor.Main.html#6346" class="Bound">trustedRoot</a> <a id="6358" href="Armor.Main.html#6358" class="Bound">suf₂</a> <a id="6363" href="Armor.Main.html#6363" class="Bound">ps≡₂</a><a id="6367" class="Symbol">)</a> <a id="6369" class="Symbol">=</a> <a id="6371" href="Armor.Main.html#6309" class="Bound">rootS</a> <a id="6377" class="Keyword">in</a>
      <a id="6386" href="Armor.Main.html#11396" class="Function">runCertChecks</a> <a id="6400" class="Symbol">(</a><a id="6401" href="Armor.Main.html#875" class="Function">ilistToList</a> <a id="6413" href="Armor.Main.html#6346" class="Bound">trustedRoot</a><a id="6424" class="Symbol">)</a> <a id="6426" class="Symbol">(</a><a id="6427" href="Armor.Main.html#875" class="Function">ilistToList</a> <a id="6439" href="Armor.Main.html#6183" class="Bound">cert</a><a id="6443" class="Symbol">)</a>
    <a id="6449" class="CatchallClause Symbol">_</a> <a id="6451" class="Symbol">→</a>
      <a id="6459" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> <a id="6480" href="Armor.Main.html#889" class="Function">usage</a>
      <a id="6492" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a> <a id="6498" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> <a id="6519" class="String">&quot;-- wrong number of arguments passed&quot;</a>
      <a id="6563" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a> <a id="6569" href="System.Exit.html#929" class="Function">Armor.IO.exitFailure</a>

  <a id="6593" class="Keyword">where</a>
  <a id="6601" class="Keyword">record</a> <a id="6608" href="Armor.Main.html#6608" class="Record">Output</a> <a id="6615" class="Symbol">:</a> <a id="6617" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="6621" class="Keyword">where</a>
    <a id="6631" class="Keyword">field</a>
      <a id="6643" href="Armor.Main.html#6643" class="Field">sigAlgOID</a>  <a id="6654" class="Symbol">:</a> <a id="6656" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6661" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
      <a id="6673" href="Armor.Main.html#6673" class="Field">tbsBytes</a>   <a id="6684" class="Symbol">:</a> <a id="6686" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6691" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
      <a id="6703" href="Armor.Main.html#6703" class="Field">pkBytes</a>    <a id="6714" class="Symbol">:</a> <a id="6716" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6721" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
      <a id="6733" href="Armor.Main.html#6733" class="Field">sigBytes</a>   <a id="6744" class="Symbol">:</a> <a id="6746" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6751" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
      <a id="6763" href="Armor.Main.html#6763" class="Field">ekuOIDBytes</a> <a id="6775" class="Symbol">:</a> <a id="6777" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6782" class="Symbol">(</a><a id="6783" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6788" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="6793" class="Symbol">)</a>

  <a id="6798" href="Armor.Main.html#6798" class="Function">certOutput</a> <a id="6809" class="Symbol">:</a> <a id="6811" class="Symbol">∀</a> <a id="6813" class="Symbol">{@</a><a id="6815" class="Symbol">0</a> <a id="6817" href="Armor.Main.html#6817" class="Bound">bs</a><a id="6819" class="Symbol">}</a> <a id="6821" class="Symbol">→</a> <a id="6823" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="6828" href="Armor.Main.html#6817" class="Bound">bs</a> <a id="6831" class="Symbol">→</a> <a id="6833" href="Armor.Main.html#6608" class="Record">Output</a>
  <a id="6842" href="Armor.Main.html#6643" class="Field">Output.sigAlgOID</a> <a id="6859" class="Symbol">(</a><a id="6860" href="Armor.Main.html#6798" class="Function">certOutput</a> <a id="6871" href="Armor.Main.html#6871" class="Bound">x</a><a id="6872" class="Symbol">)</a> <a id="6874" class="Symbol">=</a> <a id="6876" href="Armor.Data.X509.SignAlg.TCB.html#4274" class="Function">SignAlg.getOIDBS</a> <a id="6893" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="6895" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="6901" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="6903" href="Armor.Data.X509.Cert.TCB.html#7809" class="Function">Cert.getTBSCertSignAlg</a> <a id="6926" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="6928" href="Armor.Main.html#6871" class="Bound">x</a>
  <a id="6932" href="Armor.Main.html#6673" class="Field">Output.tbsBytes</a>  <a id="6949" class="Symbol">(</a><a id="6950" href="Armor.Main.html#6798" class="Function">certOutput</a> <a id="6961" href="Armor.Main.html#6961" class="Bound">x</a><a id="6962" class="Symbol">)</a> <a id="6964" class="Symbol">=</a> <a id="6966" href="Armor.Data.X509.Cert.TCB.html#5947" class="Function">Cert.getTBSBytes</a> <a id="6983" href="Armor.Main.html#6961" class="Bound">x</a>
  <a id="6987" href="Armor.Main.html#6703" class="Field">Output.pkBytes</a>   <a id="7004" class="Symbol">(</a><a id="7005" href="Armor.Main.html#6798" class="Function">certOutput</a> <a id="7016" href="Armor.Main.html#7016" class="Bound">x</a><a id="7017" class="Symbol">)</a> <a id="7019" class="Symbol">=</a> <a id="7021" href="Armor.Data.X509.Cert.TCB.html#9126" class="Function">Cert.getPublicKeyBytes</a> <a id="7044" href="Armor.Main.html#7016" class="Bound">x</a>
  <a id="7048" href="Armor.Main.html#6733" class="Field">Output.sigBytes</a>  <a id="7065" class="Symbol">(</a><a id="7066" href="Armor.Main.html#6798" class="Function">certOutput</a> <a id="7077" href="Armor.Main.html#7077" class="Bound">x</a><a id="7078" class="Symbol">)</a> <a id="7080" class="Symbol">=</a> <a id="7082" href="Armor.Data.X509.Cert.TCB.html#9327" class="Function">Cert.getSignatureValueBytes</a> <a id="7110" href="Armor.Main.html#7077" class="Bound">x</a>
  <a id="7114" href="Armor.Main.html#6763" class="Field">Output.ekuOIDBytes</a> <a id="7133" class="Symbol">(</a><a id="7134" href="Armor.Main.html#6798" class="Function">certOutput</a> <a id="7145" href="Armor.Main.html#7145" class="Bound">x</a><a id="7146" class="Symbol">)</a> <a id="7148" class="Symbol">=</a> <a id="7150" href="Armor.Data.X509.Cert.TCB.html#9517" class="Function">Cert.getEKUOIDList</a> <a id="7169" href="Armor.Main.html#7145" class="Bound">x</a> <a id="7171" class="Symbol">(</a><a id="7172" href="Armor.Data.X509.Cert.TCB.html#8439" class="Function">Cert.getEKU</a> <a id="7184" href="Armor.Main.html#7145" class="Bound">x</a><a id="7185" class="Symbol">)</a>

  <a id="7190" href="Armor.Main.html#7190" class="Function">showOutput</a> <a id="7201" class="Symbol">:</a> <a id="7203" href="Armor.Main.html#6608" class="Record">Output</a> <a id="7210" class="Symbol">→</a> <a id="7212" href="Armor.Prelude.html#3078" class="Function">String</a>
  <a id="7221" href="Armor.Main.html#7190" class="Function">showOutput</a> <a id="7232" href="Armor.Main.html#7232" class="Bound">o</a> <a id="7234" class="Symbol">=</a>
              <a id="7250" class="Symbol">(</a><a id="7251" href="Armor.Main.html#7561" class="Function">showBytes</a> <a id="7261" href="Armor.Main.html#6673" class="Field">tbsBytes</a><a id="7269" class="Symbol">)</a>  <a id="7272" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="7282" class="String">&quot;\n&quot;</a>
    <a id="7291" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="7301" class="Symbol">(</a><a id="7302" href="Armor.Main.html#7561" class="Function">showBytes</a> <a id="7312" href="Armor.Main.html#6733" class="Field">sigBytes</a><a id="7320" class="Symbol">)</a>  <a id="7323" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="7333" class="String">&quot;\n&quot;</a>
    <a id="7342" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="7352" class="Symbol">(</a><a id="7353" href="Armor.Main.html#7561" class="Function">showBytes</a> <a id="7363" href="Armor.Main.html#6703" class="Field">pkBytes</a><a id="7370" class="Symbol">)</a>   <a id="7374" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="7384" class="String">&quot;\n&quot;</a>
    <a id="7393" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="7403" class="Symbol">(</a><a id="7404" href="Armor.Main.html#7561" class="Function">showBytes</a> <a id="7414" href="Armor.Main.html#6643" class="Field">sigAlgOID</a><a id="7423" class="Symbol">)</a> <a id="7425" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="7435" class="String">&quot;\n&quot;</a>
    <a id="7444" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="7454" class="Symbol">(</a><a id="7455" href="Armor.Main.html#7678" class="Function">showListBytes</a> <a id="7469" href="Armor.Main.html#6763" class="Field">ekuOIDBytes</a><a id="7480" class="Symbol">)</a> <a id="7482" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="7492" class="String">&quot;\n&quot;</a>
    <a id="7501" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="7511" class="String">&quot;***************&quot;</a>
    <a id="7533" class="Keyword">where</a>
    <a id="7543" class="Keyword">open</a> <a id="7548" href="Armor.Main.html#6608" class="Module">Output</a> <a id="7555" href="Armor.Main.html#7232" class="Bound">o</a>
    <a id="7561" href="Armor.Main.html#7561" class="Function">showBytes</a> <a id="7571" class="Symbol">:</a> <a id="7573" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="7578" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="7584" class="Symbol">→</a> <a id="7586" href="Armor.Prelude.html#3078" class="Function">String</a>
    <a id="7597" href="Armor.Main.html#7561" class="Function">showBytes</a> <a id="7607" href="Armor.Main.html#7607" class="Bound">xs</a> <a id="7610" class="Symbol">=</a> <a id="7612" href="Data.List.Base.html#4192" class="Function">foldr</a> <a id="7618" class="Symbol">(λ</a> <a id="7621" href="Armor.Main.html#7621" class="Bound">b</a> <a id="7623" href="Armor.Main.html#7623" class="Bound">s</a> <a id="7625" class="Symbol">→</a> <a id="7627" href="Armor.Prelude.html#12433" class="Field">show</a> <a id="7632" class="Symbol">(</a><a id="7633" href="Armor.Prelude.html#9295" class="Field">toℕ</a> <a id="7637" href="Armor.Main.html#7621" class="Bound">b</a><a id="7638" class="Symbol">)</a> <a id="7640" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="7650" class="String">&quot; &quot;</a> <a id="7654" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="7664" href="Armor.Main.html#7623" class="Bound">s</a><a id="7665" class="Symbol">)</a> <a id="7667" class="String">&quot;&quot;</a> <a id="7670" href="Armor.Main.html#7607" class="Bound">xs</a>

    <a id="7678" href="Armor.Main.html#7678" class="Function">showListBytes</a> <a id="7692" class="Symbol">:</a> <a id="7694" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="7699" class="Symbol">(</a><a id="7700" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="7705" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="7710" class="Symbol">)</a> <a id="7712" class="Symbol">→</a> <a id="7714" href="Armor.Prelude.html#3078" class="Function">String</a>
    <a id="7725" href="Armor.Main.html#7678" class="Function">showListBytes</a> <a id="7739" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="7742" class="Symbol">=</a> <a id="7744" class="String">&quot;&quot;</a>
    <a id="7751" href="Armor.Main.html#7678" class="Function">showListBytes</a> <a id="7765" class="Symbol">(</a><a id="7766" href="Armor.Main.html#7766" class="Bound">x</a> <a id="7768" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="7770" href="Armor.Main.html#7770" class="Bound">x₁</a><a id="7772" class="Symbol">)</a> <a id="7774" class="Symbol">=</a> <a id="7776" class="Symbol">(</a><a id="7777" href="Armor.Main.html#7561" class="Function">showBytes</a> <a id="7787" href="Armor.Main.html#7766" class="Bound">x</a><a id="7788" class="Symbol">)</a> <a id="7790" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="7800" class="String">&quot;@@ &quot;</a> <a id="7806" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="7816" class="Symbol">(</a><a id="7817" href="Armor.Main.html#7678" class="Function">showListBytes</a> <a id="7831" href="Armor.Main.html#7770" class="Bound">x₁</a><a id="7833" class="Symbol">)</a>


  <a id="7839" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="7848" class="Symbol">:</a> <a id="7850" class="Symbol">∀</a> <a id="7852" class="Symbol">{@</a><a id="7854" class="Symbol">0</a> <a id="7856" href="Armor.Main.html#7856" class="Bound">bs</a><a id="7858" class="Symbol">}</a> <a id="7860" class="Symbol">→</a> <a id="7862" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="7867" href="Armor.Main.html#7856" class="Bound">bs</a> <a id="7870" class="Symbol">→</a> <a id="7872" href="Armor.Prelude.html#3078" class="Function">String</a>
             <a id="7892" class="Symbol">→</a> <a id="7894" class="Symbol">{</a><a id="7895" href="Armor.Main.html#7895" class="Bound">P</a> <a id="7897" class="Symbol">:</a> <a id="7899" class="Symbol">∀</a> <a id="7901" class="Symbol">{@</a><a id="7903" class="Symbol">0</a> <a id="7905" href="Armor.Main.html#7905" class="Bound">bs</a><a id="7907" class="Symbol">}</a> <a id="7909" class="Symbol">→</a> <a id="7911" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="7916" href="Armor.Main.html#7905" class="Bound">bs</a> <a id="7919" class="Symbol">→</a> <a id="7921" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="7924" class="Symbol">}</a>
             <a id="7939" class="Symbol">→</a> <a id="7941" class="Symbol">(∀</a> <a id="7944" class="Symbol">{@</a><a id="7946" class="Symbol">0</a> <a id="7948" href="Armor.Main.html#7948" class="Bound">bs</a><a id="7950" class="Symbol">}</a> <a id="7952" class="Symbol">→</a> <a id="7954" class="Symbol">(</a><a id="7955" href="Armor.Main.html#7955" class="Bound">c</a> <a id="7957" class="Symbol">:</a> <a id="7959" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="7964" href="Armor.Main.html#7948" class="Bound">bs</a><a id="7966" class="Symbol">)</a> <a id="7968" class="Symbol">→</a> <a id="7970" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="7974" class="Symbol">(</a><a id="7975" href="Armor.Main.html#7895" class="Bound">P</a> <a id="7977" href="Armor.Main.html#7955" class="Bound">c</a><a id="7978" class="Symbol">))</a>
             <a id="7994" class="Symbol">→</a> <a id="7996" href="IO.Base.html#917" class="Datatype">IO.IO</a> <a id="8002" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="8006" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="8015" href="Armor.Main.html#8015" class="Bound">c</a> <a id="8017" href="Armor.Main.html#8017" class="Bound">m</a> <a id="8019" href="Armor.Main.html#8019" class="Bound">d</a>
    <a id="8025" class="Keyword">with</a> <a id="8030" href="Armor.Main.html#8019" class="Bound">d</a> <a id="8032" href="Armor.Main.html#8015" class="Bound">c</a>
  <a id="8036" class="Symbol">...</a> <a id="8040" class="Symbol">|</a> <a id="8042" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="8045" href="Armor.Main.html#8045" class="Bound">¬p</a> <a id="8048" class="Symbol">=</a>
    <a id="8054" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> <a id="8075" class="Symbol">(</a><a id="8076" class="Bound">m</a> <a id="8078" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="8088" class="String">&quot;: failed&quot;</a><a id="8098" class="Symbol">)</a> <a id="8100" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
    <a id="8110" href="System.Exit.html#929" class="Function">Armor.IO.exitFailure</a>
  <a id="8133" class="Symbol">...</a> <a id="8137" class="Symbol">|</a> <a id="8139" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="8143" href="Armor.Main.html#8143" class="Bound">p</a> <a id="8145" class="Symbol">=</a>
    <a id="8151" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> <a id="8172" class="Symbol">(</a><a id="8173" class="Bound">m</a> <a id="8175" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="8185" class="String">&quot;: passed&quot;</a><a id="8195" class="Symbol">)</a> <a id="8197" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
    <a id="8207" href="IO.Base.html#988" class="InductiveConstructor">IO.return</a> <a id="8217" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>

  <a id="8223" href="Armor.Main.html#8223" class="Function">runChainCheck</a> <a id="8237" class="Symbol">:</a> <a id="8239" class="Symbol">∀</a> <a id="8241" class="Symbol">{@</a><a id="8243" class="Symbol">0</a> <a id="8245" href="Armor.Main.html#8245" class="Bound">bs</a><a id="8247" class="Symbol">}</a> <a id="8249" class="Symbol">→</a> <a id="8251" class="Symbol">{</a><a id="8252" href="Armor.Main.html#8252" class="Bound">trustedRoot</a> <a id="8264" href="Armor.Main.html#8264" class="Bound">candidates</a> <a id="8275" class="Symbol">:</a> <a id="8277" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="8282" class="Symbol">(</a><a id="8283" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="8291" class="Symbol">_</a> <a id="8293" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="8297" class="Symbol">)}</a> <a id="8300" class="Symbol">→</a> <a id="8302" href="Armor.Prelude.html#3078" class="Function">String</a>
    <a id="8313" class="Symbol">→</a> <a id="8315" class="Symbol">(</a><a id="8316" href="Armor.Main.html#8316" class="Bound">issuee</a> <a id="8323" class="Symbol">:</a> <a id="8325" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="8330" href="Armor.Main.html#8245" class="Bound">bs</a><a id="8332" class="Symbol">)</a> <a id="8334" class="Symbol">→</a> <a id="8336" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="8342" href="Armor.Main.html#8252" class="Bound">trustedRoot</a> <a id="8354" href="Armor.Main.html#8264" class="Bound">candidates</a> <a id="8365" href="Armor.Main.html#8316" class="Bound">issuee</a>
    <a id="8376" class="Symbol">→</a> <a id="8378" class="Symbol">{</a><a id="8379" href="Armor.Main.html#8379" class="Bound">P</a> <a id="8381" class="Symbol">:</a> <a id="8383" class="Symbol">∀</a> <a id="8385" class="Symbol">{@</a><a id="8387" class="Symbol">0</a> <a id="8389" href="Armor.Main.html#8389" class="Bound">bs</a><a id="8391" class="Symbol">}</a> <a id="8393" class="Symbol">→</a> <a id="8395" class="Symbol">(</a><a id="8396" href="Armor.Main.html#8396" class="Bound">i</a> <a id="8398" class="Symbol">:</a> <a id="8400" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="8405" href="Armor.Main.html#8389" class="Bound">bs</a><a id="8407" class="Symbol">)</a> <a id="8409" class="Symbol">→</a> <a id="8411" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="8417" href="Armor.Main.html#8252" class="Bound">trustedRoot</a> <a id="8429" href="Armor.Main.html#8264" class="Bound">candidates</a> <a id="8440" href="Armor.Main.html#8396" class="Bound">i</a> <a id="8442" class="Symbol">→</a> <a id="8444" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="8447" class="Symbol">}</a>
    <a id="8453" class="Symbol">→</a> <a id="8455" class="Symbol">(∀</a> <a id="8458" class="Symbol">{@</a><a id="8460" class="Symbol">0</a> <a id="8462" href="Armor.Main.html#8462" class="Bound">bs</a><a id="8464" class="Symbol">}</a> <a id="8466" class="Symbol">→</a> <a id="8468" class="Symbol">(</a><a id="8469" href="Armor.Main.html#8469" class="Bound">j</a> <a id="8471" class="Symbol">:</a> <a id="8473" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="8478" href="Armor.Main.html#8462" class="Bound">bs</a><a id="8480" class="Symbol">)</a> <a id="8482" class="Symbol">→</a> <a id="8484" class="Symbol">(</a><a id="8485" href="Armor.Main.html#8485" class="Bound">chain</a> <a id="8491" class="Symbol">:</a> <a id="8493" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="8499" href="Armor.Main.html#8252" class="Bound">trustedRoot</a> <a id="8511" href="Armor.Main.html#8264" class="Bound">candidates</a> <a id="8522" href="Armor.Main.html#8469" class="Bound">j</a><a id="8523" class="Symbol">)</a> <a id="8525" class="Symbol">→</a> <a id="8527" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="8531" class="Symbol">(</a><a id="8532" href="Armor.Main.html#8379" class="Bound">P</a> <a id="8534" href="Armor.Main.html#8469" class="Bound">j</a> <a id="8536" href="Armor.Main.html#8485" class="Bound">chain</a><a id="8541" class="Symbol">))</a>
    <a id="8548" class="Symbol">→</a> <a id="8550" href="IO.Base.html#917" class="Datatype">IO.IO</a> <a id="8556" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="8560" href="Armor.Main.html#8223" class="Function">runChainCheck</a> <a id="8574" href="Armor.Main.html#8574" class="Bound">m</a> <a id="8576" href="Armor.Main.html#8576" class="Bound">i</a> <a id="8578" href="Armor.Main.html#8578" class="Bound">c</a> <a id="8580" href="Armor.Main.html#8580" class="Bound">d</a>
    <a id="8586" class="Keyword">with</a> <a id="8591" href="Armor.Main.html#8580" class="Bound">d</a> <a id="8593" href="Armor.Main.html#8576" class="Bound">i</a> <a id="8595" href="Armor.Main.html#8578" class="Bound">c</a>
  <a id="8599" class="Symbol">...</a> <a id="8603" class="Symbol">|</a> <a id="8605" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="8608" href="Armor.Main.html#8608" class="Bound">¬p</a> <a id="8611" class="Symbol">=</a>
    <a id="8617" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> <a id="8638" class="Symbol">(</a><a id="8639" class="Bound">m</a> <a id="8641" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="8651" class="String">&quot;: failed&quot;</a><a id="8661" class="Symbol">)</a> <a id="8663" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
    <a id="8673" href="System.Exit.html#929" class="Function">Armor.IO.exitFailure</a>
  <a id="8696" class="Symbol">...</a> <a id="8700" class="Symbol">|</a> <a id="8702" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="8706" href="Armor.Main.html#8706" class="Bound">p</a> <a id="8708" class="Symbol">=</a>
    <a id="8714" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> <a id="8735" class="Symbol">(</a><a id="8736" class="Bound">m</a> <a id="8738" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="8748" class="String">&quot;: passed&quot;</a><a id="8758" class="Symbol">)</a> <a id="8760" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
    <a id="8770" href="IO.Base.html#988" class="InductiveConstructor">IO.return</a> <a id="8780" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>

  <a id="8786" href="Armor.Main.html#8786" class="Function">runSingleCertChecks</a> <a id="8806" class="Symbol">:</a> <a id="8808" class="Symbol">∀</a> <a id="8810" class="Symbol">{@</a><a id="8812" class="Symbol">0</a> <a id="8814" href="Armor.Main.html#8814" class="Bound">bs</a><a id="8816" class="Symbol">}</a> <a id="8818" class="Symbol">→</a> <a id="8820" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="8825" href="Armor.Main.html#8814" class="Bound">bs</a> <a id="8828" class="Symbol">→</a> <a id="8830" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="8832" class="Symbol">→</a> <a id="8834" class="Symbol">_</a>
  <a id="8838" href="Armor.Main.html#8786" class="Function">runSingleCertChecks</a> <a id="8858" href="Armor.Main.html#8858" class="Bound">cert</a> <a id="8863" href="Armor.Main.html#8863" class="Bound">n</a> <a id="8865" class="Symbol">=</a>
    <a id="8871" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> <a id="8892" class="Symbol">(</a><a id="8893" class="String">&quot;=== Checking &quot;</a> <a id="8909" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="8919" class="Symbol">(</a><a id="8920" href="Armor.Main.html#730" class="Function">showℕ</a> <a id="8926" href="Armor.Main.html#8863" class="Bound">n</a><a id="8927" class="Symbol">))</a> <a id="8930" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
     <a id="8941" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="8950" href="Armor.Main.html#8858" class="Bound">cert</a> <a id="8955" class="String">&quot;R1&quot;</a> <a id="8960" href="Armor.Data.X509.Semantic.Cert.R1.html#701" class="Function">r1</a> <a id="8963" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
     <a id="8974" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="8983" href="Armor.Main.html#8858" class="Bound">cert</a> <a id="8988" class="String">&quot;R2&quot;</a> <a id="8993" href="Armor.Data.X509.Semantic.Cert.R2.html#699" class="Function">r2</a> <a id="8996" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
     <a id="9007" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="9016" href="Armor.Main.html#8858" class="Bound">cert</a> <a id="9021" class="String">&quot;R3&quot;</a> <a id="9026" href="Armor.Data.X509.Semantic.Cert.R3.html#638" class="Function">r3</a> <a id="9029" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
     <a id="9040" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="9049" href="Armor.Main.html#8858" class="Bound">cert</a> <a id="9054" class="String">&quot;R4&quot;</a> <a id="9059" href="Armor.Data.X509.Semantic.Cert.R4.html#678" class="Function">r4</a> <a id="9062" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
     <a id="9073" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="9082" href="Armor.Main.html#8858" class="Bound">cert</a> <a id="9087" class="String">&quot;R5&quot;</a> <a id="9092" href="Armor.Data.X509.Semantic.Cert.R5.html#797" class="Function">r5</a> <a id="9095" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
     <a id="9106" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="9115" href="Armor.Main.html#8858" class="Bound">cert</a> <a id="9120" class="String">&quot;R6&quot;</a> <a id="9125" href="Armor.Data.X509.Semantic.Cert.R6.html#2280" class="Function">r6</a> <a id="9128" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
     <a id="9139" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="9148" href="Armor.Main.html#8858" class="Bound">cert</a> <a id="9153" class="String">&quot;R7&quot;</a> <a id="9158" href="Armor.Data.X509.Semantic.Cert.R7.html#759" class="Function">r7</a> <a id="9161" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
     <a id="9172" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="9181" href="Armor.Main.html#8858" class="Bound">cert</a> <a id="9186" class="String">&quot;R8&quot;</a> <a id="9191" href="Armor.Data.X509.Semantic.Cert.R8.html#822" class="Function">r8</a> <a id="9194" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
     <a id="9205" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="9214" href="Armor.Main.html#8858" class="Bound">cert</a> <a id="9219" class="String">&quot;R9&quot;</a> <a id="9224" href="Armor.Data.X509.Semantic.Cert.R9.html#732" class="Function">r9</a> <a id="9227" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
     <a id="9238" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="9247" href="Armor.Main.html#8858" class="Bound">cert</a> <a id="9252" class="String">&quot;R10&quot;</a> <a id="9258" href="Armor.Data.X509.Semantic.Cert.R10.html#838" class="Function">r10</a> <a id="9262" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
     <a id="9273" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="9282" href="Armor.Main.html#8858" class="Bound">cert</a> <a id="9287" class="String">&quot;R11&quot;</a> <a id="9293" href="Armor.Data.X509.Semantic.Cert.R11.html#740" class="Function">r11</a> <a id="9297" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
     <a id="9308" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="9317" href="Armor.Main.html#8858" class="Bound">cert</a> <a id="9322" class="String">&quot;R12&quot;</a> <a id="9328" href="Armor.Data.X509.Semantic.Cert.R12.html#738" class="Function">r12</a> <a id="9332" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
     <a id="9343" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="9352" href="Armor.Main.html#8858" class="Bound">cert</a> <a id="9357" class="String">&quot;R13&quot;</a> <a id="9363" href="Armor.Data.X509.Semantic.Cert.R13.html#672" class="Function">r13</a> <a id="9367" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
     <a id="9378" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="9387" href="Armor.Main.html#8858" class="Bound">cert</a> <a id="9392" class="String">&quot;R14&quot;</a> <a id="9398" href="Armor.Data.X509.Semantic.Cert.R14.html#777" class="Function">r14</a> <a id="9402" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
     <a id="9413" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="9422" href="Armor.Main.html#8858" class="Bound">cert</a> <a id="9427" class="String">&quot;R15&quot;</a> <a id="9433" href="Armor.Data.X509.Semantic.Cert.R15.html#674" class="Function">r15</a> <a id="9437" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
     <a id="9448" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="9457" href="Armor.Main.html#8858" class="Bound">cert</a> <a id="9462" class="String">&quot;R16&quot;</a> <a id="9468" href="Armor.Data.X509.Semantic.Cert.R16.html#736" class="Function">r16</a> <a id="9472" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
     <a id="9483" class="Symbol">(</a><a id="9484" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="9487" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="9489" href="Armor.Main.html#8863" class="Bound">n</a> <a id="9491" href="Armor.Prelude.html#10989" class="Field Operator">≟</a> <a id="9493" class="Number">1</a> <a id="9495" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a> <a id="9497" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="9502" class="Symbol">(</a><a id="9503" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="9512" href="Armor.Main.html#8858" class="Bound">cert</a> <a id="9517" class="String">&quot;R18&quot;</a> <a id="9523" href="Armor.Data.X509.Semantic.Cert.R18.html#836" class="Function">r18</a><a id="9526" class="Symbol">)</a> <a id="9528" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="9533" class="Symbol">(</a><a id="9534" href="IO.Base.html#988" class="InductiveConstructor">IO.return</a> <a id="9544" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="9546" class="Symbol">))</a> <a id="9549" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
     <a id="9560" href="Armor.IO.html#2338" class="Function">Armor.IO.getCurrentTime</a> <a id="9584" href="IO.Base.html#1404" class="Function Operator">IO.&gt;&gt;=</a> <a id="9591" class="Symbol">λ</a> <a id="9593" href="Armor.Main.html#9593" class="Bound">now</a> <a id="9597" class="Symbol">→</a>
     <a id="9604" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> <a id="9625" class="Symbol">(</a><a id="9626" href="Armor.Foreign.Time.html#1242" class="Postulate">FFI.showTime</a> <a id="9639" href="Armor.Main.html#9593" class="Bound">now</a><a id="9642" class="Symbol">)</a> <a id="9644" href="IO.Base.html#1404" class="Function Operator">IO.&gt;&gt;=</a> <a id="9651" class="Symbol">λ</a> <a id="9653" href="Armor.Main.html#9653" class="Bound">_</a> <a id="9655" class="Symbol">→</a>
     <a id="9662" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="9667" href="Armor.Data.X690-DER.Time.GeneralizedTime.Foreign.html#1178" class="Function">GeneralizedTime.fromForeignUTC</a> <a id="9698" href="Armor.Main.html#9593" class="Bound">now</a> <a id="9702" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="9705" class="Symbol">λ</a> <a id="9707" class="Keyword">where</a>
       <a id="9720" class="Symbol">(</a><a id="9721" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="9724" href="Armor.Main.html#9724" class="Bound">¬p</a><a id="9726" class="Symbol">)</a> <a id="9728" class="Symbol">→</a>
         <a id="9739" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> <a id="9760" class="String">&quot;R17: failed to read time from system&quot;</a> <a id="9799" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
         <a id="9814" href="System.Exit.html#929" class="Function">Armor.IO.exitFailure</a>
       <a id="9842" class="Symbol">(</a><a id="9843" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="9847" href="Armor.Main.html#9847" class="Bound">p</a><a id="9848" class="Symbol">)</a> <a id="9850" class="Symbol">→</a>
         <a id="9861" href="Armor.Main.html#7839" class="Function">runCheck</a> <a id="9870" href="Armor.Main.html#8858" class="Bound">cert</a> <a id="9875" class="String">&quot;R17&quot;</a> <a id="9881" class="Symbol">(λ</a> <a id="9884" href="Armor.Main.html#9884" class="Bound">c₁</a> <a id="9887" class="Symbol">→</a> <a id="9889" href="Armor.Data.X509.Semantic.Cert.R17.html#772" class="Function">r17</a> <a id="9893" href="Armor.Main.html#9884" class="Bound">c₁</a> <a id="9896" class="Symbol">(</a><a id="9897" href="Armor.Data.X509.Validity.Time.TCB.html#2835" class="InductiveConstructor">Validity.generalized</a> <a id="9918" class="Symbol">(</a><a id="9919" href="Armor.Data.X690-DER.TLV.TCB.html#623" class="InductiveConstructor">mkTLV</a> <a id="9925" class="Symbol">(</a><a id="9926" href="Armor.Data.X690-DER.Length.Properties.html#852" class="Function">Length.shortₛ</a> <a id="9940" class="Symbol">(</a><a id="9941" href="Armor.Prelude.html#9348" class="Function Operator">#</a> <a id="9943" class="Number">15</a><a id="9945" class="Symbol">))</a> <a id="9948" href="Armor.Main.html#9847" class="Bound">p</a> <a id="9950" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="9955" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="9959" class="Symbol">)))</a>

  <a id="9966" href="Armor.Main.html#9966" class="Function">runChecks&#39;</a> <a id="9977" class="Symbol">:</a>  <a id="9980" class="Symbol">∀</a> <a id="9982" class="Symbol">{@</a><a id="9984" class="Symbol">0</a> <a id="9986" href="Armor.Main.html#9986" class="Bound">bs</a><a id="9988" class="Symbol">}</a> <a id="9990" class="Symbol">{</a><a id="9991" href="Armor.Main.html#9991" class="Bound">trustedRoot</a> <a id="10003" href="Armor.Main.html#10003" class="Bound">candidates</a> <a id="10014" class="Symbol">:</a> <a id="10016" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="10021" class="Symbol">(</a><a id="10022" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="10030" class="Symbol">_</a> <a id="10032" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="10036" class="Symbol">)}</a>
    <a id="10043" class="Symbol">→</a> <a id="10045" class="Symbol">(</a><a id="10046" href="Armor.Main.html#10046" class="Bound">issuee</a> <a id="10053" class="Symbol">:</a> <a id="10055" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="10060" href="Armor.Main.html#9986" class="Bound">bs</a><a id="10062" class="Symbol">)</a> <a id="10064" class="Symbol">→</a> <a id="10066" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="10068" class="Symbol">→</a> <a id="10070" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="10076" href="Armor.Main.html#9991" class="Bound">trustedRoot</a> <a id="10088" href="Armor.Main.html#10003" class="Bound">candidates</a> <a id="10099" href="Armor.Main.html#10046" class="Bound">issuee</a>  <a id="10107" class="Symbol">→</a> <a id="10109" href="IO.Base.html#917" class="Datatype">IO.IO</a> <a id="10115" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
  <a id="10119" href="Armor.Main.html#9966" class="Function">runChecks&#39;</a> <a id="10130" href="Armor.Main.html#10130" class="Bound">issuee</a> <a id="10137" href="Armor.Main.html#10137" class="Bound">n</a> <a id="10139" class="Symbol">(</a><a id="10140" href="Armor.Data.X509.Semantic.Chain.TCB.html#5288" class="InductiveConstructor">root</a> <a id="10145" class="Symbol">(</a><a id="10146" href="Armor.Main.html#10146" class="Bound">trustedCA</a> <a id="10156" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10158" href="Armor.Main.html#10158" class="Bound">snd</a><a id="10161" class="Symbol">))</a> <a id="10164" class="Symbol">=</a>
    <a id="10170" href="IO.Finite.html#1595" class="Function">IO.putStrLn</a> <a id="10182" class="Symbol">(</a><a id="10183" href="Armor.Main.html#7190" class="Function">showOutput</a> <a id="10194" class="Symbol">(</a><a id="10195" href="Armor.Main.html#6798" class="Function">certOutput</a> <a id="10206" href="Armor.Main.html#10130" class="Bound">issuee</a><a id="10212" class="Symbol">))</a> <a id="10215" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
    <a id="10225" href="Armor.Main.html#8786" class="Function">runSingleCertChecks</a> <a id="10245" href="Armor.Main.html#10130" class="Bound">issuee</a> <a id="10252" href="Armor.Main.html#10137" class="Bound">n</a> <a id="10254" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
    <a id="10264" href="IO.Finite.html#1595" class="Function">IO.putStrLn</a> <a id="10276" class="Symbol">(</a><a id="10277" href="Armor.Main.html#7190" class="Function">showOutput</a> <a id="10288" class="Symbol">(</a><a id="10289" href="Armor.Main.html#6798" class="Function">certOutput</a> <a id="10300" class="Symbol">(</a><a id="10301" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="10307" href="Armor.Main.html#10146" class="Bound">trustedCA</a><a id="10316" class="Symbol">)))</a> <a id="10320" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
    <a id="10330" href="Armor.Main.html#8786" class="Function">runSingleCertChecks</a> <a id="10350" class="Symbol">(</a><a id="10351" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="10357" href="Armor.Main.html#10146" class="Bound">trustedCA</a><a id="10366" class="Symbol">)</a> <a id="10368" class="Symbol">(</a><a id="10369" href="Armor.Main.html#10137" class="Bound">n</a> <a id="10371" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="10373" class="Number">1</a><a id="10374" class="Symbol">)</a>
  <a id="10378" href="Armor.Main.html#9966" class="Function">runChecks&#39;</a> <a id="10389" href="Armor.Main.html#10389" class="Bound">issuee</a> <a id="10396" href="Armor.Main.html#10396" class="Bound">n</a> <a id="10398" class="Symbol">(</a><a id="10399" href="Armor.Data.X509.Semantic.Chain.TCB.html#5383" class="InductiveConstructor">link</a> <a id="10404" href="Armor.Main.html#10404" class="Bound">issuer</a> <a id="10411" href="Armor.Main.html#10411" class="Bound">isIn</a> <a id="10416" href="Armor.Main.html#10416" class="Bound">chain</a><a id="10421" class="Symbol">)</a> <a id="10423" class="Symbol">=</a>
    <a id="10429" href="IO.Finite.html#1595" class="Function">IO.putStrLn</a> <a id="10441" class="Symbol">(</a><a id="10442" href="Armor.Main.html#7190" class="Function">showOutput</a> <a id="10453" class="Symbol">(</a><a id="10454" href="Armor.Main.html#6798" class="Function">certOutput</a> <a id="10465" href="Armor.Main.html#10389" class="Bound">issuee</a><a id="10471" class="Symbol">))</a> <a id="10474" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
    <a id="10484" href="Armor.Main.html#8786" class="Function">runSingleCertChecks</a> <a id="10504" href="Armor.Main.html#10389" class="Bound">issuee</a> <a id="10511" href="Armor.Main.html#10396" class="Bound">n</a> <a id="10513" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
    <a id="10523" href="Armor.Main.html#9966" class="Function">runChecks&#39;</a> <a id="10534" href="Armor.Main.html#10404" class="Bound">issuer</a> <a id="10541" class="Symbol">(</a><a id="10542" href="Armor.Main.html#10396" class="Bound">n</a> <a id="10544" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="10546" class="Number">1</a><a id="10547" class="Symbol">)</a> <a id="10549" href="Armor.Main.html#10416" class="Bound">chain</a>

  <a id="10558" href="Armor.Main.html#10558" class="Function">helper₁</a> <a id="10566" class="Symbol">:</a> <a id="10568" class="Symbol">∀</a> <a id="10570" class="Symbol">{@</a><a id="10572" class="Symbol">0</a> <a id="10574" href="Armor.Main.html#10574" class="Bound">bs</a><a id="10576" class="Symbol">}</a> <a id="10578" class="Symbol">{</a><a id="10579" href="Armor.Main.html#10579" class="Bound">trustedRoot</a> <a id="10591" href="Armor.Main.html#10591" class="Bound">candidates</a> <a id="10602" class="Symbol">:</a> <a id="10604" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="10609" class="Symbol">(</a><a id="10610" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="10618" class="Symbol">_</a> <a id="10620" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="10624" class="Symbol">)}</a>
    <a id="10631" class="Symbol">→</a> <a id="10633" class="Symbol">(</a><a id="10634" href="Armor.Main.html#10634" class="Bound">issuee</a> <a id="10641" class="Symbol">:</a> <a id="10643" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="10648" href="Armor.Main.html#10574" class="Bound">bs</a><a id="10650" class="Symbol">)</a> <a id="10652" class="Symbol">→</a> <a id="10654" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="10660" href="Armor.Main.html#10579" class="Bound">trustedRoot</a> <a id="10672" href="Armor.Main.html#10591" class="Bound">candidates</a> <a id="10683" href="Armor.Main.html#10634" class="Bound">issuee</a> <a id="10690" class="Symbol">→</a> <a id="10692" href="IO.Base.html#917" class="Datatype">IO.IO</a> <a id="10698" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
  <a id="10705" href="Armor.Main.html#10558" class="Function">helper₁</a> <a id="10713" href="Armor.Main.html#10713" class="Bound">issuee</a> <a id="10720" href="Armor.Main.html#10720" class="Bound">chain</a> <a id="10726" class="Symbol">=</a>
    <a id="10732" href="Armor.Main.html#9966" class="Function">runChecks&#39;</a> <a id="10743" href="Armor.Main.html#10713" class="Bound">issuee</a> <a id="10750" class="Number">1</a> <a id="10752" href="Armor.Main.html#10720" class="Bound">chain</a> <a id="10758" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
    <a id="10768" href="Armor.Main.html#8223" class="Function">runChainCheck</a> <a id="10782" class="String">&quot;R19&quot;</a> <a id="10788" href="Armor.Main.html#10713" class="Bound">issuee</a> <a id="10795" href="Armor.Main.html#10720" class="Bound">chain</a> <a id="10801" href="Armor.Data.X509.Semantic.Chain.R19.html#722" class="Function">r19</a> <a id="10805" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
    <a id="10815" href="Armor.Main.html#8223" class="Function">runChainCheck</a> <a id="10829" class="String">&quot;R20&quot;</a> <a id="10835" href="Armor.Main.html#10713" class="Bound">issuee</a> <a id="10842" href="Armor.Main.html#10720" class="Bound">chain</a> <a id="10848" href="Armor.Data.X509.Semantic.Chain.R20.html#2788" class="Function">r20</a> <a id="10852" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
    <a id="10862" href="Armor.Main.html#8223" class="Function">runChainCheck</a> <a id="10876" class="String">&quot;R21&quot;</a> <a id="10882" href="Armor.Main.html#10713" class="Bound">issuee</a> <a id="10889" href="Armor.Main.html#10720" class="Bound">chain</a> <a id="10895" href="Armor.Data.X509.Semantic.Chain.R21.html#5319" class="Function">r21</a> <a id="10899" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
    <a id="10909" href="Armor.Main.html#8223" class="Function">runChainCheck</a> <a id="10923" class="String">&quot;R22&quot;</a> <a id="10929" href="Armor.Main.html#10713" class="Bound">issuee</a> <a id="10936" href="Armor.Main.html#10720" class="Bound">chain</a> <a id="10942" href="Armor.Data.X509.Semantic.Chain.R22.html#541" class="Function">r22</a> <a id="10946" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
    <a id="10956" href="Armor.Main.html#8223" class="Function">runChainCheck</a> <a id="10970" class="String">&quot;R23&quot;</a> <a id="10976" href="Armor.Main.html#10713" class="Bound">issuee</a> <a id="10983" href="Armor.Main.html#10720" class="Bound">chain</a> <a id="10989" href="Armor.Data.X509.Semantic.Chain.R23.html#1185" class="Function">r23</a> <a id="10993" href="IO.Base.html#1475" class="Function Operator">IO.&gt;&gt;</a>
    <a id="11003" href="IO.Base.html#988" class="InductiveConstructor">IO.return</a> <a id="11013" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>

  <a id="11021" href="Armor.Main.html#11021" class="Function">helper₂</a> <a id="11029" class="Symbol">:</a> <a id="11031" class="Symbol">∀</a> <a id="11033" class="Symbol">{@</a><a id="11035" class="Symbol">0</a> <a id="11037" href="Armor.Main.html#11037" class="Bound">bs</a><a id="11039" class="Symbol">}</a> <a id="11041" class="Symbol">{</a><a id="11042" href="Armor.Main.html#11042" class="Bound">trustedRoot</a> <a id="11054" href="Armor.Main.html#11054" class="Bound">candidates</a> <a id="11065" class="Symbol">:</a> <a id="11067" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="11072" class="Symbol">(</a><a id="11073" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="11081" class="Symbol">_</a> <a id="11083" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="11087" class="Symbol">)}</a> <a id="11090" class="Symbol">(</a><a id="11091" href="Armor.Main.html#11091" class="Bound">issuee</a> <a id="11098" class="Symbol">:</a> <a id="11100" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="11105" href="Armor.Main.html#11037" class="Bound">bs</a><a id="11107" class="Symbol">)</a>
    <a id="11113" class="Symbol">→</a> <a id="11115" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="11120" class="Symbol">(</a><a id="11121" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="11127" href="Armor.Main.html#11042" class="Bound">trustedRoot</a> <a id="11139" href="Armor.Main.html#11054" class="Bound">candidates</a> <a id="11150" href="Armor.Main.html#11091" class="Bound">issuee</a><a id="11156" class="Symbol">)</a> <a id="11158" class="Symbol">→</a> <a id="11160" class="Symbol">_</a>
  <a id="11164" href="Armor.Main.html#11021" class="Function">helper₂</a> <a id="11172" href="Armor.Main.html#11172" class="Bound">issuee</a> <a id="11179" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="11182" class="Symbol">=</a> <a id="11184" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> <a id="11205" class="String">&quot;Error: no valid chain found&quot;</a> 
  <a id="11238" href="Armor.Main.html#11021" class="Function">helper₂</a> <a id="11246" href="Armor.Main.html#11246" class="Bound">issuee</a> <a id="11253" class="Symbol">(</a><a id="11254" href="Armor.Main.html#11254" class="Bound">chain</a> <a id="11260" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="11262" href="Armor.Main.html#11262" class="Bound">otherChains</a><a id="11273" class="Symbol">)</a> <a id="11275" class="Symbol">=</a>
    <a id="11281" href="Armor.Main.html#10558" class="Function">helper₁</a> <a id="11289" href="Armor.Main.html#11246" class="Bound">issuee</a> <a id="11296" href="Armor.Main.html#11254" class="Bound">chain</a> <a id="11302" href="IO.Base.html#1404" class="Function Operator">IO.&gt;&gt;=</a> <a id="11309" class="Symbol">λ</a> <a id="11311" class="Keyword">where</a>
      <a id="11323" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="11329" class="Symbol">→</a>  <a id="11332" href="Armor.Main.html#11021" class="Function">helper₂</a> <a id="11340" href="Armor.Main.html#11246" class="Bound">issuee</a> <a id="11347" href="Armor.Main.html#11262" class="Bound">otherChains</a>
      <a id="11365" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="11370" class="Symbol">→</a> <a id="11372" href="System.Exit.html#988" class="Function">Armor.IO.exitSuccess</a>

  <a id="11396" href="Armor.Main.html#11396" class="Function">runCertChecks</a> <a id="11410" class="Symbol">:</a> <a id="11412" class="Symbol">(</a><a id="11413" href="Armor.Main.html#11413" class="Bound">trustedRoot</a> <a id="11425" href="Armor.Main.html#11425" class="Bound">candidates</a> <a id="11436" class="Symbol">:</a> <a id="11438" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="11443" class="Symbol">(</a><a id="11444" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="11452" class="Symbol">_</a> <a id="11454" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="11458" class="Symbol">))</a> <a id="11461" class="Symbol">→</a> <a id="11463" class="Symbol">_</a>
  <a id="11467" href="Armor.Main.html#11396" class="Function">runCertChecks</a> <a id="11481" href="Armor.Main.html#11481" class="Bound">trustedRoot</a> <a id="11493" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="11496" class="Symbol">=</a> <a id="11498" href="Armor.IO.html#1969" class="Function">Armor.IO.putStrLnErr</a> <a id="11519" class="String">&quot;Error: no candidate certificates&quot;</a>
  <a id="11556" href="Armor.Main.html#11396" class="Function">runCertChecks</a> <a id="11570" href="Armor.Main.html#11570" class="Bound">trustedRoot</a> <a id="11582" class="Symbol">((</a><a id="11584" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="11586" class="Symbol">_</a> <a id="11588" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="11590" href="Armor.Main.html#11590" class="Bound">end</a><a id="11593" class="Symbol">)</a> <a id="11595" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="11597" href="Armor.Main.html#11597" class="Bound">restCerts</a><a id="11606" class="Symbol">)</a> <a id="11608" class="Symbol">=</a>
    <a id="11614" href="Armor.Main.html#11021" class="Function">helper₂</a> <a id="11622" href="Armor.Main.html#11590" class="Bound">end</a> <a id="11626" class="Symbol">(</a><a id="11627" href="Armor.Data.X509.Semantic.Chain.Builder.html#6264" class="Function">buildChains</a> <a id="11639" href="Armor.Main.html#11570" class="Bound">trustedRoot</a> <a id="11651" class="Symbol">(</a><a id="11652" href="Armor.Data.X509.Semantic.Chain.TCB.html#4086" class="Function">removeCertFromCerts</a> <a id="11672" href="Armor.Main.html#11590" class="Bound">end</a> <a id="11676" href="Armor.Main.html#11597" class="Bound">restCerts</a><a id="11685" class="Symbol">)</a> <a id="11687" href="Armor.Main.html#11590" class="Bound">end</a><a id="11690" class="Symbol">)</a>
    <a id="11696" class="Keyword">where</a>
    <a id="11706" class="Keyword">open</a> <a id="11711" class="Keyword">import</a> <a id="11718" href="Armor.Data.X509.Semantic.Chain.Properties.html" class="Module">Armor.Data.X509.Semantic.Chain.Properties</a>
    <a id="11764" class="Symbol">@</a><a id="11765" class="Symbol">0</a> <a id="11767" href="Armor.Main.html#11767" class="Function">un</a> <a id="11770" class="Symbol">:</a> <a id="11772" class="Symbol">(</a><a id="11773" href="Armor.Main.html#11773" class="Bound">c</a> <a id="11775" class="Symbol">:</a> <a id="11777" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="11783" href="Armor.Main.html#11570" class="Bound">trustedRoot</a> <a id="11795" class="Symbol">(</a><a id="11796" href="Armor.Data.X509.Semantic.Chain.TCB.html#4086" class="Function">removeCertFromCerts</a> <a id="11816" href="Armor.Main.html#11590" class="Bound">end</a> <a id="11820" href="Armor.Main.html#11597" class="Bound">restCerts</a><a id="11829" class="Symbol">)</a> <a id="11831" href="Armor.Main.html#11590" class="Bound">end</a><a id="11834" class="Symbol">)</a> <a id="11836" class="Symbol">→</a> <a id="11838" class="Symbol">(</a><a id="11839" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="11842" href="Armor.Main.html#11590" class="Bound">end</a><a id="11845" class="Symbol">)</a> <a id="11847" href="Data.List.Membership.Setoid.html#936" class="Function Operator">∉</a> <a id="11849" href="Armor.Main.html#11570" class="Bound">trustedRoot</a> <a id="11861" class="Symbol">→</a> <a id="11863" href="Armor.Data.X509.Semantic.Chain.TCB.html#7095" class="Function">ChainUnique</a> <a id="11875" href="Armor.Main.html#11773" class="Bound">c</a>
    <a id="11881" href="Armor.Main.html#11767" class="Function">un</a> <a id="11884" href="Armor.Main.html#11884" class="Bound">c</a> <a id="11886" href="Armor.Main.html#11886" class="Bound">end∉trust</a> <a id="11896" class="Symbol">=</a> <a id="11898" href="Armor.Data.X509.Semantic.Chain.Properties.html#2671" class="Function">chainUnique</a> <a id="11910" class="Symbol">_</a> <a id="11912" class="Symbol">_</a> <a id="11914" class="Symbol">(</a><a id="11915" href="Armor.Data.X509.Semantic.Chain.TCB.html#4614" class="Function">∉removeCertFromCerts</a> <a id="11936" href="Armor.Main.html#11590" class="Bound">end</a> <a id="11940" href="Armor.Main.html#11597" class="Bound">restCerts</a><a id="11949" class="Symbol">)</a> <a id="11951" href="Armor.Main.html#11886" class="Bound">end∉trust</a> <a id="11961" href="Armor.Main.html#11884" class="Bound">c</a>
</pre></body></html>