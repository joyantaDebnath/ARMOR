<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X690-DER.BitString.TCB</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Armor.Data.X690-DER.TLV.html" class="Module">Armor.Data.X690-DER.TLV</a>
<a id="62" class="Keyword">import</a>      <a id="74" href="Armor.Data.X690-DER.Tag.html" class="Module">Armor.Data.X690-DER.Tag</a> <a id="98" class="Symbol">as</a> <a id="101" class="Module">Tag</a>
<a id="105" class="Keyword">import</a>      <a id="117" href="Armor.Grammar.Definitions.NonMalleable.html" class="Module">Armor.Grammar.Definitions.NonMalleable</a>
<a id="156" class="Keyword">open</a> <a id="161" class="Keyword">import</a> <a id="168" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="183" class="Keyword">module</a> <a id="190" href="Armor.Data.X690-DER.BitString.TCB.html" class="Module">Armor.Data.X690-DER.BitString.TCB</a> <a id="224" class="Keyword">where</a>

<a id="231" class="Keyword">open</a> <a id="236" href="Armor.Grammar.Definitions.NonMalleable.html" class="Module">Armor.Grammar.Definitions.NonMalleable</a> <a id="275" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>

<a id="282" class="Comment">-- https://www.itu.int/rec/T-REC-X.690-202102-I/en</a>
<a id="333" class="Comment">-- 8.6.2 The contents octets for the primitive encoding shall contain an initial octet followed by zero, one or more subsequent</a>
<a id="461" class="Comment">-- octets.</a>
<a id="472" class="Comment">-- 8.6.2.1 The bits in the bitstring value, commencing with the leading bit and proceeding to the trailing bit, shall be placed in</a>
<a id="603" class="Comment">-- bits 8 to 1 of the first subsequent octet, followed by bits 8 to 1 of the second subsequent octet, followed by bits 8 to 1 of each</a>
<a id="737" class="Comment">-- octet in turn, followed by as many bits as are needed of the final subsequent octet, commencing with bit 8.</a>
<a id="848" class="Comment">-- NOTE – The terms &quot;leading bit&quot; and &quot;trailing bit&quot; are defined in Rec. ITU-T X.680 | ISO/IEC 8824-1, 22.2.</a>
<a id="957" class="Comment">-- 8.6.2.2 The initial octet shall encode, as an unsigned binary integer with bit 1 as the least significant bit, the number of</a>
<a id="1085" class="Comment">-- unused bits in the final subsequent octet. The number shall be in the range zero to seven.</a>
<a id="1179" class="Comment">-- 8.6.2.3 If the bitstring is empty, there shall be no subsequent octets, and the initial octet shall be zero.</a>
<a id="1291" class="Comment">-- 11.2.1 Each unused bit in the final octet of the encoding of a bit string value shall be set to zero.</a>
<a id="1396" class="Comment">-- 11.2.2 Where Rec. ITU-T X.680 | ISO/IEC 8824-1, 22.7, applies, the bitstring shall have all trailing 0 bits removed before</a>
<a id="1522" class="Comment">-- it is encoded.</a>
<a id="1540" class="Comment">-- NOTE 1 – In the case where a size constraint has been applied, the abstract value delivered by a decoder to the application will be one</a>
<a id="1679" class="Comment">-- of those satisfying the size constraint and differing from the transmitted value only in the number of trailing 0 bits.</a>
<a id="1802" class="Comment">-- NOTE 2 – If a bitstring value has no 1 bits, then an encoder shall encode the value with a length of 1 and an initial octet set to 0.</a>

<a id="UnusedBits"></a><a id="1940" href="Armor.Data.X690-DER.BitString.TCB.html#1940" class="Function">UnusedBits</a> <a id="1951" class="Symbol">:</a> <a id="1953" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="1959" class="Symbol">→</a> <a id="1961" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1966" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="1972" class="Symbol">→</a> <a id="1974" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1978" href="Armor.Data.X690-DER.BitString.TCB.html#1940" class="Function">UnusedBits</a> <a id="1989" href="Armor.Data.X690-DER.BitString.TCB.html#1989" class="Bound">bₕ</a> <a id="1992" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1995" class="Symbol">=</a> <a id="1997" href="Armor.Prelude.html#9194" class="Field">toℕ</a> <a id="2001" href="Armor.Data.X690-DER.BitString.TCB.html#1989" class="Bound">bₕ</a> <a id="2004" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2006" class="Number">0</a>
<a id="2008" href="Armor.Data.X690-DER.BitString.TCB.html#1940" class="Function">UnusedBits</a> <a id="2019" href="Armor.Data.X690-DER.BitString.TCB.html#2019" class="Bound">bₕ</a> <a id="2022" class="Symbol">(</a><a id="2023" href="Armor.Data.X690-DER.BitString.TCB.html#2023" class="Bound">bₜ</a> <a id="2026" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2028" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2030" class="Symbol">)</a> <a id="2032" class="Symbol">=</a> <a id="2034" href="Data.List.Base.html#7427" class="Function">drop</a> <a id="2039" class="Symbol">(</a><a id="2040" class="Number">8</a> <a id="2042" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">-</a> <a id="2044" href="Armor.Prelude.html#9194" class="Field">toℕ</a> <a id="2048" href="Armor.Data.X690-DER.BitString.TCB.html#2019" class="Bound">bₕ</a><a id="2050" class="Symbol">)</a> <a id="2052" class="Symbol">(</a><a id="2053" href="Data.Vec.Base.html#7438" class="Function">Vec.toList</a> <a id="2064" class="Symbol">(</a><a id="2065" href="Armor.Binary.Bits.TCB.html#376" class="Function">toBinary</a><a id="2073" class="Symbol">{</a><a id="2074" class="Number">8</a><a id="2075" class="Symbol">}</a> <a id="2077" href="Armor.Data.X690-DER.BitString.TCB.html#2023" class="Bound">bₜ</a><a id="2079" class="Symbol">))</a> <a id="2082" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2084" href="Data.List.Base.html#5139" class="Function">replicate</a> <a id="2094" class="Symbol">(</a><a id="2095" href="Armor.Prelude.html#9194" class="Field">toℕ</a> <a id="2099" href="Armor.Data.X690-DER.BitString.TCB.html#2019" class="Bound">bₕ</a><a id="2101" class="Symbol">)</a> <a id="2103" href="Armor.Binary.Bits.TCB.html#208" class="InductiveConstructor">#0</a>
<a id="2106" href="Armor.Data.X690-DER.BitString.TCB.html#1940" class="Function">UnusedBits</a> <a id="2117" href="Armor.Data.X690-DER.BitString.TCB.html#2117" class="Bound">bₕ</a> <a id="2120" class="Symbol">(</a><a id="2121" href="Armor.Data.X690-DER.BitString.TCB.html#2121" class="Bound">bₜ</a> <a id="2124" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2126" href="Armor.Data.X690-DER.BitString.TCB.html#2126" class="Bound">x</a> <a id="2128" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2130" href="Armor.Data.X690-DER.BitString.TCB.html#2130" class="Bound">bₜ&#39;</a><a id="2133" class="Symbol">)</a> <a id="2135" class="Symbol">=</a> <a id="2137" href="Armor.Data.X690-DER.BitString.TCB.html#1940" class="Function">UnusedBits</a> <a id="2148" href="Armor.Data.X690-DER.BitString.TCB.html#2117" class="Bound">bₕ</a> <a id="2151" class="Symbol">(</a><a id="2152" href="Armor.Data.X690-DER.BitString.TCB.html#2126" class="Bound">x</a> <a id="2154" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2156" href="Armor.Data.X690-DER.BitString.TCB.html#2130" class="Bound">bₜ&#39;</a><a id="2159" class="Symbol">)</a>

<a id="toBitRep"></a><a id="2162" href="Armor.Data.X690-DER.BitString.TCB.html#2162" class="Function">toBitRep</a> <a id="2171" class="Symbol">:</a> <a id="2173" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="2179" class="Symbol">→</a> <a id="2181" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2186" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="2192" class="Symbol">→</a> <a id="2194" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2199" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="2204" href="Armor.Data.X690-DER.BitString.TCB.html#2162" class="Function">toBitRep</a> <a id="2213" href="Armor.Data.X690-DER.BitString.TCB.html#2213" class="Bound">bₕ</a> <a id="2216" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="2219" class="Symbol">=</a> <a id="2221" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
<a id="2224" href="Armor.Data.X690-DER.BitString.TCB.html#2162" class="Function">toBitRep</a> <a id="2233" href="Armor.Data.X690-DER.BitString.TCB.html#2233" class="Bound">bₕ</a> <a id="2236" class="Symbol">(</a><a id="2237" href="Armor.Data.X690-DER.BitString.TCB.html#2237" class="Bound">bₜ</a> <a id="2240" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2242" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="2244" class="Symbol">)=</a> <a id="2247" href="Data.List.Base.html#7307" class="Function">take</a> <a id="2252" class="Symbol">(</a><a id="2253" class="Number">8</a> <a id="2255" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">-</a> <a id="2257" href="Armor.Prelude.html#9194" class="Field">toℕ</a> <a id="2261" href="Armor.Data.X690-DER.BitString.TCB.html#2233" class="Bound">bₕ</a><a id="2263" class="Symbol">)</a> <a id="2265" class="Symbol">(</a><a id="2266" href="Data.Vec.Base.html#7438" class="Function">Vec.toList</a><a id="2276" class="Symbol">{</a><a id="2277" class="Argument">n</a> <a id="2279" class="Symbol">=</a> <a id="2281" class="Number">8</a><a id="2282" class="Symbol">}</a> <a id="2284" class="Symbol">(</a><a id="2285" href="Armor.Binary.Bits.TCB.html#376" class="Function">toBinary</a> <a id="2294" href="Armor.Data.X690-DER.BitString.TCB.html#2237" class="Bound">bₜ</a><a id="2296" class="Symbol">))</a>
<a id="2299" href="Armor.Data.X690-DER.BitString.TCB.html#2162" class="Function">toBitRep</a> <a id="2308" href="Armor.Data.X690-DER.BitString.TCB.html#2308" class="Bound">bₕ</a> <a id="2311" class="Symbol">(</a><a id="2312" href="Armor.Data.X690-DER.BitString.TCB.html#2312" class="Bound">bₜ</a> <a id="2315" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2317" href="Armor.Data.X690-DER.BitString.TCB.html#2317" class="Bound">x</a> <a id="2319" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2321" href="Armor.Data.X690-DER.BitString.TCB.html#2321" class="Bound">bₜ&#39;</a><a id="2324" class="Symbol">)</a> <a id="2326" class="Symbol">=</a> <a id="2328" href="Data.Vec.Base.html#7438" class="Function">Vec.toList</a><a id="2338" class="Symbol">{</a><a id="2339" class="Argument">n</a> <a id="2341" class="Symbol">=</a> <a id="2343" class="Number">8</a><a id="2344" class="Symbol">}</a> <a id="2346" class="Symbol">(</a><a id="2347" href="Armor.Binary.Bits.TCB.html#376" class="Function">toBinary</a> <a id="2356" href="Armor.Data.X690-DER.BitString.TCB.html#2312" class="Bound">bₜ</a><a id="2358" class="Symbol">)</a> <a id="2360" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="2363" href="Armor.Data.X690-DER.BitString.TCB.html#2162" class="Function">toBitRep</a> <a id="2372" href="Armor.Data.X690-DER.BitString.TCB.html#2308" class="Bound">bₕ</a> <a id="2375" class="Symbol">(</a><a id="2376" href="Armor.Data.X690-DER.BitString.TCB.html#2317" class="Bound">x</a> <a id="2378" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2380" href="Armor.Data.X690-DER.BitString.TCB.html#2321" class="Bound">bₜ&#39;</a><a id="2383" class="Symbol">)</a>

<a id="2386" class="Keyword">record</a> <a id="BitStringValue"></a><a id="2393" href="Armor.Data.X690-DER.BitString.TCB.html#2393" class="Record">BitStringValue</a> <a id="2408" class="Symbol">(@</a><a id="2410" class="Symbol">0</a> <a id="2412" href="Armor.Data.X690-DER.BitString.TCB.html#2412" class="Bound">bs</a> <a id="2415" class="Symbol">:</a> <a id="2417" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2422" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="2427" class="Symbol">)</a> <a id="2429" class="Symbol">:</a> <a id="2431" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="2435" class="Keyword">where</a>
    <a id="2445" class="Keyword">constructor</a> <a id="mkBitStringValue"></a><a id="2457" href="Armor.Data.X690-DER.BitString.TCB.html#2457" class="InductiveConstructor">mkBitStringValue</a>
    <a id="2478" class="Keyword">field</a>
      <a id="2490" class="Symbol">@</a><a id="2491" class="Symbol">0</a> <a id="BitStringValue.bₕ"></a><a id="2493" href="Armor.Data.X690-DER.BitString.TCB.html#2493" class="Field">bₕ</a> <a id="2496" class="Symbol">:</a> <a id="2498" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
      <a id="2510" class="Symbol">@</a><a id="2511" class="Symbol">0</a> <a id="BitStringValue.bₜ"></a><a id="2513" href="Armor.Data.X690-DER.BitString.TCB.html#2513" class="Field">bₜ</a> <a id="2516" class="Symbol">:</a> <a id="2518" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2523" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
      <a id="2535" class="Symbol">@</a><a id="2536" class="Symbol">0</a> <a id="BitStringValue.bₕ&lt;8"></a><a id="2538" href="Armor.Data.X690-DER.BitString.TCB.html#2538" class="Field">bₕ&lt;8</a> <a id="2543" class="Symbol">:</a> <a id="2545" href="Armor.Prelude.html#9194" class="Field">toℕ</a> <a id="2549" href="Armor.Data.X690-DER.BitString.TCB.html#2493" class="Field">bₕ</a> <a id="2552" href="Data.Nat.Base.html#1645" class="Function Operator">&lt;</a> <a id="2554" class="Number">8</a>
      <a id="BitStringValue.bits"></a><a id="2562" href="Armor.Data.X690-DER.BitString.TCB.html#2562" class="Field">bits</a> <a id="2567" class="Symbol">:</a> <a id="2569" href="Armor.Prelude.html#7068" class="Record">Singleton</a> <a id="2579" class="Symbol">(</a><a id="2580" href="Armor.Data.X690-DER.BitString.TCB.html#2162" class="Function">toBitRep</a> <a id="2589" href="Armor.Data.X690-DER.BitString.TCB.html#2493" class="Field">bₕ</a> <a id="2592" href="Armor.Data.X690-DER.BitString.TCB.html#2513" class="Field">bₜ</a><a id="2594" class="Symbol">)</a>
      <a id="2602" class="Symbol">@</a><a id="2603" class="Symbol">0</a> <a id="BitStringValue.unusedBits"></a><a id="2605" href="Armor.Data.X690-DER.BitString.TCB.html#2605" class="Field">unusedBits</a> <a id="2616" class="Symbol">:</a> <a id="2618" href="Armor.Data.X690-DER.BitString.TCB.html#1940" class="Function">UnusedBits</a> <a id="2629" href="Armor.Data.X690-DER.BitString.TCB.html#2493" class="Field">bₕ</a> <a id="2632" href="Armor.Data.X690-DER.BitString.TCB.html#2513" class="Field">bₜ</a>
      <a id="2641" class="Symbol">@</a><a id="2642" class="Symbol">0</a> <a id="BitStringValue.bs≡"></a><a id="2644" href="Armor.Data.X690-DER.BitString.TCB.html#2644" class="Field">bs≡</a> <a id="2648" class="Symbol">:</a> <a id="2650" href="Armor.Data.X690-DER.BitString.TCB.html#2412" class="Bound">bs</a> <a id="2653" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2655" href="Armor.Data.X690-DER.BitString.TCB.html#2493" class="Field">bₕ</a> <a id="2658" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2660" href="Armor.Data.X690-DER.BitString.TCB.html#2513" class="Field">bₜ</a>

<a id="BitString"></a><a id="2664" href="Armor.Data.X690-DER.BitString.TCB.html#2664" class="Function">BitString</a> <a id="2674" class="Symbol">:</a> <a id="2676" class="Symbol">@</a><a id="2677" class="Symbol">0</a> <a id="2679" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2684" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="2690" class="Symbol">→</a> <a id="2692" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2696" href="Armor.Data.X690-DER.BitString.TCB.html#2664" class="Function">BitString</a> <a id="2706" class="Symbol">=</a> <a id="2708" href="Armor.Data.X690-DER.TLV.TCB.html#534" class="Record">TLV</a> <a id="2712" href="Armor.Data.X690-DER.Tag.html#194" class="Function">Tag.BitString</a> <a id="2726" href="Armor.Data.X690-DER.BitString.TCB.html#2393" class="Record">BitStringValue</a>

<a id="RawBitStringValue"></a><a id="2742" href="Armor.Data.X690-DER.BitString.TCB.html#2742" class="Function">RawBitStringValue</a> <a id="2760" class="Symbol">:</a> <a id="2762" href="Armor.Grammar.Definitions.NonMalleable.Base.html#125" class="Record">Raw</a> <a id="2766" href="Armor.Data.X690-DER.BitString.TCB.html#2393" class="Record">BitStringValue</a>
<a id="2781" href="Armor.Grammar.Definitions.NonMalleable.Base.html#176" class="Field">Raw.D</a> <a id="2787" href="Armor.Data.X690-DER.BitString.TCB.html#2742" class="Function">RawBitStringValue</a> <a id="2805" class="Symbol">=</a> <a id="2807" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2812" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="2817" href="Armor.Grammar.Definitions.NonMalleable.Base.html#188" class="Field">Raw.to</a> <a id="2824" href="Armor.Data.X690-DER.BitString.TCB.html#2742" class="Function">RawBitStringValue</a> <a id="2842" class="Symbol">=</a> <a id="2844" href="Armor.Prelude.html#7183" class="Function Operator">↑_</a> <a id="2847" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2849" href="Armor.Data.X690-DER.BitString.TCB.html#2562" class="Field">BitStringValue.bits</a>

<a id="RawBitString"></a><a id="2870" href="Armor.Data.X690-DER.BitString.TCB.html#2870" class="Function">RawBitString</a> <a id="2883" class="Symbol">:</a> <a id="2885" href="Armor.Grammar.Definitions.NonMalleable.Base.html#125" class="Record">Raw</a> <a id="2889" href="Armor.Data.X690-DER.BitString.TCB.html#2664" class="Function">BitString</a>
<a id="2899" href="Armor.Data.X690-DER.BitString.TCB.html#2870" class="Function">RawBitString</a> <a id="2912" class="Symbol">=</a> <a id="2914" href="Armor.Data.X690-DER.TLV.TCB.html#1272" class="Function">RawTLV</a> <a id="2921" class="Symbol">_</a> <a id="2923" href="Armor.Data.X690-DER.BitString.TCB.html#2742" class="Function">RawBitStringValue</a>
</pre></body></html>