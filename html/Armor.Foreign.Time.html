<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Foreign.Time</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="28" class="Keyword">module</a> <a id="35" href="Armor.Foreign.Time.html" class="Module">Armor.Foreign.Time</a> <a id="54" class="Keyword">where</a>

<a id="61" class="Symbol">{-#</a> <a id="65" class="Keyword">FOREIGN</a> <a id="73" class="Pragma">GHC</a> <a id="77" class="Pragma">import</a> <a id="84" class="Pragma">qualified</a> <a id="94" class="Pragma">Data.Text</a> <a id="104" class="Symbol">#-}</a>
<a id="108" class="Symbol">{-#</a> <a id="112" class="Keyword">FOREIGN</a> <a id="120" class="Pragma">GHC</a> <a id="124" class="Pragma">import</a> <a id="131" class="Pragma">Data.Time</a> <a id="141" class="Symbol">#-}</a>
<a id="145" class="Symbol">{-#</a> <a id="149" class="Keyword">FOREIGN</a> <a id="157" class="Pragma">GHC</a> <a id="161" class="Pragma">import</a> <a id="168" class="Pragma">Data.Time.Clock</a> <a id="184" class="Symbol">#-}</a>
<a id="188" class="Symbol">{-#</a> <a id="192" class="Keyword">FOREIGN</a> <a id="200" class="Pragma">GHC</a> <a id="204" class="Pragma">import</a> <a id="211" class="Pragma">Data.Time.Calendar.OrdinalDate</a> <a id="242" class="Symbol">#-}</a>
<a id="246" class="Symbol">{-#</a> <a id="250" class="Keyword">FOREIGN</a> <a id="258" class="Pragma">GHC</a> <a id="262" class="Pragma">import</a> <a id="269" class="Pragma">Data.Time.Calendar.MonthDay</a> <a id="297" class="Symbol">#-}</a>
<a id="301" class="Symbol">{-#</a> <a id="305" class="Keyword">FOREIGN</a> <a id="313" class="Pragma">GHC</a> <a id="317" class="Pragma">import</a> <a id="324" class="Pragma">Data.Time.LocalTime</a> <a id="344" class="Symbol">#-}</a>

<a id="349" class="Symbol">{-#</a> <a id="353" class="Keyword">FOREIGN</a> <a id="361" class="Pragma">GHC</a>

<a id="366" class="Pragma">year</a> <a id="371" class="Pragma">::</a> <a id="374" class="Pragma">UTCTime</a> <a id="382" class="Pragma">-&gt;</a> <a id="385" class="Pragma">Integer</a>
<a id="393" class="Pragma">year</a> <a id="398" class="Pragma">=</a> <a id="400" class="Pragma">fst</a> <a id="404" class="Pragma">.</a> <a id="406" class="Pragma">toOrdinalDate</a> <a id="420" class="Pragma">.</a> <a id="422" class="Pragma">utctDay</a>

<a id="431" class="Pragma">month</a> <a id="437" class="Pragma">::</a> <a id="440" class="Pragma">UTCTime</a> <a id="448" class="Pragma">-&gt;</a> <a id="451" class="Pragma">Integer</a>
<a id="459" class="Pragma">month</a> <a id="465" class="Pragma">x</a> <a id="467" class="Pragma">=</a> <a id="469" class="Pragma">toInteger</a> <a id="479" class="Pragma">.</a> <a id="481" class="Pragma">fst</a> <a id="485" class="Pragma">.</a> <a id="487" class="Pragma">dayOfYearToMonthAndDay</a> <a id="510" class="Pragma">(isLeapYear</a> <a id="522" class="Pragma">.</a> <a id="524" class="Pragma">year</a> <a id="529" class="Pragma">$</a> <a id="531" class="Pragma">x)</a> <a id="534" class="Pragma">.</a> <a id="536" class="Pragma">snd</a> <a id="540" class="Pragma">.</a> <a id="542" class="Pragma">toOrdinalDate</a> <a id="556" class="Pragma">.</a> <a id="558" class="Pragma">utctDay</a> <a id="566" class="Pragma">$</a> <a id="568" class="Pragma">x</a>

<a id="571" class="Pragma">day</a> <a id="575" class="Pragma">::</a> <a id="578" class="Pragma">UTCTime</a> <a id="586" class="Pragma">-&gt;</a> <a id="589" class="Pragma">Integer</a>
<a id="597" class="Pragma">day</a> <a id="601" class="Pragma">x</a> <a id="603" class="Pragma">=</a> <a id="605" class="Pragma">toInteger</a> <a id="615" class="Pragma">.</a> <a id="617" class="Pragma">snd</a> <a id="621" class="Pragma">.</a> <a id="623" class="Pragma">dayOfYearToMonthAndDay</a> <a id="646" class="Pragma">(isLeapYear</a> <a id="658" class="Pragma">.</a> <a id="660" class="Pragma">year</a> <a id="665" class="Pragma">$</a> <a id="667" class="Pragma">x)</a> <a id="670" class="Pragma">.</a> <a id="672" class="Pragma">snd</a> <a id="676" class="Pragma">.</a> <a id="678" class="Pragma">toOrdinalDate</a> <a id="692" class="Pragma">.</a> <a id="694" class="Pragma">utctDay</a> <a id="702" class="Pragma">$</a> <a id="704" class="Pragma">x</a>

<a id="707" class="Pragma">hour</a> <a id="712" class="Pragma">::</a> <a id="715" class="Pragma">UTCTime</a> <a id="723" class="Pragma">-&gt;</a> <a id="726" class="Pragma">Integer</a>
<a id="734" class="Pragma">hour</a> <a id="739" class="Pragma">=</a> <a id="741" class="Pragma">toInteger</a> <a id="751" class="Pragma">.</a> <a id="753" class="Pragma">todHour</a> <a id="761" class="Pragma">.</a> <a id="763" class="Pragma">timeToTimeOfDay</a> <a id="779" class="Pragma">.</a> <a id="781" class="Pragma">utctDayTime</a>

<a id="794" class="Pragma">minute</a> <a id="801" class="Pragma">::</a> <a id="804" class="Pragma">UTCTime</a> <a id="812" class="Pragma">-&gt;</a> <a id="815" class="Pragma">Integer</a>
<a id="823" class="Pragma">minute</a> <a id="830" class="Pragma">=</a> <a id="832" class="Pragma">toInteger</a> <a id="842" class="Pragma">.</a> <a id="844" class="Pragma">todMin</a> <a id="851" class="Pragma">.</a> <a id="853" class="Pragma">timeToTimeOfDay</a> <a id="869" class="Pragma">.</a> <a id="871" class="Pragma">utctDayTime</a>

<a id="884" class="Pragma">second</a> <a id="891" class="Pragma">::</a> <a id="894" class="Pragma">UTCTime</a> <a id="902" class="Pragma">-&gt;</a> <a id="905" class="Pragma">Integer</a>
<a id="913" class="Pragma">second</a> <a id="920" class="Pragma">=</a> <a id="922" class="Pragma">fst</a> <a id="926" class="Pragma">.</a> <a id="928" class="Pragma">properFraction</a> <a id="943" class="Pragma">.</a> <a id="945" class="Pragma">todSec</a> <a id="952" class="Pragma">.</a> <a id="954" class="Pragma">timeToTimeOfDay</a> <a id="970" class="Pragma">.</a> <a id="972" class="Pragma">utctDayTime</a>

<a id="985" class="Pragma">showTime</a> <a id="994" class="Pragma">::</a> <a id="997" class="Pragma">UTCTime</a> <a id="1005" class="Pragma">-&gt;</a> <a id="1008" class="Pragma">Data.Text.Text</a>
<a id="1023" class="Pragma">showTime</a> <a id="1032" class="Pragma">=</a> <a id="1034" class="Pragma">Data.Text.pack</a> <a id="1049" class="Pragma">.</a> <a id="1051" class="Pragma">show</a>
<a id="1056" class="Symbol">#-}</a>

<a id="1061" class="Keyword">postulate</a>
  <a id="UTCTime"></a><a id="1073" href="Armor.Foreign.Time.html#1073" class="Postulate">UTCTime</a> <a id="Day"></a><a id="1081" href="Armor.Foreign.Time.html#1081" class="Postulate">Day</a> <a id="1085" class="Symbol">:</a> <a id="1087" href="Agda.Primitive.html#326" class="Primitive">Set</a>

<a id="1092" class="Keyword">postulate</a>
  <a id="year"></a><a id="1104" href="Armor.Foreign.Time.html#1104" class="Postulate">year</a>   <a id="1111" class="Symbol">:</a> <a id="1113" href="Armor.Foreign.Time.html#1073" class="Postulate">UTCTime</a> <a id="1121" class="Symbol">→</a> <a id="1123" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
  <a id="month"></a><a id="1127" href="Armor.Foreign.Time.html#1127" class="Postulate">month</a>  <a id="1134" class="Symbol">:</a> <a id="1136" href="Armor.Foreign.Time.html#1073" class="Postulate">UTCTime</a> <a id="1144" class="Symbol">→</a> <a id="1146" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
  <a id="day"></a><a id="1150" href="Armor.Foreign.Time.html#1150" class="Postulate">day</a>    <a id="1157" class="Symbol">:</a> <a id="1159" href="Armor.Foreign.Time.html#1073" class="Postulate">UTCTime</a> <a id="1167" class="Symbol">→</a> <a id="1169" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
  <a id="hour"></a><a id="1173" href="Armor.Foreign.Time.html#1173" class="Postulate">hour</a>   <a id="1180" class="Symbol">:</a> <a id="1182" href="Armor.Foreign.Time.html#1073" class="Postulate">UTCTime</a> <a id="1190" class="Symbol">→</a> <a id="1192" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
  <a id="minute"></a><a id="1196" href="Armor.Foreign.Time.html#1196" class="Postulate">minute</a> <a id="1203" class="Symbol">:</a> <a id="1205" href="Armor.Foreign.Time.html#1073" class="Postulate">UTCTime</a> <a id="1213" class="Symbol">→</a> <a id="1215" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
  <a id="second"></a><a id="1219" href="Armor.Foreign.Time.html#1219" class="Postulate">second</a> <a id="1226" class="Symbol">:</a> <a id="1228" href="Armor.Foreign.Time.html#1073" class="Postulate">UTCTime</a> <a id="1236" class="Symbol">→</a> <a id="1238" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
  <a id="showTime"></a><a id="1242" href="Armor.Foreign.Time.html#1242" class="Postulate">showTime</a> <a id="1251" class="Symbol">:</a> <a id="1253" href="Armor.Foreign.Time.html#1073" class="Postulate">UTCTime</a> <a id="1261" class="Symbol">→</a> <a id="1263" href="Armor.Prelude.html#3078" class="Function">String</a>

<a id="1271" class="Symbol">{-#</a> <a id="1275" class="Keyword">COMPILE</a> <a id="1283" class="Keyword">GHC</a> <a id="1287" href="Armor.Foreign.Time.html#1073" class="Postulate">UTCTime</a>    <a id="1298" class="Pragma">=</a> <a id="1300" class="Pragma">type</a> <a id="1305" class="Pragma">UTCTime</a> <a id="1313" class="Symbol">#-}</a>
<a id="1317" class="Symbol">{-#</a> <a id="1321" class="Keyword">COMPILE</a> <a id="1329" class="Keyword">GHC</a> <a id="1333" href="Armor.Foreign.Time.html#1081" class="Postulate">Day</a>        <a id="1344" class="Pragma">=</a> <a id="1346" class="Pragma">type</a> <a id="1351" class="Pragma">Day</a> <a id="1355" class="Symbol">#-}</a>
<a id="1359" class="Symbol">{-#</a> <a id="1363" class="Keyword">COMPILE</a> <a id="1371" class="Keyword">GHC</a> <a id="1375" href="Armor.Foreign.Time.html#1104" class="Postulate">year</a>   <a id="1382" class="Pragma">=</a> <a id="1384" class="Pragma">year</a>  <a id="1390" class="Symbol">#-}</a>
<a id="1394" class="Symbol">{-#</a> <a id="1398" class="Keyword">COMPILE</a> <a id="1406" class="Keyword">GHC</a> <a id="1410" href="Armor.Foreign.Time.html#1127" class="Postulate">month</a>  <a id="1417" class="Pragma">=</a> <a id="1419" class="Pragma">month</a>  <a id="1426" class="Symbol">#-}</a>
<a id="1430" class="Symbol">{-#</a> <a id="1434" class="Keyword">COMPILE</a> <a id="1442" class="Keyword">GHC</a> <a id="1446" href="Armor.Foreign.Time.html#1150" class="Postulate">day</a>    <a id="1453" class="Pragma">=</a> <a id="1455" class="Pragma">day</a>  <a id="1460" class="Symbol">#-}</a>
<a id="1464" class="Symbol">{-#</a> <a id="1468" class="Keyword">COMPILE</a> <a id="1476" class="Keyword">GHC</a> <a id="1480" href="Armor.Foreign.Time.html#1173" class="Postulate">hour</a>   <a id="1487" class="Pragma">=</a> <a id="1489" class="Pragma">hour</a>  <a id="1495" class="Symbol">#-}</a>
<a id="1499" class="Symbol">{-#</a> <a id="1503" class="Keyword">COMPILE</a> <a id="1511" class="Keyword">GHC</a> <a id="1515" href="Armor.Foreign.Time.html#1196" class="Postulate">minute</a> <a id="1522" class="Pragma">=</a> <a id="1524" class="Pragma">minute</a>  <a id="1532" class="Symbol">#-}</a>
<a id="1536" class="Symbol">{-#</a> <a id="1540" class="Keyword">COMPILE</a> <a id="1548" class="Keyword">GHC</a> <a id="1552" href="Armor.Foreign.Time.html#1219" class="Postulate">second</a> <a id="1559" class="Pragma">=</a> <a id="1561" class="Pragma">second</a>  <a id="1569" class="Symbol">#-}</a>
<a id="1573" class="Symbol">{-#</a> <a id="1577" class="Keyword">COMPILE</a> <a id="1585" class="Keyword">GHC</a> <a id="1589" href="Armor.Foreign.Time.html#1242" class="Postulate">showTime</a> <a id="1598" class="Pragma">=</a> <a id="1600" class="Pragma">showTime</a>  <a id="1610" class="Symbol">#-}</a>
</pre></body></html>