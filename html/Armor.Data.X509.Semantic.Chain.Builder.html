<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.Semantic.Chain.Builder</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a>  <a id="14" class="Pragma">--sized-types</a> <a id="28" class="Symbol">#-}</a>

<a id="33" class="Keyword">open</a> <a id="38" class="Keyword">import</a> <a id="45" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="58" class="Keyword">open</a> <a id="63" class="Keyword">import</a> <a id="70" href="Armor.Data.X509.html" class="Module">Armor.Data.X509</a>
<a id="86" class="Keyword">open</a> <a id="91" class="Keyword">import</a> <a id="98" href="Armor.Data.X509.Semantic.Chain.NameMatch.html" class="Module">Armor.Data.X509.Semantic.Chain.NameMatch</a>
<a id="139" class="Keyword">open</a> <a id="144" class="Keyword">import</a> <a id="151" href="Armor.Data.X509.Semantic.Chain.Properties.html" class="Module">Armor.Data.X509.Semantic.Chain.Properties</a>
<a id="193" class="Keyword">open</a> <a id="198" class="Keyword">import</a> <a id="205" href="Armor.Data.X509.Semantic.Chain.TCB.html" class="Module">Armor.Data.X509.Semantic.Chain.TCB</a>
<a id="240" class="Keyword">open</a> <a id="245" class="Keyword">import</a> <a id="252" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>
<a id="266" class="Keyword">import</a>      <a id="278" href="Data.List.html" class="Module">Data.List</a> <a id="288" class="Symbol">as</a> <a id="291" class="Module">List</a>
<a id="296" class="Keyword">import</a>      <a id="308" href="Data.List.Membership.Propositional.html" class="Module">Data.List.Membership.Propositional</a> <a id="343" class="Symbol">as</a> <a id="346" class="Module">List</a>
<a id="351" class="Keyword">import</a>      <a id="363" href="Data.List.Membership.Propositional.Properties.html" class="Module">Data.List.Membership.Propositional.Properties</a> <a id="409" class="Symbol">as</a> <a id="412" class="Module">List</a>

<a id="418" class="Keyword">module</a> <a id="425" href="Armor.Data.X509.Semantic.Chain.Builder.html" class="Module">Armor.Data.X509.Semantic.Chain.Builder</a> <a id="464" class="Keyword">where</a>

<a id="471" class="Comment">-- data TrustTree (trustedRoot candidates : List (Exists─ _ Cert)) : ∀ {@0 bs} → Cert bs → Set</a>
<a id="TrustTreeBranchF"></a><a id="566" href="Armor.Data.X509.Semantic.Chain.Builder.html#566" class="Function">TrustTreeBranchF</a> <a id="583" class="Symbol">:</a> <a id="585" class="Symbol">∀</a> <a id="587" class="Symbol">{@</a><a id="589" class="Symbol">0</a> <a id="591" href="Armor.Data.X509.Semantic.Chain.Builder.html#591" class="Bound">bs</a><a id="593" class="Symbol">}</a> <a id="595" href="Armor.Data.X509.Semantic.Chain.Builder.html#595" class="Bound">trustedRoot</a> <a id="607" href="Armor.Data.X509.Semantic.Chain.Builder.html#607" class="Bound">candidates</a> <a id="618" class="Symbol">(</a><a id="619" href="Armor.Data.X509.Semantic.Chain.Builder.html#619" class="Bound">issuee</a> <a id="626" class="Symbol">:</a> <a id="628" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="633" href="Armor.Data.X509.Semantic.Chain.Builder.html#591" class="Bound">bs</a><a id="635" class="Symbol">)</a> <a id="637" class="Symbol">→</a> <a id="639" href="Armor.Data.X509.Semantic.Chain.TCB.html#808" class="Function Operator">IssuerFor</a> <a id="649" href="Armor.Data.X509.Semantic.Chain.Builder.html#619" class="Bound">issuee</a> <a id="656" href="Armor.Data.X509.Semantic.Chain.TCB.html#808" class="Function Operator">In</a> <a id="659" href="Armor.Data.X509.Semantic.Chain.Builder.html#607" class="Bound">candidates</a> <a id="670" class="Symbol">→</a> <a id="672" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="676" class="Keyword">record</a> <a id="TrustTree"></a><a id="683" href="Armor.Data.X509.Semantic.Chain.Builder.html#683" class="Record">TrustTree</a> <a id="693" class="Symbol">(</a><a id="694" href="Armor.Data.X509.Semantic.Chain.Builder.html#694" class="Bound">trustedRoot</a> <a id="706" href="Armor.Data.X509.Semantic.Chain.Builder.html#706" class="Bound">candidates</a> <a id="717" class="Symbol">:</a> <a id="719" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="724" class="Symbol">(</a><a id="725" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="733" class="Symbol">_</a> <a id="735" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="739" class="Symbol">))</a> <a id="742" class="Symbol">{@</a><a id="744" class="Symbol">0</a> <a id="746" href="Armor.Data.X509.Semantic.Chain.Builder.html#746" class="Bound">bs</a> <a id="749" class="Symbol">:</a> <a id="751" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="756" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="761" class="Symbol">}</a> <a id="763" class="Symbol">(</a><a id="764" href="Armor.Data.X509.Semantic.Chain.Builder.html#764" class="Bound">issuee</a> <a id="771" class="Symbol">:</a> <a id="773" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="778" href="Armor.Data.X509.Semantic.Chain.Builder.html#746" class="Bound">bs</a><a id="780" class="Symbol">)</a> <a id="782" class="Symbol">:</a> <a id="784" href="Agda.Primitive.html#326" class="Primitive">Set</a>

<a id="789" class="Comment">-- data TrustTree trustedRoot candidates where</a>
<a id="836" class="Comment">--   trustTree : ∀ {@0 bs} → (issuee : Cert bs) → TrustTreeNode trustedRoot candidates issuee → TrustTree trustedRoot candidates issuee</a>

<a id="973" href="Armor.Data.X509.Semantic.Chain.Builder.html#566" class="Function">TrustTreeBranchF</a> <a id="990" href="Armor.Data.X509.Semantic.Chain.Builder.html#990" class="Bound">trustedRoot</a> <a id="1002" href="Armor.Data.X509.Semantic.Chain.Builder.html#1002" class="Bound">candidates</a> <a id="1013" href="Armor.Data.X509.Semantic.Chain.Builder.html#1013" class="Bound">issuee</a> <a id="1020" class="Symbol">(</a><a id="1021" href="Armor.Data.X509.Semantic.Chain.TCB.html#1150" class="InductiveConstructor">anIssuerForIn</a> <a id="1035" href="Armor.Data.X509.Semantic.Chain.Builder.html#1035" class="Bound">issuer</a> <a id="1042" href="Armor.Data.X509.Semantic.Chain.Builder.html#1042" class="Bound">isIssuerFor</a> <a id="1054" href="Armor.Data.X509.Semantic.Chain.Builder.html#1054" class="Bound">issuer∈</a><a id="1061" class="Symbol">)</a> <a id="1063" class="Symbol">=</a>
  <a id="1067" href="Armor.Data.X509.Semantic.Chain.Builder.html#683" class="Record">TrustTree</a> <a id="1077" class="Symbol">(</a><a id="1078" href="Armor.Data.X509.Semantic.Chain.TCB.html#4086" class="Function">removeCertFromCerts</a> <a id="1098" href="Armor.Data.X509.Semantic.Chain.Builder.html#1035" class="Bound">issuer</a> <a id="1105" href="Armor.Data.X509.Semantic.Chain.Builder.html#990" class="Bound">trustedRoot</a><a id="1116" class="Symbol">)</a> <a id="1118" class="Symbol">(</a><a id="1119" href="Armor.Data.X509.Semantic.Chain.TCB.html#4086" class="Function">removeCertFromCerts</a> <a id="1139" href="Armor.Data.X509.Semantic.Chain.Builder.html#1035" class="Bound">issuer</a> <a id="1146" href="Armor.Data.X509.Semantic.Chain.Builder.html#1002" class="Bound">candidates</a><a id="1156" class="Symbol">)</a> <a id="1158" href="Armor.Data.X509.Semantic.Chain.Builder.html#1035" class="Bound">issuer</a>

<a id="1166" class="Keyword">record</a> <a id="1173" href="Armor.Data.X509.Semantic.Chain.Builder.html#683" class="Record">TrustTree</a> trustedRoot candidates <a id="1206" class="Symbol">{</a>bs<a id="1209" class="Symbol">}</a> issuee <a id="1218" class="Keyword">where</a>
  <a id="1226" class="Keyword">inductive</a>
  <a id="1238" class="Keyword">constructor</a> <a id="mkTrustTree"></a><a id="1250" href="Armor.Data.X509.Semantic.Chain.Builder.html#1250" class="InductiveConstructor">mkTrustTree</a>
  <a id="1264" class="Keyword">field</a>
    <a id="TrustTree.rootIssuers"></a><a id="1274" href="Armor.Data.X509.Semantic.Chain.Builder.html#1274" class="Field">rootIssuers</a>  <a id="1287" class="Symbol">:</a> <a id="1289" href="Armor.Data.X509.Semantic.Chain.TCB.html#1786" class="Function Operator">AllIssuersFor</a> <a id="1303" href="Armor.Data.X509.Semantic.Chain.Builder.html#1211" class="Bound">issuee</a> <a id="1310" href="Armor.Data.X509.Semantic.Chain.TCB.html#1786" class="Function Operator">In</a> <a id="1313" href="Armor.Data.X509.Semantic.Chain.Builder.html#1183" class="Bound">trustedRoot</a>
    <a id="TrustTree.otherIssuers"></a><a id="1329" href="Armor.Data.X509.Semantic.Chain.Builder.html#1329" class="Field">otherIssuers</a> <a id="1342" class="Symbol">:</a> <a id="1344" href="Armor.Data.X509.Semantic.Chain.TCB.html#1786" class="Function Operator">AllIssuersFor</a> <a id="1358" href="Armor.Data.X509.Semantic.Chain.Builder.html#1211" class="Bound">issuee</a> <a id="1365" href="Armor.Data.X509.Semantic.Chain.TCB.html#1786" class="Function Operator">In</a> <a id="1368" href="Armor.Data.X509.Semantic.Chain.Builder.html#1195" class="Bound">candidates</a>
    <a id="TrustTree.otherTrust"></a><a id="1383" href="Armor.Data.X509.Semantic.Chain.Builder.html#1383" class="Field">otherTrust</a>   <a id="1396" class="Symbol">:</a> <a id="1398" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="1402" class="Symbol">(</a><a id="1403" href="Armor.Data.X509.Semantic.Chain.Builder.html#566" class="Function">TrustTreeBranchF</a> <a id="1420" href="Armor.Data.X509.Semantic.Chain.Builder.html#1183" class="Bound">trustedRoot</a> <a id="1432" href="Armor.Data.X509.Semantic.Chain.Builder.html#1195" class="Bound">candidates</a> <a id="1443" href="Armor.Data.X509.Semantic.Chain.Builder.html#1211" class="Bound">issuee</a><a id="1449" class="Symbol">)</a> <a id="1451" class="Symbol">(</a><a id="1452" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="1458" href="Armor.Data.X509.Semantic.Chain.Builder.html#1329" class="Field">otherIssuers</a><a id="1470" class="Symbol">)</a>

<a id="findIssuersFor"></a><a id="1473" href="Armor.Data.X509.Semantic.Chain.Builder.html#1473" class="Function">findIssuersFor</a> <a id="1488" class="Symbol">:</a> <a id="1490" class="Symbol">∀</a> <a id="1492" class="Symbol">{@</a><a id="1494" class="Symbol">0</a> <a id="1496" href="Armor.Data.X509.Semantic.Chain.Builder.html#1496" class="Bound">bs</a><a id="1498" class="Symbol">}</a> <a id="1500" class="Symbol">→</a> <a id="1502" class="Symbol">(</a><a id="1503" href="Armor.Data.X509.Semantic.Chain.Builder.html#1503" class="Bound">issuee</a> <a id="1510" class="Symbol">:</a> <a id="1512" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="1517" href="Armor.Data.X509.Semantic.Chain.Builder.html#1496" class="Bound">bs</a><a id="1519" class="Symbol">)</a> <a id="1521" class="Symbol">→</a> <a id="1523" class="Symbol">(</a><a id="1524" href="Armor.Data.X509.Semantic.Chain.Builder.html#1524" class="Bound">certs</a> <a id="1530" class="Symbol">:</a> <a id="1532" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1537" class="Symbol">(</a><a id="1538" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="1546" class="Symbol">_</a> <a id="1548" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="1552" class="Symbol">))</a> <a id="1555" class="Symbol">→</a> <a id="1557" href="Armor.Data.X509.Semantic.Chain.TCB.html#1786" class="Function Operator">AllIssuersFor</a> <a id="1571" href="Armor.Data.X509.Semantic.Chain.Builder.html#1503" class="Bound">issuee</a> <a id="1578" href="Armor.Data.X509.Semantic.Chain.TCB.html#1786" class="Function Operator">In</a> <a id="1581" href="Armor.Data.X509.Semantic.Chain.Builder.html#1524" class="Bound">certs</a>
<a id="1587" href="Armor.Data.X509.Semantic.Chain.Builder.html#1473" class="Function">findIssuersFor</a> <a id="1602" href="Armor.Data.X509.Semantic.Chain.Builder.html#1602" class="Bound">issuee</a> <a id="1609" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1612" class="Symbol">=</a> <a id="1614" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1617" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1619" href="Data.List.Relation.Unary.All.html#1507" class="InductiveConstructor">[]</a>
<a id="1622" href="Armor.Data.X509.Semantic.Chain.Builder.html#1473" class="Function">findIssuersFor</a> <a id="1637" href="Armor.Data.X509.Semantic.Chain.Builder.html#1637" class="Bound">issuee</a> <a id="1644" class="Symbol">((</a><a id="1646" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="1648" class="Symbol">_</a> <a id="1650" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1652" href="Armor.Data.X509.Semantic.Chain.Builder.html#1652" class="Bound">cert</a><a id="1656" class="Symbol">)</a> <a id="1658" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1660" href="Armor.Data.X509.Semantic.Chain.Builder.html#1660" class="Bound">certs</a><a id="1665" class="Symbol">)</a> <a id="1667" class="Symbol">=</a>
  <a id="1671" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="1676" href="Armor.Data.X509.Semantic.Chain.Builder.html#1652" class="Bound">cert</a> <a id="1681" href="Armor.Data.X509.Semantic.Chain.TCB.html#422" class="Function Operator">isIssuerFor?</a> <a id="1694" href="Armor.Data.X509.Semantic.Chain.Builder.html#1637" class="Bound">issuee</a> <a id="1701" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="1704" class="Symbol">λ</a> <a id="1706" class="Keyword">where</a>
    <a id="1716" class="Symbol">(</a><a id="1717" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1721" href="Armor.Data.X509.Semantic.Chain.Builder.html#1721" class="Bound">isIssuer</a><a id="1729" class="Symbol">)</a> <a id="1731" class="Symbol">→</a>
      <a id="1739" href="Data.Product.html#2486" class="Function">Product.map</a> <a id="1751" class="Symbol">(λ</a> <a id="1754" href="Armor.Data.X509.Semantic.Chain.Builder.html#1754" class="Bound">issuers</a> <a id="1762" class="Symbol">→</a> <a id="1764" class="Symbol">((</a><a id="1766" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="1769" href="Armor.Data.X509.Semantic.Chain.Builder.html#1652" class="Bound">cert</a><a id="1773" class="Symbol">)</a> <a id="1775" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1777" class="Symbol">(</a><a id="1778" href="Armor.Data.X509.Semantic.Chain.Builder.html#1721" class="Bound">isIssuer</a> <a id="1787" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1789" class="Symbol">(</a><a id="1790" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="1795" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1799" class="Symbol">)))</a> <a id="1803" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1805" href="Armor.Data.X509.Semantic.Chain.Builder.html#2833" class="Function">weaken</a> <a id="1812" href="Armor.Data.X509.Semantic.Chain.Builder.html#1754" class="Bound">issuers</a><a id="1819" class="Symbol">)</a>
      <a id="1827" class="Symbol">(λ</a> <a id="1830" class="Symbol">{</a><a id="1831" href="Armor.Data.X509.Semantic.Chain.Builder.html#1831" class="Bound">issuers</a><a id="1838" class="Symbol">}</a> <a id="1840" href="Armor.Data.X509.Semantic.Chain.Builder.html#1840" class="Bound">isAllIssuersForIn</a> <a id="1858" class="Symbol">→</a>
        <a id="1868" href="Data.List.Relation.Unary.All.html#3725" class="Function">All.tabulate</a> <a id="1881" class="Symbol">(λ</a> <a id="1884" class="Keyword">where</a>
          <a id="1900" class="Symbol">{</a><a id="1901" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="1903" class="Symbol">_</a> <a id="1905" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1907" href="Armor.Data.X509.Semantic.Chain.Builder.html#1907" class="Bound">cert</a><a id="1911" class="Symbol">}</a> <a id="1913" class="Symbol">(</a><a id="1914" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="1919" href="Armor.Data.X509.Semantic.Chain.Builder.html#1919" class="Bound">px</a><a id="1921" class="Symbol">)</a> <a id="1923" href="Armor.Data.X509.Semantic.Chain.Builder.html#1923" class="Bound">isIssuerFor</a> <a id="1935" class="Symbol">→</a> <a id="1937" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="1942" href="Armor.Data.X509.Semantic.Chain.Builder.html#1919" class="Bound">px</a>
          <a id="1955" class="Symbol">{</a><a id="1956" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="1958" class="Symbol">_</a> <a id="1960" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1962" href="Armor.Data.X509.Semantic.Chain.Builder.html#1962" class="Bound">cert</a><a id="1966" class="Symbol">}</a> <a id="1968" class="Symbol">(</a><a id="1969" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a> <a id="1975" href="Armor.Data.X509.Semantic.Chain.Builder.html#1975" class="Bound">cert∈</a><a id="1980" class="Symbol">)</a> <a id="1982" href="Armor.Data.X509.Semantic.Chain.Builder.html#1982" class="Bound">isIssuerFor</a> <a id="1994" class="Symbol">→</a>
            <a id="2008" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a> <a id="2014" class="Symbol">(</a><a id="2015" href="Armor.Data.X509.Semantic.Chain.Builder.html#2954" class="Function">∈weaken</a> <a id="2023" href="Armor.Data.X509.Semantic.Chain.Builder.html#1831" class="Bound">issuers</a> <a id="2031" class="Symbol">(</a><a id="2032" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="2035" href="Armor.Data.X509.Semantic.Chain.Builder.html#1962" class="Bound">cert</a><a id="2039" class="Symbol">)</a> <a id="2041" class="Symbol">(</a><a id="2042" href="Data.List.Relation.Unary.All.html#5766" class="Function">All.lookup</a> <a id="2053" href="Armor.Data.X509.Semantic.Chain.Builder.html#1840" class="Bound">isAllIssuersForIn</a> <a id="2071" href="Armor.Data.X509.Semantic.Chain.Builder.html#1975" class="Bound">cert∈</a> <a id="2077" href="Armor.Data.X509.Semantic.Chain.Builder.html#1982" class="Bound">isIssuerFor</a><a id="2088" class="Symbol">))))</a>
      <a id="2099" href="Armor.Data.X509.Semantic.Chain.Builder.html#2553" class="Function">issuers</a>
    <a id="2111" class="Symbol">(</a><a id="2112" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2115" href="Armor.Data.X509.Semantic.Chain.Builder.html#2115" class="Bound">¬isIssuer</a><a id="2124" class="Symbol">)</a> <a id="2126" class="Symbol">→</a>
      <a id="2134" href="Data.Product.html#2486" class="Function">Product.map</a>
        <a id="2154" class="Symbol">(λ</a> <a id="2157" href="Armor.Data.X509.Semantic.Chain.Builder.html#2157" class="Bound">issuers</a> <a id="2165" class="Symbol">→</a> <a id="2167" href="Armor.Data.X509.Semantic.Chain.Builder.html#2833" class="Function">weaken</a> <a id="2174" href="Armor.Data.X509.Semantic.Chain.Builder.html#2157" class="Bound">issuers</a><a id="2181" class="Symbol">)</a>
        <a id="2191" class="Symbol">(λ</a> <a id="2194" class="Symbol">{</a><a id="2195" href="Armor.Data.X509.Semantic.Chain.Builder.html#2195" class="Bound">issuers</a><a id="2202" class="Symbol">}</a> <a id="2204" href="Armor.Data.X509.Semantic.Chain.Builder.html#2204" class="Bound">isAllIssuersForIn</a> <a id="2222" class="Symbol">→</a>
          <a id="2234" href="Data.List.Relation.Unary.All.html#3725" class="Function">All.tabulate</a> <a id="2247" class="Symbol">λ</a> <a id="2249" class="Keyword">where</a>
            <a id="2267" class="Symbol">{</a><a id="2268" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="2270" class="Symbol">_</a> <a id="2272" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2274" href="Armor.Data.X509.Semantic.Chain.Builder.html#2274" class="Bound">cert</a><a id="2278" class="Symbol">}</a> <a id="2280" class="Symbol">(</a><a id="2281" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="2286" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="2290" class="Symbol">)</a> <a id="2292" href="Armor.Data.X509.Semantic.Chain.Builder.html#2292" class="Bound">isIssuerFor</a> <a id="2304" class="Symbol">→</a>
              <a id="2320" href="Armor.Prelude.html#6155" class="Function">contradiction</a> <a id="2334" href="Armor.Data.X509.Semantic.Chain.Builder.html#2292" class="Bound">isIssuerFor</a> <a id="2346" href="Armor.Data.X509.Semantic.Chain.Builder.html#2115" class="Bound">¬isIssuer</a>
            <a id="2368" class="Symbol">{</a><a id="2369" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="2371" class="Symbol">_</a> <a id="2373" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2375" href="Armor.Data.X509.Semantic.Chain.Builder.html#2375" class="Bound">cert</a><a id="2379" class="Symbol">}</a> <a id="2381" class="Symbol">(</a><a id="2382" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a> <a id="2388" href="Armor.Data.X509.Semantic.Chain.Builder.html#2388" class="Bound">c∈</a><a id="2390" class="Symbol">)</a> <a id="2392" href="Armor.Data.X509.Semantic.Chain.Builder.html#2392" class="Bound">isIssuerFor</a> <a id="2404" class="Symbol">→</a>
              <a id="2420" href="Armor.Data.X509.Semantic.Chain.Builder.html#2954" class="Function">∈weaken</a> <a id="2428" href="Armor.Data.X509.Semantic.Chain.Builder.html#2195" class="Bound">issuers</a> <a id="2436" class="Symbol">(</a><a id="2437" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="2440" href="Armor.Data.X509.Semantic.Chain.Builder.html#2375" class="Bound">cert</a><a id="2444" class="Symbol">)</a> <a id="2446" class="Symbol">(</a><a id="2447" href="Data.List.Relation.Unary.All.html#5766" class="Function">All.lookup</a> <a id="2458" href="Armor.Data.X509.Semantic.Chain.Builder.html#2204" class="Bound">isAllIssuersForIn</a> <a id="2476" href="Armor.Data.X509.Semantic.Chain.Builder.html#2388" class="Bound">c∈</a> <a id="2479" href="Armor.Data.X509.Semantic.Chain.Builder.html#2392" class="Bound">isIssuerFor</a><a id="2490" class="Symbol">))</a>
        <a id="2501" href="Armor.Data.X509.Semantic.Chain.Builder.html#2553" class="Function">issuers</a>
  <a id="2511" class="Keyword">where</a>
  <a id="2519" class="Keyword">import</a> <a id="2526" href="Data.Product.html" class="Module">Data.Product</a> <a id="2539" class="Symbol">as</a> <a id="2542" class="Module">Product</a>

  <a id="2553" href="Armor.Data.X509.Semantic.Chain.Builder.html#2553" class="Function">issuers</a> <a id="2561" class="Symbol">:</a> <a id="2563" href="Armor.Data.X509.Semantic.Chain.TCB.html#1786" class="Function Operator">AllIssuersFor</a> <a id="2577" href="Armor.Data.X509.Semantic.Chain.Builder.html#1637" class="Bound">issuee</a> <a id="2584" href="Armor.Data.X509.Semantic.Chain.TCB.html#1786" class="Function Operator">In</a> <a id="2587" href="Armor.Data.X509.Semantic.Chain.Builder.html#1660" class="Bound">certs</a>
  <a id="2595" href="Armor.Data.X509.Semantic.Chain.Builder.html#2553" class="Function">issuers</a> <a id="2603" class="Symbol">=</a> <a id="2605" href="Armor.Data.X509.Semantic.Chain.Builder.html#1473" class="Function">findIssuersFor</a> <a id="2620" href="Armor.Data.X509.Semantic.Chain.Builder.html#1637" class="Bound">issuee</a> <a id="2627" href="Armor.Data.X509.Semantic.Chain.Builder.html#1660" class="Bound">certs</a>

  <a id="2636" href="Armor.Data.X509.Semantic.Chain.Builder.html#2636" class="Function">weaken₁</a> <a id="2644" class="Symbol">:</a> <a id="2646" href="Armor.Data.X509.Semantic.Chain.TCB.html#808" class="Function Operator">IssuerFor</a> <a id="2656" href="Armor.Data.X509.Semantic.Chain.Builder.html#1637" class="Bound">issuee</a> <a id="2663" href="Armor.Data.X509.Semantic.Chain.TCB.html#808" class="Function Operator">In</a> <a id="2666" href="Armor.Data.X509.Semantic.Chain.Builder.html#1660" class="Bound">certs</a> <a id="2672" class="Symbol">→</a> <a id="2674" href="Armor.Data.X509.Semantic.Chain.TCB.html#808" class="Function Operator">IssuerFor</a> <a id="2684" href="Armor.Data.X509.Semantic.Chain.Builder.html#1637" class="Bound">issuee</a> <a id="2691" href="Armor.Data.X509.Semantic.Chain.TCB.html#808" class="Function Operator">In</a> <a id="2694" class="Symbol">((</a><a id="2696" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="2699" href="Armor.Data.X509.Semantic.Chain.Builder.html#1652" class="Bound">cert</a><a id="2703" class="Symbol">)</a> <a id="2705" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2707" href="Armor.Data.X509.Semantic.Chain.Builder.html#1660" class="Bound">certs</a><a id="2712" class="Symbol">)</a>
  <a id="2716" href="Armor.Data.X509.Semantic.Chain.Builder.html#2636" class="Function">weaken₁</a> <a id="2724" class="Symbol">=</a> <a id="2726" class="Symbol">(λ</a> <a id="2729" class="Keyword">where</a> <a id="2735" class="Symbol">(</a><a id="2736" href="Armor.Data.X509.Semantic.Chain.TCB.html#1150" class="InductiveConstructor">anIssuerForIn</a> <a id="2750" href="Armor.Data.X509.Semantic.Chain.Builder.html#2750" class="Bound">issuer</a> <a id="2757" href="Armor.Data.X509.Semantic.Chain.Builder.html#2757" class="Bound">isIssuerFor</a> <a id="2769" href="Armor.Data.X509.Semantic.Chain.Builder.html#2769" class="Bound">issuer∈</a><a id="2776" class="Symbol">)</a> <a id="2778" class="Symbol">→</a> <a id="2780" href="Armor.Data.X509.Semantic.Chain.TCB.html#1150" class="InductiveConstructor">anIssuerForIn</a> <a id="2794" href="Armor.Data.X509.Semantic.Chain.Builder.html#2750" class="Bound">issuer</a> <a id="2801" href="Armor.Data.X509.Semantic.Chain.Builder.html#2757" class="Bound">isIssuerFor</a> <a id="2813" class="Symbol">(</a><a id="2814" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a> <a id="2820" href="Armor.Data.X509.Semantic.Chain.Builder.html#2769" class="Bound">issuer∈</a><a id="2827" class="Symbol">))</a>

  <a id="2833" href="Armor.Data.X509.Semantic.Chain.Builder.html#2833" class="Function">weaken</a> <a id="2840" class="Symbol">:</a> <a id="2842" href="Armor.Data.X509.Semantic.Chain.TCB.html#984" class="Function Operator">IssuersFor</a> <a id="2853" href="Armor.Data.X509.Semantic.Chain.Builder.html#1637" class="Bound">issuee</a> <a id="2860" href="Armor.Data.X509.Semantic.Chain.TCB.html#984" class="Function Operator">In</a> <a id="2863" href="Armor.Data.X509.Semantic.Chain.Builder.html#1660" class="Bound">certs</a> <a id="2869" class="Symbol">→</a> <a id="2871" href="Armor.Data.X509.Semantic.Chain.TCB.html#984" class="Function Operator">IssuersFor</a> <a id="2882" href="Armor.Data.X509.Semantic.Chain.Builder.html#1637" class="Bound">issuee</a> <a id="2889" href="Armor.Data.X509.Semantic.Chain.TCB.html#984" class="Function Operator">In</a> <a id="2892" class="Symbol">((</a><a id="2894" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="2897" href="Armor.Data.X509.Semantic.Chain.Builder.html#1652" class="Bound">cert</a><a id="2901" class="Symbol">)</a> <a id="2903" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2905" href="Armor.Data.X509.Semantic.Chain.Builder.html#1660" class="Bound">certs</a><a id="2910" class="Symbol">)</a>
  <a id="2914" href="Armor.Data.X509.Semantic.Chain.Builder.html#2833" class="Function">weaken</a> <a id="2921" href="Armor.Data.X509.Semantic.Chain.Builder.html#2921" class="Bound">issuers</a> <a id="2929" class="Symbol">=</a> <a id="2931" href="Data.List.Base.html#1544" class="Function">map</a> <a id="2935" href="Armor.Data.X509.Semantic.Chain.Builder.html#2636" class="Function">weaken₁</a> <a id="2943" href="Armor.Data.X509.Semantic.Chain.Builder.html#2921" class="Bound">issuers</a>

  <a id="2954" href="Armor.Data.X509.Semantic.Chain.Builder.html#2954" class="Function">∈weaken</a> <a id="2962" class="Symbol">:</a> <a id="2964" class="Symbol">(</a><a id="2965" href="Armor.Data.X509.Semantic.Chain.Builder.html#2965" class="Bound">issuers</a> <a id="2973" class="Symbol">:</a> <a id="2975" href="Armor.Data.X509.Semantic.Chain.TCB.html#984" class="Function Operator">IssuersFor</a> <a id="2986" href="Armor.Data.X509.Semantic.Chain.Builder.html#1637" class="Bound">issuee</a> <a id="2993" href="Armor.Data.X509.Semantic.Chain.TCB.html#984" class="Function Operator">In</a> <a id="2996" href="Armor.Data.X509.Semantic.Chain.Builder.html#1660" class="Bound">certs</a><a id="3001" class="Symbol">)</a> <a id="3003" class="Symbol">→</a> <a id="3005" class="Symbol">(</a><a id="3006" href="Armor.Data.X509.Semantic.Chain.Builder.html#3006" class="Bound">c</a> <a id="3008" class="Symbol">:</a> <a id="3010" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="3018" class="Symbol">_</a> <a id="3020" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="3024" class="Symbol">)</a> <a id="3026" class="Symbol">→</a> <a id="3028" href="Armor.Data.X509.Semantic.Chain.Builder.html#3006" class="Bound">c</a> <a id="3030" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="3032" href="Data.List.Base.html#1544" class="Function">map</a> <a id="3036" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="3042" href="Armor.Data.X509.Semantic.Chain.Builder.html#2965" class="Bound">issuers</a> <a id="3050" class="Symbol">→</a> <a id="3052" href="Armor.Data.X509.Semantic.Chain.Builder.html#3006" class="Bound">c</a> <a id="3054" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="3056" href="Data.List.Base.html#1544" class="Function">map</a> <a id="3060" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="3066" class="Symbol">(</a><a id="3067" href="Armor.Data.X509.Semantic.Chain.Builder.html#2833" class="Function">weaken</a> <a id="3074" href="Armor.Data.X509.Semantic.Chain.Builder.html#2965" class="Bound">issuers</a><a id="3081" class="Symbol">)</a>
  <a id="3085" href="Armor.Data.X509.Semantic.Chain.Builder.html#2954" class="Function">∈weaken</a> <a id="3093" href="Armor.Data.X509.Semantic.Chain.Builder.html#3093" class="Bound">issuers</a> <a id="3101" class="Symbol">(</a><a id="3102" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="3104" class="Symbol">_</a> <a id="3106" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3108" href="Armor.Data.X509.Semantic.Chain.Builder.html#3108" class="Bound">c</a><a id="3109" class="Symbol">)</a> <a id="3111" href="Armor.Data.X509.Semantic.Chain.Builder.html#3111" class="Bound">c∈issuers</a> <a id="3121" class="Symbol">=</a> <a id="3123" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">subst</a> <a id="3129" class="Symbol">(</a><a id="3130" href="Data.List.Membership.Setoid.html#887" class="Function Operator">_∈</a> <a id="3133" href="Data.List.Base.html#1544" class="Function">map</a> <a id="3137" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="3143" class="Symbol">(</a><a id="3144" href="Armor.Data.X509.Semantic.Chain.Builder.html#2833" class="Function">weaken</a> <a id="3151" href="Armor.Data.X509.Semantic.Chain.Builder.html#3093" class="Bound">issuers</a><a id="3158" class="Symbol">))</a> <a id="3161" href="Armor.Data.X509.Semantic.Chain.Builder.html#3405" class="Function">c≡</a> <a id="3164" href="Armor.Data.X509.Semantic.Chain.Builder.html#3269" class="Function">c∈</a>
    <a id="3171" class="Keyword">where</a>
    <a id="3181" href="Armor.Data.X509.Semantic.Chain.Builder.html#3181" class="Function">lem</a> <a id="3185" class="Symbol">:</a> <a id="3187" href="Data.Product.html#1369" class="Function">∃</a> <a id="3189" class="Symbol">λ</a> <a id="3191" href="Armor.Data.X509.Semantic.Chain.Builder.html#3191" class="Bound">x</a> <a id="3193" class="Symbol">→</a> <a id="3195" href="Armor.Data.X509.Semantic.Chain.Builder.html#3191" class="Bound">x</a> <a id="3197" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="3199" href="Armor.Data.X509.Semantic.Chain.Builder.html#3093" class="Bound">issuers</a> <a id="3207" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="3209" class="Symbol">(</a><a id="3210" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="3213" href="Armor.Data.X509.Semantic.Chain.Builder.html#3108" class="Bound">c</a><a id="3214" class="Symbol">)</a> <a id="3216" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3218" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="3224" href="Armor.Data.X509.Semantic.Chain.Builder.html#3191" class="Bound">x</a>
    <a id="3230" href="Armor.Data.X509.Semantic.Chain.Builder.html#3181" class="Function">lem</a> <a id="3234" class="Symbol">=</a> <a id="3236" href="Data.List.Membership.Propositional.Properties.html#3482" class="Function">List.∈-map⁻</a> <a id="3248" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="3254" href="Armor.Data.X509.Semantic.Chain.Builder.html#3111" class="Bound">c∈issuers</a>

    <a id="3269" href="Armor.Data.X509.Semantic.Chain.Builder.html#3269" class="Function">c∈</a> <a id="3272" class="Symbol">:</a> <a id="3274" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="3280" class="Symbol">(</a><a id="3281" href="Armor.Data.X509.Semantic.Chain.Builder.html#2636" class="Function">weaken₁</a> <a id="3289" class="Symbol">(</a><a id="3290" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="3296" href="Armor.Data.X509.Semantic.Chain.Builder.html#3181" class="Function">lem</a><a id="3299" class="Symbol">))</a> <a id="3302" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="3304" href="Data.List.Base.html#1544" class="Function">map</a> <a id="3308" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="3314" class="Symbol">(</a><a id="3315" href="Armor.Data.X509.Semantic.Chain.Builder.html#2833" class="Function">weaken</a> <a id="3322" href="Armor.Data.X509.Semantic.Chain.Builder.html#3093" class="Bound">issuers</a><a id="3329" class="Symbol">)</a>
    <a id="3335" href="Armor.Data.X509.Semantic.Chain.Builder.html#3269" class="Function">c∈</a> <a id="3338" class="Symbol">=</a> <a id="3340" href="Data.List.Membership.Propositional.Properties.html#3368" class="Function">List.∈-map⁺</a> <a id="3352" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="3358" class="Symbol">(</a><a id="3359" href="Data.List.Membership.Propositional.Properties.html#3368" class="Function">List.∈-map⁺</a> <a id="3371" href="Armor.Data.X509.Semantic.Chain.Builder.html#2636" class="Function">weaken₁</a> <a id="3379" class="Symbol">(</a><a id="3380" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="3386" class="Symbol">(</a><a id="3387" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="3393" href="Armor.Data.X509.Semantic.Chain.Builder.html#3181" class="Function">lem</a><a id="3396" class="Symbol">)))</a>

    <a id="3405" href="Armor.Data.X509.Semantic.Chain.Builder.html#3405" class="Function">c≡</a> <a id="3408" class="Symbol">:</a> <a id="3410" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="3416" class="Symbol">(</a><a id="3417" href="Armor.Data.X509.Semantic.Chain.Builder.html#2636" class="Function">weaken₁</a> <a id="3425" class="Symbol">(</a><a id="3426" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="3432" href="Armor.Data.X509.Semantic.Chain.Builder.html#3181" class="Function">lem</a><a id="3435" class="Symbol">))</a> <a id="3438" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3440" class="Symbol">(</a><a id="3441" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="3444" href="Armor.Data.X509.Semantic.Chain.Builder.html#3108" class="Bound">c</a><a id="3445" class="Symbol">)</a>
    <a id="3451" href="Armor.Data.X509.Semantic.Chain.Builder.html#3405" class="Function">c≡</a> <a id="3454" class="Symbol">=</a> <a id="3456" href="Armor.Prelude.html#3493" class="Function Operator">case</a> <a id="3461" href="Armor.Data.X509.Semantic.Chain.Builder.html#3181" class="Function">lem</a> <a id="3465" href="Armor.Prelude.html#3493" class="Function Operator">ret</a> <a id="3469" class="Symbol">(λ</a> <a id="3472" href="Armor.Data.X509.Semantic.Chain.Builder.html#3472" class="Bound">x</a> <a id="3474" class="Symbol">→</a> <a id="3476" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="3482" class="Symbol">(</a><a id="3483" href="Armor.Data.X509.Semantic.Chain.Builder.html#2636" class="Function">weaken₁</a> <a id="3491" class="Symbol">(</a><a id="3492" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="3498" href="Armor.Data.X509.Semantic.Chain.Builder.html#3472" class="Bound">x</a><a id="3499" class="Symbol">))</a> <a id="3502" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="3504" class="Symbol">(</a><a id="3505" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="3508" href="Armor.Data.X509.Semantic.Chain.Builder.html#3108" class="Bound">c</a><a id="3509" class="Symbol">))</a> <a id="3512" href="Armor.Prelude.html#3493" class="Function Operator">of</a> <a id="3515" class="Symbol">λ</a> <a id="3517" class="Keyword">where</a>
      <a id="3529" class="Symbol">(</a><a id="3530" href="Armor.Data.X509.Semantic.Chain.TCB.html#1150" class="InductiveConstructor">anIssuerForIn</a> <a id="3544" class="Symbol">_</a> <a id="3546" class="Symbol">_</a> <a id="3548" class="Symbol">_</a> <a id="3550" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3552" class="Symbol">(_</a> <a id="3555" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3557" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="3561" class="Symbol">))</a> <a id="3564" class="Symbol">→</a> <a id="3566" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>

<a id="buildTrustTreeWF"></a><a id="3572" href="Armor.Data.X509.Semantic.Chain.Builder.html#3572" class="Function">buildTrustTreeWF</a> <a id="3589" class="Symbol">:</a> <a id="3591" class="Symbol">(</a><a id="3592" href="Armor.Data.X509.Semantic.Chain.Builder.html#3592" class="Bound">trustedRoot</a> <a id="3604" href="Armor.Data.X509.Semantic.Chain.Builder.html#3604" class="Bound">candidates</a> <a id="3615" class="Symbol">:</a> <a id="3617" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3622" class="Symbol">(</a><a id="3623" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="3631" class="Symbol">_</a> <a id="3633" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="3637" class="Symbol">))</a> <a id="3640" class="Symbol">→</a> <a id="3642" class="Symbol">@</a><a id="3643" class="Symbol">0</a> <a id="3645" href="Armor.Prelude.html#3779" class="Function">Acc</a> <a id="3649" href="Data.Nat.Base.html#1645" class="Function Operator">_&lt;_</a> <a id="3653" class="Symbol">(</a><a id="3654" href="Data.List.Base.html#4864" class="Function">length</a> <a id="3661" href="Armor.Data.X509.Semantic.Chain.Builder.html#3604" class="Bound">candidates</a><a id="3671" class="Symbol">)</a>
               <a id="3688" class="Symbol">→</a> <a id="3690" class="Symbol">∀</a> <a id="3692" class="Symbol">{@</a><a id="3694" class="Symbol">0</a> <a id="3696" href="Armor.Data.X509.Semantic.Chain.Builder.html#3696" class="Bound">bs</a><a id="3698" class="Symbol">}</a> <a id="3700" class="Symbol">→</a> <a id="3702" class="Symbol">(</a><a id="3703" href="Armor.Data.X509.Semantic.Chain.Builder.html#3703" class="Bound">issuee</a> <a id="3710" class="Symbol">:</a> <a id="3712" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="3717" href="Armor.Data.X509.Semantic.Chain.Builder.html#3696" class="Bound">bs</a><a id="3719" class="Symbol">)</a> <a id="3721" class="Symbol">→</a> <a id="3723" href="Armor.Data.X509.Semantic.Chain.Builder.html#683" class="Record">TrustTree</a> <a id="3733" href="Armor.Data.X509.Semantic.Chain.Builder.html#3592" class="Bound">trustedRoot</a> <a id="3745" href="Armor.Data.X509.Semantic.Chain.Builder.html#3604" class="Bound">candidates</a> <a id="3756" href="Armor.Data.X509.Semantic.Chain.Builder.html#3703" class="Bound">issuee</a>
<a id="3763" href="Armor.Data.X509.Semantic.Chain.Builder.html#3572" class="Function">buildTrustTreeWF</a> <a id="3780" href="Armor.Data.X509.Semantic.Chain.Builder.html#3780" class="Bound">trustedRoot</a> <a id="3792" href="Armor.Data.X509.Semantic.Chain.Builder.html#3792" class="Bound">candidates</a> <a id="3803" class="Symbol">(</a><a id="3804" href="Induction.WellFounded.html#1062" class="InductiveConstructor">WellFounded.acc</a> <a id="3820" href="Armor.Data.X509.Semantic.Chain.Builder.html#3820" class="Bound">rs</a><a id="3822" class="Symbol">)</a> <a id="3824" class="Symbol">{</a><a id="3825" href="Armor.Data.X509.Semantic.Chain.Builder.html#3825" class="Bound">bs</a><a id="3827" class="Symbol">}</a> <a id="3829" href="Armor.Data.X509.Semantic.Chain.Builder.html#3829" class="Bound">issuee</a> <a id="3836" class="Symbol">=</a>
  <a id="3840" href="Armor.Data.X509.Semantic.Chain.Builder.html#1250" class="InductiveConstructor">mkTrustTree</a> <a id="3852" href="Armor.Data.X509.Semantic.Chain.Builder.html#3965" class="Function">rootIssuers</a> <a id="3864" href="Armor.Data.X509.Semantic.Chain.Builder.html#4068" class="Function">otherIssuers</a> <a id="3877" class="Symbol">(</a><a id="3878" href="Data.List.Relation.Unary.All.html#3725" class="Function">All.tabulate</a> <a id="3891" href="Armor.Data.X509.Semantic.Chain.Builder.html#4171" class="Function">ih</a><a id="3893" class="Symbol">)</a>
<a id="3895" class="Comment">--   mkTrustTree rootIssuers otherIssuers (All.tabulate ih)</a>
  <a id="3957" class="Keyword">where</a>
  <a id="3965" href="Armor.Data.X509.Semantic.Chain.Builder.html#3965" class="Function">rootIssuers</a> <a id="3977" class="Symbol">:</a> <a id="3979" href="Armor.Data.X509.Semantic.Chain.TCB.html#1786" class="Function Operator">AllIssuersFor</a> <a id="3993" href="Armor.Data.X509.Semantic.Chain.Builder.html#3829" class="Bound">issuee</a> <a id="4000" href="Armor.Data.X509.Semantic.Chain.TCB.html#1786" class="Function Operator">In</a> <a id="4003" href="Armor.Data.X509.Semantic.Chain.Builder.html#3780" class="Bound">trustedRoot</a>
  <a id="4017" href="Armor.Data.X509.Semantic.Chain.Builder.html#3965" class="Function">rootIssuers</a> <a id="4029" class="Symbol">=</a> <a id="4031" href="Armor.Data.X509.Semantic.Chain.Builder.html#1473" class="Function">findIssuersFor</a> <a id="4046" href="Armor.Data.X509.Semantic.Chain.Builder.html#3829" class="Bound">issuee</a> <a id="4053" href="Armor.Data.X509.Semantic.Chain.Builder.html#3780" class="Bound">trustedRoot</a>

  <a id="4068" href="Armor.Data.X509.Semantic.Chain.Builder.html#4068" class="Function">otherIssuers</a> <a id="4081" class="Symbol">:</a> <a id="4083" href="Armor.Data.X509.Semantic.Chain.TCB.html#1786" class="Function Operator">AllIssuersFor</a> <a id="4097" href="Armor.Data.X509.Semantic.Chain.Builder.html#3829" class="Bound">issuee</a> <a id="4104" href="Armor.Data.X509.Semantic.Chain.TCB.html#1786" class="Function Operator">In</a> <a id="4107" href="Armor.Data.X509.Semantic.Chain.Builder.html#3792" class="Bound">candidates</a>
  <a id="4120" href="Armor.Data.X509.Semantic.Chain.Builder.html#4068" class="Function">otherIssuers</a> <a id="4133" class="Symbol">=</a> <a id="4135" href="Armor.Data.X509.Semantic.Chain.Builder.html#1473" class="Function">findIssuersFor</a> <a id="4150" href="Armor.Data.X509.Semantic.Chain.Builder.html#3829" class="Bound">issuee</a> <a id="4157" href="Armor.Data.X509.Semantic.Chain.Builder.html#3792" class="Bound">candidates</a>

  <a id="4171" href="Armor.Data.X509.Semantic.Chain.Builder.html#4171" class="Function">ih</a> <a id="4174" class="Symbol">:</a> <a id="4176" class="Symbol">{</a><a id="4177" href="Armor.Data.X509.Semantic.Chain.Builder.html#4177" class="Bound">iss</a> <a id="4181" class="Symbol">:</a> <a id="4183" href="Armor.Data.X509.Semantic.Chain.TCB.html#808" class="Function Operator">IssuerFor</a> <a id="4193" href="Armor.Data.X509.Semantic.Chain.Builder.html#3829" class="Bound">issuee</a> <a id="4200" href="Armor.Data.X509.Semantic.Chain.TCB.html#808" class="Function Operator">In</a> <a id="4203" href="Armor.Data.X509.Semantic.Chain.Builder.html#3792" class="Bound">candidates</a><a id="4213" class="Symbol">}</a> <a id="4215" class="Symbol">→</a> <a id="4217" href="Armor.Data.X509.Semantic.Chain.Builder.html#4177" class="Bound">iss</a> <a id="4221" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="4223" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="4229" href="Armor.Data.X509.Semantic.Chain.Builder.html#4068" class="Function">otherIssuers</a>
       <a id="4249" class="Symbol">→</a> <a id="4251" href="Armor.Data.X509.Semantic.Chain.Builder.html#566" class="Function">TrustTreeBranchF</a> <a id="4268" href="Armor.Data.X509.Semantic.Chain.Builder.html#3780" class="Bound">trustedRoot</a> <a id="4280" href="Armor.Data.X509.Semantic.Chain.Builder.html#3792" class="Bound">candidates</a> <a id="4291" href="Armor.Data.X509.Semantic.Chain.Builder.html#3829" class="Bound">issuee</a> <a id="4298" href="Armor.Data.X509.Semantic.Chain.Builder.html#4177" class="Bound">iss</a>
  <a id="4304" href="Armor.Data.X509.Semantic.Chain.Builder.html#4171" class="Function">ih</a><a id="4306" class="Symbol">{</a><a id="4307" href="Armor.Data.X509.Semantic.Chain.TCB.html#1150" class="InductiveConstructor">anIssuerForIn</a> <a id="4321" href="Armor.Data.X509.Semantic.Chain.Builder.html#4321" class="Bound">issuer</a> <a id="4328" href="Armor.Data.X509.Semantic.Chain.Builder.html#4328" class="Bound">isIssuerFor</a> <a id="4340" href="Armor.Data.X509.Semantic.Chain.Builder.html#4340" class="Bound">issuer∈candidates</a><a id="4357" class="Symbol">}</a> <a id="4359" href="Armor.Data.X509.Semantic.Chain.Builder.html#4359" class="Bound">∈otherIssuers</a> <a id="4373" class="Symbol">=</a>
    <a id="4379" href="Armor.Data.X509.Semantic.Chain.Builder.html#3572" class="Function">buildTrustTreeWF</a> <a id="4396" class="Symbol">(</a><a id="4397" href="Armor.Data.X509.Semantic.Chain.TCB.html#4086" class="Function">removeCertFromCerts</a> <a id="4417" href="Armor.Data.X509.Semantic.Chain.Builder.html#4321" class="Bound">issuer</a> <a id="4424" href="Armor.Data.X509.Semantic.Chain.Builder.html#3780" class="Bound">trustedRoot</a><a id="4435" class="Symbol">)</a> <a id="4437" class="Symbol">(</a><a id="4438" href="Armor.Data.X509.Semantic.Chain.TCB.html#4086" class="Function">removeCertFromCerts</a> <a id="4458" href="Armor.Data.X509.Semantic.Chain.Builder.html#4321" class="Bound">issuer</a> <a id="4465" href="Armor.Data.X509.Semantic.Chain.Builder.html#3792" class="Bound">candidates</a><a id="4475" class="Symbol">)</a>
      <a id="4483" class="Symbol">(</a><a id="4484" href="Armor.Data.X509.Semantic.Chain.Builder.html#3820" class="Bound">rs</a> <a id="4487" class="Symbol">_</a> <a id="4489" class="Symbol">(</a><a id="4490" href="Armor.Data.X509.Semantic.Chain.TCB.html#4930" class="Function">removeCertFromCerts&lt;</a> <a id="4511" href="Armor.Data.X509.Semantic.Chain.Builder.html#4321" class="Bound">issuer</a> <a id="4518" href="Armor.Data.X509.Semantic.Chain.Builder.html#3792" class="Bound">candidates</a> <a id="4529" href="Armor.Data.X509.Semantic.Chain.Builder.html#4340" class="Bound">issuer∈candidates</a><a id="4546" class="Symbol">))</a>
      <a id="4555" href="Armor.Data.X509.Semantic.Chain.Builder.html#4321" class="Bound">issuer</a>

<a id="buildTrustTree"></a><a id="4563" href="Armor.Data.X509.Semantic.Chain.Builder.html#4563" class="Function">buildTrustTree</a> <a id="4578" class="Symbol">:</a> <a id="4580" class="Symbol">(</a><a id="4581" href="Armor.Data.X509.Semantic.Chain.Builder.html#4581" class="Bound">trustedRoot</a> <a id="4593" href="Armor.Data.X509.Semantic.Chain.Builder.html#4593" class="Bound">candidates</a> <a id="4604" class="Symbol">:</a> <a id="4606" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4611" class="Symbol">(</a><a id="4612" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="4620" class="Symbol">_</a> <a id="4622" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="4626" class="Symbol">))</a>
                 <a id="4646" class="Symbol">→</a> <a id="4648" class="Symbol">∀</a> <a id="4650" class="Symbol">{@</a><a id="4652" class="Symbol">0</a> <a id="4654" href="Armor.Data.X509.Semantic.Chain.Builder.html#4654" class="Bound">bs</a><a id="4656" class="Symbol">}</a> <a id="4658" class="Symbol">→</a> <a id="4660" class="Symbol">(</a><a id="4661" href="Armor.Data.X509.Semantic.Chain.Builder.html#4661" class="Bound">issuee</a> <a id="4668" class="Symbol">:</a> <a id="4670" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="4675" href="Armor.Data.X509.Semantic.Chain.Builder.html#4654" class="Bound">bs</a><a id="4677" class="Symbol">)</a> <a id="4679" class="Symbol">→</a> <a id="4681" href="Armor.Data.X509.Semantic.Chain.Builder.html#683" class="Record">TrustTree</a> <a id="4691" href="Armor.Data.X509.Semantic.Chain.Builder.html#4581" class="Bound">trustedRoot</a> <a id="4703" href="Armor.Data.X509.Semantic.Chain.Builder.html#4593" class="Bound">candidates</a> <a id="4714" href="Armor.Data.X509.Semantic.Chain.Builder.html#4661" class="Bound">issuee</a>
<a id="4721" href="Armor.Data.X509.Semantic.Chain.Builder.html#4563" class="Function">buildTrustTree</a> <a id="4736" href="Armor.Data.X509.Semantic.Chain.Builder.html#4736" class="Bound">trustedRoot</a> <a id="4748" href="Armor.Data.X509.Semantic.Chain.Builder.html#4748" class="Bound">candidates</a> <a id="4759" class="Symbol">=</a> <a id="4761" href="Armor.Data.X509.Semantic.Chain.Builder.html#3572" class="Function">buildTrustTreeWF</a> <a id="4778" href="Armor.Data.X509.Semantic.Chain.Builder.html#4736" class="Bound">trustedRoot</a> <a id="4790" href="Armor.Data.X509.Semantic.Chain.Builder.html#4748" class="Bound">candidates</a> <a id="4801" class="Symbol">(</a><a id="4802" href="Data.Nat.Induction.html#2302" class="Function">&lt;-wellFounded</a> <a id="4816" class="Symbol">_)</a>
  <a id="4821" class="Keyword">where</a>
  <a id="4829" class="Keyword">open</a> <a id="4834" class="Keyword">import</a> <a id="4841" href="Data.Nat.Induction.html" class="Module">Data.Nat.Induction</a>

<a id="toChainsBranchWF"></a><a id="4861" href="Armor.Data.X509.Semantic.Chain.Builder.html#4861" class="Function">toChainsBranchWF</a>
  <a id="4880" class="Symbol">:</a> <a id="4882" class="Symbol">∀</a> <a id="4884" class="Symbol">(</a><a id="4885" href="Armor.Data.X509.Semantic.Chain.Builder.html#4885" class="Bound">trustedRoot</a> <a id="4897" href="Armor.Data.X509.Semantic.Chain.Builder.html#4897" class="Bound">candidates</a> <a id="4908" class="Symbol">:</a> <a id="4910" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4915" class="Symbol">(</a><a id="4916" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="4924" class="Symbol">_</a> <a id="4926" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="4930" class="Symbol">))</a> <a id="4933" class="Symbol">{@</a><a id="4935" class="Symbol">0</a> <a id="4937" href="Armor.Data.X509.Semantic.Chain.Builder.html#4937" class="Bound">bs</a><a id="4939" class="Symbol">}</a> <a id="4941" class="Symbol">(</a><a id="4942" href="Armor.Data.X509.Semantic.Chain.Builder.html#4942" class="Bound">endEnt</a> <a id="4949" class="Symbol">:</a> <a id="4951" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="4956" href="Armor.Data.X509.Semantic.Chain.Builder.html#4937" class="Bound">bs</a><a id="4958" class="Symbol">)</a>
    <a id="4964" class="Symbol">→</a> <a id="4966" class="Symbol">@</a><a id="4967" class="Symbol">0</a> <a id="4969" href="Armor.Prelude.html#3779" class="Function">Acc</a> <a id="4973" href="Data.Nat.Base.html#1645" class="Function Operator">_&lt;_</a> <a id="4977" class="Symbol">(</a><a id="4978" href="Data.List.Base.html#4864" class="Function">length</a> <a id="4985" href="Armor.Data.X509.Semantic.Chain.Builder.html#4897" class="Bound">candidates</a><a id="4995" class="Symbol">)</a>
    <a id="5001" class="Symbol">→</a> <a id="5003" href="Data.Product.html#1369" class="Function">∃</a> <a id="5005" class="Symbol">(</a><a id="5006" href="Armor.Data.X509.Semantic.Chain.Builder.html#566" class="Function">TrustTreeBranchF</a> <a id="5023" href="Armor.Data.X509.Semantic.Chain.Builder.html#4885" class="Bound">trustedRoot</a> <a id="5035" href="Armor.Data.X509.Semantic.Chain.Builder.html#4897" class="Bound">candidates</a> <a id="5046" href="Armor.Data.X509.Semantic.Chain.Builder.html#4942" class="Bound">endEnt</a><a id="5052" class="Symbol">)</a> <a id="5054" class="Symbol">→</a> <a id="5056" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5061" class="Symbol">(</a><a id="5062" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="5068" href="Armor.Data.X509.Semantic.Chain.Builder.html#4885" class="Bound">trustedRoot</a> <a id="5080" href="Armor.Data.X509.Semantic.Chain.Builder.html#4897" class="Bound">candidates</a> <a id="5091" href="Armor.Data.X509.Semantic.Chain.Builder.html#4942" class="Bound">endEnt</a><a id="5097" class="Symbol">)</a>

<a id="toChainsWF"></a><a id="5100" href="Armor.Data.X509.Semantic.Chain.Builder.html#5100" class="Function">toChainsWF</a> <a id="5111" class="Symbol">:</a> <a id="5113" class="Symbol">∀</a> <a id="5115" class="Symbol">(</a><a id="5116" href="Armor.Data.X509.Semantic.Chain.Builder.html#5116" class="Bound">trustedRoot</a> <a id="5128" href="Armor.Data.X509.Semantic.Chain.Builder.html#5128" class="Bound">candidates</a> <a id="5139" class="Symbol">:</a> <a id="5141" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5146" class="Symbol">(</a><a id="5147" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="5155" class="Symbol">_</a> <a id="5157" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="5161" class="Symbol">))</a> <a id="5164" class="Symbol">{@</a><a id="5166" class="Symbol">0</a> <a id="5168" href="Armor.Data.X509.Semantic.Chain.Builder.html#5168" class="Bound">bs</a><a id="5170" class="Symbol">}</a> <a id="5172" class="Symbol">(</a><a id="5173" href="Armor.Data.X509.Semantic.Chain.Builder.html#5173" class="Bound">endEnt</a> <a id="5180" class="Symbol">:</a> <a id="5182" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="5187" href="Armor.Data.X509.Semantic.Chain.Builder.html#5168" class="Bound">bs</a><a id="5189" class="Symbol">)</a>
             <a id="5204" class="Symbol">→</a> <a id="5206" class="Symbol">@</a><a id="5207" class="Symbol">0</a> <a id="5209" href="Armor.Prelude.html#3779" class="Function">Acc</a> <a id="5213" href="Data.Nat.Base.html#1645" class="Function Operator">_&lt;_</a> <a id="5217" class="Symbol">(</a><a id="5218" href="Data.List.Base.html#4864" class="Function">length</a> <a id="5225" href="Armor.Data.X509.Semantic.Chain.Builder.html#5128" class="Bound">candidates</a><a id="5235" class="Symbol">)</a>
             <a id="5250" class="Symbol">→</a> <a id="5252" href="Armor.Data.X509.Semantic.Chain.Builder.html#683" class="Record">TrustTree</a> <a id="5262" href="Armor.Data.X509.Semantic.Chain.Builder.html#5116" class="Bound">trustedRoot</a> <a id="5274" href="Armor.Data.X509.Semantic.Chain.Builder.html#5128" class="Bound">candidates</a> <a id="5285" href="Armor.Data.X509.Semantic.Chain.Builder.html#5173" class="Bound">endEnt</a>
             <a id="5305" class="Symbol">→</a> <a id="5307" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5312" class="Symbol">(</a><a id="5313" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="5319" href="Armor.Data.X509.Semantic.Chain.Builder.html#5116" class="Bound">trustedRoot</a> <a id="5331" href="Armor.Data.X509.Semantic.Chain.Builder.html#5128" class="Bound">candidates</a> <a id="5342" href="Armor.Data.X509.Semantic.Chain.Builder.html#5173" class="Bound">endEnt</a><a id="5348" class="Symbol">)</a>

<a id="5351" href="Armor.Data.X509.Semantic.Chain.Builder.html#4861" class="Function">toChainsBranchWF</a> <a id="5368" href="Armor.Data.X509.Semantic.Chain.Builder.html#5368" class="Bound">trustedRoot</a> <a id="5380" href="Armor.Data.X509.Semantic.Chain.Builder.html#5380" class="Bound">candidates</a> <a id="5391" href="Armor.Data.X509.Semantic.Chain.Builder.html#5391" class="Bound">endEnt</a> <a id="5398" class="Symbol">(</a><a id="5399" href="Induction.WellFounded.html#1062" class="InductiveConstructor">WellFounded.acc</a> <a id="5415" href="Armor.Data.X509.Semantic.Chain.Builder.html#5415" class="Bound">rs</a><a id="5417" class="Symbol">)</a> <a id="5419" class="Symbol">(</a><a id="5420" href="Armor.Data.X509.Semantic.Chain.TCB.html#1150" class="InductiveConstructor">anIssuerForIn</a> <a id="5434" href="Armor.Data.X509.Semantic.Chain.Builder.html#5434" class="Bound">issuer</a> <a id="5441" href="Armor.Data.X509.Semantic.Chain.Builder.html#5441" class="Bound">isIssuerFor</a> <a id="5453" href="Armor.Data.X509.Semantic.Chain.Builder.html#5453" class="Bound">issuer∈</a> <a id="5461" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5463" href="Armor.Data.X509.Semantic.Chain.Builder.html#5463" class="Bound">tr</a><a id="5465" class="Symbol">)</a> <a id="5467" class="Symbol">=</a>
  <a id="5471" href="Data.List.Base.html#1544" class="Function">map</a> <a id="5475" class="Symbol">(</a><a id="5476" href="Armor.Data.X509.Semantic.Chain.TCB.html#5383" class="InductiveConstructor">link</a> <a id="5481" href="Armor.Data.X509.Semantic.Chain.Builder.html#5434" class="Bound">issuer</a> <a id="5488" class="Symbol">(</a><a id="5489" href="Armor.Data.X509.Semantic.Chain.Builder.html#5441" class="Bound">isIssuerFor</a> <a id="5501" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="5503" href="Armor.Data.X509.Semantic.Chain.Builder.html#5453" class="Bound">issuer∈</a><a id="5510" class="Symbol">))</a>
    <a id="5517" class="Symbol">(</a><a id="5518" href="Armor.Data.X509.Semantic.Chain.Builder.html#5100" class="Function">toChainsWF</a> <a id="5529" class="Symbol">(</a><a id="5530" href="Armor.Data.X509.Semantic.Chain.TCB.html#4086" class="Function">removeCertFromCerts</a> <a id="5550" href="Armor.Data.X509.Semantic.Chain.Builder.html#5434" class="Bound">issuer</a> <a id="5557" href="Armor.Data.X509.Semantic.Chain.Builder.html#5368" class="Bound">trustedRoot</a><a id="5568" class="Symbol">)</a> <a id="5570" class="Symbol">(</a><a id="5571" href="Armor.Data.X509.Semantic.Chain.TCB.html#4086" class="Function">removeCertFromCerts</a> <a id="5591" href="Armor.Data.X509.Semantic.Chain.Builder.html#5434" class="Bound">issuer</a> <a id="5598" href="Armor.Data.X509.Semantic.Chain.Builder.html#5380" class="Bound">candidates</a><a id="5608" class="Symbol">)</a>
      <a id="5616" href="Armor.Data.X509.Semantic.Chain.Builder.html#5434" class="Bound">issuer</a>
      <a id="5629" class="Symbol">(</a><a id="5630" href="Armor.Data.X509.Semantic.Chain.Builder.html#5415" class="Bound">rs</a> <a id="5633" class="Symbol">_</a> <a id="5635" class="Symbol">(</a><a id="5636" href="Armor.Data.X509.Semantic.Chain.TCB.html#4930" class="Function">removeCertFromCerts&lt;</a> <a id="5657" href="Armor.Data.X509.Semantic.Chain.Builder.html#5434" class="Bound">issuer</a> <a id="5664" href="Armor.Data.X509.Semantic.Chain.Builder.html#5380" class="Bound">candidates</a> <a id="5675" href="Armor.Data.X509.Semantic.Chain.Builder.html#5453" class="Bound">issuer∈</a><a id="5682" class="Symbol">))</a>
      <a id="5691" href="Armor.Data.X509.Semantic.Chain.Builder.html#5463" class="Bound">tr</a><a id="5693" class="Symbol">)</a>

<a id="5696" href="Armor.Data.X509.Semantic.Chain.Builder.html#5100" class="Function">toChainsWF</a> <a id="5707" href="Armor.Data.X509.Semantic.Chain.Builder.html#5707" class="Bound">trustedRoot</a> <a id="5719" href="Armor.Data.X509.Semantic.Chain.Builder.html#5719" class="Bound">candidates</a> <a id="5730" href="Armor.Data.X509.Semantic.Chain.Builder.html#5730" class="Bound">endEnt</a> <a id="5737" href="Armor.Data.X509.Semantic.Chain.Builder.html#5737" class="Bound">ac</a> <a id="5740" class="Symbol">(</a><a id="5741" href="Armor.Data.X509.Semantic.Chain.Builder.html#1250" class="InductiveConstructor">mkTrustTree</a> <a id="5753" href="Armor.Data.X509.Semantic.Chain.Builder.html#5753" class="Bound">rootIssuers</a> <a id="5765" href="Armor.Data.X509.Semantic.Chain.Builder.html#5765" class="Bound">otherIssuers</a> <a id="5778" href="Armor.Data.X509.Semantic.Chain.Builder.html#5778" class="Bound">otherTrust</a><a id="5788" class="Symbol">)</a> <a id="5790" class="Symbol">=</a>
     <a id="5797" href="Data.List.Base.html#1544" class="Function">map</a> <a id="5801" href="Armor.Data.X509.Semantic.Chain.TCB.html#5288" class="InductiveConstructor">root</a> <a id="5806" class="Symbol">(</a><a id="5807" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="5813" href="Armor.Data.X509.Semantic.Chain.Builder.html#5753" class="Bound">rootIssuers</a><a id="5824" class="Symbol">)</a>
  <a id="5828" href="Data.List.Base.html#1810" class="Function Operator">++</a> <a id="5831" href="Data.List.Base.html#4450" class="Function">concatMap</a> <a id="5841" class="Symbol">(</a><a id="5842" href="Armor.Data.X509.Semantic.Chain.Builder.html#4861" class="Function">toChainsBranchWF</a> <a id="5859" href="Armor.Data.X509.Semantic.Chain.Builder.html#5707" class="Bound">trustedRoot</a> <a id="5871" href="Armor.Data.X509.Semantic.Chain.Builder.html#5719" class="Bound">candidates</a> <a id="5882" href="Armor.Data.X509.Semantic.Chain.Builder.html#5730" class="Bound">endEnt</a> <a id="5889" href="Armor.Data.X509.Semantic.Chain.Builder.html#5737" class="Bound">ac</a><a id="5891" class="Symbol">)</a> <a id="5893" class="Symbol">(</a><a id="5894" href="Data.List.Relation.Unary.All.html#2859" class="Function">All.toList</a> <a id="5905" href="Armor.Data.X509.Semantic.Chain.Builder.html#5778" class="Bound">otherTrust</a><a id="5915" class="Symbol">)</a>

<a id="toChains"></a><a id="5918" href="Armor.Data.X509.Semantic.Chain.Builder.html#5918" class="Function">toChains</a> <a id="5927" class="Symbol">:</a> <a id="5929" class="Symbol">∀</a> <a id="5931" class="Symbol">(</a><a id="5932" href="Armor.Data.X509.Semantic.Chain.Builder.html#5932" class="Bound">trustedRoot</a> <a id="5944" href="Armor.Data.X509.Semantic.Chain.Builder.html#5944" class="Bound">candidates</a> <a id="5955" class="Symbol">:</a> <a id="5957" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5962" class="Symbol">(</a><a id="5963" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="5971" class="Symbol">_</a> <a id="5973" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="5977" class="Symbol">))</a> <a id="5980" class="Symbol">{@</a><a id="5982" class="Symbol">0</a> <a id="5984" href="Armor.Data.X509.Semantic.Chain.Builder.html#5984" class="Bound">bs</a><a id="5986" class="Symbol">}</a> <a id="5988" class="Symbol">(</a><a id="5989" href="Armor.Data.X509.Semantic.Chain.Builder.html#5989" class="Bound">endEnt</a> <a id="5996" class="Symbol">:</a> <a id="5998" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="6003" href="Armor.Data.X509.Semantic.Chain.Builder.html#5984" class="Bound">bs</a><a id="6005" class="Symbol">)</a>
           <a id="6018" class="Symbol">→</a> <a id="6020" href="Armor.Data.X509.Semantic.Chain.Builder.html#683" class="Record">TrustTree</a> <a id="6030" href="Armor.Data.X509.Semantic.Chain.Builder.html#5932" class="Bound">trustedRoot</a> <a id="6042" href="Armor.Data.X509.Semantic.Chain.Builder.html#5944" class="Bound">candidates</a> <a id="6053" href="Armor.Data.X509.Semantic.Chain.Builder.html#5989" class="Bound">endEnt</a>
           <a id="6071" class="Symbol">→</a> <a id="6073" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6078" class="Symbol">(</a><a id="6079" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="6085" href="Armor.Data.X509.Semantic.Chain.Builder.html#5932" class="Bound">trustedRoot</a> <a id="6097" href="Armor.Data.X509.Semantic.Chain.Builder.html#5944" class="Bound">candidates</a> <a id="6108" href="Armor.Data.X509.Semantic.Chain.Builder.html#5989" class="Bound">endEnt</a><a id="6114" class="Symbol">)</a>
<a id="6116" href="Armor.Data.X509.Semantic.Chain.Builder.html#5918" class="Function">toChains</a> <a id="6125" href="Armor.Data.X509.Semantic.Chain.Builder.html#6125" class="Bound">trustedRoot</a> <a id="6137" href="Armor.Data.X509.Semantic.Chain.Builder.html#6137" class="Bound">candidates</a> <a id="6148" href="Armor.Data.X509.Semantic.Chain.Builder.html#6148" class="Bound">endEnt</a> <a id="6155" href="Armor.Data.X509.Semantic.Chain.Builder.html#6155" class="Bound">tr</a> <a id="6158" class="Symbol">=</a> <a id="6160" href="Armor.Data.X509.Semantic.Chain.Builder.html#5100" class="Function">toChainsWF</a> <a id="6171" href="Armor.Data.X509.Semantic.Chain.Builder.html#6125" class="Bound">trustedRoot</a> <a id="6183" href="Armor.Data.X509.Semantic.Chain.Builder.html#6137" class="Bound">candidates</a> <a id="6194" href="Armor.Data.X509.Semantic.Chain.Builder.html#6148" class="Bound">endEnt</a> <a id="6201" class="Symbol">(</a><a id="6202" href="Data.Nat.Induction.html#2302" class="Function">&lt;-wellFounded</a> <a id="6216" class="Symbol">_)</a> <a id="6219" href="Armor.Data.X509.Semantic.Chain.Builder.html#6155" class="Bound">tr</a>
  <a id="6224" class="Keyword">where</a>
  <a id="6232" class="Keyword">open</a> <a id="6237" class="Keyword">import</a> <a id="6244" href="Data.Nat.Induction.html" class="Module">Data.Nat.Induction</a>

<a id="buildChains"></a><a id="6264" href="Armor.Data.X509.Semantic.Chain.Builder.html#6264" class="Function">buildChains</a> <a id="6276" class="Symbol">:</a> <a id="6278" class="Symbol">(</a><a id="6279" href="Armor.Data.X509.Semantic.Chain.Builder.html#6279" class="Bound">trustedRoot</a> <a id="6291" href="Armor.Data.X509.Semantic.Chain.Builder.html#6291" class="Bound">candidates</a> <a id="6302" class="Symbol">:</a> <a id="6304" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6309" class="Symbol">(</a><a id="6310" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="6318" class="Symbol">_</a> <a id="6320" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="6324" class="Symbol">))</a>
              <a id="6341" class="Symbol">→</a> <a id="6343" class="Symbol">∀</a> <a id="6345" class="Symbol">{@</a><a id="6347" class="Symbol">0</a> <a id="6349" href="Armor.Data.X509.Semantic.Chain.Builder.html#6349" class="Bound">bs</a><a id="6351" class="Symbol">}</a> <a id="6353" class="Symbol">→</a> <a id="6355" class="Symbol">(</a><a id="6356" href="Armor.Data.X509.Semantic.Chain.Builder.html#6356" class="Bound">issuee</a> <a id="6363" class="Symbol">:</a> <a id="6365" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="6370" href="Armor.Data.X509.Semantic.Chain.Builder.html#6349" class="Bound">bs</a><a id="6372" class="Symbol">)</a>
              <a id="6388" class="Symbol">→</a> <a id="6390" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6395" class="Symbol">(</a><a id="6396" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="6402" href="Armor.Data.X509.Semantic.Chain.Builder.html#6279" class="Bound">trustedRoot</a> <a id="6414" href="Armor.Data.X509.Semantic.Chain.Builder.html#6291" class="Bound">candidates</a> <a id="6425" href="Armor.Data.X509.Semantic.Chain.Builder.html#6356" class="Bound">issuee</a><a id="6431" class="Symbol">)</a>
<a id="6433" href="Armor.Data.X509.Semantic.Chain.Builder.html#6264" class="Function">buildChains</a> <a id="6445" href="Armor.Data.X509.Semantic.Chain.Builder.html#6445" class="Bound">trustedRoot</a> <a id="6457" href="Armor.Data.X509.Semantic.Chain.Builder.html#6457" class="Bound">candidates</a> <a id="6468" href="Armor.Data.X509.Semantic.Chain.Builder.html#6468" class="Bound">issuee</a> <a id="6475" class="Symbol">=</a>
  <a id="6479" href="Armor.Data.X509.Semantic.Chain.Builder.html#5918" class="Function">toChains</a> <a id="6488" class="Symbol">_</a> <a id="6490" class="Symbol">_</a> <a id="6492" class="Symbol">_</a> <a id="6494" class="Symbol">(</a><a id="6495" href="Armor.Data.X509.Semantic.Chain.Builder.html#4563" class="Function">buildTrustTree</a> <a id="6510" href="Armor.Data.X509.Semantic.Chain.Builder.html#6445" class="Bound">trustedRoot</a> <a id="6522" href="Armor.Data.X509.Semantic.Chain.Builder.html#6457" class="Bound">candidates</a> <a id="6533" href="Armor.Data.X509.Semantic.Chain.Builder.html#6468" class="Bound">issuee</a><a id="6539" class="Symbol">)</a>

<a id="6542" class="Comment">-- completeness</a>

<a id="toChainsBranchCompleteWF"></a><a id="6559" href="Armor.Data.X509.Semantic.Chain.Builder.html#6559" class="Function">toChainsBranchCompleteWF</a>
  <a id="6586" class="Symbol">:</a> <a id="6588" class="Symbol">∀</a> <a id="6590" class="Symbol">(</a><a id="6591" href="Armor.Data.X509.Semantic.Chain.Builder.html#6591" class="Bound">trustedRoot</a> <a id="6603" href="Armor.Data.X509.Semantic.Chain.Builder.html#6603" class="Bound">candidates</a> <a id="6614" class="Symbol">:</a> <a id="6616" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6621" class="Symbol">(</a><a id="6622" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="6630" class="Symbol">_</a> <a id="6632" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="6636" class="Symbol">))</a>
    <a id="6643" class="Symbol">→</a> <a id="6645" class="Symbol">∀</a> <a id="6647" class="Symbol">{@</a><a id="6649" class="Symbol">0</a> <a id="6651" href="Armor.Data.X509.Semantic.Chain.Builder.html#6651" class="Bound">bs</a><a id="6653" class="Symbol">}</a> <a id="6655" class="Symbol">(</a><a id="6656" href="Armor.Data.X509.Semantic.Chain.Builder.html#6656" class="Bound">issuee</a> <a id="6663" class="Symbol">:</a> <a id="6665" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="6670" href="Armor.Data.X509.Semantic.Chain.Builder.html#6651" class="Bound">bs</a><a id="6672" class="Symbol">)</a>
    <a id="6678" class="Symbol">→</a> <a id="6680" class="Symbol">(@</a><a id="6682" class="Symbol">0</a> <a id="6684" href="Armor.Data.X509.Semantic.Chain.Builder.html#6684" class="Bound">ac</a> <a id="6687" class="Symbol">:</a> <a id="6689" href="Armor.Prelude.html#3779" class="Function">Acc</a> <a id="6693" href="Data.Nat.Base.html#1645" class="Function Operator">_&lt;_</a> <a id="6697" class="Symbol">(</a><a id="6698" href="Data.List.Base.html#4864" class="Function">length</a> <a id="6705" href="Armor.Data.X509.Semantic.Chain.Builder.html#6603" class="Bound">candidates</a><a id="6715" class="Symbol">))</a>
    <a id="6722" class="Symbol">→</a> <a id="6724" class="Symbol">(</a><a id="6725" href="Armor.Data.X509.Semantic.Chain.Builder.html#6725" class="Bound">tb</a> <a id="6728" class="Symbol">:</a> <a id="6730" href="Data.Product.html#1369" class="Function">∃</a> <a id="6732" class="Symbol">(</a><a id="6733" href="Armor.Data.X509.Semantic.Chain.Builder.html#566" class="Function">TrustTreeBranchF</a> <a id="6750" href="Armor.Data.X509.Semantic.Chain.Builder.html#6591" class="Bound">trustedRoot</a> <a id="6762" href="Armor.Data.X509.Semantic.Chain.Builder.html#6603" class="Bound">candidates</a> <a id="6773" href="Armor.Data.X509.Semantic.Chain.Builder.html#6656" class="Bound">issuee</a><a id="6779" class="Symbol">))</a>
    <a id="6786" class="Symbol">→</a> <a id="6788" class="Keyword">let</a> <a id="6792" class="Symbol">(</a><a id="6793" href="Armor.Data.X509.Semantic.Chain.TCB.html#1150" class="InductiveConstructor">anIssuerForIn</a> <a id="6807" href="Armor.Data.X509.Semantic.Chain.Builder.html#6807" class="Bound">issuer</a> <a id="6814" class="Symbol">_</a> <a id="6816" href="Armor.Data.X509.Semantic.Chain.Builder.html#6816" class="Bound">issuer∈</a><a id="6823" class="Symbol">)</a> <a id="6825" class="Symbol">=</a> <a id="6827" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="6833" href="Armor.Data.X509.Semantic.Chain.Builder.html#6725" class="Bound">tb</a> <a id="6836" class="Keyword">in</a>
      <a id="6845" class="Symbol">∀</a> <a id="6847" class="Symbol">(</a><a id="6848" href="Armor.Data.X509.Semantic.Chain.Builder.html#6848" class="Bound">isIssuerFor</a> <a id="6860" class="Symbol">:</a> <a id="6862" href="Armor.Data.X509.Semantic.Chain.Builder.html#6807" class="Bound">issuer</a> <a id="6869" href="Armor.Data.X509.Semantic.Chain.TCB.html#273" class="Function Operator">IsIssuerFor</a> <a id="6881" href="Armor.Data.X509.Semantic.Chain.Builder.html#6656" class="Bound">issuee</a><a id="6887" class="Symbol">)</a> <a id="6889" class="Symbol">(</a><a id="6890" href="Armor.Data.X509.Semantic.Chain.Builder.html#6890" class="Bound">issuer∈&#39;</a> <a id="6899" class="Symbol">:</a> <a id="6901" class="Symbol">(</a><a id="6902" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="6905" href="Armor.Data.X509.Semantic.Chain.Builder.html#6807" class="Bound">issuer</a><a id="6911" class="Symbol">)</a> <a id="6913" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="6915" href="Armor.Data.X509.Semantic.Chain.Builder.html#6603" class="Bound">candidates</a><a id="6925" class="Symbol">)</a>
      <a id="6933" class="Symbol">→</a> <a id="6935" class="Symbol">(</a><a id="6936" href="Armor.Data.X509.Semantic.Chain.Builder.html#6936" class="Bound">chain</a> <a id="6942" class="Symbol">:</a> <a id="6944" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="6950" class="Symbol">(</a><a id="6951" href="Armor.Data.X509.Semantic.Chain.TCB.html#4086" class="Function">removeCertFromCerts</a> <a id="6971" href="Armor.Data.X509.Semantic.Chain.Builder.html#6807" class="Bound">issuer</a> <a id="6978" href="Armor.Data.X509.Semantic.Chain.Builder.html#6591" class="Bound">trustedRoot</a><a id="6989" class="Symbol">)</a> <a id="6991" class="Symbol">(</a><a id="6992" href="Armor.Data.X509.Semantic.Chain.TCB.html#4086" class="Function">removeCertFromCerts</a> <a id="7012" href="Armor.Data.X509.Semantic.Chain.Builder.html#6807" class="Bound">issuer</a> <a id="7019" href="Armor.Data.X509.Semantic.Chain.Builder.html#6603" class="Bound">candidates</a><a id="7029" class="Symbol">)</a> <a id="7031" href="Armor.Data.X509.Semantic.Chain.Builder.html#6807" class="Bound">issuer</a><a id="7037" class="Symbol">)</a>
      <a id="7045" class="Symbol">→</a> <a id="7047" href="Armor.Prelude.html#1624" class="Function">Any</a><a id="7050" class="Symbol">{</a><a id="7051" class="Argument">A</a> <a id="7053" class="Symbol">=</a> <a id="7055" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="7061" href="Armor.Data.X509.Semantic.Chain.Builder.html#6591" class="Bound">trustedRoot</a> <a id="7073" href="Armor.Data.X509.Semantic.Chain.Builder.html#6603" class="Bound">candidates</a> <a id="7084" href="Armor.Data.X509.Semantic.Chain.Builder.html#6656" class="Bound">issuee</a><a id="7090" class="Symbol">}</a> <a id="7092" class="Symbol">(λ</a> <a id="7095" href="Armor.Data.X509.Semantic.Chain.Builder.html#7095" class="Bound">c</a> <a id="7097" class="Symbol">→</a> <a id="7099" href="Armor.Data.X509.Semantic.Chain.TCB.html#5383" class="InductiveConstructor">link</a> <a id="7104" href="Armor.Data.X509.Semantic.Chain.Builder.html#6807" class="Bound">issuer</a> <a id="7111" class="Symbol">(</a><a id="7112" href="Armor.Data.X509.Semantic.Chain.Builder.html#6848" class="Bound">isIssuerFor</a> <a id="7124" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7126" href="Armor.Data.X509.Semantic.Chain.Builder.html#6890" class="Bound">issuer∈&#39;</a><a id="7134" class="Symbol">)</a> <a id="7136" href="Armor.Data.X509.Semantic.Chain.Builder.html#6936" class="Bound">chain</a> <a id="7142" href="Armor.Data.X509.Semantic.Chain.TCB.html#7302" class="Function Operator">≡Chain</a> <a id="7149" href="Armor.Data.X509.Semantic.Chain.Builder.html#7095" class="Bound">c</a><a id="7150" class="Symbol">)</a> <a id="7152" class="Symbol">(</a><a id="7153" href="Armor.Data.X509.Semantic.Chain.Builder.html#4861" class="Function">toChainsBranchWF</a> <a id="7170" class="Symbol">_</a> <a id="7172" class="Symbol">_</a> <a id="7174" class="Symbol">_</a> <a id="7176" href="Armor.Data.X509.Semantic.Chain.Builder.html#6684" class="Bound">ac</a> <a id="7179" href="Armor.Data.X509.Semantic.Chain.Builder.html#6725" class="Bound">tb</a><a id="7181" class="Symbol">)</a>


<a id="toChainsCompleteWF"></a><a id="7185" href="Armor.Data.X509.Semantic.Chain.Builder.html#7185" class="Function">toChainsCompleteWF</a>
  <a id="7206" class="Symbol">:</a> <a id="7208" class="Symbol">∀</a> <a id="7210" class="Symbol">(</a><a id="7211" href="Armor.Data.X509.Semantic.Chain.Builder.html#7211" class="Bound">trustedRoot</a> <a id="7223" href="Armor.Data.X509.Semantic.Chain.Builder.html#7223" class="Bound">candidates</a> <a id="7234" class="Symbol">:</a> <a id="7236" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="7241" class="Symbol">(</a><a id="7242" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="7250" class="Symbol">_</a> <a id="7252" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="7256" class="Symbol">))</a>
    <a id="7263" class="Symbol">→</a> <a id="7265" class="Symbol">∀</a> <a id="7267" class="Symbol">{@</a><a id="7269" class="Symbol">0</a> <a id="7271" href="Armor.Data.X509.Semantic.Chain.Builder.html#7271" class="Bound">bs</a><a id="7273" class="Symbol">}</a> <a id="7275" class="Symbol">(</a><a id="7276" href="Armor.Data.X509.Semantic.Chain.Builder.html#7276" class="Bound">issuee</a> <a id="7283" class="Symbol">:</a> <a id="7285" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="7290" href="Armor.Data.X509.Semantic.Chain.Builder.html#7271" class="Bound">bs</a><a id="7292" class="Symbol">)</a>
    <a id="7298" class="Symbol">→</a> <a id="7300" class="Symbol">(@</a><a id="7302" class="Symbol">0</a> <a id="7304" href="Armor.Data.X509.Semantic.Chain.Builder.html#7304" class="Bound">ac</a> <a id="7307" class="Symbol">:</a> <a id="7309" href="Armor.Prelude.html#3779" class="Function">Acc</a> <a id="7313" href="Data.Nat.Base.html#1645" class="Function Operator">_&lt;_</a> <a id="7317" class="Symbol">(</a><a id="7318" href="Data.List.Base.html#4864" class="Function">length</a> <a id="7325" href="Armor.Data.X509.Semantic.Chain.Builder.html#7223" class="Bound">candidates</a><a id="7335" class="Symbol">))</a>
    <a id="7342" class="Symbol">→</a> <a id="7344" class="Symbol">(</a><a id="7345" href="Armor.Data.X509.Semantic.Chain.Builder.html#7345" class="Bound">tr</a> <a id="7348" class="Symbol">:</a> <a id="7350" href="Armor.Data.X509.Semantic.Chain.Builder.html#683" class="Record">TrustTree</a> <a id="7360" href="Armor.Data.X509.Semantic.Chain.Builder.html#7211" class="Bound">trustedRoot</a> <a id="7372" href="Armor.Data.X509.Semantic.Chain.Builder.html#7223" class="Bound">candidates</a> <a id="7383" href="Armor.Data.X509.Semantic.Chain.Builder.html#7276" class="Bound">issuee</a><a id="7389" class="Symbol">)</a>
    <a id="7395" class="Symbol">→</a> <a id="7397" class="Symbol">(</a><a id="7398" href="Armor.Data.X509.Semantic.Chain.Builder.html#7398" class="Bound">c</a> <a id="7400" class="Symbol">:</a> <a id="7402" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="7408" href="Armor.Data.X509.Semantic.Chain.Builder.html#7211" class="Bound">trustedRoot</a> <a id="7420" href="Armor.Data.X509.Semantic.Chain.Builder.html#7223" class="Bound">candidates</a> <a id="7431" href="Armor.Data.X509.Semantic.Chain.Builder.html#7276" class="Bound">issuee</a><a id="7437" class="Symbol">)</a>
    <a id="7443" class="Symbol">→</a> <a id="7445" href="Armor.Prelude.html#1624" class="Function">Any</a> <a id="7449" class="Symbol">(</a><a id="7450" href="Armor.Data.X509.Semantic.Chain.Builder.html#7398" class="Bound">c</a> <a id="7452" href="Armor.Data.X509.Semantic.Chain.TCB.html#7302" class="Function Operator">≡Chain_</a><a id="7459" class="Symbol">)</a> <a id="7461" class="Symbol">(</a><a id="7462" href="Armor.Data.X509.Semantic.Chain.Builder.html#5100" class="Function">toChainsWF</a> <a id="7473" class="Symbol">_</a> <a id="7475" class="Symbol">_</a> <a id="7477" class="Symbol">_</a> <a id="7479" href="Armor.Data.X509.Semantic.Chain.Builder.html#7304" class="Bound">ac</a> <a id="7482" href="Armor.Data.X509.Semantic.Chain.Builder.html#7345" class="Bound">tr</a><a id="7484" class="Symbol">)</a>

<a id="7487" href="Armor.Data.X509.Semantic.Chain.Builder.html#6559" class="Function">toChainsBranchCompleteWF</a> <a id="7512" href="Armor.Data.X509.Semantic.Chain.Builder.html#7512" class="Bound">trustedRoot</a> <a id="7524" href="Armor.Data.X509.Semantic.Chain.Builder.html#7524" class="Bound">candidates</a> <a id="7535" class="Comment">{- unique -}</a> <a id="7548" href="Armor.Data.X509.Semantic.Chain.Builder.html#7548" class="Bound">issuee</a> <a id="7555" class="Symbol">(</a><a id="7556" href="Induction.WellFounded.html#1062" class="InductiveConstructor">WellFounded.acc</a> <a id="7572" href="Armor.Data.X509.Semantic.Chain.Builder.html#7572" class="Bound">rs</a><a id="7574" class="Symbol">)</a> <a id="7576" class="Symbol">((</a><a id="7578" href="Armor.Data.X509.Semantic.Chain.TCB.html#1150" class="InductiveConstructor">anIssuerForIn</a> <a id="7592" href="Armor.Data.X509.Semantic.Chain.Builder.html#7592" class="Bound">issuer</a> <a id="7599" href="Armor.Data.X509.Semantic.Chain.Builder.html#7599" class="Bound">isIssuerFor</a> <a id="7611" href="Armor.Data.X509.Semantic.Chain.Builder.html#7611" class="Bound">issuer∈</a><a id="7618" class="Symbol">)</a> <a id="7620" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7622" href="Armor.Data.X509.Semantic.Chain.Builder.html#7622" class="Bound">tr</a><a id="7624" class="Symbol">)</a> <a id="7626" href="Armor.Data.X509.Semantic.Chain.Builder.html#7626" class="Bound">isIssuerFor&#39;</a> <a id="7639" href="Armor.Data.X509.Semantic.Chain.Builder.html#7639" class="Bound">issuer∈&#39;</a> <a id="7648" href="Armor.Data.X509.Semantic.Chain.Builder.html#7648" class="Bound">chain</a> <a id="7654" class="Symbol">=</a>
  <a id="7658" href="Data.List.Relation.Unary.Any.Properties.html#10941" class="Function">Any.map⁺</a><a id="7666" class="Symbol">{</a><a id="7667" class="Argument">xs</a> <a id="7670" class="Symbol">=</a> <a id="7672" href="Armor.Data.X509.Semantic.Chain.Builder.html#7764" class="Function">chains&#39;</a><a id="7679" class="Symbol">}</a>
    <a id="7685" class="Symbol">(</a><a id="7686" href="Data.List.Relation.Unary.Any.html#1643" class="Function">Any.map</a>
      <a id="7700" class="Symbol">(λ</a> <a id="7703" class="Symbol">{</a><a id="7704" href="Armor.Data.X509.Semantic.Chain.Builder.html#7704" class="Bound">chain&#39;</a><a id="7710" class="Symbol">}</a> <a id="7712" href="Armor.Data.X509.Semantic.Chain.Builder.html#7712" class="Bound">≡chain</a> <a id="7719" class="Symbol">→</a> <a id="7721" href="Relation.Binary.PropositionalEquality.Core.html#1367" class="Function">cong₂</a> <a id="7727" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a> <a id="7731" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="7736" href="Armor.Data.X509.Semantic.Chain.Builder.html#7712" class="Bound">≡chain</a><a id="7742" class="Symbol">)</a>
      <a id="7750" href="Armor.Data.X509.Semantic.Chain.Builder.html#7966" class="Function">ih</a><a id="7752" class="Symbol">)</a>
  <a id="7756" class="Keyword">where</a>
  <a id="7764" href="Armor.Data.X509.Semantic.Chain.Builder.html#7764" class="Function">chains&#39;</a> <a id="7772" class="Symbol">:</a> <a id="7774" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="7779" class="Symbol">(</a><a id="7780" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="7786" class="Symbol">(</a><a id="7787" href="Armor.Data.X509.Semantic.Chain.TCB.html#4086" class="Function">removeCertFromCerts</a> <a id="7807" href="Armor.Data.X509.Semantic.Chain.Builder.html#7592" class="Bound">issuer</a> <a id="7814" href="Armor.Data.X509.Semantic.Chain.Builder.html#7512" class="Bound">trustedRoot</a><a id="7825" class="Symbol">)</a> <a id="7827" class="Symbol">(</a><a id="7828" href="Armor.Data.X509.Semantic.Chain.TCB.html#4086" class="Function">removeCertFromCerts</a> <a id="7848" href="Armor.Data.X509.Semantic.Chain.Builder.html#7592" class="Bound">issuer</a> <a id="7855" href="Armor.Data.X509.Semantic.Chain.Builder.html#7524" class="Bound">candidates</a><a id="7865" class="Symbol">)</a> <a id="7867" href="Armor.Data.X509.Semantic.Chain.Builder.html#7592" class="Bound">issuer</a><a id="7873" class="Symbol">)</a>
  <a id="7877" href="Armor.Data.X509.Semantic.Chain.Builder.html#7764" class="Function">chains&#39;</a> <a id="7885" class="Symbol">=</a> <a id="7887" href="Armor.Data.X509.Semantic.Chain.Builder.html#5100" class="Function">toChainsWF</a> <a id="7898" class="Symbol">_</a> <a id="7900" class="Symbol">_</a> <a id="7902" href="Armor.Data.X509.Semantic.Chain.Builder.html#7592" class="Bound">issuer</a> <a id="7909" class="Symbol">(</a><a id="7910" href="Armor.Data.X509.Semantic.Chain.Builder.html#7572" class="Bound">rs</a> <a id="7913" class="Symbol">_</a> <a id="7915" class="Symbol">(</a><a id="7916" href="Armor.Data.X509.Semantic.Chain.TCB.html#4930" class="Function">removeCertFromCerts&lt;</a> <a id="7937" class="Symbol">_</a> <a id="7939" href="Armor.Data.X509.Semantic.Chain.Builder.html#7524" class="Bound">candidates</a> <a id="7950" href="Armor.Data.X509.Semantic.Chain.Builder.html#7611" class="Bound">issuer∈</a><a id="7957" class="Symbol">))</a> <a id="7960" href="Armor.Data.X509.Semantic.Chain.Builder.html#7622" class="Bound">tr</a>

  <a id="7966" href="Armor.Data.X509.Semantic.Chain.Builder.html#7966" class="Function">ih</a> <a id="7969" class="Symbol">:</a> <a id="7971" href="Armor.Prelude.html#1624" class="Function">Any</a> <a id="7975" class="Symbol">(</a><a id="7976" href="Armor.Data.X509.Semantic.Chain.Builder.html#7648" class="Bound">chain</a> <a id="7982" href="Armor.Data.X509.Semantic.Chain.TCB.html#7302" class="Function Operator">≡Chain_</a><a id="7989" class="Symbol">)</a> <a id="7991" href="Armor.Data.X509.Semantic.Chain.Builder.html#7764" class="Function">chains&#39;</a>
  <a id="8001" href="Armor.Data.X509.Semantic.Chain.Builder.html#7966" class="Function">ih</a> <a id="8004" class="Symbol">=</a> <a id="8006" href="Armor.Data.X509.Semantic.Chain.Builder.html#7185" class="Function">toChainsCompleteWF</a> <a id="8025" class="Symbol">_</a> <a id="8027" class="Symbol">_</a> <a id="8029" href="Armor.Data.X509.Semantic.Chain.Builder.html#7592" class="Bound">issuer</a> <a id="8036" class="Symbol">(</a><a id="8037" href="Armor.Data.X509.Semantic.Chain.Builder.html#7572" class="Bound">rs</a> <a id="8040" class="Symbol">_</a> <a id="8042" class="Symbol">(</a><a id="8043" href="Armor.Data.X509.Semantic.Chain.TCB.html#4930" class="Function">removeCertFromCerts&lt;</a> <a id="8064" class="Symbol">_</a> <a id="8066" href="Armor.Data.X509.Semantic.Chain.Builder.html#7524" class="Bound">candidates</a> <a id="8077" href="Armor.Data.X509.Semantic.Chain.Builder.html#7611" class="Bound">issuer∈</a><a id="8084" class="Symbol">))</a> <a id="8087" href="Armor.Data.X509.Semantic.Chain.Builder.html#7622" class="Bound">tr</a> <a id="8090" href="Armor.Data.X509.Semantic.Chain.Builder.html#7648" class="Bound">chain</a>

<a id="allLookupLemma"></a><a id="8097" href="Armor.Data.X509.Semantic.Chain.Builder.html#8097" class="Function">allLookupLemma</a> <a id="8112" class="Symbol">:</a> <a id="8114" class="Symbol">{</a><a id="8115" href="Armor.Data.X509.Semantic.Chain.Builder.html#8115" class="Bound">A</a> <a id="8117" class="Symbol">:</a> <a id="8119" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="8122" class="Symbol">}</a> <a id="8124" class="Symbol">{</a><a id="8125" href="Armor.Data.X509.Semantic.Chain.Builder.html#8125" class="Bound">P</a> <a id="8127" class="Symbol">:</a> <a id="8129" class="Symbol">(</a><a id="8130" href="Armor.Data.X509.Semantic.Chain.Builder.html#8130" class="Bound">a</a> <a id="8132" class="Symbol">:</a> <a id="8134" href="Armor.Data.X509.Semantic.Chain.Builder.html#8115" class="Bound">A</a><a id="8135" class="Symbol">)</a> <a id="8137" class="Symbol">→</a> <a id="8139" href="Agda.Primitive.html#326" class="Primitive">Set</a><a id="8142" class="Symbol">}</a> <a id="8144" class="Symbol">→</a> <a id="8146" class="Symbol">∀</a> <a id="8148" class="Symbol">{</a><a id="8149" href="Armor.Data.X509.Semantic.Chain.Builder.html#8149" class="Bound">x</a> <a id="8151" href="Armor.Data.X509.Semantic.Chain.Builder.html#8151" class="Bound">xs</a><a id="8153" class="Symbol">}</a> <a id="8155" class="Symbol">→</a> <a id="8157" class="Symbol">(</a><a id="8158" href="Armor.Data.X509.Semantic.Chain.Builder.html#8158" class="Bound">all</a> <a id="8162" class="Symbol">:</a> <a id="8164" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="8168" href="Armor.Data.X509.Semantic.Chain.Builder.html#8125" class="Bound">P</a> <a id="8170" href="Armor.Data.X509.Semantic.Chain.Builder.html#8151" class="Bound">xs</a><a id="8172" class="Symbol">)</a> <a id="8174" class="Symbol">→</a> <a id="8176" class="Symbol">(</a><a id="8177" href="Armor.Data.X509.Semantic.Chain.Builder.html#8177" class="Bound">x∈</a> <a id="8180" class="Symbol">:</a> <a id="8182" href="Armor.Data.X509.Semantic.Chain.Builder.html#8149" class="Bound">x</a> <a id="8184" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="8186" href="Armor.Data.X509.Semantic.Chain.Builder.html#8151" class="Bound">xs</a><a id="8188" class="Symbol">)</a> <a id="8190" class="Symbol">→</a> <a id="8192" class="Symbol">((</a><a id="8194" href="Armor.Data.X509.Semantic.Chain.Builder.html#8149" class="Bound">x</a> <a id="8196" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8198" href="Data.List.Relation.Unary.All.html#5766" class="Function">All.lookup</a> <a id="8209" href="Armor.Data.X509.Semantic.Chain.Builder.html#8158" class="Bound">all</a> <a id="8213" href="Armor.Data.X509.Semantic.Chain.Builder.html#8177" class="Bound">x∈</a><a id="8215" class="Symbol">))</a> <a id="8218" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="8220" href="Data.List.Relation.Unary.All.html#2859" class="Function">All.toList</a> <a id="8231" href="Armor.Data.X509.Semantic.Chain.Builder.html#8158" class="Bound">all</a>
<a id="8235" href="Armor.Data.X509.Semantic.Chain.Builder.html#8097" class="Function">allLookupLemma</a> <a id="8250" class="Symbol">{</a><a id="8251" href="Armor.Data.X509.Semantic.Chain.Builder.html#8251" class="Bound">x</a><a id="8252" class="Symbol">}</a> <a id="8254" class="Symbol">{</a><a id="8255" href="Armor.Data.X509.Semantic.Chain.Builder.html#8255" class="Bound">xs</a><a id="8257" class="Symbol">}</a> <a id="8259" class="Symbol">(</a><a id="8260" href="Armor.Data.X509.Semantic.Chain.Builder.html#8260" class="Bound">px₁</a> <a id="8264" href="Data.List.Relation.Unary.All.html#1524" class="InductiveConstructor Operator">∷</a> <a id="8266" href="Armor.Data.X509.Semantic.Chain.Builder.html#8266" class="Bound">all₁</a><a id="8270" class="Symbol">)</a> <a id="8272" class="Symbol">(</a><a id="8273" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="8278" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="8282" class="Symbol">)</a> <a id="8284" class="Symbol">=</a> <a id="8286" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="8291" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
<a id="8296" href="Armor.Data.X509.Semantic.Chain.Builder.html#8097" class="Function">allLookupLemma</a> <a id="8311" class="Symbol">{</a><a id="8312" href="Armor.Data.X509.Semantic.Chain.Builder.html#8312" class="Bound">x</a><a id="8313" class="Symbol">}</a> <a id="8315" class="Symbol">{</a><a id="8316" href="Armor.Data.X509.Semantic.Chain.Builder.html#8316" class="Bound">xs</a><a id="8318" class="Symbol">}</a> <a id="8320" class="Symbol">(</a><a id="8321" href="Armor.Data.X509.Semantic.Chain.Builder.html#8321" class="Bound">px</a> <a id="8324" href="Data.List.Relation.Unary.All.html#1524" class="InductiveConstructor Operator">∷</a> <a id="8326" href="Armor.Data.X509.Semantic.Chain.Builder.html#8326" class="Bound">all₁</a><a id="8330" class="Symbol">)</a> <a id="8332" class="Symbol">(</a><a id="8333" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a> <a id="8339" href="Armor.Data.X509.Semantic.Chain.Builder.html#8339" class="Bound">x∈</a><a id="8341" class="Symbol">)</a> <a id="8343" class="Symbol">=</a> <a id="8345" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a> <a id="8351" class="Symbol">(</a><a id="8352" href="Armor.Data.X509.Semantic.Chain.Builder.html#8097" class="Function">allLookupLemma</a> <a id="8367" href="Armor.Data.X509.Semantic.Chain.Builder.html#8326" class="Bound">all₁</a> <a id="8372" href="Armor.Data.X509.Semantic.Chain.Builder.html#8339" class="Bound">x∈</a><a id="8374" class="Symbol">)</a>


<a id="8378" href="Armor.Data.X509.Semantic.Chain.Builder.html#7185" class="Function">toChainsCompleteWF</a> <a id="8397" href="Armor.Data.X509.Semantic.Chain.Builder.html#8397" class="Bound">trustedRoot</a> <a id="8409" href="Armor.Data.X509.Semantic.Chain.Builder.html#8409" class="Bound">candidates</a> <a id="8420" class="Comment">{- unique -}</a> <a id="8433" href="Armor.Data.X509.Semantic.Chain.Builder.html#8433" class="Bound">endEnt</a> <a id="8440" href="Armor.Data.X509.Semantic.Chain.Builder.html#8440" class="Bound">ac</a> <a id="8443" class="Symbol">(</a><a id="8444" href="Armor.Data.X509.Semantic.Chain.Builder.html#1250" class="InductiveConstructor">mkTrustTree</a> <a id="8456" class="Symbol">(</a><a id="8457" href="Armor.Data.X509.Semantic.Chain.Builder.html#8457" class="Bound">rootIssuers</a> <a id="8469" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="8471" href="Armor.Data.X509.Semantic.Chain.Builder.html#8471" class="Bound">allRootIssuers</a><a id="8485" class="Symbol">)</a> <a id="8487" href="Armor.Data.X509.Semantic.Chain.Builder.html#8487" class="Bound">otherIssuers</a> <a id="8500" href="Armor.Data.X509.Semantic.Chain.Builder.html#8500" class="Bound">otherTrust</a><a id="8510" class="Symbol">)</a> <a id="8512" class="Symbol">(</a><a id="8513" href="Armor.Data.X509.Semantic.Chain.TCB.html#5288" class="InductiveConstructor">root</a> <a id="8518" class="Symbol">(</a><a id="8519" href="Armor.Data.X509.Semantic.Chain.TCB.html#1150" class="InductiveConstructor">anIssuerForIn</a> <a id="8533" href="Armor.Data.X509.Semantic.Chain.Builder.html#8533" class="Bound">issuer</a> <a id="8540" href="Armor.Data.X509.Semantic.Chain.Builder.html#8540" class="Bound">isIssuerFor</a> <a id="8552" href="Armor.Data.X509.Semantic.Chain.Builder.html#8552" class="Bound">issuer∈</a><a id="8559" class="Symbol">))</a> <a id="8562" class="Symbol">=</a>
  <a id="8566" href="Data.List.Relation.Unary.Any.Properties.html#12214" class="Function">Any.++⁺ˡ</a> <a id="8575" class="Symbol">{</a><a id="8576" class="Argument">xs</a> <a id="8579" class="Symbol">=</a> <a id="8581" href="Data.List.Base.html#1544" class="Function">map</a> <a id="8585" href="Armor.Data.X509.Semantic.Chain.TCB.html#5288" class="InductiveConstructor">root</a> <a id="8590" href="Armor.Data.X509.Semantic.Chain.Builder.html#8457" class="Bound">rootIssuers</a><a id="8601" class="Symbol">}</a>
    <a id="8607" class="Symbol">(</a><a id="8608" href="Data.List.Relation.Unary.Any.Properties.html#10941" class="Function">Any.map⁺</a>
      <a id="8623" class="Symbol">(</a><a id="8624" href="Data.List.Membership.Propositional.html#1052" class="Function">List.lose</a> <a id="8634" href="Armor.Data.X509.Semantic.Chain.Builder.html#8911" class="Function">rootIssuer∈root</a> <a id="8650" class="Symbol">(</a><a id="8651" href="Relation.Binary.PropositionalEquality.Core.html#1367" class="Function">cong₂</a> <a id="8657" class="Symbol">(λ</a> <a id="8660" href="Armor.Data.X509.Semantic.Chain.Builder.html#8660" class="Bound">x</a> <a id="8662" href="Armor.Data.X509.Semantic.Chain.Builder.html#8662" class="Bound">y</a> <a id="8664" class="Symbol">→</a> <a id="8666" href="Armor.Data.X509.Semantic.Chain.Builder.html#8660" class="Bound">x</a> <a id="8668" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="8670" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="8672" href="Armor.Data.X509.Semantic.Chain.Builder.html#8662" class="Bound">y</a> <a id="8674" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="8675" class="Symbol">)</a> <a id="8677" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="8682" class="Symbol">(</a><a id="8683" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="8689" class="Symbol">(</a><a id="8690" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="8696" href="Armor.Data.X509.Semantic.Chain.Builder.html#8725" class="Function">rootIssuerLem</a><a id="8709" class="Symbol">)))))</a>
  <a id="8717" class="Keyword">where</a>
  <a id="8725" href="Armor.Data.X509.Semantic.Chain.Builder.html#8725" class="Function">rootIssuerLem</a> <a id="8739" class="Symbol">:</a> <a id="8741" href="Data.Product.html#1369" class="Function">∃</a> <a id="8743" class="Symbol">λ</a> <a id="8745" href="Armor.Data.X509.Semantic.Chain.Builder.html#8745" class="Bound">x</a> <a id="8747" class="Symbol">→</a> <a id="8749" href="Armor.Data.X509.Semantic.Chain.Builder.html#8745" class="Bound">x</a> <a id="8751" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="8753" href="Armor.Data.X509.Semantic.Chain.Builder.html#8457" class="Bound">rootIssuers</a> <a id="8765" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="8767" class="Symbol">(</a><a id="8768" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="8771" href="Armor.Data.X509.Semantic.Chain.Builder.html#8533" class="Bound">issuer</a><a id="8777" class="Symbol">)</a> <a id="8779" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="8781" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="8787" href="Armor.Data.X509.Semantic.Chain.Builder.html#8745" class="Bound">x</a>
  <a id="8791" href="Armor.Data.X509.Semantic.Chain.Builder.html#8725" class="Function">rootIssuerLem</a> <a id="8805" class="Symbol">=</a> <a id="8807" href="Data.List.Membership.Propositional.Properties.html#3482" class="Function">List.∈-map⁻</a> <a id="8819" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="8825" class="Symbol">(</a><a id="8826" href="Data.List.Relation.Unary.All.html#5766" class="Function">All.lookup</a> <a id="8837" href="Armor.Data.X509.Semantic.Chain.Builder.html#8471" class="Bound">allRootIssuers</a> <a id="8852" href="Armor.Data.X509.Semantic.Chain.Builder.html#8552" class="Bound">issuer∈</a> <a id="8860" href="Armor.Data.X509.Semantic.Chain.Builder.html#8540" class="Bound">isIssuerFor</a><a id="8871" class="Symbol">)</a>

  <a id="8876" href="Armor.Data.X509.Semantic.Chain.Builder.html#8876" class="Function">rootIssuer</a> <a id="8887" class="Symbol">=</a> <a id="8889" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="8895" href="Armor.Data.X509.Semantic.Chain.Builder.html#8725" class="Function">rootIssuerLem</a>
  <a id="8911" href="Armor.Data.X509.Semantic.Chain.Builder.html#8911" class="Function">rootIssuer∈root</a> <a id="8927" class="Symbol">=</a> <a id="8929" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="8935" class="Symbol">(</a><a id="8936" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="8942" href="Armor.Data.X509.Semantic.Chain.Builder.html#8725" class="Function">rootIssuerLem</a><a id="8955" class="Symbol">)</a>
<a id="8957" href="Armor.Data.X509.Semantic.Chain.Builder.html#7185" class="Function">toChainsCompleteWF</a> <a id="8976" href="Armor.Data.X509.Semantic.Chain.Builder.html#8976" class="Bound">trustedRoot</a> <a id="8988" href="Armor.Data.X509.Semantic.Chain.Builder.html#8988" class="Bound">candidates</a> <a id="8999" class="Comment">{- unique -}</a> <a id="9012" href="Armor.Data.X509.Semantic.Chain.Builder.html#9012" class="Bound">endEnt</a> <a id="9019" href="Armor.Data.X509.Semantic.Chain.Builder.html#9019" class="Bound">ac</a> <a id="9022" class="Symbol">(</a><a id="9023" href="Armor.Data.X509.Semantic.Chain.Builder.html#1250" class="InductiveConstructor">mkTrustTree</a> <a id="9035" class="Symbol">(</a><a id="9036" href="Armor.Data.X509.Semantic.Chain.Builder.html#9036" class="Bound">rootIssuers</a> <a id="9048" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9050" class="Symbol">_)</a> <a id="9053" class="Symbol">(</a><a id="9054" href="Armor.Data.X509.Semantic.Chain.Builder.html#9054" class="Bound">otherIssuers</a> <a id="9067" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9069" href="Armor.Data.X509.Semantic.Chain.Builder.html#9069" class="Bound">allOtherIssuers</a><a id="9084" class="Symbol">)</a> <a id="9086" href="Armor.Data.X509.Semantic.Chain.Builder.html#9086" class="Bound">otherTrust</a><a id="9096" class="Symbol">)</a> <a id="9098" href="Armor.Data.X509.Semantic.Chain.Builder.html#9098" class="Bound">chain</a><a id="9103" class="Symbol">@(</a><a id="9105" href="Armor.Data.X509.Semantic.Chain.TCB.html#5383" class="InductiveConstructor">link</a> <a id="9110" href="Armor.Data.X509.Semantic.Chain.Builder.html#9110" class="Bound">issuer</a> <a id="9117" class="Symbol">(</a><a id="9118" href="Armor.Data.X509.Semantic.Chain.Builder.html#9118" class="Bound">isIssuer</a> <a id="9127" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9129" href="Armor.Data.X509.Semantic.Chain.Builder.html#9129" class="Bound">issuer∈</a><a id="9136" class="Symbol">)</a> <a id="9138" href="Armor.Data.X509.Semantic.Chain.Builder.html#9138" class="Bound">c</a><a id="9139" class="Symbol">)</a> <a id="9141" class="Symbol">=</a>
  <a id="9145" href="Data.List.Relation.Unary.Any.Properties.html#12312" class="Function">Any.++⁺ʳ</a> <a id="9154" class="Symbol">(</a><a id="9155" href="Data.List.Base.html#1544" class="Function">map</a> <a id="9159" href="Armor.Data.X509.Semantic.Chain.TCB.html#5288" class="InductiveConstructor">root</a> <a id="9164" href="Armor.Data.X509.Semantic.Chain.Builder.html#9036" class="Bound">rootIssuers</a><a id="9175" class="Symbol">)</a>
    <a id="9181" class="Symbol">(</a><a id="9182" href="Data.List.Relation.Unary.Any.Properties.html#14689" class="Function">Any.concat⁺</a><a id="9193" class="Symbol">{</a><a id="9194" class="Argument">xss</a> <a id="9198" class="Symbol">=</a> <a id="9200" href="Data.List.Base.html#1544" class="Function">map</a> <a id="9204" class="Symbol">(</a><a id="9205" href="Armor.Data.X509.Semantic.Chain.Builder.html#4861" class="Function">toChainsBranchWF</a> <a id="9222" href="Armor.Data.X509.Semantic.Chain.Builder.html#8976" class="Bound">trustedRoot</a> <a id="9234" href="Armor.Data.X509.Semantic.Chain.Builder.html#8988" class="Bound">candidates</a> <a id="9245" href="Armor.Data.X509.Semantic.Chain.Builder.html#9012" class="Bound">endEnt</a> <a id="9252" href="Armor.Data.X509.Semantic.Chain.Builder.html#9019" class="Bound">ac</a><a id="9254" class="Symbol">)</a> <a id="9256" class="Symbol">(</a><a id="9257" href="Data.List.Relation.Unary.All.html#2859" class="Function">All.toList</a> <a id="9268" href="Armor.Data.X509.Semantic.Chain.Builder.html#9086" class="Bound">otherTrust</a><a id="9278" class="Symbol">)}</a>
      <a id="9287" class="Symbol">(</a><a id="9288" href="Data.List.Relation.Unary.Any.Properties.html#10941" class="Function">Any.map⁺</a><a id="9296" class="Symbol">{</a><a id="9297" class="Argument">xs</a> <a id="9300" class="Symbol">=</a> <a id="9302" href="Data.List.Relation.Unary.All.html#2859" class="Function">All.toList</a> <a id="9313" href="Armor.Data.X509.Semantic.Chain.Builder.html#9086" class="Bound">otherTrust</a><a id="9323" class="Symbol">}</a>
        <a id="9333" class="Symbol">(</a><a id="9334" href="Data.List.Membership.Propositional.html#1052" class="Function">List.lose</a>
          <a id="9354" class="Symbol">(</a><a id="9355" href="Armor.Data.X509.Semantic.Chain.Builder.html#8097" class="Function">allLookupLemma</a> <a id="9370" href="Armor.Data.X509.Semantic.Chain.Builder.html#9086" class="Bound">otherTrust</a> <a id="9381" class="Symbol">(</a><a id="9382" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="9388" class="Symbol">(</a><a id="9389" href="Armor.Data.X509.Semantic.Chain.Builder.html#10033" class="Function">isIssuer×isInF</a> <a id="9404" href="Armor.Data.X509.Semantic.Chain.Builder.html#9865" class="Function">issuerFromOtherIssuers</a><a id="9426" class="Symbol">)))</a>
          <a id="9440" class="Symbol">(</a><a id="9441" href="Armor.Data.X509.Semantic.Chain.Builder.html#6559" class="Function">toChainsBranchCompleteWF</a> <a id="9466" href="Armor.Data.X509.Semantic.Chain.Builder.html#8976" class="Bound">trustedRoot</a> <a id="9478" href="Armor.Data.X509.Semantic.Chain.Builder.html#8988" class="Bound">candidates</a> <a id="9489" href="Armor.Data.X509.Semantic.Chain.Builder.html#9012" class="Bound">endEnt</a> <a id="9496" href="Armor.Data.X509.Semantic.Chain.Builder.html#9019" class="Bound">ac</a>
            <a id="9511" class="Symbol">(</a>  <a id="9514" class="Symbol">(</a>  <a id="9517" class="Symbol">(</a><a id="9518" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="9521" href="Armor.Data.X509.Semantic.Chain.Builder.html#9110" class="Bound">issuer</a><a id="9527" class="Symbol">)</a>
                <a id="9545" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9547" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="9553" class="Symbol">(</a><a id="9554" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="9560" class="Symbol">(</a><a id="9561" href="Armor.Data.X509.Semantic.Chain.Builder.html#10033" class="Function">isIssuer×isInF</a> <a id="9576" href="Armor.Data.X509.Semantic.Chain.Builder.html#9865" class="Function">issuerFromOtherIssuers</a><a id="9598" class="Symbol">))</a>
                <a id="9617" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9619" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="9625" class="Symbol">(</a><a id="9626" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="9632" class="Symbol">(</a><a id="9633" href="Armor.Data.X509.Semantic.Chain.Builder.html#10033" class="Function">isIssuer×isInF</a> <a id="9648" href="Armor.Data.X509.Semantic.Chain.Builder.html#9865" class="Function">issuerFromOtherIssuers</a><a id="9670" class="Symbol">)))</a>
             <a id="9687" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="9689" href="Data.List.Relation.Unary.All.html#5766" class="Function">All.lookup</a> <a id="9700" href="Armor.Data.X509.Semantic.Chain.Builder.html#9086" class="Bound">otherTrust</a> <a id="9711" class="Symbol">_)</a>
            <a id="9726" href="Armor.Data.X509.Semantic.Chain.Builder.html#9118" class="Bound">isIssuer</a> <a id="9735" href="Armor.Data.X509.Semantic.Chain.Builder.html#9129" class="Bound">issuer∈</a>
            <a id="9755" href="Armor.Data.X509.Semantic.Chain.Builder.html#9138" class="Bound">c</a><a id="9756" class="Symbol">))))</a>
  <a id="9763" class="Keyword">where</a>
  <a id="9771" href="Armor.Data.X509.Semantic.Chain.Builder.html#9771" class="Function">xs</a> <a id="9774" class="Symbol">=</a> <a id="9776" href="Data.List.Base.html#4450" class="Function">concatMap</a> <a id="9786" class="Symbol">(</a><a id="9787" href="Armor.Data.X509.Semantic.Chain.Builder.html#4861" class="Function">toChainsBranchWF</a> <a id="9804" href="Armor.Data.X509.Semantic.Chain.Builder.html#8976" class="Bound">trustedRoot</a> <a id="9816" href="Armor.Data.X509.Semantic.Chain.Builder.html#8988" class="Bound">candidates</a> <a id="9827" href="Armor.Data.X509.Semantic.Chain.Builder.html#9012" class="Bound">endEnt</a> <a id="9834" href="Armor.Data.X509.Semantic.Chain.Builder.html#9019" class="Bound">ac</a><a id="9836" class="Symbol">)</a> <a id="9838" class="Symbol">(</a><a id="9839" href="Data.List.Relation.Unary.All.html#2859" class="Function">All.toList</a> <a id="9850" href="Armor.Data.X509.Semantic.Chain.Builder.html#9086" class="Bound">otherTrust</a><a id="9860" class="Symbol">)</a>

  <a id="9865" href="Armor.Data.X509.Semantic.Chain.Builder.html#9865" class="Function">issuerFromOtherIssuers</a> <a id="9888" class="Symbol">:</a> <a id="9890" href="Data.Product.html#1369" class="Function">∃</a> <a id="9892" class="Symbol">λ</a> <a id="9894" href="Armor.Data.X509.Semantic.Chain.Builder.html#9894" class="Bound">x</a> <a id="9896" class="Symbol">→</a> <a id="9898" href="Armor.Data.X509.Semantic.Chain.Builder.html#9894" class="Bound">x</a> <a id="9900" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="9902" href="Armor.Data.X509.Semantic.Chain.Builder.html#9054" class="Bound">otherIssuers</a> <a id="9915" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="9917" class="Symbol">(</a><a id="9918" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="9921" href="Armor.Data.X509.Semantic.Chain.Builder.html#9110" class="Bound">issuer</a><a id="9927" class="Symbol">)</a> <a id="9929" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="9931" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="9937" href="Armor.Data.X509.Semantic.Chain.Builder.html#9894" class="Bound">x</a>
  <a id="9941" href="Armor.Data.X509.Semantic.Chain.Builder.html#9865" class="Function">issuerFromOtherIssuers</a> <a id="9964" class="Symbol">=</a> <a id="9966" href="Data.List.Membership.Propositional.Properties.html#3482" class="Function">List.∈-map⁻</a> <a id="9978" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="9984" class="Symbol">(</a><a id="9985" href="Data.List.Relation.Unary.All.html#5766" class="Function">All.lookup</a> <a id="9996" href="Armor.Data.X509.Semantic.Chain.Builder.html#9069" class="Bound">allOtherIssuers</a> <a id="10012" href="Armor.Data.X509.Semantic.Chain.Builder.html#9129" class="Bound">issuer∈</a> <a id="10020" href="Armor.Data.X509.Semantic.Chain.Builder.html#9118" class="Bound">isIssuer</a><a id="10028" class="Symbol">)</a>

  <a id="10033" href="Armor.Data.X509.Semantic.Chain.Builder.html#10033" class="Function">isIssuer×isInF</a> <a id="10048" class="Symbol">:</a> <a id="10050" class="Symbol">(</a><a id="10051" href="Data.Product.html#1369" class="Function">∃</a> <a id="10053" class="Symbol">λ</a> <a id="10055" href="Armor.Data.X509.Semantic.Chain.Builder.html#10055" class="Bound">x</a> <a id="10057" class="Symbol">→</a> <a id="10059" href="Armor.Data.X509.Semantic.Chain.Builder.html#10055" class="Bound">x</a> <a id="10061" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="10063" href="Armor.Data.X509.Semantic.Chain.Builder.html#9054" class="Bound">otherIssuers</a> <a id="10076" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="10078" class="Symbol">(</a><a id="10079" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="10082" href="Armor.Data.X509.Semantic.Chain.Builder.html#9110" class="Bound">issuer</a><a id="10088" class="Symbol">)</a> <a id="10090" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="10092" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="10098" href="Armor.Data.X509.Semantic.Chain.Builder.html#10055" class="Bound">x</a><a id="10099" class="Symbol">)</a>
                   <a id="10120" class="Symbol">→</a> <a id="10122" href="Agda.Builtin.Sigma.html#166" class="Record">Σ</a> <a id="10124" class="Symbol">(</a><a id="10125" href="Armor.Data.X509.Semantic.Chain.Builder.html#9110" class="Bound">issuer</a> <a id="10132" href="Armor.Data.X509.Semantic.Chain.TCB.html#623" class="Function Operator">IsIssuerFor</a> <a id="10144" href="Armor.Data.X509.Semantic.Chain.Builder.html#9012" class="Bound">endEnt</a> <a id="10151" href="Armor.Data.X509.Semantic.Chain.TCB.html#623" class="Function Operator">In</a> <a id="10154" href="Armor.Data.X509.Semantic.Chain.Builder.html#8988" class="Bound">candidates</a><a id="10164" class="Symbol">)</a> <a id="10166" class="Symbol">λ</a> <a id="10168" href="Armor.Data.X509.Semantic.Chain.Builder.html#10168" class="Bound">isIssIn</a> <a id="10176" class="Symbol">→</a> <a id="10178" class="Symbol">((</a><a id="10180" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="10183" href="Armor.Data.X509.Semantic.Chain.Builder.html#9110" class="Bound">issuer</a><a id="10189" class="Symbol">)</a> <a id="10191" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10193" href="Armor.Data.X509.Semantic.Chain.Builder.html#10168" class="Bound">isIssIn</a><a id="10200" class="Symbol">)</a> <a id="10202" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="10204" href="Armor.Data.X509.Semantic.Chain.Builder.html#9054" class="Bound">otherIssuers</a>
  <a id="10219" href="Armor.Data.X509.Semantic.Chain.Builder.html#10033" class="Function">isIssuer×isInF</a> <a id="10234" class="Symbol">((_</a> <a id="10238" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10240" href="Armor.Data.X509.Semantic.Chain.Builder.html#10240" class="Bound">ret</a><a id="10243" class="Symbol">)</a> <a id="10245" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10247" href="Armor.Data.X509.Semantic.Chain.Builder.html#10247" class="Bound">x∈otherIssuers</a> <a id="10262" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10264" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="10268" class="Symbol">)</a> <a id="10270" class="Symbol">=</a> <a id="10272" href="Armor.Data.X509.Semantic.Chain.Builder.html#10240" class="Bound">ret</a> <a id="10276" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="10278" href="Armor.Data.X509.Semantic.Chain.Builder.html#10247" class="Bound">x∈otherIssuers</a>

<a id="toChainsComplete"></a><a id="10294" href="Armor.Data.X509.Semantic.Chain.Builder.html#10294" class="Function">toChainsComplete</a>
  <a id="10313" class="Symbol">:</a> <a id="10315" class="Symbol">∀</a> <a id="10317" class="Symbol">(</a><a id="10318" href="Armor.Data.X509.Semantic.Chain.Builder.html#10318" class="Bound">trustedRoot</a> <a id="10330" href="Armor.Data.X509.Semantic.Chain.Builder.html#10330" class="Bound">candidates</a> <a id="10341" class="Symbol">:</a> <a id="10343" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="10348" class="Symbol">(</a><a id="10349" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="10357" class="Symbol">_</a> <a id="10359" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="10363" class="Symbol">))</a>
    <a id="10370" class="Symbol">→</a> <a id="10372" class="Symbol">∀</a> <a id="10374" class="Symbol">{@</a><a id="10376" class="Symbol">0</a> <a id="10378" href="Armor.Data.X509.Semantic.Chain.Builder.html#10378" class="Bound">bs</a><a id="10380" class="Symbol">}</a> <a id="10382" class="Symbol">(</a><a id="10383" href="Armor.Data.X509.Semantic.Chain.Builder.html#10383" class="Bound">issuee</a> <a id="10390" class="Symbol">:</a> <a id="10392" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="10397" href="Armor.Data.X509.Semantic.Chain.Builder.html#10378" class="Bound">bs</a><a id="10399" class="Symbol">)</a>
    <a id="10405" class="Symbol">→</a> <a id="10407" class="Symbol">(</a><a id="10408" href="Armor.Data.X509.Semantic.Chain.Builder.html#10408" class="Bound">tr</a> <a id="10411" class="Symbol">:</a> <a id="10413" href="Armor.Data.X509.Semantic.Chain.Builder.html#683" class="Record">TrustTree</a> <a id="10423" href="Armor.Data.X509.Semantic.Chain.Builder.html#10318" class="Bound">trustedRoot</a> <a id="10435" href="Armor.Data.X509.Semantic.Chain.Builder.html#10330" class="Bound">candidates</a> <a id="10446" href="Armor.Data.X509.Semantic.Chain.Builder.html#10383" class="Bound">issuee</a><a id="10452" class="Symbol">)</a>
    <a id="10458" class="Symbol">→</a> <a id="10460" class="Symbol">(</a><a id="10461" href="Armor.Data.X509.Semantic.Chain.Builder.html#10461" class="Bound">c</a> <a id="10463" class="Symbol">:</a> <a id="10465" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="10471" href="Armor.Data.X509.Semantic.Chain.Builder.html#10318" class="Bound">trustedRoot</a> <a id="10483" href="Armor.Data.X509.Semantic.Chain.Builder.html#10330" class="Bound">candidates</a> <a id="10494" href="Armor.Data.X509.Semantic.Chain.Builder.html#10383" class="Bound">issuee</a><a id="10500" class="Symbol">)</a>
    <a id="10506" class="Symbol">→</a> <a id="10508" href="Armor.Prelude.html#1624" class="Function">Any</a> <a id="10512" class="Symbol">(</a><a id="10513" href="Armor.Data.X509.Semantic.Chain.Builder.html#10461" class="Bound">c</a> <a id="10515" href="Armor.Data.X509.Semantic.Chain.TCB.html#7302" class="Function Operator">≡Chain_</a><a id="10522" class="Symbol">)</a> <a id="10524" class="Symbol">(</a><a id="10525" href="Armor.Data.X509.Semantic.Chain.Builder.html#5918" class="Function">toChains</a> <a id="10534" class="Symbol">_</a> <a id="10536" class="Symbol">_</a> <a id="10538" class="Symbol">_</a> <a id="10540" href="Armor.Data.X509.Semantic.Chain.Builder.html#10408" class="Bound">tr</a><a id="10542" class="Symbol">)</a>
<a id="10544" href="Armor.Data.X509.Semantic.Chain.Builder.html#10294" class="Function">toChainsComplete</a> <a id="10561" href="Armor.Data.X509.Semantic.Chain.Builder.html#10561" class="Bound">trust</a> <a id="10567" href="Armor.Data.X509.Semantic.Chain.Builder.html#10567" class="Bound">candidates</a> <a id="10578" href="Armor.Data.X509.Semantic.Chain.Builder.html#10578" class="Bound">issuee</a> <a id="10585" class="Symbol">=</a>
  <a id="10589" href="Armor.Data.X509.Semantic.Chain.Builder.html#7185" class="Function">toChainsCompleteWF</a> <a id="10608" href="Armor.Data.X509.Semantic.Chain.Builder.html#10561" class="Bound">trust</a> <a id="10614" href="Armor.Data.X509.Semantic.Chain.Builder.html#10567" class="Bound">candidates</a> <a id="10625" href="Armor.Data.X509.Semantic.Chain.Builder.html#10578" class="Bound">issuee</a> <a id="10632" class="Symbol">(</a><a id="10633" href="Data.Nat.Induction.html#2302" class="Function">&lt;-wellFounded</a> <a id="10647" class="Symbol">_)</a>
  <a id="10652" class="Keyword">where</a>
  <a id="10660" class="Keyword">open</a> <a id="10665" class="Keyword">import</a> <a id="10672" href="Data.Nat.Induction.html" class="Module">Data.Nat.Induction</a>

<a id="buildChainsComplete"></a><a id="10692" href="Armor.Data.X509.Semantic.Chain.Builder.html#10692" class="Function">buildChainsComplete</a> <a id="10712" class="Symbol">:</a> <a id="10714" class="Symbol">∀</a> <a id="10716" href="Armor.Data.X509.Semantic.Chain.Builder.html#10716" class="Bound">trust</a> <a id="10722" href="Armor.Data.X509.Semantic.Chain.Builder.html#10722" class="Bound">candidates</a> <a id="10733" class="Symbol">{@</a><a id="10735" class="Symbol">0</a> <a id="10737" href="Armor.Data.X509.Semantic.Chain.Builder.html#10737" class="Bound">bs</a><a id="10739" class="Symbol">}</a> <a id="10741" class="Symbol">(</a><a id="10742" href="Armor.Data.X509.Semantic.Chain.Builder.html#10742" class="Bound">issuee</a> <a id="10749" class="Symbol">:</a> <a id="10751" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="10756" href="Armor.Data.X509.Semantic.Chain.Builder.html#10737" class="Bound">bs</a><a id="10758" class="Symbol">)</a> <a id="10760" class="Symbol">→</a> <a id="10762" class="Symbol">(</a><a id="10763" href="Armor.Data.X509.Semantic.Chain.Builder.html#10763" class="Bound">c</a> <a id="10765" class="Symbol">:</a> <a id="10767" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="10773" href="Armor.Data.X509.Semantic.Chain.Builder.html#10716" class="Bound">trust</a> <a id="10779" href="Armor.Data.X509.Semantic.Chain.Builder.html#10722" class="Bound">candidates</a> <a id="10790" href="Armor.Data.X509.Semantic.Chain.Builder.html#10742" class="Bound">issuee</a><a id="10796" class="Symbol">)</a>
                      <a id="10820" class="Symbol">→</a> <a id="10822" href="Armor.Prelude.html#1624" class="Function">Any</a> <a id="10826" class="Symbol">(</a><a id="10827" href="Armor.Data.X509.Semantic.Chain.Builder.html#10763" class="Bound">c</a> <a id="10829" href="Armor.Data.X509.Semantic.Chain.TCB.html#7302" class="Function Operator">≡Chain_</a><a id="10836" class="Symbol">)</a> <a id="10838" class="Symbol">(</a><a id="10839" href="Armor.Data.X509.Semantic.Chain.Builder.html#6264" class="Function">buildChains</a> <a id="10851" href="Armor.Data.X509.Semantic.Chain.Builder.html#10716" class="Bound">trust</a> <a id="10857" href="Armor.Data.X509.Semantic.Chain.Builder.html#10722" class="Bound">candidates</a> <a id="10868" href="Armor.Data.X509.Semantic.Chain.Builder.html#10742" class="Bound">issuee</a><a id="10874" class="Symbol">)</a>
<a id="10876" href="Armor.Data.X509.Semantic.Chain.Builder.html#10692" class="Function">buildChainsComplete</a> <a id="10896" href="Armor.Data.X509.Semantic.Chain.Builder.html#10896" class="Bound">trust</a> <a id="10902" href="Armor.Data.X509.Semantic.Chain.Builder.html#10902" class="Bound">candidates</a> <a id="10913" href="Armor.Data.X509.Semantic.Chain.Builder.html#10913" class="Bound">issuee</a> <a id="10920" class="Symbol">=</a>
  <a id="10924" href="Armor.Data.X509.Semantic.Chain.Builder.html#10294" class="Function">toChainsComplete</a> <a id="10941" href="Armor.Data.X509.Semantic.Chain.Builder.html#10896" class="Bound">trust</a> <a id="10947" href="Armor.Data.X509.Semantic.Chain.Builder.html#10902" class="Bound">candidates</a> <a id="10958" href="Armor.Data.X509.Semantic.Chain.Builder.html#10913" class="Bound">issuee</a> <a id="10965" class="Symbol">(</a><a id="10966" href="Armor.Data.X509.Semantic.Chain.Builder.html#4563" class="Function">buildTrustTree</a> <a id="10981" href="Armor.Data.X509.Semantic.Chain.Builder.html#10896" class="Bound">trust</a> <a id="10987" href="Armor.Data.X509.Semantic.Chain.Builder.html#10902" class="Bound">candidates</a> <a id="10998" href="Armor.Data.X509.Semantic.Chain.Builder.html#10913" class="Bound">issuee</a><a id="11004" class="Symbol">)</a>
</pre></body></html>