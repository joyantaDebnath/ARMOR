<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.PublicKey.Val.TCB</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Armor.Data.X509.PublicKey.Alg.TCB.html" class="Module">Armor.Data.X509.PublicKey.Alg.TCB</a> <a id="72" class="Symbol">as</a> <a id="75" class="Module">Alg</a>
  <a id="81" class="Keyword">hiding</a> <a id="88" class="Symbol">(</a><a id="89" href="Armor.Data.X509.PublicKey.Alg.TCB.html#2118" class="Function">getOID</a><a id="95" class="Symbol">)</a>
<a id="97" class="Keyword">import</a>      <a id="109" href="Armor.Data.X509.PublicKey.Alg.TCB.OIDs.html" class="Module">Armor.Data.X509.PublicKey.Alg.TCB.OIDs</a> <a id="148" class="Symbol">as</a> <a id="151" class="Module">OIDs</a>
<a id="156" class="Keyword">open</a> <a id="161" class="Keyword">import</a> <a id="168" href="Armor.Data.X509.PublicKey.Val.EC.TCB.html" class="Module">Armor.Data.X509.PublicKey.Val.EC.TCB</a>
<a id="205" class="Keyword">open</a> <a id="210" class="Keyword">import</a> <a id="217" href="Armor.Data.X509.PublicKey.Val.RSA.TCB.html" class="Module">Armor.Data.X509.PublicKey.Val.RSA.TCB</a>
<a id="255" class="Keyword">open</a> <a id="260" class="Keyword">import</a> <a id="267" href="Armor.Data.X690-DER.BitString.TCB.html" class="Module">Armor.Data.X690-DER.BitString.TCB</a>
<a id="301" class="Keyword">open</a> <a id="306" class="Keyword">import</a> <a id="313" href="Armor.Data.X690-DER.OID.html" class="Module">Armor.Data.X690-DER.OID</a>
<a id="337" class="Keyword">open</a> <a id="342" class="Keyword">import</a> <a id="349" href="Armor.Data.X690-DER.TLV.TCB.html" class="Module">Armor.Data.X690-DER.TLV.TCB</a>
<a id="377" class="Keyword">import</a>      <a id="389" href="Armor.Grammar.Definitions.NonMalleable.html" class="Module">Armor.Grammar.Definitions.NonMalleable</a>
<a id="428" class="Keyword">import</a>      <a id="440" href="Armor.Grammar.Sum.TCB.html" class="Module">Armor.Grammar.Sum.TCB</a>
<a id="462" class="Keyword">open</a> <a id="467" class="Keyword">import</a> <a id="474" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="489" class="Keyword">module</a> <a id="496" href="Armor.Data.X509.PublicKey.Val.TCB.html" class="Module">Armor.Data.X509.PublicKey.Val.TCB</a> <a id="530" class="Keyword">where</a>

<a id="537" class="Keyword">open</a> <a id="542" href="Armor.Grammar.Definitions.NonMalleable.html" class="Module">Armor.Grammar.Definitions.NonMalleable</a> <a id="581" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="587" class="Keyword">open</a> <a id="592" href="Armor.Grammar.Sum.TCB.html" class="Module">Armor.Grammar.Sum.TCB</a>                  <a id="631" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>

<a id="PublicKeyVal&#39;"></a><a id="638" href="Armor.Data.X509.PublicKey.Val.TCB.html#638" class="Function">PublicKeyVal&#39;</a> <a id="652" class="Symbol">:</a> <a id="654" class="Symbol">∀</a> <a id="656" class="Symbol">{@</a><a id="658" class="Symbol">0</a> <a id="660" href="Armor.Data.X509.PublicKey.Val.TCB.html#660" class="Bound">bs₁</a><a id="663" class="Symbol">}</a> <a id="665" class="Symbol">→</a> <a id="667" class="Symbol">(</a><a id="668" href="Armor.Data.X509.PublicKey.Val.TCB.html#668" class="Bound">a</a> <a id="670" class="Symbol">:</a> <a id="672" href="Armor.Data.X509.PublicKey.Alg.TCB.html#1955" class="Function">PublicKeyAlg</a> <a id="685" href="Armor.Data.X509.PublicKey.Val.TCB.html#660" class="Bound">bs₁</a><a id="688" class="Symbol">)</a> <a id="690" class="Symbol">→</a> <a id="692" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="696" class="Symbol">((</a><a id="698" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="701" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="709" class="Symbol">(</a><a id="710" href="Armor.Data.X509.PublicKey.Alg.TCB.html#2118" class="Function">Alg.getOID</a> <a id="721" href="Armor.Data.X509.PublicKey.Val.TCB.html#668" class="Bound">a</a><a id="722" class="Symbol">))</a> <a id="725" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="727" href="Armor.Data.X509.PublicKey.Alg.TCB.OIDs.html#2392" class="Function">OIDs.Supported</a><a id="741" class="Symbol">)</a> <a id="743" class="Symbol">→</a> <a id="745" class="Symbol">@</a><a id="746" class="Symbol">0</a> <a id="748" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="753" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="759" class="Symbol">→</a> <a id="761" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="765" href="Armor.Data.X509.PublicKey.Val.TCB.html#638" class="Function">PublicKeyVal&#39;</a> <a id="779" href="Armor.Data.X509.PublicKey.Val.TCB.html#779" class="Bound">a</a> <a id="781" class="Symbol">(</a><a id="782" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="785" href="Armor.Data.X509.PublicKey.Val.TCB.html#785" class="Bound">¬p</a><a id="787" class="Symbol">)</a> <a id="789" class="Symbol">=</a> <a id="791" href="Armor.Data.X690-DER.BitString.TCB.html#2664" class="Function">BitString</a>
<a id="801" href="Armor.Data.X509.PublicKey.Val.TCB.html#638" class="Function">PublicKeyVal&#39;</a> <a id="815" href="Armor.Data.X509.PublicKey.Val.TCB.html#815" class="Bound">a</a> <a id="817" class="Symbol">(</a><a id="818" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="822" class="Symbol">(</a><a id="823" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="828" href="Armor.Data.X509.PublicKey.Val.TCB.html#828" class="Bound">px</a><a id="830" class="Symbol">))</a> <a id="833" class="Symbol">=</a> <a id="835" href="Armor.Data.X509.PublicKey.Val.RSA.TCB.html#1406" class="Function">RSABitString</a>
<a id="848" href="Armor.Data.X509.PublicKey.Val.TCB.html#638" class="Function">PublicKeyVal&#39;</a> <a id="862" href="Armor.Data.X509.PublicKey.Val.TCB.html#862" class="Bound">a</a> <a id="864" class="Symbol">(</a><a id="865" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="869" class="Symbol">(</a><a id="870" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a> <a id="876" class="Symbol">(</a><a id="877" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="882" href="Armor.Data.X509.PublicKey.Val.TCB.html#882" class="Bound">px</a><a id="884" class="Symbol">)))</a> <a id="888" class="Symbol">=</a> <a id="890" href="Armor.Data.X509.PublicKey.Val.EC.TCB.html#1424" class="Function">ECBitString</a>

<a id="PublicKeyVal"></a><a id="903" href="Armor.Data.X509.PublicKey.Val.TCB.html#903" class="Function">PublicKeyVal</a> <a id="916" class="Symbol">:</a> <a id="918" class="Symbol">∀</a> <a id="920" class="Symbol">{@</a><a id="922" class="Symbol">0</a> <a id="924" href="Armor.Data.X509.PublicKey.Val.TCB.html#924" class="Bound">bs₁</a><a id="927" class="Symbol">}</a> <a id="929" class="Symbol">→</a> <a id="931" class="Symbol">(</a><a id="932" href="Armor.Data.X509.PublicKey.Val.TCB.html#932" class="Bound">a</a> <a id="934" class="Symbol">:</a> <a id="936" href="Armor.Data.X509.PublicKey.Alg.TCB.html#1955" class="Function">PublicKeyAlg</a> <a id="949" href="Armor.Data.X509.PublicKey.Val.TCB.html#924" class="Bound">bs₁</a><a id="952" class="Symbol">)</a> <a id="954" class="Symbol">→</a> <a id="956" class="Symbol">@</a><a id="957" class="Symbol">0</a> <a id="959" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="964" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="970" class="Symbol">→</a> <a id="972" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="976" href="Armor.Data.X509.PublicKey.Val.TCB.html#903" class="Function">PublicKeyVal</a> <a id="989" href="Armor.Data.X509.PublicKey.Val.TCB.html#989" class="Bound">a</a> <a id="991" class="Symbol">=</a> <a id="993" href="Armor.Data.X509.PublicKey.Val.TCB.html#638" class="Function">PublicKeyVal&#39;</a> <a id="1007" href="Armor.Data.X509.PublicKey.Val.TCB.html#989" class="Bound">a</a> <a id="1009" class="Symbol">((</a><a id="1011" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="1014" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="1022" class="Symbol">(</a><a id="1023" href="Armor.Data.X509.PublicKey.Alg.TCB.html#2118" class="Function">Alg.getOID</a> <a id="1034" href="Armor.Data.X509.PublicKey.Val.TCB.html#989" class="Bound">a</a><a id="1035" class="Symbol">))</a> <a id="1038" href="Armor.Prelude.html#11173" class="Function Operator">∈?</a> <a id="1041" href="Armor.Data.X509.PublicKey.Alg.TCB.OIDs.html#2392" class="Function">OIDs.Supported</a><a id="1055" class="Symbol">)</a>

<a id="RawPublicKeyVal“"></a><a id="1058" href="Armor.Data.X509.PublicKey.Val.TCB.html#1058" class="Function">RawPublicKeyVal“</a> <a id="1075" class="Symbol">:</a> <a id="1077" href="Armor.Grammar.Definitions.NonMalleable.Base.html#125" class="Record">Raw</a> <a id="1081" class="Symbol">(</a><a id="1082" href="Armor.Grammar.Sum.TCB.html#177" class="Datatype">Sum</a> <a id="1086" href="Armor.Data.X690-DER.BitString.TCB.html#2664" class="Function">BitString</a> <a id="1096" class="Symbol">(</a><a id="1097" href="Armor.Grammar.Sum.TCB.html#177" class="Datatype">Sum</a> <a id="1101" href="Armor.Data.X509.PublicKey.Val.RSA.TCB.html#1406" class="Function">RSABitString</a> <a id="1114" href="Armor.Data.X509.PublicKey.Val.EC.TCB.html#1424" class="Function">ECBitString</a><a id="1125" class="Symbol">))</a>
<a id="1128" href="Armor.Data.X509.PublicKey.Val.TCB.html#1058" class="Function">RawPublicKeyVal“</a> <a id="1145" class="Symbol">=</a> <a id="1147" href="Armor.Grammar.Sum.TCB.html#289" class="Function">RawSum</a> <a id="1154" href="Armor.Data.X690-DER.BitString.TCB.html#2870" class="Function">RawBitString</a> <a id="1167" class="Symbol">(</a><a id="1168" href="Armor.Grammar.Sum.TCB.html#289" class="Function">RawSum</a> <a id="1175" href="Armor.Data.X509.PublicKey.Val.RSA.TCB.html#1500" class="Function">RawRSABitString</a> <a id="1191" href="Armor.Data.X509.PublicKey.Val.EC.TCB.html#1508" class="Function">RawECBitString</a><a id="1205" class="Symbol">)</a>

<a id="RawPublicKeyVal"></a><a id="1208" href="Armor.Data.X509.PublicKey.Val.TCB.html#1208" class="Function">RawPublicKeyVal</a> <a id="1224" class="Symbol">:</a> <a id="1226" href="Armor.Grammar.Definitions.NonMalleable.Base.html#229" class="Record">Raw₁</a> <a id="1231" href="Armor.Data.X509.PublicKey.Alg.TCB.html#2032" class="Function">RawPublicKeyAlg</a> <a id="1247" href="Armor.Data.X509.PublicKey.Val.TCB.html#903" class="Function">PublicKeyVal</a>
<a id="toRawPublicKeyVal"></a><a id="1260" href="Armor.Data.X509.PublicKey.Val.TCB.html#1260" class="Function">toRawPublicKeyVal</a> <a id="1278" class="Symbol">:</a> <a id="1280" class="Symbol">∀</a> <a id="1282" class="Symbol">{@</a><a id="1284" class="Symbol">0</a> <a id="1286" href="Armor.Data.X509.PublicKey.Val.TCB.html#1286" class="Bound">bs₁</a><a id="1289" class="Symbol">}</a> <a id="1291" class="Symbol">→</a> <a id="1293" class="Symbol">(</a><a id="1294" href="Armor.Data.X509.PublicKey.Val.TCB.html#1294" class="Bound">a</a> <a id="1296" class="Symbol">:</a> <a id="1298" href="Armor.Data.X509.PublicKey.Alg.TCB.html#1955" class="Function">PublicKeyAlg</a> <a id="1311" href="Armor.Data.X509.PublicKey.Val.TCB.html#1286" class="Bound">bs₁</a><a id="1314" class="Symbol">)</a> <a id="1316" class="Symbol">→</a> <a id="1318" class="Symbol">(</a><a id="1319" href="Armor.Data.X509.PublicKey.Val.TCB.html#1319" class="Bound">o∈?</a> <a id="1323" class="Symbol">:</a> <a id="1325" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="1329" class="Symbol">((</a><a id="1331" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="1334" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="1342" class="Symbol">(</a><a id="1343" href="Armor.Data.X509.PublicKey.Alg.TCB.html#2118" class="Function">Alg.getOID</a> <a id="1354" href="Armor.Data.X509.PublicKey.Val.TCB.html#1294" class="Bound">a</a><a id="1355" class="Symbol">))</a> <a id="1358" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="1360" href="Armor.Data.X509.PublicKey.Alg.TCB.OIDs.html#2392" class="Function">OIDs.Supported</a><a id="1374" class="Symbol">))</a>
                    <a id="1397" class="Symbol">→</a> <a id="1399" class="Symbol">∀</a> <a id="1401" class="Symbol">{@</a><a id="1403" class="Symbol">0</a> <a id="1405" href="Armor.Data.X509.PublicKey.Val.TCB.html#1405" class="Bound">bs₂</a><a id="1408" class="Symbol">}</a> <a id="1410" class="Symbol">→</a> <a id="1412" href="Armor.Data.X509.PublicKey.Val.TCB.html#638" class="Function">PublicKeyVal&#39;</a> <a id="1426" href="Armor.Data.X509.PublicKey.Val.TCB.html#1294" class="Bound">a</a> <a id="1428" href="Armor.Data.X509.PublicKey.Val.TCB.html#1319" class="Bound">o∈?</a> <a id="1432" href="Armor.Data.X509.PublicKey.Val.TCB.html#1405" class="Bound">bs₂</a> <a id="1436" class="Symbol">→</a> <a id="1438" href="Armor.Grammar.Definitions.NonMalleable.Base.html#341" class="Field">Raw₁.D</a> <a id="1445" href="Armor.Data.X509.PublicKey.Val.TCB.html#1208" class="Function">RawPublicKeyVal</a> <a id="1461" class="Symbol">(</a><a id="1462" href="Armor.Grammar.Definitions.NonMalleable.Base.html#188" class="Field">Raw.to</a> <a id="1469" href="Armor.Data.X509.PublicKey.Alg.TCB.html#2032" class="Function">RawPublicKeyAlg</a> <a id="1485" href="Armor.Data.X509.PublicKey.Val.TCB.html#1294" class="Bound">a</a><a id="1486" class="Symbol">)</a>

<a id="1489" href="Armor.Grammar.Definitions.NonMalleable.Base.html#341" class="Field">Raw₁.D</a> <a id="1496" href="Armor.Data.X509.PublicKey.Val.TCB.html#1208" class="Function">RawPublicKeyVal</a> <a id="1512" href="Armor.Data.X509.PublicKey.Val.TCB.html#1512" class="Bound">o</a> <a id="1514" class="Symbol">=</a> <a id="1516" href="Armor.Grammar.Definitions.NonMalleable.Base.html#176" class="Field">Raw.D</a> <a id="1522" href="Armor.Data.X509.PublicKey.Val.TCB.html#1058" class="Function">RawPublicKeyVal“</a>
<a id="1539" href="Armor.Grammar.Definitions.NonMalleable.Base.html#363" class="Field">Raw₁.to</a> <a id="1547" href="Armor.Data.X509.PublicKey.Val.TCB.html#1208" class="Function">RawPublicKeyVal</a> <a id="1563" href="Armor.Data.X509.PublicKey.Val.TCB.html#1563" class="Bound">o</a> <a id="1565" href="Armor.Data.X509.PublicKey.Val.TCB.html#1565" class="Bound">p</a> <a id="1567" class="Symbol">=</a> <a id="1569" href="Armor.Data.X509.PublicKey.Val.TCB.html#1260" class="Function">toRawPublicKeyVal</a> <a id="1587" href="Armor.Data.X509.PublicKey.Val.TCB.html#1563" class="Bound">o</a> <a id="1589" class="Symbol">((</a><a id="1591" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="1594" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="1602" class="Symbol">(</a><a id="1603" href="Armor.Data.X509.PublicKey.Alg.TCB.html#2118" class="Function">Alg.getOID</a> <a id="1614" href="Armor.Data.X509.PublicKey.Val.TCB.html#1563" class="Bound">o</a><a id="1615" class="Symbol">))</a> <a id="1618" href="Armor.Prelude.html#11173" class="Function Operator">∈?</a> <a id="1621" href="Armor.Data.X509.PublicKey.Alg.TCB.OIDs.html#2392" class="Function">OIDs.Supported</a><a id="1635" class="Symbol">)</a> <a id="1637" href="Armor.Data.X509.PublicKey.Val.TCB.html#1565" class="Bound">p</a>

<a id="1640" href="Armor.Data.X509.PublicKey.Val.TCB.html#1260" class="Function">toRawPublicKeyVal</a> <a id="1658" href="Armor.Data.X509.PublicKey.Val.TCB.html#1658" class="Bound">a</a> <a id="1660" class="Symbol">(</a><a id="1661" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1664" href="Armor.Data.X509.PublicKey.Val.TCB.html#1664" class="Bound">¬p</a><a id="1666" class="Symbol">)</a> <a id="1668" href="Armor.Data.X509.PublicKey.Val.TCB.html#1668" class="Bound">p</a> <a id="1670" class="Symbol">=</a> <a id="1672" href="Armor.Grammar.Definitions.NonMalleable.Base.html#188" class="Field">Raw.to</a> <a id="1679" href="Armor.Data.X509.PublicKey.Val.TCB.html#1058" class="Function">RawPublicKeyVal“</a> <a id="1696" class="Symbol">(</a><a id="1697" href="Armor.Grammar.Sum.TCB.html#236" class="InductiveConstructor">inj₁</a> <a id="1702" href="Armor.Data.X509.PublicKey.Val.TCB.html#1668" class="Bound">p</a><a id="1703" class="Symbol">)</a>
<a id="1705" href="Armor.Data.X509.PublicKey.Val.TCB.html#1260" class="Function">toRawPublicKeyVal</a> <a id="1723" href="Armor.Data.X509.PublicKey.Val.TCB.html#1723" class="Bound">a</a> <a id="1725" class="Symbol">(</a><a id="1726" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1730" class="Symbol">(</a><a id="1731" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="1736" href="Armor.Data.X509.PublicKey.Val.TCB.html#1736" class="Bound">px</a><a id="1738" class="Symbol">))</a> <a id="1741" href="Armor.Data.X509.PublicKey.Val.TCB.html#1741" class="Bound">p</a> <a id="1743" class="Symbol">=</a> <a id="1745" href="Armor.Grammar.Definitions.NonMalleable.Base.html#188" class="Field">Raw.to</a> <a id="1752" href="Armor.Data.X509.PublicKey.Val.TCB.html#1058" class="Function">RawPublicKeyVal“</a> <a id="1769" class="Symbol">(</a><a id="1770" href="Armor.Grammar.Sum.TCB.html#263" class="InductiveConstructor">inj₂</a> <a id="1775" class="Symbol">(</a><a id="1776" href="Armor.Grammar.Sum.TCB.html#236" class="InductiveConstructor">inj₁</a> <a id="1781" href="Armor.Data.X509.PublicKey.Val.TCB.html#1741" class="Bound">p</a><a id="1782" class="Symbol">))</a>
<a id="1785" href="Armor.Data.X509.PublicKey.Val.TCB.html#1260" class="Function">toRawPublicKeyVal</a> <a id="1803" href="Armor.Data.X509.PublicKey.Val.TCB.html#1803" class="Bound">a</a> <a id="1805" class="Symbol">(</a><a id="1806" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1810" class="Symbol">(</a><a id="1811" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a> <a id="1817" class="Symbol">(</a><a id="1818" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="1823" href="Armor.Data.X509.PublicKey.Val.TCB.html#1823" class="Bound">px</a><a id="1825" class="Symbol">)))</a> <a id="1829" href="Armor.Data.X509.PublicKey.Val.TCB.html#1829" class="Bound">p</a> <a id="1831" class="Symbol">=</a> <a id="1833" href="Armor.Grammar.Definitions.NonMalleable.Base.html#188" class="Field">Raw.to</a> <a id="1840" href="Armor.Data.X509.PublicKey.Val.TCB.html#1058" class="Function">RawPublicKeyVal“</a> <a id="1857" class="Symbol">(</a><a id="1858" href="Armor.Grammar.Sum.TCB.html#263" class="InductiveConstructor">inj₂</a> <a id="1863" class="Symbol">(</a><a id="1864" href="Armor.Grammar.Sum.TCB.html#263" class="InductiveConstructor">inj₂</a> <a id="1869" href="Armor.Data.X509.PublicKey.Val.TCB.html#1829" class="Bound">p</a><a id="1870" class="Symbol">))</a>
</pre></body></html>