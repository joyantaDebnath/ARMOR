<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.Semantic.Cert.R6</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Armor.Data.X509.html" class="Module">Armor.Data.X509</a>
<a id="54" class="Keyword">import</a>      <a id="66" href="Armor.Data.X509.Extension.TCB.OIDs.html" class="Module">Armor.Data.X509.Extension.TCB.OIDs</a> <a id="101" class="Symbol">as</a> <a id="104" class="Module">OIDs</a>
<a id="109" class="Keyword">open</a> <a id="114" class="Keyword">import</a> <a id="121" href="Armor.Data.X509.Semantic.Cert.Utils.html" class="Module">Armor.Data.X509.Semantic.Cert.Utils</a>
<a id="157" class="Keyword">import</a>      <a id="169" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a>
<a id="195" class="Keyword">import</a>      <a id="207" href="Armor.Grammar.Option.html" class="Module">Armor.Grammar.Option</a>
<a id="228" class="Keyword">open</a> <a id="233" class="Keyword">import</a> <a id="240" href="Armor.Grammar.IList.html" class="Module">Armor.Grammar.IList</a> <a id="260" class="Symbol">as</a> <a id="263" class="Module">IList</a>
<a id="269" class="Keyword">open</a> <a id="274" class="Keyword">import</a> <a id="281" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>
<a id="295" class="Keyword">import</a>      <a id="307" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="316" class="Symbol">as</a> <a id="319" class="Module">Sum</a>
<a id="323" class="Keyword">open</a> <a id="328" class="Keyword">import</a> <a id="335" href="Relation.Nullary.Implication.html" class="Module">Relation.Nullary.Implication</a>

<a id="365" class="Keyword">module</a> <a id="372" href="Armor.Data.X509.Semantic.Cert.R6.html" class="Module">Armor.Data.X509.Semantic.Cert.R6</a> <a id="405" class="Keyword">where</a>

<a id="412" class="Keyword">open</a> <a id="417" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a> <a id="443" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="449" class="Keyword">open</a> <a id="454" href="Armor.Grammar.Option.html" class="Module">Armor.Grammar.Option</a>      <a id="480" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>

<a id="487" class="Comment">-- https://datatracker.ietf.org/doc/html/rfc5280#section-4.1.2.8</a>
<a id="552" class="Comment">-- Unique Identifiers fields MUST only appear if the Version is 2 or 3.</a>
<a id="HasUniqueIdentifiers"></a><a id="624" href="Armor.Data.X509.Semantic.Cert.R6.html#624" class="Function">HasUniqueIdentifiers</a> <a id="645" class="Symbol">:</a> <a id="647" class="Symbol">∀</a> <a id="649" class="Symbol">{</a><a id="650" href="Armor.Data.X509.Semantic.Cert.R6.html#650" class="Bound">bs</a><a id="652" class="Symbol">}</a> <a id="654" class="Symbol">→</a> <a id="656" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="661" href="Armor.Data.X509.Semantic.Cert.R6.html#650" class="Bound">bs</a> <a id="664" class="Symbol">→</a> <a id="666" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="670" href="Armor.Data.X509.Semantic.Cert.R6.html#624" class="Function">HasUniqueIdentifiers</a> <a id="691" href="Armor.Data.X509.Semantic.Cert.R6.html#691" class="Bound">c</a> <a id="693" class="Symbol">=</a>
    <a id="699" class="Symbol">(</a><a id="700" href="Data.Product.html#1369" class="Function">∃</a> <a id="702" class="Symbol">λ</a> <a id="704" href="Armor.Data.X509.Semantic.Cert.R6.html#704" class="Bound">subUID</a> <a id="711" class="Symbol">→</a> <a id="713" href="Armor.Data.X509.Cert.TCB.html#7663" class="Function">Cert.getSubUID</a> <a id="728" href="Armor.Data.X509.Semantic.Cert.R6.html#691" class="Bound">c</a> <a id="730" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="732" href="Armor.Grammar.Option.TCB.html#255" class="InductiveConstructor">some</a> <a id="737" href="Armor.Data.X509.Semantic.Cert.R6.html#704" class="Bound">subUID</a><a id="743" class="Symbol">)</a>
  <a id="747" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="749" class="Symbol">(</a><a id="750" href="Data.Product.html#1369" class="Function">∃</a> <a id="752" class="Symbol">λ</a> <a id="754" href="Armor.Data.X509.Semantic.Cert.R6.html#754" class="Bound">issUID</a> <a id="761" class="Symbol">→</a> <a id="763" href="Armor.Data.X509.Cert.TCB.html#7517" class="Function">Cert.getIssUID</a> <a id="778" href="Armor.Data.X509.Semantic.Cert.R6.html#691" class="Bound">c</a> <a id="780" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="782" href="Armor.Grammar.Option.TCB.html#255" class="InductiveConstructor">some</a> <a id="787" href="Armor.Data.X509.Semantic.Cert.R6.html#754" class="Bound">issUID</a><a id="793" class="Symbol">)</a>

<a id="796" class="Comment">{- https://datatracker.ietf.org/doc/html/rfc5280#section-4.1.2.1
-- This field describes the version of the encoded certificate.  When
-- extensions are used, as expected in this profile, version MUST be 3
-- (value is 2).  If no extensions are present, but a UniqueIdentifier
-- is present, the version SHOULD be 2 (value is 1); however, the
-- version MAY be 3.  If only basic fields are present, the version
-- SHOULD be 1 (the value is omitted from the certificate as the default
-- value); however, the version MAY be 2 or 3.
--
-- Implementations SHOULD be prepared to accept any version certificate.
-- At a minimum, conforming implementations MUST recognize version 3
-- certificates.
--
-- Generation of version 2 certificates is not expected by
-- implementations based on this profile.
-}</a>
<a id="IsVersion2Or3"></a><a id="1596" href="Armor.Data.X509.Semantic.Cert.R6.html#1596" class="Function">IsVersion2Or3</a> <a id="1610" class="Symbol">:</a> <a id="1612" class="Symbol">∀</a> <a id="1614" class="Symbol">{</a><a id="1615" href="Armor.Data.X509.Semantic.Cert.R6.html#1615" class="Bound">bs</a><a id="1617" class="Symbol">}</a> <a id="1619" class="Symbol">→</a> <a id="1621" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="1626" href="Armor.Data.X509.Semantic.Cert.R6.html#1615" class="Bound">bs</a> <a id="1629" class="Symbol">→</a> <a id="1631" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1635" href="Armor.Data.X509.Semantic.Cert.R6.html#1596" class="Function">IsVersion2Or3</a> <a id="1649" href="Armor.Data.X509.Semantic.Cert.R6.html#1649" class="Bound">c</a> <a id="1651" class="Symbol">=</a> <a id="1653" href="Armor.Data.X509.Cert.TCB.html#5795" class="Function">Cert.getVersion</a> <a id="1669" href="Armor.Data.X509.Semantic.Cert.R6.html#1649" class="Bound">c</a> <a id="1671" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="1673" href="Armor.Data.X509.TBSCert.Version.TCB.html#1402" class="InductiveConstructor">TBSCert.v2</a> <a id="1684" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1686" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1688" href="Armor.Data.X509.TBSCert.Version.TCB.html#1405" class="InductiveConstructor">TBSCert.v3</a> <a id="1699" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="R6"></a><a id="1702" href="Armor.Data.X509.Semantic.Cert.R6.html#1702" class="Function">R6</a> <a id="1705" class="Symbol">:</a> <a id="1707" class="Symbol">∀</a> <a id="1709" class="Symbol">{</a><a id="1710" href="Armor.Data.X509.Semantic.Cert.R6.html#1710" class="Bound">bs</a><a id="1712" class="Symbol">}</a> <a id="1714" class="Symbol">→</a> <a id="1716" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="1721" href="Armor.Data.X509.Semantic.Cert.R6.html#1710" class="Bound">bs</a> <a id="1724" class="Symbol">→</a> <a id="1726" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1730" href="Armor.Data.X509.Semantic.Cert.R6.html#1702" class="Function">R6</a> <a id="1733" href="Armor.Data.X509.Semantic.Cert.R6.html#1733" class="Bound">c</a> <a id="1735" class="Symbol">=</a> <a id="1737" href="Armor.Data.X509.Semantic.Cert.R6.html#624" class="Function">HasUniqueIdentifiers</a> <a id="1758" href="Armor.Data.X509.Semantic.Cert.R6.html#1733" class="Bound">c</a> <a id="1760" class="Symbol">→</a> <a id="1762" href="Armor.Data.X509.Semantic.Cert.R6.html#1596" class="Function">IsVersion2Or3</a> <a id="1776" href="Armor.Data.X509.Semantic.Cert.R6.html#1733" class="Bound">c</a>

<a id="hasUniqueIdentifiers?"></a><a id="1779" href="Armor.Data.X509.Semantic.Cert.R6.html#1779" class="Function">hasUniqueIdentifiers?</a> <a id="1801" class="Symbol">:</a> <a id="1803" class="Symbol">∀</a> <a id="1805" class="Symbol">{@</a><a id="1807" class="Symbol">0</a> <a id="1809" href="Armor.Data.X509.Semantic.Cert.R6.html#1809" class="Bound">bs</a><a id="1811" class="Symbol">}</a> <a id="1813" class="Symbol">→</a> <a id="1815" class="Symbol">(</a><a id="1816" href="Armor.Data.X509.Semantic.Cert.R6.html#1816" class="Bound">c</a> <a id="1818" class="Symbol">:</a> <a id="1820" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="1825" href="Armor.Data.X509.Semantic.Cert.R6.html#1809" class="Bound">bs</a><a id="1827" class="Symbol">)</a> <a id="1829" class="Symbol">→</a> <a id="1831" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="1835" class="Symbol">(</a><a id="1836" href="Armor.Data.X509.Semantic.Cert.R6.html#624" class="Function">HasUniqueIdentifiers</a> <a id="1857" href="Armor.Data.X509.Semantic.Cert.R6.html#1816" class="Bound">c</a><a id="1858" class="Symbol">)</a>
<a id="1860" href="Armor.Data.X509.Semantic.Cert.R6.html#1779" class="Function">hasUniqueIdentifiers?</a> <a id="1882" href="Armor.Data.X509.Semantic.Cert.R6.html#1882" class="Bound">c</a> <a id="1884" class="Symbol">=</a>
  <a id="1888" href="Armor.Prelude.html#3493" class="Function Operator">case</a> <a id="1893" href="Armor.Data.X509.Cert.TCB.html#7663" class="Function">Cert.getSubUID</a> <a id="1908" href="Armor.Data.X509.Semantic.Cert.R6.html#1882" class="Bound">c</a> <a id="1910" href="Data.Product.html#1235" class="Function Operator">,′</a> <a id="1913" href="Armor.Data.X509.Cert.TCB.html#7517" class="Function">Cert.getIssUID</a> <a id="1928" href="Armor.Data.X509.Semantic.Cert.R6.html#1882" class="Bound">c</a>
  <a id="1932" href="Armor.Prelude.html#3493" class="Function Operator">ret</a> <a id="1936" class="Symbol">(λ</a> <a id="1939" class="Keyword">where</a> <a id="1945" class="Symbol">(</a><a id="1946" href="Armor.Data.X509.Semantic.Cert.R6.html#1946" class="Bound">s</a> <a id="1948" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1950" href="Armor.Data.X509.Semantic.Cert.R6.html#1950" class="Bound">i</a><a id="1951" class="Symbol">)</a> <a id="1953" class="Symbol">→</a> <a id="1955" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="1959" class="Symbol">((</a><a id="1961" href="Data.Product.html#1369" class="Function">∃</a> <a id="1963" class="Symbol">λ</a> <a id="1965" href="Armor.Data.X509.Semantic.Cert.R6.html#1965" class="Bound">subUID</a> <a id="1972" class="Symbol">→</a> <a id="1974" href="Armor.Data.X509.Semantic.Cert.R6.html#1946" class="Bound">s</a> <a id="1976" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1978" href="Armor.Grammar.Option.TCB.html#255" class="InductiveConstructor">some</a> <a id="1983" href="Armor.Data.X509.Semantic.Cert.R6.html#1965" class="Bound">subUID</a><a id="1989" class="Symbol">)</a> <a id="1991" href="Data.Sum.Base.html#734" class="Datatype Operator">⊎</a> <a id="1993" href="Data.Product.html#1369" class="Function">∃</a> <a id="1995" class="Symbol">λ</a> <a id="1997" href="Armor.Data.X509.Semantic.Cert.R6.html#1997" class="Bound">issUID</a> <a id="2004" class="Symbol">→</a> <a id="2006" href="Armor.Data.X509.Semantic.Cert.R6.html#1950" class="Bound">i</a> <a id="2008" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2010" href="Armor.Grammar.Option.TCB.html#255" class="InductiveConstructor">some</a> <a id="2015" href="Armor.Data.X509.Semantic.Cert.R6.html#1997" class="Bound">issUID</a><a id="2021" class="Symbol">))</a>
  <a id="2026" href="Armor.Prelude.html#3493" class="Function Operator">of</a> <a id="2029" class="Symbol">λ</a> <a id="2031" class="Keyword">where</a>
    <a id="2041" class="Symbol">(</a><a id="2042" href="Armor.Grammar.Option.TCB.html#255" class="InductiveConstructor">some</a> <a id="2047" href="Armor.Data.X509.Semantic.Cert.R6.html#2047" class="Bound">x</a> <a id="2049" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2051" href="Armor.Data.X509.Semantic.Cert.R6.html#2051" class="Bound">i</a><a id="2052" class="Symbol">)</a> <a id="2054" class="Symbol">→</a> <a id="2056" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2060" class="Symbol">(</a><a id="2061" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="2066" class="Symbol">(</a><a id="2067" href="Armor.Data.X509.Semantic.Cert.R6.html#2047" class="Bound">x</a> <a id="2069" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2071" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="2075" class="Symbol">))</a>
    <a id="2082" class="Symbol">(</a><a id="2083" href="Armor.Grammar.Option.TCB.html#235" class="InductiveConstructor">none</a> <a id="2088" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2090" href="Armor.Grammar.Option.TCB.html#255" class="InductiveConstructor">some</a> <a id="2095" href="Armor.Data.X509.Semantic.Cert.R6.html#2095" class="Bound">x</a><a id="2096" class="Symbol">)</a> <a id="2098" class="Symbol">→</a> <a id="2100" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="2104" class="Symbol">(</a><a id="2105" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="2110" class="Symbol">(</a><a id="2111" href="Armor.Data.X509.Semantic.Cert.R6.html#2095" class="Bound">x</a> <a id="2113" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2115" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="2119" class="Symbol">))</a>
    <a id="2126" class="Symbol">(</a><a id="2127" href="Armor.Grammar.Option.TCB.html#235" class="InductiveConstructor">none</a> <a id="2132" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2134" href="Armor.Grammar.Option.TCB.html#235" class="InductiveConstructor">none</a><a id="2138" class="Symbol">)</a> <a id="2140" class="Symbol">→</a> <a id="2142" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="2145" href="Data.Sum.Base.html#920" class="Function Operator">Sum.[</a> <a id="2151" class="Symbol">(λ</a> <a id="2154" class="Symbol">())</a> <a id="2158" href="Data.Sum.Base.html#920" class="Function Operator">,</a> <a id="2160" class="Symbol">(λ</a> <a id="2163" class="Symbol">())</a> <a id="2167" href="Data.Sum.Base.html#920" class="Function Operator">]</a>

<a id="isVersion2Or3?"></a><a id="2170" href="Armor.Data.X509.Semantic.Cert.R6.html#2170" class="Function">isVersion2Or3?</a> <a id="2185" class="Symbol">:</a> <a id="2187" class="Symbol">∀</a> <a id="2189" class="Symbol">{@</a><a id="2191" class="Symbol">0</a> <a id="2193" href="Armor.Data.X509.Semantic.Cert.R6.html#2193" class="Bound">bs</a><a id="2195" class="Symbol">}</a> <a id="2197" class="Symbol">→</a> <a id="2199" class="Symbol">(</a><a id="2200" href="Armor.Data.X509.Semantic.Cert.R6.html#2200" class="Bound">c</a> <a id="2202" class="Symbol">:</a> <a id="2204" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="2209" href="Armor.Data.X509.Semantic.Cert.R6.html#2193" class="Bound">bs</a><a id="2211" class="Symbol">)</a> <a id="2213" class="Symbol">→</a> <a id="2215" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="2219" class="Symbol">(</a><a id="2220" href="Armor.Data.X509.Semantic.Cert.R6.html#1596" class="Function">IsVersion2Or3</a> <a id="2234" href="Armor.Data.X509.Semantic.Cert.R6.html#2200" class="Bound">c</a><a id="2235" class="Symbol">)</a>
<a id="2237" href="Armor.Data.X509.Semantic.Cert.R6.html#2170" class="Function">isVersion2Or3?</a> <a id="2252" href="Armor.Data.X509.Semantic.Cert.R6.html#2252" class="Bound">c</a> <a id="2254" class="Symbol">=</a> <a id="2256" href="Armor.Data.X509.Cert.TCB.html#5795" class="Function">Cert.getVersion</a> <a id="2272" href="Armor.Data.X509.Semantic.Cert.R6.html#2252" class="Bound">c</a> <a id="2274" href="Armor.Prelude.html#11173" class="Function Operator">∈?</a> <a id="2277" class="Symbol">_</a>

<a id="r6"></a><a id="2280" href="Armor.Data.X509.Semantic.Cert.R6.html#2280" class="Function">r6</a> <a id="2283" class="Symbol">:</a> <a id="2285" class="Symbol">∀</a> <a id="2287" class="Symbol">{@</a><a id="2289" class="Symbol">0</a> <a id="2291" href="Armor.Data.X509.Semantic.Cert.R6.html#2291" class="Bound">bs</a><a id="2293" class="Symbol">}</a> <a id="2295" class="Symbol">→</a> <a id="2297" class="Symbol">(</a><a id="2298" href="Armor.Data.X509.Semantic.Cert.R6.html#2298" class="Bound">c</a> <a id="2300" class="Symbol">:</a> <a id="2302" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="2307" href="Armor.Data.X509.Semantic.Cert.R6.html#2291" class="Bound">bs</a><a id="2309" class="Symbol">)</a> <a id="2311" class="Symbol">→</a> <a id="2313" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="2317" class="Symbol">(</a><a id="2318" href="Armor.Data.X509.Semantic.Cert.R6.html#1702" class="Function">R6</a> <a id="2321" href="Armor.Data.X509.Semantic.Cert.R6.html#2298" class="Bound">c</a><a id="2322" class="Symbol">)</a>
<a id="2324" href="Armor.Data.X509.Semantic.Cert.R6.html#2280" class="Function">r6</a> <a id="2327" href="Armor.Data.X509.Semantic.Cert.R6.html#2327" class="Bound">c</a> <a id="2329" class="Symbol">=</a> <a id="2331" class="Symbol">(</a><a id="2332" href="Armor.Data.X509.Semantic.Cert.R6.html#1779" class="Function">hasUniqueIdentifiers?</a> <a id="2354" href="Armor.Data.X509.Semantic.Cert.R6.html#2327" class="Bound">c</a><a id="2355" class="Symbol">)</a> <a id="2357" href="Relation.Nullary.Implication.html#885" class="Function Operator">→-dec</a> <a id="2363" class="Symbol">(</a><a id="2364" href="Armor.Data.X509.Semantic.Cert.R6.html#2170" class="Function">isVersion2Or3?</a> <a id="2379" href="Armor.Data.X509.Semantic.Cert.R6.html#2327" class="Bound">c</a><a id="2380" class="Symbol">)</a>
</pre></body></html>