<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.Semantic.Chain.R23</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--sized-types</a> <a id="27" class="Symbol">#-}</a>

<a id="32" class="Keyword">open</a> <a id="37" class="Keyword">import</a> <a id="44" href="Armor.Data.X509.html" class="Module">Armor.Data.X509</a>
<a id="60" class="Keyword">open</a> <a id="65" class="Keyword">import</a> <a id="72" href="Armor.Data.X509.Semantic.Cert.Utils.html" class="Module">Armor.Data.X509.Semantic.Cert.Utils</a>
  <a id="110" class="Keyword">using</a> <a id="116" class="Symbol">(</a><a id="117" href="Armor.Data.X509.Semantic.Cert.Utils.html#578" class="Function">IsConfirmedCA</a> <a id="131" class="Symbol">;</a> <a id="133" href="Armor.Data.X509.Semantic.Cert.Utils.html#842" class="Function">isConfirmedCA?</a><a id="147" class="Symbol">)</a>
<a id="149" class="Keyword">open</a> <a id="154" class="Keyword">import</a> <a id="161" href="Armor.Data.X509.Semantic.Chain.TCB.html" class="Module">Armor.Data.X509.Semantic.Chain.TCB</a>
<a id="196" class="Keyword">open</a> <a id="201" class="Keyword">import</a> <a id="208" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="223" class="Keyword">module</a> <a id="230" href="Armor.Data.X509.Semantic.Chain.R23.html" class="Module">Armor.Data.X509.Semantic.Chain.R23</a> <a id="265" class="Keyword">where</a>

<a id="272" class="Comment">{- https://datatracker.ietf.org/doc/html/rfc5280#section-6.1.4
--    To prepare for processing of certificate i+1, perform the
--    following steps for certificate i:
--
--    ...
-- 
--    (k)  If certificate i is a version 3 certificate, verify that the
--         basicConstraints extension is present and that cA is set to
--         TRUE.  (If certificate i is a version 1 or version 2
--         certificate, then the application MUST either verify that
--         certificate i is a CA certificate through out-of-band means
--         or reject the certificate.  Conforming implementations may
--         choose to reject all version 1 and version 2 intermediate
--         certificates.)
-}</a>

<a id="973" class="Keyword">module</a> <a id="980" href="Armor.Data.X509.Semantic.Chain.R23.html#980" class="Module">_</a> <a id="982" class="Symbol">{</a><a id="983" href="Armor.Data.X509.Semantic.Chain.R23.html#983" class="Bound">trust</a> <a id="989" href="Armor.Data.X509.Semantic.Chain.R23.html#989" class="Bound">candidates</a> <a id="1000" class="Symbol">:</a> <a id="1002" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1007" class="Symbol">(</a><a id="1008" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="1016" class="Symbol">_</a> <a id="1018" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="1022" class="Symbol">)}</a> <a id="1025" class="Symbol">{@</a><a id="1027" class="Symbol">0</a> <a id="1029" href="Armor.Data.X509.Semantic.Chain.R23.html#1029" class="Bound">bs</a><a id="1031" class="Symbol">}</a> <a id="1033" class="Symbol">(</a><a id="1034" href="Armor.Data.X509.Semantic.Chain.R23.html#1034" class="Bound">issuee</a> <a id="1041" class="Symbol">:</a> <a id="1043" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="1048" href="Armor.Data.X509.Semantic.Chain.R23.html#1029" class="Bound">bs</a><a id="1050" class="Symbol">)</a> <a id="1052" class="Keyword">where</a>

  <a id="1061" href="Armor.Data.X509.Semantic.Chain.R23.html#1061" class="Function">R23</a> <a id="1065" class="Symbol">:</a> <a id="1067" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="1073" href="Armor.Data.X509.Semantic.Chain.R23.html#983" class="Bound">trust</a> <a id="1079" href="Armor.Data.X509.Semantic.Chain.R23.html#989" class="Bound">candidates</a> <a id="1090" href="Armor.Data.X509.Semantic.Chain.R23.html#1034" class="Bound">issuee</a> <a id="1097" class="Symbol">→</a> <a id="1099" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="1105" href="Armor.Data.X509.Semantic.Chain.R23.html#1061" class="Function">R23</a> <a id="1109" href="Armor.Data.X509.Semantic.Chain.R23.html#1109" class="Bound">c</a> <a id="1111" class="Symbol">=</a> <a id="1113" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="1117" class="Symbol">(</a><a id="1118" href="Armor.Data.X509.Semantic.Cert.Utils.html#578" class="Function">IsConfirmedCA</a> <a id="1132" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1134" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="1139" class="Symbol">)</a> <a id="1141" class="Symbol">(</a><a id="1142" href="Armor.Prelude.html#2309" class="Function">tailSafe</a> <a id="1151" class="Symbol">(</a><a id="1152" href="Armor.Data.X509.Semantic.Chain.TCB.html#5959" class="Function">toList</a> <a id="1159" href="Armor.Data.X509.Semantic.Chain.R23.html#1109" class="Bound">c</a><a id="1160" class="Symbol">)</a> <a id="1162" class="Symbol">(</a><a id="1163" href="Armor.Data.X509.Semantic.Chain.TCB.html#6830" class="Function">toListLength≥1</a> <a id="1178" href="Armor.Data.X509.Semantic.Chain.R23.html#1109" class="Bound">c</a><a id="1179" class="Symbol">))</a>

  <a id="1185" href="Armor.Data.X509.Semantic.Chain.R23.html#1185" class="Function">r23</a> <a id="1189" class="Symbol">:</a> <a id="1191" class="Symbol">(</a><a id="1192" href="Armor.Data.X509.Semantic.Chain.R23.html#1192" class="Bound">c</a> <a id="1194" class="Symbol">:</a> <a id="1196" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="1202" href="Armor.Data.X509.Semantic.Chain.R23.html#983" class="Bound">trust</a> <a id="1208" href="Armor.Data.X509.Semantic.Chain.R23.html#989" class="Bound">candidates</a> <a id="1219" href="Armor.Data.X509.Semantic.Chain.R23.html#1034" class="Bound">issuee</a><a id="1225" class="Symbol">)</a> <a id="1227" class="Symbol">→</a> <a id="1229" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="1233" class="Symbol">(</a><a id="1234" href="Armor.Data.X509.Semantic.Chain.R23.html#1061" class="Function">R23</a> <a id="1238" href="Armor.Data.X509.Semantic.Chain.R23.html#1192" class="Bound">c</a><a id="1239" class="Symbol">)</a>
  <a id="1243" href="Armor.Data.X509.Semantic.Chain.R23.html#1185" class="Function">r23</a> <a id="1247" href="Armor.Data.X509.Semantic.Chain.R23.html#1247" class="Bound">c</a> <a id="1249" class="Symbol">=</a> <a id="1251" href="Data.List.Relation.Unary.All.html#6240" class="Function">All.all?</a> <a id="1260" class="Symbol">(</a><a id="1261" href="Armor.Data.X509.Semantic.Cert.Utils.html#842" class="Function">isConfirmedCA?</a> <a id="1276" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1278" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a><a id="1283" class="Symbol">)</a> <a id="1285" class="Symbol">_</a>
</pre></body></html>