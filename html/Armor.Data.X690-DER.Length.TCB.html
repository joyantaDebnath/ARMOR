<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X690-DER.Length.TCB</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>
<a id="52" class="Keyword">import</a>      <a id="64" href="Armor.Grammar.Definitions.NonMalleable.html" class="Module">Armor.Grammar.Definitions.NonMalleable</a>
<a id="103" class="Keyword">import</a>      <a id="115" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="135" class="Symbol">as</a> <a id="138" class="Module">Nat</a>

<a id="143" class="Keyword">module</a> <a id="150" href="Armor.Data.X690-DER.Length.TCB.html" class="Module">Armor.Data.X690-DER.Length.TCB</a> <a id="181" class="Keyword">where</a>

<a id="188" class="Keyword">open</a> <a id="193" href="Armor.Grammar.Definitions.NonMalleable.html" class="Module">Armor.Grammar.Definitions.NonMalleable</a> <a id="232" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
  <a id="240" class="Keyword">using</a> <a id="246" class="Symbol">(</a><a id="247" href="Armor.Grammar.Definitions.NonMalleable.Base.html#125" class="Record">Raw</a><a id="250" class="Symbol">)</a>

<a id="253" class="Comment">-- https://www.itu.int/rec/T-REC-X.690-202102-I/en</a>
<a id="304" class="Comment">-- 10.1 Length forms</a>
<a id="325" class="Comment">-- The definite form of length encoding shall be used, encoded in the minimum number of octets. [Contrast with 8.1.3.2 b).]</a>
<a id="449" class="Comment">-- 8.1.3.3 For the definite form, the length octets shall consist of one or more octets, and shall represent the number of octets</a>
<a id="579" class="Comment">-- in the contents octets using either the short form (see 8.1.3.4) or the long form (see 8.1.3.5) as a sender&#39;s option.</a>
<a id="700" class="Comment">-- NOTE – The short form can only be used if the number of octets in the contents octets is less than or equal to 127.</a>
<a id="819" class="Comment">-- 8.1.3.4 In the short form, the length octets shall consist of a single octet in which bit 8 is zero and bits 7 to 1 encode the</a>
<a id="949" class="Comment">-- number of octets in the contents octets (which may be zero), as an unsigned binary integer with bit 7 as the most significant</a>
<a id="1078" class="Comment">-- bit.</a>
<a id="1086" class="Comment">-- 8.1.3.5 In the long form, the length octets shall consist of an initial octet and one or more subsequent octets. The initial</a>
<a id="1214" class="Comment">-- octet shall be encoded as follows:</a>
<a id="1252" class="Comment">-- a) bit 8 shall be one;</a>
<a id="1278" class="Comment">-- b) bits 7 to 1 shall encode the number of subsequent octets in the length octets, as an unsigned binary integer with</a>
<a id="1398" class="Comment">-- bit 7 as the most significant bit;</a>
<a id="1436" class="Comment">-- c) the value 111111112 shall not be used.</a>
<a id="1481" class="Comment">-- NOTE 1 – This restriction is introduced for possible future extension.</a>
<a id="1555" class="Comment">-- Bits 8 to 1 of the first subsequent octet, followed by bits 8 to 1 of the second subsequent octet, followed in turn by bits 8 to 1</a>
<a id="1689" class="Comment">-- of each further octet up to and including the last subsequent octet, shall be the encoding of an unsigned binary integer equal</a>
<a id="1819" class="Comment">-- to the number of octets in the contents octets, with bit 8 of the first subsequent octet as the most significant bit.</a>

<a id="1941" class="Keyword">record</a> <a id="Short"></a><a id="1948" href="Armor.Data.X690-DER.Length.TCB.html#1948" class="Record">Short</a> <a id="1954" class="Symbol">(@</a><a id="1956" class="Symbol">0</a> <a id="1958" href="Armor.Data.X690-DER.Length.TCB.html#1958" class="Bound">bs</a> <a id="1961" class="Symbol">:</a> <a id="1963" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1968" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="1973" class="Symbol">)</a> <a id="1975" class="Symbol">:</a> <a id="1977" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="1981" class="Keyword">where</a>
  <a id="1989" class="Keyword">constructor</a> <a id="mkShort"></a><a id="2001" href="Armor.Data.X690-DER.Length.TCB.html#2001" class="InductiveConstructor">mkShort</a>
  <a id="2011" class="Keyword">field</a>
    <a id="Short.l"></a><a id="2021" href="Armor.Data.X690-DER.Length.TCB.html#2021" class="Field">l</a> <a id="2023" class="Symbol">:</a> <a id="2025" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
    <a id="2035" class="Symbol">@</a><a id="2036" class="Symbol">0</a> <a id="Short.l&lt;128"></a><a id="2038" href="Armor.Data.X690-DER.Length.TCB.html#2038" class="Field">l&lt;128</a> <a id="2044" class="Symbol">:</a> <a id="2046" href="Armor.Prelude.html#9295" class="Field">toℕ</a> <a id="2050" href="Armor.Data.X690-DER.Length.TCB.html#2021" class="Field">l</a> <a id="2052" href="Data.Nat.Base.html#1645" class="Function Operator">&lt;</a> <a id="2054" class="Number">128</a>
    <a id="2062" class="Symbol">@</a><a id="2063" class="Symbol">0</a> <a id="Short.bs≡"></a><a id="2065" href="Armor.Data.X690-DER.Length.TCB.html#2065" class="Field">bs≡</a> <a id="2069" class="Symbol">:</a> <a id="2071" href="Armor.Data.X690-DER.Length.TCB.html#1958" class="Bound">bs</a> <a id="2074" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2076" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="2078" href="Armor.Data.X690-DER.Length.TCB.html#2021" class="Field">l</a> <a id="2080" href="Data.List.Base.html#5025" class="Function Operator">]</a>

<a id="2083" class="Comment">-- Needs to be proof irrelevant (UP)</a>
<a id="MinRepLong"></a><a id="2120" href="Armor.Data.X690-DER.Length.TCB.html#2120" class="Function">MinRepLong</a> <a id="2131" class="Symbol">:</a> <a id="2133" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="2139" class="Symbol">→</a> <a id="2141" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2146" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="2152" class="Symbol">→</a> <a id="2154" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="2158" href="Armor.Data.X690-DER.Length.TCB.html#2120" class="Function">MinRepLong</a> <a id="2169" href="Armor.Data.X690-DER.Length.TCB.html#2169" class="Bound">lₕ</a> <a id="2172" href="Armor.Data.X690-DER.Length.TCB.html#2172" class="Bound">lₜ</a> <a id="2175" class="Symbol">=</a>
  <a id="2179" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="2182" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌊</a> <a id="2184" href="Armor.Data.X690-DER.Length.TCB.html#2172" class="Bound">lₜ</a> <a id="2187" href="Armor.Prelude.html#10989" class="Field Operator">≟</a> <a id="2189" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="2192" href="Relation.Nullary.Decidable.Core.html#1312" class="Function Operator">⌋</a> <a id="2194" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="2199" href="Armor.Prelude.html#9295" class="Field">toℕ</a> <a id="2203" href="Armor.Data.X690-DER.Length.TCB.html#2169" class="Bound">lₕ</a> <a id="2206" href="Data.Nat.Base.html#1679" class="Function Operator">≥</a> <a id="2208" class="Number">128</a> <a id="2212" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="2217" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>

<a id="2220" class="Keyword">record</a> <a id="Long"></a><a id="2227" href="Armor.Data.X690-DER.Length.TCB.html#2227" class="Record">Long</a> <a id="2232" class="Symbol">(@</a><a id="2234" class="Symbol">0</a> <a id="2236" href="Armor.Data.X690-DER.Length.TCB.html#2236" class="Bound">bs</a> <a id="2239" class="Symbol">:</a> <a id="2241" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2246" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="2251" class="Symbol">)</a> <a id="2253" class="Symbol">:</a> <a id="2255" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="2259" class="Keyword">where</a>
  <a id="2267" class="Keyword">constructor</a> <a id="mkLong"></a><a id="2279" href="Armor.Data.X690-DER.Length.TCB.html#2279" class="InductiveConstructor">mkLong</a>
  <a id="2288" class="Keyword">field</a>
    <a id="Long.l"></a><a id="2298" href="Armor.Data.X690-DER.Length.TCB.html#2298" class="Field">l</a> <a id="2300" class="Symbol">:</a> <a id="2302" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
    <a id="2312" class="Symbol">@</a><a id="2313" class="Symbol">0</a> <a id="Long.l&gt;128"></a><a id="2315" href="Armor.Data.X690-DER.Length.TCB.html#2315" class="Field">l&gt;128</a> <a id="2321" class="Symbol">:</a> <a id="2323" class="Number">128</a> <a id="2327" href="Data.Nat.Base.html#1645" class="Function Operator">&lt;</a> <a id="2329" href="Armor.Prelude.html#9295" class="Field">toℕ</a> <a id="2333" href="Armor.Data.X690-DER.Length.TCB.html#2298" class="Field">l</a>
    <a id="Long.lₕ"></a><a id="2339" href="Armor.Data.X690-DER.Length.TCB.html#2339" class="Field">lₕ</a> <a id="2342" class="Symbol">:</a> <a id="2344" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
    <a id="2354" class="Symbol">@</a><a id="2355" class="Symbol">0</a> <a id="Long.lₕ≢0"></a><a id="2357" href="Armor.Data.X690-DER.Length.TCB.html#2357" class="Field">lₕ≢0</a> <a id="2362" class="Symbol">:</a> <a id="2364" href="Armor.Prelude.html#9295" class="Field">toℕ</a> <a id="2368" href="Armor.Data.X690-DER.Length.TCB.html#2339" class="Field">lₕ</a> <a id="2371" href="Data.Nat.Base.html#1709" class="Function Operator">&gt;</a> <a id="2373" class="Number">0</a>
    <a id="Long.lₜ"></a><a id="2379" href="Armor.Data.X690-DER.Length.TCB.html#2379" class="Field">lₜ</a> <a id="2382" class="Symbol">:</a> <a id="2384" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2389" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
    <a id="2399" class="Symbol">@</a><a id="2400" class="Symbol">0</a> <a id="Long.lₜLen"></a><a id="2402" href="Armor.Data.X690-DER.Length.TCB.html#2402" class="Field">lₜLen</a> <a id="2408" class="Symbol">:</a> <a id="2410" href="Data.List.Base.html#4864" class="Function">length</a> <a id="2417" href="Armor.Data.X690-DER.Length.TCB.html#2379" class="Field">lₜ</a> <a id="2420" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2422" href="Armor.Prelude.html#9295" class="Field">toℕ</a> <a id="2426" href="Armor.Data.X690-DER.Length.TCB.html#2298" class="Field">l</a> <a id="2428" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">-</a> <a id="2430" class="Number">129</a>
    <a id="2438" class="Symbol">@</a><a id="2439" class="Symbol">0</a> <a id="Long.lₕₜMinRepLong"></a><a id="2441" href="Armor.Data.X690-DER.Length.TCB.html#2441" class="Field">lₕₜMinRepLong</a> <a id="2455" class="Symbol">:</a> <a id="2457" href="Armor.Data.X690-DER.Length.TCB.html#2120" class="Function">MinRepLong</a> <a id="2468" href="Armor.Data.X690-DER.Length.TCB.html#2339" class="Field">lₕ</a> <a id="2471" href="Armor.Data.X690-DER.Length.TCB.html#2379" class="Field">lₜ</a>
    <a id="2478" class="Symbol">@</a><a id="2479" class="Symbol">0</a> <a id="Long.bs≡"></a><a id="2481" href="Armor.Data.X690-DER.Length.TCB.html#2481" class="Field">bs≡</a> <a id="2485" class="Symbol">:</a> <a id="2487" href="Armor.Data.X690-DER.Length.TCB.html#2236" class="Bound">bs</a> <a id="2490" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="2492" href="Armor.Data.X690-DER.Length.TCB.html#2298" class="Field">l</a> <a id="2494" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2496" href="Armor.Data.X690-DER.Length.TCB.html#2339" class="Field">lₕ</a> <a id="2499" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2501" href="Armor.Data.X690-DER.Length.TCB.html#2379" class="Field">lₜ</a>

<a id="2505" class="Keyword">data</a> <a id="Length"></a><a id="2510" href="Armor.Data.X690-DER.Length.TCB.html#2510" class="Datatype">Length</a> <a id="2517" class="Symbol">:</a> <a id="2519" class="Symbol">(@</a><a id="2521" class="Symbol">0</a> <a id="2523" href="Armor.Data.X690-DER.Length.TCB.html#2523" class="Bound">_</a> <a id="2525" class="Symbol">:</a> <a id="2527" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2532" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="2537" class="Symbol">)</a> <a id="2539" class="Symbol">→</a> <a id="2541" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="2545" class="Keyword">where</a>
  <a id="Length.short"></a><a id="2553" href="Armor.Data.X690-DER.Length.TCB.html#2553" class="InductiveConstructor">short</a> <a id="2559" class="Symbol">:</a> <a id="2561" class="Symbol">∀</a> <a id="2563" class="Symbol">{@</a><a id="2565" class="Symbol">0</a> <a id="2567" href="Armor.Data.X690-DER.Length.TCB.html#2567" class="Bound">bs</a><a id="2569" class="Symbol">}</a> <a id="2571" class="Symbol">→</a> <a id="2573" href="Armor.Data.X690-DER.Length.TCB.html#1948" class="Record">Short</a> <a id="2579" href="Armor.Data.X690-DER.Length.TCB.html#2567" class="Bound">bs</a> <a id="2582" class="Symbol">→</a> <a id="2584" href="Armor.Data.X690-DER.Length.TCB.html#2510" class="Datatype">Length</a> <a id="2591" href="Armor.Data.X690-DER.Length.TCB.html#2567" class="Bound">bs</a>
  <a id="Length.long"></a><a id="2596" href="Armor.Data.X690-DER.Length.TCB.html#2596" class="InductiveConstructor">long</a>  <a id="2602" class="Symbol">:</a> <a id="2604" class="Symbol">∀</a> <a id="2606" class="Symbol">{@</a><a id="2608" class="Symbol">0</a> <a id="2610" href="Armor.Data.X690-DER.Length.TCB.html#2610" class="Bound">bs</a><a id="2612" class="Symbol">}</a> <a id="2614" class="Symbol">→</a> <a id="2616" href="Armor.Data.X690-DER.Length.TCB.html#2227" class="Record">Long</a>  <a id="2622" href="Armor.Data.X690-DER.Length.TCB.html#2610" class="Bound">bs</a> <a id="2625" class="Symbol">→</a> <a id="2627" href="Armor.Data.X690-DER.Length.TCB.html#2510" class="Datatype">Length</a> <a id="2634" href="Armor.Data.X690-DER.Length.TCB.html#2610" class="Bound">bs</a>

<a id="getLengthRaw"></a><a id="2638" href="Armor.Data.X690-DER.Length.TCB.html#2638" class="Function">getLengthRaw</a> <a id="2651" class="Symbol">:</a> <a id="2653" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2658" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="2664" class="Symbol">→</a> <a id="2666" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="2668" href="Armor.Data.X690-DER.Length.TCB.html#2638" class="Function">getLengthRaw</a> <a id="2681" class="Symbol">=</a> <a id="2683" href="Armor.Binary.UInt8.TCB.html#353" class="Function">unsigned</a>

<a id="getLength"></a><a id="2693" href="Armor.Data.X690-DER.Length.TCB.html#2693" class="Function">getLength</a> <a id="2703" class="Symbol">:</a> <a id="2705" class="Symbol">∀</a> <a id="2707" class="Symbol">{@</a><a id="2709" class="Symbol">0</a> <a id="2711" href="Armor.Data.X690-DER.Length.TCB.html#2711" class="Bound">bs</a><a id="2713" class="Symbol">}</a> <a id="2715" class="Symbol">→</a> <a id="2717" href="Armor.Data.X690-DER.Length.TCB.html#2510" class="Datatype">Length</a> <a id="2724" href="Armor.Data.X690-DER.Length.TCB.html#2711" class="Bound">bs</a> <a id="2727" class="Symbol">→</a> <a id="2729" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="2731" href="Armor.Data.X690-DER.Length.TCB.html#2693" class="Function">getLength</a> <a id="2741" class="Symbol">{</a><a id="2742" href="Armor.Data.X690-DER.Length.TCB.html#2742" class="Bound">bs</a><a id="2744" class="Symbol">}</a> <a id="2746" class="Symbol">(</a><a id="2747" href="Armor.Data.X690-DER.Length.TCB.html#2553" class="InductiveConstructor">short</a> <a id="2753" class="Symbol">(</a><a id="2754" href="Armor.Data.X690-DER.Length.TCB.html#2001" class="InductiveConstructor">mkShort</a> <a id="2762" href="Armor.Data.X690-DER.Length.TCB.html#2762" class="Bound">l</a> <a id="2764" href="Armor.Data.X690-DER.Length.TCB.html#2764" class="Bound">l&lt;128</a> <a id="2770" href="Armor.Data.X690-DER.Length.TCB.html#2770" class="Bound">bs≡</a><a id="2773" class="Symbol">))</a> <a id="2776" class="Symbol">=</a> <a id="2778" href="Armor.Prelude.html#9295" class="Field">toℕ</a> <a id="2782" href="Armor.Data.X690-DER.Length.TCB.html#2762" class="Bound">l</a>
<a id="2784" href="Armor.Data.X690-DER.Length.TCB.html#2693" class="Function">getLength</a> <a id="2794" class="Symbol">{</a><a id="2795" href="Armor.Data.X690-DER.Length.TCB.html#2795" class="Bound">bs</a><a id="2797" class="Symbol">}</a> <a id="2799" class="Symbol">(</a><a id="2800" href="Armor.Data.X690-DER.Length.TCB.html#2596" class="InductiveConstructor">long</a> <a id="2805" class="Symbol">(</a><a id="2806" href="Armor.Data.X690-DER.Length.TCB.html#2279" class="InductiveConstructor">mkLong</a> <a id="2813" href="Armor.Data.X690-DER.Length.TCB.html#2813" class="Bound">l</a> <a id="2815" href="Armor.Data.X690-DER.Length.TCB.html#2815" class="Bound">l&gt;128</a> <a id="2821" href="Armor.Data.X690-DER.Length.TCB.html#2821" class="Bound">lₕ</a> <a id="2824" href="Armor.Data.X690-DER.Length.TCB.html#2824" class="Bound">lₕ≢0</a> <a id="2829" href="Armor.Data.X690-DER.Length.TCB.html#2829" class="Bound">lₜ</a> <a id="2832" href="Armor.Data.X690-DER.Length.TCB.html#2832" class="Bound">lₜLen</a> <a id="2838" class="Symbol">_</a> <a id="2840" href="Armor.Data.X690-DER.Length.TCB.html#2840" class="Bound">bs≡</a><a id="2843" class="Symbol">))</a> <a id="2846" class="Symbol">=</a> <a id="2848" href="Armor.Data.X690-DER.Length.TCB.html#2638" class="Function">getLengthRaw</a> <a id="2861" class="Symbol">(</a><a id="2862" href="Armor.Data.X690-DER.Length.TCB.html#2821" class="Bound">lₕ</a> <a id="2865" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="2867" href="Armor.Data.X690-DER.Length.TCB.html#2829" class="Bound">lₜ</a><a id="2869" class="Symbol">)</a>

<a id="toLength"></a><a id="2872" href="Armor.Data.X690-DER.Length.TCB.html#2872" class="Function">toLength</a> <a id="2881" class="Symbol">:</a> <a id="2883" class="Symbol">(</a><a id="2884" href="Armor.Data.X690-DER.Length.TCB.html#2884" class="Bound">n</a> <a id="2886" class="Symbol">:</a> <a id="2888" href="Armor.Prelude.html#794" class="Function">Fin</a> <a id="2892" class="Number">128</a><a id="2895" class="Symbol">)</a> <a id="2897" class="Symbol">→</a> <a id="2899" href="Armor.Data.X690-DER.Length.TCB.html#2510" class="Datatype">Length</a> <a id="2906" class="Symbol">(</a><a id="2907" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="2909" href="Data.Fin.Base.html#3117" class="Function">Fin.inject≤</a> <a id="2921" href="Armor.Data.X690-DER.Length.TCB.html#2884" class="Bound">n</a> <a id="2923" class="Symbol">(</a><a id="2924" href="Relation.Nullary.Decidable.Core.html#1484" class="Function">toWitness</a><a id="2933" class="Symbol">{</a><a id="2934" class="Argument">Q</a> <a id="2936" class="Symbol">=</a> <a id="2938" class="Symbol">_</a> <a id="2940" href="Data.Nat.Properties.html#5517" class="Function Operator">≤?</a> <a id="2943" class="Symbol">_}</a> <a id="2946" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="2948" class="Symbol">)</a> <a id="2950" href="Data.List.Base.html#5025" class="Function Operator">]</a><a id="2951" class="Symbol">)</a>
<a id="2953" href="Armor.Data.X690-DER.Length.TCB.html#2872" class="Function">toLength</a> <a id="2962" href="Armor.Data.X690-DER.Length.TCB.html#2962" class="Bound">n</a> <a id="2964" class="Symbol">=</a> <a id="2966" href="Armor.Data.X690-DER.Length.TCB.html#2553" class="InductiveConstructor">short</a> <a id="2972" class="Symbol">(</a><a id="2973" href="Armor.Data.X690-DER.Length.TCB.html#2001" class="InductiveConstructor">mkShort</a> <a id="2981" href="Armor.Data.X690-DER.Length.TCB.html#3002" class="Function">c</a> <a id="2983" href="Armor.Data.X690-DER.Length.TCB.html#3062" class="Function">c&lt;</a> <a id="2986" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="2990" class="Symbol">)</a>
  <a id="2994" class="Keyword">where</a>
  <a id="3002" href="Armor.Data.X690-DER.Length.TCB.html#3002" class="Function">c</a> <a id="3004" class="Symbol">:</a> <a id="3006" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
  <a id="3014" href="Armor.Data.X690-DER.Length.TCB.html#3002" class="Function">c</a> <a id="3016" class="Symbol">=</a> <a id="3018" href="Data.Fin.Base.html#3117" class="Function">Fin.inject≤</a> <a id="3030" href="Armor.Data.X690-DER.Length.TCB.html#2962" class="Bound">n</a> <a id="3032" class="Symbol">(</a><a id="3033" href="Relation.Nullary.Decidable.Core.html#1484" class="Function">toWitness</a><a id="3042" class="Symbol">{</a><a id="3043" class="Argument">Q</a> <a id="3045" class="Symbol">=</a> <a id="3047" class="Symbol">_</a> <a id="3049" href="Data.Nat.Properties.html#5517" class="Function Operator">≤?</a> <a id="3052" class="Symbol">_}</a> <a id="3055" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="3057" class="Symbol">)</a>

  <a id="3062" href="Armor.Data.X690-DER.Length.TCB.html#3062" class="Function">c&lt;</a> <a id="3065" class="Symbol">:</a> <a id="3067" href="Armor.Prelude.html#9295" class="Field">toℕ</a> <a id="3071" href="Armor.Data.X690-DER.Length.TCB.html#3002" class="Function">c</a> <a id="3073" href="Data.Nat.Base.html#1645" class="Function Operator">&lt;</a> <a id="3075" class="Number">128</a>
  <a id="3081" href="Armor.Data.X690-DER.Length.TCB.html#3062" class="Function">c&lt;</a> <a id="3084" class="Symbol">=</a> <a id="3086" href="Data.Nat.Properties.html#4747" class="Function">Nat.≤-trans</a>
         <a id="3107" class="Symbol">(</a><a id="3108" href="Data.Nat.Base.html#1600" class="InductiveConstructor">s≤s</a> <a id="3112" class="Symbol">(</a><a id="3113" href="Armor.Prelude.html#22962" class="Function">Lemmas.≡⇒≤</a> <a id="3124" class="Symbol">(</a><a id="3125" href="Data.Fin.Properties.html#15633" class="Function">Fin.toℕ-inject≤</a> <a id="3141" href="Armor.Data.X690-DER.Length.TCB.html#2962" class="Bound">n</a> <a id="3143" class="Symbol">(</a><a id="3144" href="Relation.Nullary.Decidable.Core.html#1484" class="Function">toWitness</a><a id="3153" class="Symbol">{</a><a id="3154" class="Argument">Q</a> <a id="3156" class="Symbol">=</a> <a id="3158" class="Symbol">_</a> <a id="3160" href="Data.Nat.Properties.html#5517" class="Function Operator">≤?</a> <a id="3163" class="Symbol">_}</a> <a id="3166" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="3168" class="Symbol">))))</a>
         <a id="3182" class="Symbol">(</a><a id="3183" href="Data.Nat.Properties.html#4747" class="Function">Nat.≤-trans</a>
           <a id="3206" class="Symbol">(</a><a id="3207" href="Data.Fin.Properties.html#3947" class="Function">Fin.toℕ&lt;n</a> <a id="3217" href="Armor.Data.X690-DER.Length.TCB.html#2962" class="Bound">n</a><a id="3218" class="Symbol">)</a>
           <a id="3231" href="Data.Nat.Properties.html#4564" class="Function">Nat.≤-refl</a><a id="3241" class="Symbol">)</a>

<a id="3244" class="Comment">-- for nonmalleability</a>
<a id="RawLength"></a><a id="3267" href="Armor.Data.X690-DER.Length.TCB.html#3267" class="Function">RawLength</a> <a id="3277" class="Symbol">:</a> <a id="3279" href="Armor.Grammar.Definitions.NonMalleable.Base.html#125" class="Record">Raw</a> <a id="3283" href="Armor.Data.X690-DER.Length.TCB.html#2510" class="Datatype">Length</a>
<a id="3290" href="Armor.Grammar.Definitions.NonMalleable.Base.html#176" class="Field">Raw.D</a> <a id="3296" href="Armor.Data.X690-DER.Length.TCB.html#3267" class="Function">RawLength</a> <a id="3306" class="Symbol">=</a> <a id="3308" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="3310" href="Armor.Grammar.Definitions.NonMalleable.Base.html#188" class="Field">Raw.to</a> <a id="3317" href="Armor.Data.X690-DER.Length.TCB.html#3267" class="Function">RawLength</a> <a id="3327" class="Symbol">=</a> <a id="3329" href="Armor.Data.X690-DER.Length.TCB.html#2693" class="Function">getLength</a>
</pre></body></html>