<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.SignAlg.DSA.TCB</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Armor.Data.X690-DER.Null.TCB.html" class="Module">Armor.Data.X690-DER.Null.TCB</a>
<a id="67" class="Keyword">import</a>      <a id="79" href="Armor.Data.X509.SignAlg.TCB.OIDs.html" class="Module">Armor.Data.X509.SignAlg.TCB.OIDs</a> <a id="112" class="Symbol">as</a> <a id="115" class="Module">OIDs</a>
<a id="120" class="Keyword">open</a> <a id="125" class="Keyword">import</a> <a id="132" href="Armor.Data.X690-DER.OID.html" class="Module">Armor.Data.X690-DER.OID</a>
<a id="156" class="Keyword">open</a> <a id="161" class="Keyword">import</a> <a id="168" href="Armor.Data.X690-DER.Sequence.DefinedByOID.TCB.html" class="Module">Armor.Data.X690-DER.Sequence.DefinedByOID.TCB</a>
<a id="214" class="Keyword">open</a> <a id="219" class="Keyword">import</a> <a id="226" href="Armor.Data.X690-DER.TLV.TCB.html" class="Module">Armor.Data.X690-DER.TLV.TCB</a>
<a id="254" class="Keyword">import</a>      <a id="266" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a>
<a id="292" class="Keyword">open</a> <a id="297" class="Keyword">import</a> <a id="304" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="319" class="Keyword">module</a> <a id="326" href="Armor.Data.X509.SignAlg.DSA.TCB.html" class="Module">Armor.Data.X509.SignAlg.DSA.TCB</a> <a id="358" class="Keyword">where</a>

<a id="365" class="Keyword">open</a> <a id="370" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a>  <a id="397" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>

<a id="404" class="Comment">-- TODO: Previously we had the parameter as an explicit null. The documentation</a>
<a id="484" class="Comment">-- says it must be absent. Which is it?</a>

<a id="DSAParams&#39;"></a><a id="525" href="Armor.Data.X509.SignAlg.DSA.TCB.html#525" class="Function">DSAParams&#39;</a> <a id="536" class="Symbol">:</a> <a id="538" class="Symbol">∀</a> <a id="540" class="Symbol">{@</a><a id="542" class="Symbol">0</a> <a id="544" href="Armor.Data.X509.SignAlg.DSA.TCB.html#544" class="Bound">bs</a><a id="546" class="Symbol">}</a> <a id="548" class="Symbol">→</a> <a id="550" class="Symbol">(</a><a id="551" href="Armor.Data.X509.SignAlg.DSA.TCB.html#551" class="Bound">o</a> <a id="553" class="Symbol">:</a> <a id="555" href="Armor.Data.X690-DER.OID.TCB.html#2963" class="Function">OID</a> <a id="559" href="Armor.Data.X509.SignAlg.DSA.TCB.html#544" class="Bound">bs</a><a id="561" class="Symbol">)</a> <a id="563" class="Symbol">→</a> <a id="565" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="569" class="Symbol">((</a><a id="571" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="574" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="582" href="Armor.Data.X509.SignAlg.DSA.TCB.html#551" class="Bound">o</a><a id="583" class="Symbol">)</a> <a id="585" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="587" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#7389" class="Function">OIDs.DSA.Supported</a><a id="605" class="Symbol">)</a> <a id="607" class="Symbol">→</a> <a id="609" class="Symbol">@</a><a id="610" class="Symbol">0</a> <a id="612" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="617" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="623" class="Symbol">→</a> <a id="625" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="629" href="Armor.Data.X509.SignAlg.DSA.TCB.html#525" class="Function">DSAParams&#39;</a> <a id="640" href="Armor.Data.X509.SignAlg.DSA.TCB.html#640" class="Bound">o</a> <a id="642" class="Symbol">(</a><a id="643" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="646" href="Armor.Data.X509.SignAlg.DSA.TCB.html#646" class="Bound">¬p</a><a id="648" class="Symbol">)</a> <a id="650" href="Armor.Data.X509.SignAlg.DSA.TCB.html#650" class="Bound">bs</a> <a id="653" class="Symbol">=</a> <a id="655" href="Data.Empty.html#526" class="Datatype">⊥</a>
<a id="657" href="Armor.Data.X509.SignAlg.DSA.TCB.html#525" class="Function">DSAParams&#39;</a> <a id="668" href="Armor.Data.X509.SignAlg.DSA.TCB.html#668" class="Bound">o</a> <a id="670" class="Symbol">(</a><a id="671" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="675" href="Armor.Data.X509.SignAlg.DSA.TCB.html#675" class="Bound">p</a><a id="676" class="Symbol">)</a> <a id="678" href="Armor.Data.X509.SignAlg.DSA.TCB.html#678" class="Bound">bs</a> <a id="681" class="Symbol">=</a> <a id="683" href="Armor.Prelude.html#7766" class="Record">Erased</a> <a id="690" class="Symbol">(</a><a id="691" href="Armor.Data.X509.SignAlg.DSA.TCB.html#678" class="Bound">bs</a> <a id="694" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="696" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="698" class="Symbol">)</a>

<a id="DSAParams"></a><a id="701" href="Armor.Data.X509.SignAlg.DSA.TCB.html#701" class="Function">DSAParams</a> <a id="711" class="Symbol">:</a> <a id="713" href="Armor.Data.X690-DER.Sequence.DefinedByOID.TCB.html#514" class="Function">AnyDefinedByOID</a>
<a id="729" href="Armor.Data.X509.SignAlg.DSA.TCB.html#701" class="Function">DSAParams</a> <a id="739" href="Armor.Data.X509.SignAlg.DSA.TCB.html#739" class="Bound">o</a> <a id="741" class="Symbol">=</a> <a id="743" href="Armor.Data.X509.SignAlg.DSA.TCB.html#525" class="Function">DSAParams&#39;</a> <a id="754" href="Armor.Data.X509.SignAlg.DSA.TCB.html#739" class="Bound">o</a> <a id="756" class="Symbol">((</a><a id="758" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="761" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="769" href="Armor.Data.X509.SignAlg.DSA.TCB.html#739" class="Bound">o</a><a id="770" class="Symbol">)</a> <a id="772" href="Armor.Prelude.html#11173" class="Function Operator">∈?</a> <a id="775" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#7389" class="Function">OIDs.DSA.Supported</a><a id="793" class="Symbol">)</a>

<a id="RawDSAParamsRep"></a><a id="796" href="Armor.Data.X509.SignAlg.DSA.TCB.html#796" class="Function">RawDSAParamsRep</a> <a id="812" class="Symbol">:</a> <a id="814" href="Armor.Grammar.Definitions.NonMalleable.Base.html#125" class="Record">Raw</a> <a id="818" class="Symbol">(λ</a> <a id="821" href="Armor.Data.X509.SignAlg.DSA.TCB.html#821" class="Bound">bs</a> <a id="824" class="Symbol">→</a> <a id="826" href="Armor.Prelude.html#7766" class="Record">Erased</a> <a id="833" class="Symbol">(</a><a id="834" href="Armor.Data.X509.SignAlg.DSA.TCB.html#821" class="Bound">bs</a> <a id="837" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="839" class="InductiveConstructor">[]</a><a id="841" class="Symbol">))</a>
<a id="844" href="Armor.Data.X509.SignAlg.DSA.TCB.html#796" class="Function">RawDSAParamsRep</a> <a id="860" class="Symbol">=</a> <a id="862" href="Armor.Grammar.Definitions.NonMalleable.Base.html#434" class="Function">RawSubSingleton</a>

<a id="RawDSAParams"></a><a id="879" href="Armor.Data.X509.SignAlg.DSA.TCB.html#879" class="Function">RawDSAParams</a> <a id="892" class="Symbol">:</a> <a id="894" href="Armor.Grammar.Definitions.NonMalleable.Base.html#229" class="Record">Raw₁</a> <a id="899" href="Armor.Data.X690-DER.OID.TCB.html#3030" class="Function">RawOID</a> <a id="906" href="Armor.Data.X509.SignAlg.DSA.TCB.html#701" class="Function">DSAParams</a>
<a id="toRawDSAParams"></a><a id="916" href="Armor.Data.X509.SignAlg.DSA.TCB.html#916" class="Function">toRawDSAParams</a> <a id="931" class="Symbol">:</a> <a id="933" class="Symbol">∀</a> <a id="935" class="Symbol">{@</a><a id="937" class="Symbol">0</a> <a id="939" href="Armor.Data.X509.SignAlg.DSA.TCB.html#939" class="Bound">bs</a><a id="941" class="Symbol">}</a> <a id="943" class="Symbol">→</a> <a id="945" class="Symbol">(</a><a id="946" href="Armor.Data.X509.SignAlg.DSA.TCB.html#946" class="Bound">o</a> <a id="948" class="Symbol">:</a> <a id="950" href="Armor.Data.X690-DER.OID.TCB.html#2963" class="Function">OID</a> <a id="954" href="Armor.Data.X509.SignAlg.DSA.TCB.html#939" class="Bound">bs</a><a id="956" class="Symbol">)</a> <a id="958" class="Symbol">→</a> <a id="960" class="Symbol">(</a><a id="961" href="Armor.Data.X509.SignAlg.DSA.TCB.html#961" class="Bound">o∈?</a> <a id="965" class="Symbol">:</a> <a id="967" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="971" class="Symbol">((</a><a id="973" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="976" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="984" href="Armor.Data.X509.SignAlg.DSA.TCB.html#946" class="Bound">o</a><a id="985" class="Symbol">)</a> <a id="987" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="989" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#7389" class="Function">OIDs.DSA.Supported</a><a id="1007" class="Symbol">))</a>
                   <a id="1029" class="Symbol">→</a> <a id="1031" class="Symbol">∀</a> <a id="1033" class="Symbol">{@</a><a id="1035" class="Symbol">0</a> <a id="1037" href="Armor.Data.X509.SignAlg.DSA.TCB.html#1037" class="Bound">bs&#39;</a><a id="1040" class="Symbol">}</a> <a id="1042" class="Symbol">→</a> <a id="1044" href="Armor.Data.X509.SignAlg.DSA.TCB.html#525" class="Function">DSAParams&#39;</a> <a id="1055" href="Armor.Data.X509.SignAlg.DSA.TCB.html#946" class="Bound">o</a> <a id="1057" href="Armor.Data.X509.SignAlg.DSA.TCB.html#961" class="Bound">o∈?</a> <a id="1061" href="Armor.Data.X509.SignAlg.DSA.TCB.html#1037" class="Bound">bs&#39;</a> <a id="1065" class="Symbol">→</a> <a id="1067" href="Armor.Grammar.Definitions.NonMalleable.Base.html#341" class="Field">Raw₁.D</a> <a id="1074" href="Armor.Data.X509.SignAlg.DSA.TCB.html#879" class="Function">RawDSAParams</a> <a id="1087" class="Symbol">(</a><a id="1088" href="Armor.Grammar.Definitions.NonMalleable.Base.html#188" class="Field">Raw.to</a> <a id="1095" href="Armor.Data.X690-DER.OID.TCB.html#3030" class="Function">RawOID</a> <a id="1102" href="Armor.Data.X509.SignAlg.DSA.TCB.html#946" class="Bound">o</a><a id="1103" class="Symbol">)</a>

<a id="1106" href="Armor.Grammar.Definitions.NonMalleable.Base.html#341" class="Field">Raw₁.D</a> <a id="1113" href="Armor.Data.X509.SignAlg.DSA.TCB.html#879" class="Function">RawDSAParams</a> <a id="1126" href="Armor.Data.X509.SignAlg.DSA.TCB.html#1126" class="Bound">o</a> <a id="1128" class="Symbol">=</a> <a id="1130" href="Armor.Grammar.Definitions.NonMalleable.Base.html#176" class="Field">Raw.D</a> <a id="1136" href="Armor.Data.X509.SignAlg.DSA.TCB.html#796" class="Function">RawDSAParamsRep</a>
<a id="1152" href="Armor.Grammar.Definitions.NonMalleable.Base.html#363" class="Field">Raw₁.to</a> <a id="1160" href="Armor.Data.X509.SignAlg.DSA.TCB.html#879" class="Function">RawDSAParams</a> <a id="1173" href="Armor.Data.X509.SignAlg.DSA.TCB.html#1173" class="Bound">o</a> <a id="1175" href="Armor.Data.X509.SignAlg.DSA.TCB.html#1175" class="Bound">p</a> <a id="1177" class="Symbol">=</a> <a id="1179" href="Armor.Data.X509.SignAlg.DSA.TCB.html#916" class="Function">toRawDSAParams</a> <a id="1194" href="Armor.Data.X509.SignAlg.DSA.TCB.html#1173" class="Bound">o</a> <a id="1196" class="Symbol">((</a><a id="1198" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="1201" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="1209" href="Armor.Data.X509.SignAlg.DSA.TCB.html#1173" class="Bound">o</a><a id="1210" class="Symbol">)</a> <a id="1212" href="Armor.Prelude.html#11173" class="Function Operator">∈?</a> <a id="1215" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#7389" class="Function">OIDs.DSA.Supported</a><a id="1233" class="Symbol">)</a> <a id="1235" href="Armor.Data.X509.SignAlg.DSA.TCB.html#1175" class="Bound">p</a>

<a id="1238" href="Armor.Data.X509.SignAlg.DSA.TCB.html#916" class="Function">toRawDSAParams</a> <a id="1253" href="Armor.Data.X509.SignAlg.DSA.TCB.html#1253" class="Bound">o</a> <a id="1255" class="Symbol">(</a><a id="1256" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1260" href="Armor.Data.X509.SignAlg.DSA.TCB.html#1260" class="Bound">p₁</a><a id="1262" class="Symbol">)</a> <a id="1264" href="Armor.Data.X509.SignAlg.DSA.TCB.html#1264" class="Bound">p</a> <a id="1266" class="Symbol">=</a> <a id="1268" href="Armor.Grammar.Definitions.NonMalleable.Base.html#188" class="Field">Raw.to</a> <a id="1275" href="Armor.Data.X509.SignAlg.DSA.TCB.html#796" class="Function">RawDSAParamsRep</a> <a id="1291" href="Armor.Data.X509.SignAlg.DSA.TCB.html#1264" class="Bound">p</a>

<a id="DSA"></a><a id="1294" href="Armor.Data.X509.SignAlg.DSA.TCB.html#1294" class="Function">DSA</a> <a id="1298" class="Symbol">:</a> <a id="1300" class="Symbol">@</a><a id="1301" class="Symbol">0</a> <a id="1303" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1308" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="1314" class="Symbol">→</a> <a id="1316" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1320" href="Armor.Data.X509.SignAlg.DSA.TCB.html#1294" class="Function">DSA</a> <a id="1324" class="Symbol">=</a> <a id="1326" href="Armor.Data.X690-DER.Sequence.DefinedByOID.TCB.html#1169" class="Function">DefinedByOID</a> <a id="1339" href="Armor.Data.X509.SignAlg.DSA.TCB.html#701" class="Function">DSAParams</a>

<a id="RawDSA"></a><a id="1350" href="Armor.Data.X509.SignAlg.DSA.TCB.html#1350" class="Function">RawDSA</a> <a id="1357" class="Symbol">:</a> <a id="1359" href="Armor.Grammar.Definitions.NonMalleable.Base.html#125" class="Record">Raw</a> <a id="1363" href="Armor.Data.X509.SignAlg.DSA.TCB.html#1294" class="Function">DSA</a>
<a id="1367" href="Armor.Data.X509.SignAlg.DSA.TCB.html#1350" class="Function">RawDSA</a> <a id="1374" class="Symbol">=</a> <a id="1376" href="Armor.Data.X690-DER.Sequence.DefinedByOID.TCB.html#1441" class="Function">RawDefinedByOID</a> <a id="1392" href="Armor.Data.X509.SignAlg.DSA.TCB.html#879" class="Function">RawDSAParams</a>

<a id="1406" class="Comment">-- erase</a>
<a id="1415" class="Comment">--   : ∀ {@0 bs} → Supported bs</a>
<a id="1447" class="Comment">--     → DefinedByOID</a>
<a id="1469" class="Comment">--         (λ o → (Erased ∘ OctetStringValue) ×ₚ const (True ((-, TLV.val o) ∈? supportedSignAlgOIDs)))</a>
<a id="1573" class="Comment">--         bs</a>
<a id="1587" class="Comment">-- erase (Sum.inj₁ (mkTLV len (mkOIDDefinedFields algOID (mk×ₚ _ ≋-refl) bs≡₁) len≡ bs≡)) =</a>
<a id="1679" class="Comment">--   mkTLV len (mkOIDDefinedFields algOID (mk×ₚ (─ self) tt) bs≡₁) len≡ bs≡</a>
<a id="1755" class="Comment">-- erase (Sum.inj₂ (Sum.inj₁ (mkTLV len (mkOIDDefinedFields algOID (mk×ₚ _ ≋-refl) bs≡₁) len≡ bs≡))) =</a>
<a id="1858" class="Comment">--   mkTLV len (mkOIDDefinedFields algOID (mk×ₚ (─ self) tt) bs≡₁) len≡ bs≡</a>
<a id="1934" class="Comment">-- erase (Sum.inj₂ (Sum.inj₂ (mkTLV len (mkOIDDefinedFields algOID (mk×ₚ _ ≋-refl) bs≡₁) len≡ bs≡))) =</a>
<a id="2037" class="Comment">--   mkTLV len (mkOIDDefinedFields algOID (mk×ₚ (─ self) tt) bs≡₁) len≡ bs≡</a>
</pre></body></html>