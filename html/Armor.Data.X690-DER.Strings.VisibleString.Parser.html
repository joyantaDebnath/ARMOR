<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X690-DER.Strings.VisibleString.Parser</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Armor.Data.X690-DER.Strings.VisibleString.TCB.html" class="Module">Armor.Data.X690-DER.Strings.VisibleString.TCB</a>
<a id="84" class="Keyword">open</a> <a id="89" class="Keyword">import</a> <a id="96" href="Armor.Data.X690-DER.TLV.html" class="Module">Armor.Data.X690-DER.TLV</a>
<a id="120" class="Keyword">import</a>      <a id="132" href="Armor.Data.X690-DER.Tag.html" class="Module">Armor.Data.X690-DER.Tag</a> <a id="156" class="Symbol">as</a> <a id="159" class="Module">Tag</a>
<a id="163" class="Keyword">import</a>      <a id="175" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a>
<a id="201" class="Keyword">import</a>      <a id="213" href="Armor.Grammar.IList.html" class="Module">Armor.Grammar.IList</a>
<a id="233" class="Keyword">import</a>      <a id="245" href="Armor.Grammar.Parallel.html" class="Module">Armor.Grammar.Parallel</a>
<a id="268" class="Keyword">import</a>      <a id="280" href="Armor.Grammar.Parser.html" class="Module">Armor.Grammar.Parser</a>
<a id="301" class="Keyword">open</a> <a id="306" class="Keyword">import</a> <a id="313" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="328" class="Keyword">module</a> <a id="335" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html" class="Module">Armor.Data.X690-DER.Strings.VisibleString.Parser</a> <a id="384" class="Keyword">where</a>

<a id="391" class="Keyword">open</a> <a id="396" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a> <a id="422" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="428" class="Keyword">open</a> <a id="433" href="Armor.Grammar.IList.html" class="Module">Armor.Grammar.IList</a>       <a id="459" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="465" class="Keyword">open</a> <a id="470" href="Armor.Grammar.Parallel.html" class="Module">Armor.Grammar.Parallel</a>    <a id="496" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="502" class="Keyword">open</a> <a id="507" href="Armor.Grammar.Parser.html" class="Module">Armor.Grammar.Parser</a>      <a id="533" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>

<a id="540" class="Keyword">private</a>
  <a id="here&#39;"></a><a id="550" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#550" class="Function">here&#39;</a> <a id="556" class="Symbol">=</a> <a id="558" class="String">&quot;X690-DER: Strings: VisibleString: &quot;</a>

  <a id="parseExact"></a><a id="598" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#598" class="Function">parseExact</a> <a id="609" class="Symbol">:</a> <a id="611" class="Symbol">∀</a> <a id="613" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#613" class="Bound">n</a> <a id="615" class="Symbol">→</a> <a id="617" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="624" class="Symbol">(</a><a id="625" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="633" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="635" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="638" class="Symbol">)</a> <a id="640" class="Symbol">(</a><a id="641" href="Armor.Grammar.Parallel.TCB.html#1532" class="Function">ExactLength</a> <a id="653" href="Armor.Data.X690-DER.Strings.VisibleString.TCB.html#368" class="Record">VisibleStringValue</a> <a id="672" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#613" class="Bound">n</a><a id="673" class="Symbol">)</a>
  <a id="677" href="Armor.Grammar.Parser.Core.html#775" class="Field">runParser</a> <a id="687" class="Symbol">(</a><a id="688" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#598" class="Function">parseExact</a> <a id="699" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#699" class="Bound">n</a><a id="700" class="Symbol">)</a> <a id="702" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#702" class="Bound">xs</a> <a id="705" class="Symbol">=</a> <a id="707" class="Keyword">do</a>
    <a id="714" class="Symbol">(</a><a id="715" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="719" class="Symbol">(</a><a id="720" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="728" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#728" class="Bound">pre₁</a> <a id="733" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#733" class="Bound">r₁</a> <a id="736" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#736" class="Bound">r₁≡</a> <a id="740" class="Symbol">(</a><a id="741" href="Armor.Grammar.Parallel.TCB.html#334" class="InductiveConstructor">mk×ₚ</a> <a id="746" class="Symbol">(</a><a id="747" href="Armor.Grammar.Parallel.TCB.html#334" class="InductiveConstructor">mk×ₚ</a> <a id="752" class="Symbol">(</a><a id="753" href="Armor.Prelude.html#7237" class="InductiveConstructor">singleton</a> <a id="763" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#763" class="Bound">chars</a> <a id="769" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#769" class="Bound">chars≡</a><a id="775" class="Symbol">)</a> <a id="777" class="Symbol">(</a><a id="778" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="780" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#780" class="Bound">len₁</a><a id="784" class="Symbol">))</a> <a id="787" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#787" class="Bound">range₁</a><a id="793" class="Symbol">)</a> <a id="795" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#795" class="Bound">suf₁</a> <a id="800" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#800" class="Bound">ps≡</a><a id="803" class="Symbol">))</a> <a id="806" href="Category.Monad.Indexed.html#677" class="Field Operator">←</a>
      <a id="814" href="Armor.Grammar.Parser.Core.html#775" class="Field">runParser</a>
        <a id="832" class="Symbol">(</a><a id="833" href="Armor.Grammar.Parallel.Parser.html#582" class="Function">parseSigma&#39;</a><a id="844" class="Symbol">{</a><a id="845" class="Argument">B</a> <a id="847" class="Symbol">=</a> <a id="849" class="Symbol">λ</a> <a id="851" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#851" class="Bound">xs₁</a> <a id="855" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#855" class="Bound">str</a> <a id="859" class="Symbol">→</a> <a id="861" href="Armor.Prelude.html#7766" class="Record">Erased</a> <a id="868" class="Symbol">(</a><a id="869" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="873" class="Symbol">(</a><a id="874" href="Armor.Prelude.html#9500" class="Function">InRange</a> <a id="882" class="Number">32</a> <a id="885" class="Number">127</a><a id="888" class="Symbol">)</a> <a id="890" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#851" class="Bound">xs₁</a><a id="893" class="Symbol">)}</a>
          <a id="906" class="Symbol">(</a><a id="907" href="Armor.Grammar.Parallel.Properties.html#4184" class="Function">Parallel.ExactLength.nosubstrings</a> <a id="941" class="Symbol">_)</a>
          <a id="954" class="Symbol">(λ</a> <a id="957" class="Symbol">{</a><a id="958" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#958" class="Bound">xs₁</a><a id="961" class="Symbol">}</a> <a id="963" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#963" class="Bound">x</a> <a id="965" class="Symbol">→</a> <a id="967" href="Armor.Prelude.html#8180" class="Function">erased?</a> <a id="975" class="Symbol">(</a><a id="976" href="Data.List.Relation.Unary.All.html#6240" class="Function">All.all?</a> <a id="985" class="Symbol">(</a><a id="986" href="Armor.Prelude.html#9661" class="Function">inRange?</a> <a id="995" class="Number">32</a> <a id="998" class="Number">127</a><a id="1001" class="Symbol">)</a> <a id="1003" class="Symbol">_))</a> <a id="1007" class="Comment">-- (λ {xs₁} x → All.all? (inRange? 32 127) _)</a>
          <a id="1063" class="Symbol">(λ</a> <a id="1066" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#1066" class="Bound">a₁</a> <a id="1069" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#1069" class="Bound">a₂</a> <a id="1072" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#1072" class="Bound">x</a> <a id="1074" class="Symbol">→</a> <a id="1076" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#1072" class="Bound">x</a><a id="1077" class="Symbol">)</a> <a id="1079" class="Comment">-- (λ a₁ a₂ x → x)</a>
          <a id="1108" class="Symbol">(</a><a id="1109" href="Armor.Grammar.Parallel.Parser.html#2478" class="Function">parseN</a> <a id="1116" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#699" class="Bound">n</a> <a id="1118" class="Symbol">(</a><a id="1119" href="Armor.Prelude.html#14236" class="Field">tell</a> <a id="1124" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1126" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#550" class="Function">here&#39;</a> <a id="1132" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1142" class="String">&quot;underflow&quot;</a><a id="1153" class="Symbol">)))</a>
        <a id="1165" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#702" class="Bound">xs</a>
      <a id="1174" class="Keyword">where</a> <a id="1180" class="Symbol">(</a><a id="1181" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1184" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#1184" class="Bound">¬p</a><a id="1186" class="Symbol">)</a> <a id="1188" class="Symbol">→</a> <a id="1190" class="Keyword">do</a>
        <a id="1201" href="Armor.Prelude.html#14236" class="Field">tell</a> <a id="1206" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1208" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#550" class="Function">here&#39;</a> <a id="1214" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1224" class="String">&quot;invalid character range: &quot;</a> <a id="1252" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1262" href="Armor.Prelude.html#12433" class="Field">show</a> <a id="1267" class="Symbol">(</a><a id="1268" href="Data.List.Base.html#1544" class="Function">map</a> <a id="1272" href="Armor.Prelude.html#9295" class="Field">toℕ</a> <a id="1276" class="Symbol">(</a><a id="1277" href="Data.List.Base.html#7307" class="Function">take</a> <a id="1282" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#699" class="Bound">n</a> <a id="1284" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#702" class="Bound">xs</a><a id="1286" class="Symbol">))</a>
        <a id="1297" href="Category.Monad.Indexed.html#644" class="Field">return</a> <a id="1304" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1306" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1309" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1311" class="Symbol">λ</a> <a id="1313" class="Keyword">where</a>
          <a id="1329" class="Symbol">(</a><a id="1330" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="1338" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#1338" class="Bound">prefix</a> <a id="1345" class="DottedPattern Symbol">._</a> <a id="1348" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1353" class="Symbol">(</a><a id="1354" href="Armor.Grammar.Parallel.TCB.html#334" class="InductiveConstructor">mk×ₚ</a> <a id="1359" class="Symbol">(</a><a id="1360" href="Armor.Data.X690-DER.Strings.VisibleString.TCB.html#434" class="InductiveConstructor">mkVisibleStringValue</a> <a id="1381" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#1381" class="Bound">chars</a> <a id="1387" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#1387" class="Bound">range</a> <a id="1393" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1397" class="Symbol">)</a> <a id="1399" class="Symbol">(</a><a id="1400" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="1402" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1406" class="Symbol">))</a> <a id="1409" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#1409" class="Bound">suffix</a> <a id="1416" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#1416" class="Bound">ps≡</a><a id="1419" class="Symbol">)</a> <a id="1421" class="Symbol">→</a> <a id="1423" href="Armor.Prelude.html#12974" class="Function Operator">‼</a>
            <a id="1437" href="Armor.Prelude.html#6155" class="Function">contradiction</a> <a id="1451" class="Symbol">(</a><a id="1452" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="1460" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#1381" class="Bound">chars</a> <a id="1466" class="Symbol">_</a> <a id="1468" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1473" class="Symbol">(</a><a id="1474" href="Armor.Grammar.Parallel.TCB.html#334" class="InductiveConstructor">mk×ₚ</a> <a id="1479" class="Symbol">(</a><a id="1480" href="Armor.Grammar.Parallel.TCB.html#334" class="InductiveConstructor">mk×ₚ</a> <a id="1485" href="Armor.Prelude.html#7310" class="InductiveConstructor">self</a> <a id="1490" class="Symbol">(</a><a id="1491" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="1493" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1497" class="Symbol">))</a> <a id="1500" class="Symbol">(</a><a id="1501" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="1503" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#1387" class="Bound">range</a><a id="1508" class="Symbol">))</a> <a id="1511" class="Symbol">_</a> <a id="1513" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#1416" class="Bound">ps≡</a><a id="1516" class="Symbol">)</a> <a id="1518" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#1184" class="Bound">¬p</a>
    <a id="1525" href="Category.Monad.Indexed.html#644" class="Field">return</a> <a id="1532" class="Symbol">(</a><a id="1533" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a>
      <a id="1543" class="Symbol">(</a><a id="1544" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="1552" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#728" class="Bound">pre₁</a> <a id="1557" class="Symbol">_</a> <a id="1559" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#736" class="Bound">r₁≡</a>
        <a id="1571" class="Symbol">(</a><a id="1572" href="Armor.Grammar.Parallel.TCB.html#334" class="InductiveConstructor">mk×ₚ</a>
          <a id="1587" class="Symbol">(</a><a id="1588" href="Armor.Data.X690-DER.Strings.VisibleString.TCB.html#434" class="InductiveConstructor">mkVisibleStringValue</a> <a id="1609" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#763" class="Bound">chars</a> <a id="1615" class="Symbol">(</a><a id="1616" href="Armor.Prelude.html#4612" class="Function">subst₀</a> <a id="1623" class="Symbol">(</a><a id="1624" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="1628" class="Symbol">(</a><a id="1629" href="Armor.Prelude.html#9500" class="Function">InRange</a> <a id="1637" class="Number">32</a> <a id="1640" class="Number">127</a><a id="1643" class="Symbol">))</a> <a id="1646" class="Symbol">(</a><a id="1647" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="1651" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#769" class="Bound">chars≡</a><a id="1657" class="Symbol">)</a> <a id="1659" class="Symbol">(</a><a id="1660" href="Armor.Prelude.html#7861" class="Function Operator">¡</a> <a id="1662" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#787" class="Bound">range₁</a><a id="1668" class="Symbol">))</a> <a id="1671" class="Symbol">(</a><a id="1672" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="1676" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#769" class="Bound">chars≡</a><a id="1682" class="Symbol">))</a>
          <a id="1695" class="Symbol">(</a><a id="1696" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="1698" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#780" class="Bound">len₁</a><a id="1702" class="Symbol">))</a>
        <a id="1713" class="Symbol">_</a> <a id="1715" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#800" class="Bound">ps≡</a><a id="1718" class="Symbol">))</a>

<a id="parseVisibleString"></a><a id="1722" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#1722" class="Function">parseVisibleString</a> <a id="1741" class="Symbol">:</a> <a id="1743" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="1750" class="Symbol">(</a><a id="1751" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="1759" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1761" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="1764" class="Symbol">)</a> <a id="1766" href="Armor.Data.X690-DER.Strings.VisibleString.TCB.html#587" class="Function">VisibleString</a>
<a id="1780" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#1722" class="Function">parseVisibleString</a> <a id="1799" class="Symbol">=</a> <a id="1801" href="Armor.Data.X690-DER.TLV.Parser.html#788" class="Function">parseTLV</a> <a id="1810" class="Symbol">_</a> <a id="1812" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#550" class="Function">here&#39;</a> <a id="1818" class="Symbol">_</a> <a id="1820" href="Armor.Data.X690-DER.Strings.VisibleString.Parser.html#598" class="Function">parseExact</a>
</pre></body></html>