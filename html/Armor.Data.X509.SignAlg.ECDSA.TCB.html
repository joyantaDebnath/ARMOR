<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.SignAlg.ECDSA.TCB</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="26" class="Keyword">import</a>      <a id="38" href="Armor.Data.X509.SignAlg.TCB.OIDs.html" class="Module">Armor.Data.X509.SignAlg.TCB.OIDs</a> <a id="71" class="Symbol">as</a> <a id="74" class="Module">OIDs</a>
<a id="79" class="Keyword">open</a> <a id="84" class="Keyword">import</a> <a id="91" href="Armor.Data.X690-DER.OID.html" class="Module">Armor.Data.X690-DER.OID</a>
<a id="115" class="Keyword">open</a> <a id="120" class="Keyword">import</a> <a id="127" href="Armor.Data.X690-DER.Sequence.DefinedByOID.html" class="Module">Armor.Data.X690-DER.Sequence.DefinedByOID</a>
<a id="169" class="Keyword">open</a> <a id="174" class="Keyword">import</a> <a id="181" href="Armor.Data.X690-DER.TLV.TCB.html" class="Module">Armor.Data.X690-DER.TLV.TCB</a>
<a id="209" class="Keyword">import</a>      <a id="221" href="Armor.Grammar.Definitions.NonMalleable.html" class="Module">Armor.Grammar.Definitions.NonMalleable</a>
<a id="260" class="Keyword">open</a> <a id="265" class="Keyword">import</a> <a id="272" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="287" class="Keyword">module</a> <a id="294" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html" class="Module">Armor.Data.X509.SignAlg.ECDSA.TCB</a> <a id="328" class="Keyword">where</a>

<a id="335" class="Keyword">open</a> <a id="340" href="Armor.Grammar.Definitions.NonMalleable.html" class="Module">Armor.Grammar.Definitions.NonMalleable</a> <a id="379" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>

<a id="ECDSAParams&#39;"></a><a id="386" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#386" class="Function">ECDSAParams&#39;</a> <a id="399" class="Symbol">:</a> <a id="401" class="Symbol">∀</a> <a id="403" class="Symbol">{@</a><a id="405" class="Symbol">0</a> <a id="407" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#407" class="Bound">bs</a><a id="409" class="Symbol">}</a> <a id="411" class="Symbol">→</a> <a id="413" class="Symbol">(</a><a id="414" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#414" class="Bound">o</a> <a id="416" class="Symbol">:</a> <a id="418" href="Armor.Data.X690-DER.OID.TCB.html#2963" class="Function">OID</a> <a id="422" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#407" class="Bound">bs</a><a id="424" class="Symbol">)</a> <a id="426" class="Symbol">→</a> <a id="428" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="432" class="Symbol">((</a><a id="434" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="437" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="445" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#414" class="Bound">o</a><a id="446" class="Symbol">)</a> <a id="448" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="450" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#10599" class="Function">OIDs.ECDSA.Supported</a><a id="470" class="Symbol">)</a> <a id="472" class="Symbol">→</a> <a id="474" class="Symbol">@</a><a id="475" class="Symbol">0</a> <a id="477" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="482" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="488" class="Symbol">→</a> <a id="490" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="494" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#386" class="Function">ECDSAParams&#39;</a> <a id="507" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#507" class="Bound">o</a> <a id="509" class="Symbol">(</a><a id="510" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="513" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#513" class="Bound">¬p</a><a id="515" class="Symbol">)</a> <a id="517" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#517" class="Bound">bs</a> <a id="520" class="Symbol">=</a> <a id="522" href="Data.Empty.html#526" class="Datatype">⊥</a>
<a id="524" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#386" class="Function">ECDSAParams&#39;</a> <a id="537" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#537" class="Bound">o</a> <a id="539" class="Symbol">(</a><a id="540" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="544" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#544" class="Bound">p</a><a id="545" class="Symbol">)</a> <a id="547" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#547" class="Bound">bs</a> <a id="550" class="Symbol">=</a> <a id="552" href="Armor.Prelude.html#7665" class="Record">Erased</a> <a id="559" class="Symbol">(</a><a id="560" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#547" class="Bound">bs</a> <a id="563" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="565" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="567" class="Symbol">)</a>

<a id="ECDSAParams"></a><a id="570" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#570" class="Function">ECDSAParams</a> <a id="582" class="Symbol">:</a> <a id="584" href="Armor.Data.X690-DER.Sequence.DefinedByOID.TCB.html#514" class="Function">AnyDefinedByOID</a>
<a id="600" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#570" class="Function">ECDSAParams</a> <a id="612" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#612" class="Bound">o</a> <a id="614" class="Symbol">=</a> <a id="616" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#386" class="Function">ECDSAParams&#39;</a> <a id="629" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#612" class="Bound">o</a> <a id="631" class="Symbol">((</a><a id="633" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="636" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="644" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#612" class="Bound">o</a><a id="645" class="Symbol">)</a> <a id="647" href="Armor.Prelude.html#11072" class="Function Operator">∈?</a> <a id="650" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#10599" class="Function">OIDs.ECDSA.Supported</a><a id="670" class="Symbol">)</a>

<a id="RawECDSAParamsRep"></a><a id="673" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#673" class="Function">RawECDSAParamsRep</a> <a id="691" class="Symbol">:</a> <a id="693" href="Armor.Grammar.Definitions.NonMalleable.Base.html#125" class="Record">Raw</a> <a id="697" class="Symbol">(λ</a> <a id="700" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#700" class="Bound">bs</a> <a id="703" class="Symbol">→</a> <a id="705" href="Armor.Prelude.html#7665" class="Record">Erased</a> <a id="712" class="Symbol">(</a><a id="713" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#700" class="Bound">bs</a> <a id="716" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="718" class="InductiveConstructor">[]</a><a id="720" class="Symbol">))</a>
<a id="723" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#673" class="Function">RawECDSAParamsRep</a> <a id="741" class="Symbol">=</a> <a id="743" href="Armor.Grammar.Definitions.NonMalleable.Base.html#434" class="Function">RawSubSingleton</a>

<a id="RawECDSAParams"></a><a id="760" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#760" class="Function">RawECDSAParams</a> <a id="775" class="Symbol">:</a> <a id="777" href="Armor.Grammar.Definitions.NonMalleable.Base.html#229" class="Record">Raw₁</a> <a id="782" href="Armor.Data.X690-DER.OID.TCB.html#3030" class="Function">RawOID</a> <a id="789" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#570" class="Function">ECDSAParams</a>
<a id="toRawECDSAParams"></a><a id="801" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#801" class="Function">toRawECDSAParams</a> <a id="818" class="Symbol">:</a> <a id="820" class="Symbol">∀</a> <a id="822" class="Symbol">{@</a><a id="824" class="Symbol">0</a> <a id="826" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#826" class="Bound">bs</a><a id="828" class="Symbol">}</a> <a id="830" class="Symbol">→</a> <a id="832" class="Symbol">(</a><a id="833" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#833" class="Bound">o</a> <a id="835" class="Symbol">:</a> <a id="837" href="Armor.Data.X690-DER.OID.TCB.html#2963" class="Function">OID</a> <a id="841" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#826" class="Bound">bs</a><a id="843" class="Symbol">)</a> <a id="845" class="Symbol">→</a> <a id="847" class="Symbol">(</a><a id="848" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#848" class="Bound">o∈?</a> <a id="852" class="Symbol">:</a> <a id="854" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="858" class="Symbol">((</a><a id="860" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="863" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="871" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#833" class="Bound">o</a><a id="872" class="Symbol">)</a> <a id="874" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="876" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#10599" class="Function">OIDs.ECDSA.Supported</a><a id="896" class="Symbol">))</a>
                   <a id="918" class="Symbol">→</a> <a id="920" class="Symbol">∀</a> <a id="922" class="Symbol">{@</a><a id="924" class="Symbol">0</a> <a id="926" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#926" class="Bound">bs&#39;</a><a id="929" class="Symbol">}</a> <a id="931" class="Symbol">→</a> <a id="933" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#386" class="Function">ECDSAParams&#39;</a> <a id="946" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#833" class="Bound">o</a> <a id="948" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#848" class="Bound">o∈?</a> <a id="952" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#926" class="Bound">bs&#39;</a> <a id="956" class="Symbol">→</a> <a id="958" href="Armor.Grammar.Definitions.NonMalleable.Base.html#341" class="Field">Raw₁.D</a> <a id="965" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#760" class="Function">RawECDSAParams</a> <a id="980" class="Symbol">(</a><a id="981" href="Armor.Grammar.Definitions.NonMalleable.Base.html#188" class="Field">Raw.to</a> <a id="988" href="Armor.Data.X690-DER.OID.TCB.html#3030" class="Function">RawOID</a> <a id="995" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#833" class="Bound">o</a><a id="996" class="Symbol">)</a>

<a id="999" href="Armor.Grammar.Definitions.NonMalleable.Base.html#341" class="Field">Raw₁.D</a> <a id="1006" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#760" class="Function">RawECDSAParams</a> <a id="1021" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#1021" class="Bound">o</a> <a id="1023" class="Symbol">=</a> <a id="1025" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="1027" href="Armor.Grammar.Definitions.NonMalleable.Base.html#363" class="Field">Raw₁.to</a> <a id="1035" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#760" class="Function">RawECDSAParams</a> <a id="1050" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#1050" class="Bound">o</a> <a id="1052" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#1052" class="Bound">p</a> <a id="1054" class="Symbol">=</a> <a id="1056" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#801" class="Function">toRawECDSAParams</a> <a id="1073" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#1050" class="Bound">o</a> <a id="1075" class="Symbol">((</a><a id="1077" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="1080" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="1088" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#1050" class="Bound">o</a><a id="1089" class="Symbol">)</a> <a id="1091" href="Armor.Prelude.html#11072" class="Function Operator">∈?</a> <a id="1094" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#10599" class="Function">OIDs.ECDSA.Supported</a><a id="1114" class="Symbol">)</a> <a id="1116" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#1052" class="Bound">p</a>

<a id="1119" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#801" class="Function">toRawECDSAParams</a> <a id="1136" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#1136" class="Bound">o</a> <a id="1138" class="Symbol">(</a><a id="1139" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1143" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#1143" class="Bound">p₁</a><a id="1145" class="Symbol">)</a> <a id="1147" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#1147" class="Bound">p</a> <a id="1149" class="Symbol">=</a> <a id="1151" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>

<a id="ECDSA"></a><a id="1155" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#1155" class="Function">ECDSA</a> <a id="1161" class="Symbol">:</a> <a id="1163" class="Symbol">@</a><a id="1164" class="Symbol">0</a> <a id="1166" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1171" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="1177" class="Symbol">→</a> <a id="1179" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1183" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#1155" class="Function">ECDSA</a> <a id="1189" class="Symbol">=</a> <a id="1191" href="Armor.Data.X690-DER.Sequence.DefinedByOID.TCB.html#1169" class="Function">DefinedByOID</a> <a id="1204" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#570" class="Function">ECDSAParams</a>

<a id="RawECDSA"></a><a id="1217" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#1217" class="Function">RawECDSA</a> <a id="1226" class="Symbol">:</a> <a id="1228" href="Armor.Grammar.Definitions.NonMalleable.Base.html#125" class="Record">Raw</a> <a id="1232" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#1155" class="Function">ECDSA</a>
<a id="1238" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#1217" class="Function">RawECDSA</a> <a id="1247" class="Symbol">=</a> <a id="1249" href="Armor.Data.X690-DER.Sequence.DefinedByOID.TCB.html#1441" class="Function">RawDefinedByOID</a> <a id="1265" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#760" class="Function">RawECDSAParams</a>

<a id="1281" class="Comment">-- erase</a>
<a id="1290" class="Comment">--   : ∀ {@0 bs} → Supported bs</a>
<a id="1322" class="Comment">--     → DefinedByOID</a>
<a id="1344" class="Comment">--         (λ o → (Erased ∘ OctetStringValue) ×ₚ const (True ((-, TLV.val o) ∈? supportedSignAlgOIDs)))</a>
<a id="1448" class="Comment">--         bs</a>
<a id="1462" class="Comment">-- erase (Sum.inj₁ (mkTLV len (mkOIDDefinedFields algOID (mk×ₚ _ ≋-refl) bs≡₁) len≡ bs≡)) =</a>
<a id="1554" class="Comment">--   mkTLV len (mkOIDDefinedFields algOID (mk×ₚ (─ self) tt) bs≡₁) len≡ bs≡</a>
<a id="1630" class="Comment">-- erase (Sum.inj₂ (Sum.inj₁ (mkTLV len (mkOIDDefinedFields algOID (mk×ₚ _ ≋-refl) bs≡₁) len≡ bs≡))) =</a>
<a id="1733" class="Comment">--   mkTLV len (mkOIDDefinedFields algOID (mk×ₚ (─ self) tt) bs≡₁) len≡ bs≡</a>
<a id="1809" class="Comment">-- erase (Sum.inj₂ (Sum.inj₂ (Sum.inj₁ (mkTLV len (mkOIDDefinedFields algOID (mk×ₚ _ ≋-refl) bs≡₁) len≡ bs≡)))) =</a>
<a id="1923" class="Comment">--   mkTLV len (mkOIDDefinedFields algOID (mk×ₚ (─ self) tt) bs≡₁) len≡ bs≡</a>
<a id="1999" class="Comment">-- erase (Sum.inj₂ (Sum.inj₂ (Sum.inj₂ (Sum.inj₁ (mkTLV len (mkOIDDefinedFields algOID (mk×ₚ _ ≋-refl) bs≡₁) len≡ bs≡))))) =</a>
<a id="2124" class="Comment">--   mkTLV len (mkOIDDefinedFields algOID (mk×ₚ (─ self) tt) bs≡₁) len≡ bs≡</a>
<a id="2200" class="Comment">-- erase (Sum.inj₂ (Sum.inj₂ (Sum.inj₂ (Sum.inj₂ (mkTLV len (mkOIDDefinedFields algOID (mk×ₚ _ ≋-refl) bs≡₁) len≡ bs≡))))) =</a>
<a id="2325" class="Comment">--   mkTLV len (mkOIDDefinedFields algOID (mk×ₚ (─ self) tt) bs≡₁) len≡ bs≡</a>
</pre></body></html>