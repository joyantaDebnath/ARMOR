<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.SignAlg.Parser</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="28" class="Keyword">open</a> <a id="33" class="Keyword">import</a> <a id="40" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="53" class="Keyword">open</a> <a id="58" class="Keyword">import</a> <a id="65" href="Armor.Data.X509.SignAlg.DSA.html" class="Module">Armor.Data.X509.SignAlg.DSA</a>
<a id="93" class="Keyword">open</a> <a id="98" class="Keyword">import</a> <a id="105" href="Armor.Data.X509.SignAlg.ECDSA.html" class="Module">Armor.Data.X509.SignAlg.ECDSA</a>
<a id="135" class="Keyword">open</a> <a id="140" class="Keyword">import</a> <a id="147" href="Armor.Data.X509.SignAlg.Properties.html" class="Module">Armor.Data.X509.SignAlg.Properties</a>
<a id="182" class="Keyword">open</a> <a id="187" class="Keyword">import</a> <a id="194" href="Armor.Data.X509.SignAlg.RSA.html" class="Module">Armor.Data.X509.SignAlg.RSA</a>
<a id="222" class="Keyword">open</a> <a id="227" class="Keyword">import</a> <a id="234" href="Armor.Data.X509.SignAlg.TCB.html" class="Module">Armor.Data.X509.SignAlg.TCB</a>
<a id="262" class="Keyword">open</a> <a id="267" class="Keyword">import</a> <a id="274" href="Armor.Data.X690-DER.OID.html" class="Module">Armor.Data.X690-DER.OID</a>
<a id="298" class="Keyword">open</a> <a id="303" class="Keyword">import</a> <a id="310" href="Armor.Data.X690-DER.OctetString.html" class="Module">Armor.Data.X690-DER.OctetString</a>
<a id="342" class="Keyword">open</a> <a id="347" class="Keyword">import</a> <a id="354" href="Armor.Data.X690-DER.Sequence.DefinedByOID.html" class="Module">Armor.Data.X690-DER.Sequence.DefinedByOID</a>
<a id="396" class="Keyword">open</a> <a id="401" class="Keyword">import</a> <a id="408" href="Armor.Data.X690-DER.TLV.html" class="Module">Armor.Data.X690-DER.TLV</a>
<a id="432" class="Keyword">import</a>      <a id="444" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a>
<a id="470" class="Keyword">import</a>      <a id="482" href="Armor.Grammar.Parallel.html" class="Module">Armor.Grammar.Parallel</a>
<a id="505" class="Keyword">import</a>      <a id="517" href="Armor.Grammar.Parser.html" class="Module">Armor.Grammar.Parser</a>
<a id="538" class="Keyword">import</a>      <a id="550" href="Armor.Grammar.Properties.html" class="Module">Armor.Grammar.Properties</a>
<a id="575" class="Keyword">import</a>      <a id="587" href="Armor.Grammar.Sum.html" class="Module">Armor.Grammar.Sum</a>

<a id="606" class="Keyword">module</a> <a id="613" href="Armor.Data.X509.SignAlg.Parser.html" class="Module">Armor.Data.X509.SignAlg.Parser</a> <a id="644" class="Keyword">where</a>

<a id="651" class="Keyword">open</a> <a id="656" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a> <a id="682" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="688" class="Keyword">open</a> <a id="693" href="Armor.Grammar.Parallel.html" class="Module">Armor.Grammar.Parallel</a>    <a id="719" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="725" class="Keyword">open</a> <a id="730" href="Armor.Grammar.Parser.html" class="Module">Armor.Grammar.Parser</a>      <a id="756" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="762" class="Keyword">open</a> <a id="767" href="Armor.Grammar.Properties.html" class="Module">Armor.Grammar.Properties</a>  <a id="793" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="799" class="Keyword">open</a> <a id="804" href="Armor.Grammar.Sum.html" class="Module">Armor.Grammar.Sum</a>         <a id="830" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>

<a id="837" class="Keyword">private</a>
  <a id="here&#39;"></a><a id="847" href="Armor.Data.X509.SignAlg.Parser.html#847" class="Function">here&#39;</a> <a id="853" class="Symbol">=</a> <a id="855" class="String">&quot;X509: SignAlg&quot;</a>

<a id="parseParam"></a><a id="872" href="Armor.Data.X509.SignAlg.Parser.html#872" class="Function">parseParam</a> <a id="883" class="Symbol">:</a> <a id="885" class="Symbol">∀</a> <a id="887" href="Armor.Data.X509.SignAlg.Parser.html#887" class="Bound">n</a> <a id="889" class="Symbol">{@</a><a id="891" class="Symbol">0</a> <a id="893" href="Armor.Data.X509.SignAlg.Parser.html#893" class="Bound">bs</a><a id="895" class="Symbol">}</a> <a id="897" class="Symbol">(</a><a id="898" href="Armor.Data.X509.SignAlg.Parser.html#898" class="Bound">o</a> <a id="900" class="Symbol">:</a> <a id="902" href="Armor.Data.X690-DER.OID.TCB.html#2963" class="Function">OID</a> <a id="906" href="Armor.Data.X509.SignAlg.Parser.html#893" class="Bound">bs</a><a id="908" class="Symbol">)</a> <a id="910" class="Symbol">→</a> <a id="912" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="919" class="Symbol">(</a><a id="920" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="928" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="930" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="933" class="Symbol">)</a> <a id="935" class="Symbol">(</a><a id="936" href="Armor.Grammar.Parallel.TCB.html#1532" class="Function">ExactLength</a> <a id="948" class="Symbol">(</a><a id="949" href="Armor.Data.X509.SignAlg.TCB.html#2845" class="Function">SignAlgParam</a> <a id="962" href="Armor.Data.X509.SignAlg.Parser.html#898" class="Bound">o</a><a id="963" class="Symbol">)</a> <a id="965" href="Armor.Data.X509.SignAlg.Parser.html#887" class="Bound">n</a><a id="966" class="Symbol">)</a>
<a id="968" href="Armor.Data.X509.SignAlg.Parser.html#872" class="Function">parseParam</a> <a id="979" href="Armor.Data.X509.SignAlg.Parser.html#979" class="Bound">n</a> <a id="981" href="Armor.Data.X509.SignAlg.Parser.html#981" class="Bound">o</a> <a id="983" class="Symbol">=</a>
  <a id="987" href="Armor.Prelude.html#3493" class="Function Operator">case</a> <a id="992" href="Armor.Data.X509.SignAlg.TCB.html#2716" class="Function">isSupported</a> <a id="1004" href="Armor.Data.X509.SignAlg.Parser.html#981" class="Bound">o</a>
  <a id="1008" href="Armor.Prelude.html#3493" class="Function Operator">ret</a> <a id="1012" class="Symbol">(λ</a> <a id="1015" href="Armor.Data.X509.SignAlg.Parser.html#1015" class="Bound">o∈?</a> <a id="1019" class="Symbol">→</a> <a id="1021" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="1028" class="Symbol">(</a><a id="1029" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="1037" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1039" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="1042" class="Symbol">)</a> <a id="1044" class="Symbol">(</a><a id="1045" href="Armor.Grammar.Parallel.TCB.html#1532" class="Function">ExactLength</a> <a id="1057" class="Symbol">(</a><a id="1058" href="Armor.Data.X509.SignAlg.TCB.html#2486" class="Function">SignAlgParam&#39;</a> <a id="1072" href="Armor.Data.X509.SignAlg.Parser.html#981" class="Bound">o</a> <a id="1074" href="Armor.Data.X509.SignAlg.Parser.html#1015" class="Bound">o∈?</a><a id="1077" class="Symbol">)</a> <a id="1079" href="Armor.Data.X509.SignAlg.Parser.html#979" class="Bound">n</a><a id="1080" class="Symbol">))</a>
  <a id="1085" href="Armor.Prelude.html#3493" class="Function Operator">of</a> <a id="1088" class="Symbol">λ</a> <a id="1090" class="Keyword">where</a>
    <a id="1100" class="Symbol">(</a><a id="1101" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1104" href="Armor.Data.X509.SignAlg.Parser.html#1104" class="Bound">¬p</a><a id="1106" class="Symbol">)</a> <a id="1108" class="Symbol">→</a> <a id="1110" href="Armor.Grammar.Parallel.Parser.html#2478" class="Function">parseN</a> <a id="1117" class="Symbol">_</a> <a id="1119" class="Symbol">(</a><a id="1120" href="Armor.Prelude.html#14236" class="Field">tell</a> <a id="1125" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1127" href="Armor.Data.X509.SignAlg.Parser.html#847" class="Function">here&#39;</a> <a id="1133" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1143" class="String">&quot; (param): underflow&quot;</a><a id="1164" class="Symbol">)</a>
    <a id="1170" class="Symbol">(</a><a id="1171" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1175" href="Armor.Data.X509.SignAlg.Parser.html#1175" class="Bound">o∈</a><a id="1177" class="Symbol">)</a> <a id="1179" class="Symbol">→</a>
      <a id="1187" href="Armor.Prelude.html#3493" class="Function Operator">case</a> <a id="1192" href="Armor.Data.X509.SignAlg.TCB.html#2036" class="Function">lookupSignAlg</a> <a id="1206" href="Armor.Data.X509.SignAlg.Parser.html#981" class="Bound">o</a> <a id="1208" href="Armor.Data.X509.SignAlg.Parser.html#1175" class="Bound">o∈</a>
      <a id="1217" href="Armor.Prelude.html#3493" class="Function Operator">ret</a> <a id="1221" class="Symbol">(λ</a> <a id="1224" href="Armor.Data.X509.SignAlg.Parser.html#1224" class="Bound">o∈</a> <a id="1227" class="Symbol">→</a> <a id="1229" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="1236" class="Symbol">(</a><a id="1237" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="1245" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1247" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="1250" class="Symbol">)</a> <a id="1252" class="Symbol">(</a><a id="1253" href="Armor.Grammar.Parallel.TCB.html#1532" class="Function">ExactLength</a> <a id="1265" class="Symbol">(</a><a id="1266" href="Armor.Data.X509.SignAlg.TCB.html#2223" class="Function">SignAlgParam“</a> <a id="1280" href="Armor.Data.X509.SignAlg.Parser.html#981" class="Bound">o</a> <a id="1282" href="Armor.Data.X509.SignAlg.Parser.html#1224" class="Bound">o∈</a><a id="1284" class="Symbol">)</a> <a id="1286" href="Armor.Data.X509.SignAlg.Parser.html#979" class="Bound">n</a><a id="1287" class="Symbol">))</a>
      <a id="1296" href="Armor.Prelude.html#3493" class="Function Operator">of</a> <a id="1299" class="Symbol">λ</a> <a id="1301" class="Keyword">where</a>
        <a id="1315" class="Symbol">(</a><a id="1316" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="1321" href="Armor.Data.X509.SignAlg.Parser.html#1321" class="Bound">x</a><a id="1322" class="Symbol">)</a> <a id="1324" class="Symbol">→</a>
          <a id="1336" href="Armor.Grammar.Parallel.Parser.html#3682" class="Function">parseExactLength</a>
            <a id="1365" class="Symbol">(λ</a> <a id="1368" class="Keyword">where</a> <a id="1374" class="Symbol">_</a> <a id="1376" class="Symbol">(</a><a id="1377" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="1379" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1383" class="Symbol">)</a> <a id="1385" class="Symbol">(</a><a id="1386" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="1388" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1392" class="Symbol">)</a> <a id="1394" class="Symbol">→</a> <a id="1396" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1400" class="Symbol">)</a>
            <a id="1414" href="Armor.Prelude.html#14764" class="Function">silent</a>
            <a id="1433" class="Symbol">(</a><a id="1434" href="Armor.Grammar.Parser.Core.html#1310" class="Function">parseErased</a> <a id="1446" class="Symbol">(</a><a id="1447" href="Armor.Grammar.Parser.Lit.html#205" class="Function">parseLit</a> <a id="1456" href="Armor.Prelude.html#14764" class="Function">silent</a> <a id="1463" href="Armor.Prelude.html#14764" class="Function">silent</a> <a id="1470" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1472" class="Symbol">))</a>
            <a id="1487" class="Symbol">_</a>
        <a id="1497" class="Symbol">(</a><a id="1498" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="1503" class="Symbol">(</a><a id="1504" href="Data.Sum.Base.html#784" class="InductiveConstructor">inj₁</a> <a id="1509" href="Armor.Data.X509.SignAlg.Parser.html#1509" class="Bound">x</a><a id="1510" class="Symbol">))</a> <a id="1513" class="Symbol">→</a>
          <a id="1525" href="Armor.Grammar.Parallel.Parser.html#3682" class="Function">parseExactLength</a>
            <a id="1554" class="Symbol">(λ</a> <a id="1557" class="Keyword">where</a> <a id="1563" class="Symbol">_</a> <a id="1565" class="Symbol">(</a><a id="1566" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="1568" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1572" class="Symbol">)</a> <a id="1574" class="Symbol">(</a><a id="1575" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="1577" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1581" class="Symbol">)</a> <a id="1583" class="Symbol">→</a> <a id="1585" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1589" class="Symbol">)</a>
            <a id="1603" href="Armor.Prelude.html#14764" class="Function">silent</a>
            <a id="1622" class="Symbol">(</a><a id="1623" href="Armor.Grammar.Parser.Core.html#1310" class="Function">parseErased</a> <a id="1635" class="Symbol">(</a><a id="1636" href="Armor.Grammar.Parser.Lit.html#205" class="Function">parseLit</a> <a id="1645" href="Armor.Prelude.html#14764" class="Function">silent</a> <a id="1652" href="Armor.Prelude.html#14764" class="Function">silent</a> <a id="1659" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1661" class="Symbol">))</a>
            <a id="1676" class="Symbol">_</a>
        <a id="1686" class="Symbol">(</a><a id="1687" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="1692" class="Symbol">(</a><a id="1693" href="Data.Sum.Base.html#809" class="InductiveConstructor">inj₂</a> <a id="1698" href="Armor.Data.X509.SignAlg.Parser.html#1698" class="Bound">y</a><a id="1699" class="Symbol">))</a> <a id="1702" class="Symbol">→</a>
          <a id="1714" href="Armor.Data.X509.SignAlg.RSA.Parser.html#697" class="Function">RSA.parseParams</a> <a id="1730" href="Armor.Data.X509.SignAlg.Parser.html#979" class="Bound">n</a> <a id="1732" href="Armor.Data.X509.SignAlg.Parser.html#981" class="Bound">o</a> <a id="1734" class="Symbol">(</a><a id="1735" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1739" href="Armor.Data.X509.SignAlg.Parser.html#1698" class="Bound">y</a><a id="1740" class="Symbol">)</a>

<a id="parse"></a><a id="1743" href="Armor.Data.X509.SignAlg.Parser.html#1743" class="Function">parse</a> <a id="1749" class="Symbol">:</a> <a id="1751" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="1758" class="Symbol">(</a><a id="1759" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="1767" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1769" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="1772" class="Symbol">)</a> <a id="1774" href="Armor.Data.X509.SignAlg.TCB.html#4043" class="Function">SignAlg</a>
<a id="1782" href="Armor.Data.X509.SignAlg.Parser.html#1743" class="Function">parse</a> <a id="1788" class="Symbol">=</a>
  <a id="1792" href="Armor.Data.X690-DER.Sequence.DefinedByOID.Parser.html#1562" class="Function">DefinedByOID.parse</a> <a id="1811" href="Armor.Data.X509.SignAlg.Parser.html#847" class="Function">here&#39;</a> <a id="1817" href="Armor.Data.X509.SignAlg.Parser.html#872" class="Function">parseParam</a>
</pre></body></html>