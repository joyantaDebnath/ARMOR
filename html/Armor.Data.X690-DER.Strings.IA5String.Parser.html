<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X690-DER.Strings.IA5String.Parser</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Armor.Data.X690-DER.OctetString.html" class="Module">Armor.Data.X690-DER.OctetString</a>
<a id="70" class="Keyword">open</a> <a id="75" class="Keyword">import</a> <a id="82" href="Armor.Data.X690-DER.Strings.IA5String.TCB.html" class="Module">Armor.Data.X690-DER.Strings.IA5String.TCB</a>
<a id="124" class="Keyword">open</a> <a id="129" class="Keyword">import</a> <a id="136" href="Armor.Data.X690-DER.TLV.html" class="Module">Armor.Data.X690-DER.TLV</a>
<a id="160" class="Keyword">import</a>      <a id="172" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a>
<a id="198" class="Keyword">import</a>      <a id="210" href="Armor.Grammar.Parallel.html" class="Module">Armor.Grammar.Parallel</a>
<a id="233" class="Keyword">import</a>      <a id="245" href="Armor.Grammar.Parser.html" class="Module">Armor.Grammar.Parser</a>
<a id="266" class="Keyword">open</a> <a id="271" class="Keyword">import</a> <a id="278" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="293" class="Keyword">module</a> <a id="300" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html" class="Module">Armor.Data.X690-DER.Strings.IA5String.Parser</a> <a id="345" class="Keyword">where</a>

<a id="352" class="Keyword">open</a> <a id="357" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a> <a id="383" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="389" class="Keyword">open</a> <a id="394" href="Armor.Grammar.Parallel.html" class="Module">Armor.Grammar.Parallel</a>    <a id="420" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="426" class="Keyword">open</a> <a id="431" href="Armor.Grammar.Parser.html" class="Module">Armor.Grammar.Parser</a>      <a id="457" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>

<a id="parseIA5StringValue"></a><a id="464" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#464" class="Function">parseIA5StringValue</a> <a id="484" class="Symbol">:</a> <a id="486" class="Symbol">∀</a> <a id="488" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#488" class="Bound">n</a> <a id="490" class="Symbol">→</a> <a id="492" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="499" class="Symbol">(</a><a id="500" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="508" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="510" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="513" class="Symbol">)</a> <a id="515" class="Symbol">(</a><a id="516" href="Armor.Grammar.Parallel.TCB.html#1532" class="Function">ExactLength</a> <a id="528" href="Armor.Data.X690-DER.Strings.IA5String.TCB.html#323" class="Record">IA5StringValue</a> <a id="543" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#488" class="Bound">n</a><a id="544" class="Symbol">)</a>
<a id="546" href="Armor.Grammar.Parser.Core.html#775" class="Field">runParser</a> <a id="556" class="Symbol">(</a><a id="557" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#464" class="Function">parseIA5StringValue</a> <a id="577" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#577" class="Bound">n</a><a id="578" class="Symbol">)</a> <a id="580" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#580" class="Bound">xs</a> <a id="583" class="Symbol">=</a> <a id="585" class="Keyword">do</a>
  <a id="590" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="594" class="Symbol">(</a><a id="595" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="603" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#603" class="Bound">pre₀</a> <a id="608" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#608" class="Bound">r₀</a> <a id="611" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#611" class="Bound">r₀≡</a> <a id="615" class="Symbol">(</a><a id="616" href="Armor.Grammar.Parallel.TCB.html#334" class="InductiveConstructor">mk×ₚ</a> <a id="621" class="Symbol">(</a><a id="622" href="Armor.Prelude.html#7237" class="InductiveConstructor">singleton</a> <a id="632" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#632" class="Bound">os₀</a> <a id="636" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="640" class="Symbol">)</a> <a id="642" class="Symbol">(</a><a id="643" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="645" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#645" class="Bound">osLen</a><a id="650" class="Symbol">))</a> <a id="653" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#653" class="Bound">suf₀</a> <a id="658" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#658" class="Bound">ps≡₀</a><a id="662" class="Symbol">)</a> <a id="664" href="Category.Monad.Indexed.html#677" class="Field Operator">←</a> <a id="666" href="Armor.Grammar.Parser.Core.html#775" class="Field">runParser</a> <a id="676" class="Symbol">(</a><a id="677" href="Armor.Data.X690-DER.OctetString.Parser.html#494" class="Function">OctetString.parseValue</a> <a id="700" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#577" class="Bound">n</a><a id="701" class="Symbol">)</a> <a id="703" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#580" class="Bound">xs</a>
    <a id="710" class="Keyword">where</a> <a id="716" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="719" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#719" class="Bound">¬parse</a> <a id="726" class="Symbol">→</a> <a id="728" class="Keyword">do</a>
      <a id="737" href="Category.Monad.Indexed.html#644" class="Field">return</a> <a id="744" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="746" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="749" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="751" class="Symbol">λ</a> <a id="753" class="Keyword">where</a>
        <a id="767" class="Symbol">(</a><a id="768" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="776" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#776" class="Bound">prefix</a> <a id="783" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#783" class="Bound">read</a> <a id="788" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#788" class="Bound">read≡</a> <a id="794" class="Symbol">(</a><a id="795" href="Armor.Grammar.Parallel.TCB.html#334" class="InductiveConstructor">mk×ₚ</a> <a id="800" class="Symbol">(</a><a id="801" href="Armor.Data.X690-DER.Strings.IA5String.TCB.html#385" class="InductiveConstructor">mkIA5StringValue</a> <a id="818" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#818" class="Bound">str</a> <a id="822" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#822" class="Bound">all&lt;128</a><a id="829" class="Symbol">)</a> <a id="831" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#831" class="Bound">strLen</a><a id="837" class="Symbol">)</a> <a id="839" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#839" class="Bound">suffix</a> <a id="846" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#846" class="Bound">ps≡</a><a id="849" class="Symbol">)</a> <a id="851" class="Symbol">→</a>
          <a id="863" href="Armor.Prelude.html#6155" class="Function">contradiction</a>
            <a id="889" class="Symbol">(</a><a id="890" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="898" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#776" class="Bound">prefix</a> <a id="905" class="Symbol">_</a> <a id="907" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#788" class="Bound">read≡</a>
              <a id="927" class="Symbol">(</a><a id="928" href="Armor.Grammar.Parallel.TCB.html#334" class="InductiveConstructor">mk×ₚ</a> <a id="933" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#818" class="Bound">str</a> <a id="937" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#831" class="Bound">strLen</a><a id="943" class="Symbol">)</a> <a id="945" class="Symbol">_</a> <a id="947" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#846" class="Bound">ps≡</a><a id="950" class="Symbol">)</a>
            <a id="964" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#719" class="Bound">¬parse</a>
  <a id="973" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="978" href="Data.List.Relation.Unary.All.html#6240" class="Function">All.all?</a> <a id="987" class="Symbol">(</a><a id="988" href="Data.Fin.Properties.html#8185" class="Function Operator">Fin._&lt;?</a> <a id="996" class="Symbol">(</a><a id="997" href="Armor.Prelude.html#9348" class="Function Operator">#</a> <a id="999" class="Number">128</a><a id="1002" class="Symbol">))</a> <a id="1005" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#632" class="Bound">os₀</a> <a id="1009" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="1012" class="Symbol">λ</a> <a id="1014" class="Keyword">where</a>
    <a id="1024" class="Symbol">(</a><a id="1025" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a>  <a id="1029" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1029" class="Bound">all≮128</a><a id="1036" class="Symbol">)</a> <a id="1038" class="Symbol">→</a> <a id="1040" class="Keyword">do</a>
      <a id="1049" href="Armor.Prelude.html#14236" class="Field">tell</a> <a id="1054" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1056" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1716" class="Function">here&#39;</a> <a id="1062" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1072" class="String">&quot;: value violation&quot;</a>
      <a id="1098" href="Category.Monad.Indexed.html#644" class="Field">return</a> <a id="1105" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1107" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1110" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1112" class="Symbol">λ</a> <a id="1114" class="Keyword">where</a>
        <a id="1128" class="Symbol">(</a><a id="1129" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="1137" class="DottedPattern Symbol">.</a><a id="1138" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1186" class="DottedPattern Bound">str&#39;</a> <a id="1143" class="Symbol">_</a> <a id="1145" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1145" class="Bound">read≡</a> <a id="1151" class="Symbol">(</a><a id="1152" href="Armor.Grammar.Parallel.TCB.html#334" class="InductiveConstructor">mk×ₚ</a> <a id="1157" class="Symbol">(</a><a id="1158" href="Armor.Data.X690-DER.Strings.IA5String.TCB.html#385" class="InductiveConstructor">mkIA5StringValue</a> <a id="1175" class="Symbol">(</a><a id="1176" href="Armor.Prelude.html#7237" class="InductiveConstructor">singleton</a> <a id="1186" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1186" class="Bound">str&#39;</a> <a id="1191" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1195" class="Symbol">)</a> <a id="1197" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1197" class="Bound">all&lt;128</a><a id="1204" class="Symbol">)</a> <a id="1206" class="Symbol">(</a><a id="1207" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="1209" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1209" class="Bound">strLen</a><a id="1215" class="Symbol">))</a> <a id="1218" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1218" class="Bound">suffix</a> <a id="1225" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1225" class="Bound">ps≡</a><a id="1228" class="Symbol">)</a> <a id="1230" class="Symbol">→</a> <a id="1232" href="Armor.Prelude.html#12974" class="Function Operator">‼</a>
          <a id="1244" class="Keyword">let</a> <a id="1248" class="Symbol">@</a><a id="1249" class="Symbol">0</a> <a id="1251" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1251" class="Bound">pre₀≡</a> <a id="1257" class="Symbol">:</a> <a id="1259" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#603" class="Bound">pre₀</a> <a id="1264" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1266" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1186" class="Bound">str&#39;</a>
              <a id="1285" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1251" class="Bound">pre₀≡</a> <a id="1291" class="Symbol">=</a> <a id="1293" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="1299" href="Function.Base.html#1919" class="Function Operator">$</a>
                <a id="1317" href="Armor.Prelude.html#19816" class="Function">Lemmas.length-++-≡</a> <a id="1336" class="Symbol">_</a> <a id="1338" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#653" class="Bound">suf₀</a> <a id="1343" class="Symbol">_</a> <a id="1345" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1218" class="Bound">suffix</a>
                  <a id="1370" class="Symbol">(</a><a id="1371" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a> <a id="1377" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#658" class="Bound">ps≡₀</a> <a id="1382" class="Symbol">(</a><a id="1383" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="1387" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1225" class="Bound">ps≡</a><a id="1390" class="Symbol">))</a>
                  <a id="1411" class="Symbol">(</a><a id="1412" href="Relation.Binary.PropositionalEquality.Core.html#1729" class="Function">trans</a> <a id="1418" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#645" class="Bound">osLen</a> <a id="1424" class="Symbol">(</a><a id="1425" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="1429" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1209" class="Bound">strLen</a><a id="1435" class="Symbol">))</a>
          <a id="1448" class="Keyword">in</a>
          <a id="1461" href="Armor.Prelude.html#6155" class="Function">contradiction</a> <a id="1475" class="Symbol">(</a><a id="1476" href="Relation.Binary.PropositionalEquality.Core.html#1780" class="Function">subst</a> <a id="1482" class="Symbol">(</a><a id="1483" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="1487" class="Symbol">_)</a> <a id="1490" class="Symbol">(</a><a id="1491" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="1495" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1251" class="Bound">pre₀≡</a><a id="1500" class="Symbol">)</a> <a id="1502" class="Symbol">(</a><a id="1503" href="Relation.Nullary.Decidable.Core.html#1484" class="Function">toWitness</a> <a id="1513" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1197" class="Bound">all&lt;128</a><a id="1520" class="Symbol">))</a> <a id="1523" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1029" class="Bound">all≮128</a>
    <a id="1535" class="Symbol">(</a><a id="1536" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1540" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1540" class="Bound">all&lt;128</a><a id="1547" class="Symbol">)</a> <a id="1549" class="Symbol">→</a>
      <a id="1557" href="Category.Monad.Indexed.html#644" class="Field">return</a> <a id="1564" class="Symbol">(</a><a id="1565" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a>
        <a id="1577" class="Symbol">(</a><a id="1578" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="1586" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#603" class="Bound">pre₀</a> <a id="1591" class="Symbol">_</a> <a id="1593" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#611" class="Bound">r₀≡</a>
          <a id="1607" class="Symbol">(</a><a id="1608" href="Armor.Grammar.Parallel.TCB.html#334" class="InductiveConstructor">mk×ₚ</a> <a id="1613" class="Symbol">(</a><a id="1614" href="Armor.Data.X690-DER.Strings.IA5String.TCB.html#385" class="InductiveConstructor">mkIA5StringValue</a> <a id="1631" class="Symbol">(</a><a id="1632" href="Armor.Prelude.html#7237" class="InductiveConstructor">singleton</a> <a id="1642" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#632" class="Bound">os₀</a> <a id="1646" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1650" class="Symbol">)</a> <a id="1652" class="Symbol">(</a><a id="1653" href="Relation.Nullary.Decidable.Core.html#1653" class="Function">fromWitness</a> <a id="1665" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1540" class="Bound">all&lt;128</a><a id="1672" class="Symbol">))</a> <a id="1675" class="Symbol">(</a><a id="1676" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="1678" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#645" class="Bound">osLen</a><a id="1683" class="Symbol">))</a>
          <a id="1696" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#653" class="Bound">suf₀</a> <a id="1701" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#658" class="Bound">ps≡₀</a><a id="1705" class="Symbol">))</a>
  <a id="1710" class="Keyword">where</a> <a id="1716" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1716" class="Function">here&#39;</a> <a id="1722" class="Symbol">=</a> <a id="1724" class="String">&quot;parseIA5StringValue&quot;</a>

<a id="parseIA5String"></a><a id="1747" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1747" class="Function">parseIA5String</a> <a id="1762" class="Symbol">:</a> <a id="1764" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="1771" class="Symbol">(</a><a id="1772" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="1780" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1782" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="1785" class="Symbol">)</a> <a id="1787" href="Armor.Data.X690-DER.Strings.IA5String.TCB.html#546" class="Function">IA5String</a>
<a id="1797" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1747" class="Function">parseIA5String</a> <a id="1812" class="Symbol">=</a> <a id="1814" href="Armor.Data.X690-DER.TLV.Parser.html#788" class="Function">parseTLV</a> <a id="1823" class="Symbol">_</a> <a id="1825" class="String">&quot;IA5String&quot;</a> <a id="1837" class="Symbol">_</a> <a id="1839" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#464" class="Function">parseIA5StringValue</a>
</pre></body></html>