<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.SignAlg.ECDSA.Parser</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html" class="Module">Armor.Data.X509.SignAlg.ECDSA.TCB</a>
<a id="72" class="Keyword">import</a>      <a id="84" href="Armor.Data.X509.SignAlg.TCB.OIDs.html" class="Module">Armor.Data.X509.SignAlg.TCB.OIDs</a> <a id="117" class="Symbol">as</a> <a id="120" class="Module">OIDs</a>
<a id="125" class="Keyword">open</a> <a id="130" class="Keyword">import</a> <a id="137" href="Armor.Data.X690-DER.OID.html" class="Module">Armor.Data.X690-DER.OID</a>
<a id="161" class="Keyword">open</a> <a id="166" class="Keyword">import</a> <a id="173" href="Armor.Data.X690-DER.Sequence.DefinedByOID.html" class="Module">Armor.Data.X690-DER.Sequence.DefinedByOID</a>
<a id="215" class="Keyword">open</a> <a id="220" class="Keyword">import</a> <a id="227" href="Armor.Data.X690-DER.TLV.html" class="Module">Armor.Data.X690-DER.TLV</a>
<a id="251" class="Keyword">import</a>      <a id="263" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a>
<a id="289" class="Keyword">import</a>      <a id="301" href="Armor.Grammar.Parallel.html" class="Module">Armor.Grammar.Parallel</a>
<a id="324" class="Keyword">import</a>      <a id="336" href="Armor.Grammar.Parser.html" class="Module">Armor.Grammar.Parser</a>
<a id="357" class="Keyword">open</a> <a id="362" class="Keyword">import</a> <a id="369" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="384" class="Keyword">module</a> <a id="391" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html" class="Module">Armor.Data.X509.SignAlg.ECDSA.Parser</a> <a id="428" class="Keyword">where</a>

<a id="435" class="Keyword">open</a> <a id="440" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a> <a id="466" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="472" class="Keyword">open</a> <a id="477" href="Armor.Grammar.Parallel.html" class="Module">Armor.Grammar.Parallel</a>    <a id="503" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="509" class="Keyword">open</a> <a id="514" href="Armor.Grammar.Parser.html" class="Module">Armor.Grammar.Parser</a>      <a id="540" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>

<a id="547" class="Keyword">private</a>
  <a id="here&#39;"></a><a id="557" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#557" class="Function">here&#39;</a> <a id="563" class="Symbol">=</a> <a id="565" class="String">&quot;X509: SignAlg: ECDSA&quot;</a>

<a id="parseParams"></a><a id="589" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#589" class="Function">parseParams</a> <a id="601" class="Symbol">:</a> <a id="603" class="Symbol">∀</a> <a id="605" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#605" class="Bound">n</a> <a id="607" class="Symbol">{@</a><a id="609" class="Symbol">0</a> <a id="611" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#611" class="Bound">bs</a><a id="613" class="Symbol">}</a> <a id="615" class="Symbol">→</a> <a id="617" class="Symbol">(</a><a id="618" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#618" class="Bound">o</a> <a id="620" class="Symbol">:</a> <a id="622" href="Armor.Data.X690-DER.OID.TCB.html#2963" class="Function">OID</a> <a id="626" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#611" class="Bound">bs</a><a id="628" class="Symbol">)</a> <a id="630" class="Symbol">(</a><a id="631" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#631" class="Bound">o∈?</a> <a id="635" class="Symbol">:</a> <a id="637" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="641" class="Symbol">((</a><a id="643" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="646" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="654" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#618" class="Bound">o</a><a id="655" class="Symbol">)</a> <a id="657" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="659" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#10599" class="Function">OIDs.ECDSA.Supported</a><a id="679" class="Symbol">))</a>
              <a id="696" class="Symbol">→</a> <a id="698" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="705" class="Symbol">(</a><a id="706" href="Armor.Prelude.html#14201" class="Record">Logging</a> <a id="714" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="716" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="719" class="Symbol">)</a> <a id="721" class="Symbol">(</a><a id="722" href="Armor.Grammar.Parallel.TCB.html#1532" class="Function">ExactLength</a> <a id="734" class="Symbol">(</a><a id="735" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#386" class="Function">ECDSAParams&#39;</a> <a id="748" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#618" class="Bound">o</a> <a id="750" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#631" class="Bound">o∈?</a><a id="753" class="Symbol">)</a> <a id="755" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#605" class="Bound">n</a><a id="756" class="Symbol">)</a>
<a id="758" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#589" class="Function">parseParams</a> <a id="770" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#770" class="Bound">n</a> <a id="772" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#772" class="Bound">o</a> <a id="774" class="Symbol">(</a><a id="775" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="778" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#778" class="Bound">¬p</a><a id="780" class="Symbol">)</a> <a id="782" class="Symbol">=</a>
  <a id="786" href="Armor.Grammar.Parallel.Parser.html#3682" class="Function">parseExactLength</a> <a id="803" class="Symbol">(λ</a> <a id="806" class="Keyword">where</a> <a id="812" class="Symbol">_</a> <a id="814" class="Symbol">())</a> <a id="818" href="Armor.Prelude.html#14663" class="Function">silent</a> <a id="825" href="Armor.Grammar.Parser.Core.html#2514" class="Function">parseFalse</a> <a id="836" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#770" class="Bound">n</a>
<a id="838" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#589" class="Function">parseParams</a> <a id="850" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#850" class="Bound">n</a> <a id="852" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#852" class="Bound">o</a> <a id="854" class="Symbol">(</a><a id="855" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="859" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#859" class="Bound">p</a><a id="860" class="Symbol">)</a> <a id="862" class="Symbol">=</a>
  <a id="866" href="Armor.Grammar.Parallel.Parser.html#3682" class="Function">parseExactLength</a> <a id="883" class="Symbol">(λ</a> <a id="886" class="Keyword">where</a> <a id="892" class="Symbol">_</a> <a id="894" class="Symbol">(</a><a id="895" href="Armor.Prelude.html#7719" class="InductiveConstructor Operator">─</a> <a id="897" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="901" class="Symbol">)</a> <a id="903" class="Symbol">(</a><a id="904" href="Armor.Prelude.html#7719" class="InductiveConstructor Operator">─</a> <a id="906" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="910" class="Symbol">)</a> <a id="912" class="Symbol">→</a> <a id="914" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="918" class="Symbol">)</a>
    <a id="924" class="Symbol">(</a><a id="925" href="Armor.Prelude.html#14135" class="Field">tell</a> <a id="930" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="932" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#557" class="Function">here&#39;</a> <a id="938" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="948" class="String">&quot;: parameter should be absent&quot;</a><a id="978" class="Symbol">)</a>
    <a id="984" class="Symbol">(</a><a id="985" href="Armor.Grammar.Parser.Core.html#1310" class="Function">parseErased</a> <a id="997" class="Symbol">(</a><a id="998" href="Armor.Grammar.Parser.Lit.html#205" class="Function">parseLit</a> <a id="1007" href="Armor.Prelude.html#14663" class="Function">silent</a> <a id="1014" href="Armor.Prelude.html#14663" class="Function">silent</a> <a id="1021" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1023" class="Symbol">))</a> <a id="1026" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#850" class="Bound">n</a>

<a id="parse"></a><a id="1029" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#1029" class="Function">parse</a> <a id="1035" class="Symbol">:</a> <a id="1037" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="1044" class="Symbol">(</a><a id="1045" href="Armor.Prelude.html#14201" class="Record">Logging</a> <a id="1053" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1055" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="1058" class="Symbol">)</a> <a id="1060" href="Armor.Data.X509.SignAlg.ECDSA.TCB.html#1155" class="Function">ECDSA</a>
<a id="1066" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#1029" class="Function">parse</a> <a id="1072" class="Symbol">=</a> <a id="1074" href="Armor.Data.X690-DER.Sequence.DefinedByOID.Parser.html#1562" class="Function">DefinedByOID.parse</a> <a id="1093" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#557" class="Function">here&#39;</a> <a id="1099" class="Symbol">λ</a> <a id="1101" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#1101" class="Bound">n</a> <a id="1103" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#1103" class="Bound">o</a> <a id="1105" class="Symbol">→</a> <a id="1107" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#589" class="Function">parseParams</a> <a id="1119" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#1101" class="Bound">n</a> <a id="1121" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#1103" class="Bound">o</a> <a id="1123" class="Symbol">((</a><a id="1125" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="1128" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="1136" href="Armor.Data.X509.SignAlg.ECDSA.Parser.html#1103" class="Bound">o</a><a id="1137" class="Symbol">)</a> <a id="1139" href="Armor.Prelude.html#11072" class="Function Operator">∈?</a> <a id="1142" href="Armor.Data.X509.SignAlg.TCB.OIDs.html#10599" class="Function">OIDs.ECDSA.Supported</a><a id="1162" class="Symbol">)</a>
</pre></body></html>