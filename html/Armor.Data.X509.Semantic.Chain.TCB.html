<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.Semantic.Chain.TCB</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a>  <a id="14" class="Pragma">--sized-types</a> <a id="28" class="Symbol">#-}</a>

<a id="33" class="Keyword">open</a> <a id="38" class="Keyword">import</a> <a id="45" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="58" class="Keyword">open</a> <a id="63" class="Keyword">import</a> <a id="70" href="Armor.Data.X509.html" class="Module">Armor.Data.X509</a>
<a id="86" class="Keyword">open</a> <a id="91" class="Keyword">import</a> <a id="98" href="Armor.Data.X509.Semantic.Chain.NameMatch.html" class="Module">Armor.Data.X509.Semantic.Chain.NameMatch</a>
<a id="139" class="Keyword">open</a> <a id="144" class="Keyword">import</a> <a id="151" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="166" class="Keyword">module</a> <a id="173" href="Armor.Data.X509.Semantic.Chain.TCB.html" class="Module">Armor.Data.X509.Semantic.Chain.TCB</a> <a id="208" class="Keyword">where</a>

<a id="215" class="Comment">-- IssuerFor c₁ c₂ := &quot;a cert for the issuer of c₁ is c₂&quot;</a>
<a id="_IsIssuerFor_"></a><a id="273" href="Armor.Data.X509.Semantic.Chain.TCB.html#273" class="Function Operator">_IsIssuerFor_</a> <a id="287" class="Symbol">:</a> <a id="289" class="Symbol">∀</a> <a id="291" class="Symbol">{@</a><a id="293" class="Symbol">0</a> <a id="295" href="Armor.Data.X509.Semantic.Chain.TCB.html#295" class="Bound">bs₁</a> <a id="299" href="Armor.Data.X509.Semantic.Chain.TCB.html#299" class="Bound">bs₂</a><a id="302" class="Symbol">}</a> <a id="304" class="Symbol">→</a> <a id="306" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="311" href="Armor.Data.X509.Semantic.Chain.TCB.html#295" class="Bound">bs₁</a> <a id="315" class="Symbol">→</a> <a id="317" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="322" href="Armor.Data.X509.Semantic.Chain.TCB.html#299" class="Bound">bs₂</a> <a id="326" class="Symbol">→</a> <a id="328" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="332" href="Armor.Data.X509.Semantic.Chain.TCB.html#273" class="Function Operator">_IsIssuerFor_</a> <a id="346" href="Armor.Data.X509.Semantic.Chain.TCB.html#346" class="Bound">issuer</a> <a id="353" href="Armor.Data.X509.Semantic.Chain.TCB.html#353" class="Bound">issuee</a> <a id="360" class="Symbol">=</a> <a id="362" href="Armor.Data.X509.Semantic.Chain.NameMatch.html#7148" class="Function">NameMatch</a> <a id="372" class="Symbol">(</a><a id="373" href="Armor.Data.X509.Cert.TCB.html#7367" class="Function">Cert.getIssuer</a> <a id="388" href="Armor.Data.X509.Semantic.Chain.TCB.html#353" class="Bound">issuee</a><a id="394" class="Symbol">)</a> <a id="396" class="Symbol">(</a><a id="397" href="Armor.Data.X509.Cert.TCB.html#7440" class="Function">Cert.getSubject</a> <a id="413" href="Armor.Data.X509.Semantic.Chain.TCB.html#346" class="Bound">issuer</a><a id="419" class="Symbol">)</a>

<a id="_isIssuerFor?_"></a><a id="422" href="Armor.Data.X509.Semantic.Chain.TCB.html#422" class="Function Operator">_isIssuerFor?_</a> <a id="437" class="Symbol">:</a>  <a id="440" class="Symbol">∀</a> <a id="442" class="Symbol">{@</a><a id="444" class="Symbol">0</a> <a id="446" href="Armor.Data.X509.Semantic.Chain.TCB.html#446" class="Bound">bs₁</a> <a id="450" href="Armor.Data.X509.Semantic.Chain.TCB.html#450" class="Bound">bs₂</a><a id="453" class="Symbol">}</a> <a id="455" class="Symbol">→</a> <a id="457" class="Symbol">(</a><a id="458" href="Armor.Data.X509.Semantic.Chain.TCB.html#458" class="Bound">issuer</a> <a id="465" class="Symbol">:</a> <a id="467" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="472" href="Armor.Data.X509.Semantic.Chain.TCB.html#446" class="Bound">bs₁</a><a id="475" class="Symbol">)</a> <a id="477" class="Symbol">→</a> <a id="479" class="Symbol">(</a><a id="480" href="Armor.Data.X509.Semantic.Chain.TCB.html#480" class="Bound">issuee</a> <a id="487" class="Symbol">:</a> <a id="489" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="494" href="Armor.Data.X509.Semantic.Chain.TCB.html#450" class="Bound">bs₂</a><a id="497" class="Symbol">)</a> <a id="499" class="Symbol">→</a> <a id="501" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="505" class="Symbol">(</a><a id="506" href="Armor.Data.X509.Semantic.Chain.TCB.html#458" class="Bound">issuer</a> <a id="513" href="Armor.Data.X509.Semantic.Chain.TCB.html#273" class="Function Operator">IsIssuerFor</a> <a id="525" href="Armor.Data.X509.Semantic.Chain.TCB.html#480" class="Bound">issuee</a><a id="531" class="Symbol">)</a>
<a id="533" href="Armor.Data.X509.Semantic.Chain.TCB.html#533" class="Bound">issuer</a> <a id="540" href="Armor.Data.X509.Semantic.Chain.TCB.html#422" class="Function Operator">isIssuerFor?</a> <a id="553" href="Armor.Data.X509.Semantic.Chain.TCB.html#553" class="Bound">issuee</a> <a id="560" class="Symbol">=</a> <a id="562" href="Armor.Data.X509.Semantic.Chain.NameMatch.html#7512" class="Function">nameMatch?</a> <a id="573" class="Symbol">(</a><a id="574" href="Armor.Data.X509.Cert.TCB.html#7367" class="Function">Cert.getIssuer</a> <a id="589" href="Armor.Data.X509.Semantic.Chain.TCB.html#553" class="Bound">issuee</a><a id="595" class="Symbol">)</a> <a id="597" class="Symbol">(</a><a id="598" href="Armor.Data.X509.Cert.TCB.html#7440" class="Function">Cert.getSubject</a> <a id="614" href="Armor.Data.X509.Semantic.Chain.TCB.html#533" class="Bound">issuer</a><a id="620" class="Symbol">)</a>

<a id="_IsIssuerFor_In_"></a><a id="623" href="Armor.Data.X509.Semantic.Chain.TCB.html#623" class="Function Operator">_IsIssuerFor_In_</a> <a id="640" class="Symbol">:</a> <a id="642" class="Symbol">∀</a> <a id="644" class="Symbol">{@</a><a id="646" class="Symbol">0</a> <a id="648" href="Armor.Data.X509.Semantic.Chain.TCB.html#648" class="Bound">bs₁</a> <a id="652" href="Armor.Data.X509.Semantic.Chain.TCB.html#652" class="Bound">bs₂</a><a id="655" class="Symbol">}</a> <a id="657" class="Symbol">→</a> <a id="659" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="664" href="Armor.Data.X509.Semantic.Chain.TCB.html#648" class="Bound">bs₁</a> <a id="668" class="Symbol">→</a> <a id="670" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="675" href="Armor.Data.X509.Semantic.Chain.TCB.html#652" class="Bound">bs₂</a> <a id="679" class="Symbol">→</a> <a id="681" class="Symbol">(</a><a id="682" href="Armor.Data.X509.Semantic.Chain.TCB.html#682" class="Bound">certs</a> <a id="688" class="Symbol">:</a> <a id="690" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="695" class="Symbol">(</a><a id="696" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="704" class="Symbol">_</a> <a id="706" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="710" class="Symbol">))</a> <a id="713" class="Symbol">→</a> <a id="715" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="719" href="Armor.Data.X509.Semantic.Chain.TCB.html#719" class="Bound">issuer</a> <a id="726" href="Armor.Data.X509.Semantic.Chain.TCB.html#623" class="Function Operator">IsIssuerFor</a> <a id="738" href="Armor.Data.X509.Semantic.Chain.TCB.html#738" class="Bound">issuee</a> <a id="745" href="Armor.Data.X509.Semantic.Chain.TCB.html#623" class="Function Operator">In</a> <a id="748" href="Armor.Data.X509.Semantic.Chain.TCB.html#748" class="Bound">certs</a> <a id="754" class="Symbol">=</a> <a id="756" href="Armor.Data.X509.Semantic.Chain.TCB.html#719" class="Bound">issuer</a> <a id="763" href="Armor.Data.X509.Semantic.Chain.TCB.html#273" class="Function Operator">IsIssuerFor</a> <a id="775" href="Armor.Data.X509.Semantic.Chain.TCB.html#738" class="Bound">issuee</a> <a id="782" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="784" class="Symbol">(</a><a id="785" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="787" class="Symbol">_</a> <a id="789" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="791" href="Armor.Data.X509.Semantic.Chain.TCB.html#719" class="Bound">issuer</a><a id="797" class="Symbol">)</a> <a id="799" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="801" href="Armor.Data.X509.Semantic.Chain.TCB.html#748" class="Bound">certs</a>

<a id="IssuerFor_In_"></a><a id="808" href="Armor.Data.X509.Semantic.Chain.TCB.html#808" class="Function Operator">IssuerFor_In_</a> <a id="822" class="Symbol">:</a> <a id="824" class="Symbol">∀</a> <a id="826" class="Symbol">{@</a><a id="828" class="Symbol">0</a> <a id="830" href="Armor.Data.X509.Semantic.Chain.TCB.html#830" class="Bound">bs</a><a id="832" class="Symbol">}</a> <a id="834" class="Symbol">→</a> <a id="836" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="841" href="Armor.Data.X509.Semantic.Chain.TCB.html#830" class="Bound">bs</a> <a id="844" class="Symbol">→</a> <a id="846" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="851" class="Symbol">(</a><a id="852" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="860" class="Symbol">_</a> <a id="862" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="866" class="Symbol">)</a> <a id="868" class="Symbol">→</a> <a id="870" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="874" href="Armor.Data.X509.Semantic.Chain.TCB.html#808" class="Function Operator">IssuerFor</a> <a id="884" href="Armor.Data.X509.Semantic.Chain.TCB.html#884" class="Bound">issuee</a> <a id="891" href="Armor.Data.X509.Semantic.Chain.TCB.html#808" class="Function Operator">In</a> <a id="894" href="Armor.Data.X509.Semantic.Chain.TCB.html#894" class="Bound">certs</a> <a id="900" class="Symbol">=</a> <a id="902" href="Agda.Builtin.Sigma.html#166" class="Record">Σ</a> <a id="904" class="Symbol">(</a><a id="905" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="913" class="Symbol">_</a> <a id="915" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="919" class="Symbol">)</a> <a id="921" class="Symbol">(λ</a> <a id="924" class="Keyword">where</a> <a id="930" class="Symbol">(</a><a id="931" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="933" class="Symbol">_</a> <a id="935" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="937" href="Armor.Data.X509.Semantic.Chain.TCB.html#937" class="Bound">issuer</a><a id="943" class="Symbol">)</a> <a id="945" class="Symbol">→</a> <a id="947" href="Armor.Data.X509.Semantic.Chain.TCB.html#937" class="Bound">issuer</a> <a id="954" href="Armor.Data.X509.Semantic.Chain.TCB.html#623" class="Function Operator">IsIssuerFor</a> <a id="966" href="Armor.Data.X509.Semantic.Chain.TCB.html#884" class="Bound">issuee</a> <a id="973" href="Armor.Data.X509.Semantic.Chain.TCB.html#623" class="Function Operator">In</a> <a id="976" href="Armor.Data.X509.Semantic.Chain.TCB.html#894" class="Bound">certs</a><a id="981" class="Symbol">)</a>

<a id="IssuersFor_In_"></a><a id="984" href="Armor.Data.X509.Semantic.Chain.TCB.html#984" class="Function Operator">IssuersFor_In_</a> <a id="999" class="Symbol">:</a> <a id="1001" class="Symbol">{@</a><a id="1003" class="Symbol">0</a> <a id="1005" href="Armor.Data.X509.Semantic.Chain.TCB.html#1005" class="Bound">bs</a> <a id="1008" class="Symbol">:</a> <a id="1010" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1015" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="1020" class="Symbol">}</a> <a id="1022" class="Symbol">(</a><a id="1023" href="Armor.Data.X509.Semantic.Chain.TCB.html#1023" class="Bound">issuee</a> <a id="1030" class="Symbol">:</a> <a id="1032" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="1037" href="Armor.Data.X509.Semantic.Chain.TCB.html#1005" class="Bound">bs</a><a id="1039" class="Symbol">)</a> <a id="1041" class="Symbol">(</a><a id="1042" href="Armor.Data.X509.Semantic.Chain.TCB.html#1042" class="Bound">certs</a> <a id="1048" class="Symbol">:</a> <a id="1050" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1055" class="Symbol">(</a><a id="1056" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="1064" class="Symbol">_</a> <a id="1066" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="1070" class="Symbol">))</a> <a id="1073" class="Symbol">→</a> <a id="1075" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1079" href="Armor.Data.X509.Semantic.Chain.TCB.html#984" class="Function Operator">IssuersFor</a> <a id="1090" href="Armor.Data.X509.Semantic.Chain.TCB.html#1090" class="Bound">issuee</a> <a id="1097" href="Armor.Data.X509.Semantic.Chain.TCB.html#984" class="Function Operator">In</a> <a id="1100" href="Armor.Data.X509.Semantic.Chain.TCB.html#1100" class="Bound">certs</a> <a id="1106" class="Symbol">=</a> <a id="1108" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1113" class="Symbol">(</a><a id="1114" href="Armor.Data.X509.Semantic.Chain.TCB.html#808" class="Function Operator">IssuerFor</a> <a id="1124" href="Armor.Data.X509.Semantic.Chain.TCB.html#1090" class="Bound">issuee</a> <a id="1131" href="Armor.Data.X509.Semantic.Chain.TCB.html#808" class="Function Operator">In</a> <a id="1134" href="Armor.Data.X509.Semantic.Chain.TCB.html#1100" class="Bound">certs</a><a id="1139" class="Symbol">)</a>

<a id="1142" class="Keyword">pattern</a> <a id="anIssuerForIn"></a><a id="1150" href="Armor.Data.X509.Semantic.Chain.TCB.html#1150" class="InductiveConstructor">anIssuerForIn</a><a id="1163" class="Symbol">{</a><a id="1164" href="Armor.Data.X509.Semantic.Chain.TCB.html#1210" class="Bound">bs</a><a id="1166" class="Symbol">}</a> <a id="1168" href="Armor.Data.X509.Semantic.Chain.TCB.html#1214" class="Bound">issuer</a> <a id="1175" href="Armor.Data.X509.Semantic.Chain.TCB.html#1227" class="Bound">isIssuerFor</a> <a id="1187" href="Armor.Data.X509.Semantic.Chain.TCB.html#1239" class="Bound">issuer∈</a> <a id="1195" class="Symbol">=</a> <a id="1197" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="1201" class="Symbol">(</a><a id="1202" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="1206" class="Symbol">(</a><a id="1207" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─_</a> <a id="1210" href="Armor.Data.X509.Semantic.Chain.TCB.html#1210" class="Bound">bs</a><a id="1212" class="Symbol">)</a> <a id="1214" href="Armor.Data.X509.Semantic.Chain.TCB.html#1214" class="Bound">issuer</a><a id="1220" class="Symbol">)</a> <a id="1222" class="Symbol">(</a><a id="1223" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="1227" href="Armor.Data.X509.Semantic.Chain.TCB.html#1227" class="Bound">isIssuerFor</a> <a id="1239" href="Armor.Data.X509.Semantic.Chain.TCB.html#1239" class="Bound">issuer∈</a><a id="1246" class="Symbol">)</a>

<a id="getIssuerCert"></a><a id="1249" href="Armor.Data.X509.Semantic.Chain.TCB.html#1249" class="Function">getIssuerCert</a> <a id="1263" class="Symbol">:</a> <a id="1265" class="Symbol">∀</a> <a id="1267" class="Symbol">{@</a><a id="1269" class="Symbol">0</a> <a id="1271" href="Armor.Data.X509.Semantic.Chain.TCB.html#1271" class="Bound">bs</a><a id="1273" class="Symbol">}</a> <a id="1275" class="Symbol">{</a><a id="1276" href="Armor.Data.X509.Semantic.Chain.TCB.html#1276" class="Bound">issuee</a> <a id="1283" class="Symbol">:</a> <a id="1285" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="1290" href="Armor.Data.X509.Semantic.Chain.TCB.html#1271" class="Bound">bs</a><a id="1292" class="Symbol">}</a> <a id="1294" class="Symbol">{</a><a id="1295" href="Armor.Data.X509.Semantic.Chain.TCB.html#1295" class="Bound">certs</a><a id="1300" class="Symbol">}</a> <a id="1302" class="Symbol">→</a> <a id="1304" class="Symbol">(</a><a id="1305" href="Armor.Data.X509.Semantic.Chain.TCB.html#1305" class="Bound">iss</a> <a id="1309" class="Symbol">:</a> <a id="1311" href="Armor.Data.X509.Semantic.Chain.TCB.html#808" class="Function Operator">IssuerFor</a> <a id="1321" href="Armor.Data.X509.Semantic.Chain.TCB.html#1276" class="Bound">issuee</a> <a id="1328" href="Armor.Data.X509.Semantic.Chain.TCB.html#808" class="Function Operator">In</a> <a id="1331" href="Armor.Data.X509.Semantic.Chain.TCB.html#1295" class="Bound">certs</a><a id="1336" class="Symbol">)</a> <a id="1338" class="Symbol">→</a> <a id="1340" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="1345" class="Symbol">(</a><a id="1346" href="Armor.Prelude.html#7861" class="Function Operator">¡</a> <a id="1348" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="1354" class="Symbol">(</a><a id="1355" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="1361" href="Armor.Data.X509.Semantic.Chain.TCB.html#1305" class="Bound">iss</a><a id="1364" class="Symbol">))</a>
<a id="1367" href="Armor.Data.X509.Semantic.Chain.TCB.html#1249" class="Function">getIssuerCert</a> <a id="1381" class="Symbol">(</a><a id="1382" href="Armor.Data.X509.Semantic.Chain.TCB.html#1150" class="InductiveConstructor">anIssuerForIn</a><a id="1395" class="Symbol">{</a><a id="1396" href="Armor.Data.X509.Semantic.Chain.TCB.html#1396" class="Bound">bs</a><a id="1398" class="Symbol">}</a> <a id="1400" href="Armor.Data.X509.Semantic.Chain.TCB.html#1400" class="Bound">issuer</a> <a id="1407" class="Symbol">_</a> <a id="1409" class="Symbol">_)</a> <a id="1412" class="Symbol">=</a> <a id="1414" href="Armor.Data.X509.Semantic.Chain.TCB.html#1400" class="Bound">issuer</a>

<a id="IsAllIssuersForIn-syntax"></a><a id="1422" href="Armor.Data.X509.Semantic.Chain.TCB.html#1422" class="Function">IsAllIssuersForIn-syntax</a> <a id="1447" class="Symbol">:</a> <a id="1449" class="Symbol">{@</a><a id="1451" class="Symbol">0</a> <a id="1453" href="Armor.Data.X509.Semantic.Chain.TCB.html#1453" class="Bound">bs</a> <a id="1456" class="Symbol">:</a> <a id="1458" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1463" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="1468" class="Symbol">}</a> <a id="1470" class="Symbol">(</a><a id="1471" href="Armor.Data.X509.Semantic.Chain.TCB.html#1471" class="Bound">issuee</a> <a id="1478" class="Symbol">:</a> <a id="1480" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="1485" href="Armor.Data.X509.Semantic.Chain.TCB.html#1453" class="Bound">bs</a><a id="1487" class="Symbol">)</a> <a id="1489" class="Symbol">(</a><a id="1490" href="Armor.Data.X509.Semantic.Chain.TCB.html#1490" class="Bound">certs</a> <a id="1496" class="Symbol">:</a> <a id="1498" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1503" class="Symbol">(</a><a id="1504" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="1512" class="Symbol">_</a> <a id="1514" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="1518" class="Symbol">))</a> <a id="1521" class="Symbol">→</a> <a id="1523" href="Armor.Data.X509.Semantic.Chain.TCB.html#984" class="Function Operator">IssuersFor</a> <a id="1534" href="Armor.Data.X509.Semantic.Chain.TCB.html#1471" class="Bound">issuee</a> <a id="1541" href="Armor.Data.X509.Semantic.Chain.TCB.html#984" class="Function Operator">In</a> <a id="1544" href="Armor.Data.X509.Semantic.Chain.TCB.html#1490" class="Bound">certs</a> <a id="1550" class="Symbol">→</a> <a id="1552" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1556" href="Armor.Data.X509.Semantic.Chain.TCB.html#1422" class="Function">IsAllIssuersForIn-syntax</a> <a id="1581" href="Armor.Data.X509.Semantic.Chain.TCB.html#1581" class="Bound">issuee</a> <a id="1588" href="Armor.Data.X509.Semantic.Chain.TCB.html#1588" class="Bound">certs</a> <a id="1594" href="Armor.Data.X509.Semantic.Chain.TCB.html#1594" class="Bound">issuers</a> <a id="1602" class="Symbol">=</a> <a id="1604" href="Data.List.Relation.Unary.All.html#1444" class="Datatype">All</a> <a id="1608" class="Symbol">(λ</a> <a id="1611" class="Symbol">(</a><a id="1612" href="Armor.Prelude.html#7820" class="InductiveConstructor Operator">─</a> <a id="1614" class="Symbol">_</a> <a id="1616" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1618" href="Armor.Data.X509.Semantic.Chain.TCB.html#1618" class="Bound">cert</a><a id="1622" class="Symbol">)</a> <a id="1624" class="Symbol">→</a> <a id="1626" href="Armor.Data.X509.Semantic.Chain.TCB.html#1618" class="Bound">cert</a> <a id="1631" href="Armor.Data.X509.Semantic.Chain.TCB.html#273" class="Function Operator">IsIssuerFor</a> <a id="1643" href="Armor.Data.X509.Semantic.Chain.TCB.html#1581" class="Bound">issuee</a> <a id="1650" class="Symbol">→</a> <a id="1652" class="Symbol">(</a><a id="1653" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="1656" href="Armor.Data.X509.Semantic.Chain.TCB.html#1618" class="Bound">cert</a><a id="1660" class="Symbol">)</a> <a id="1662" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="1664" href="Data.List.Base.html#1544" class="Function">map</a> <a id="1668" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="1674" href="Armor.Data.X509.Semantic.Chain.TCB.html#1594" class="Bound">issuers</a><a id="1681" class="Symbol">)</a> <a id="1683" href="Armor.Data.X509.Semantic.Chain.TCB.html#1588" class="Bound">certs</a>

<a id="1690" class="Keyword">syntax</a> <a id="1697" href="Armor.Data.X509.Semantic.Chain.TCB.html#1422" class="Function">IsAllIssuersForIn-syntax</a> <a id="1722" class="Bound">issuee</a> <a id="1729" class="Bound">certs</a> <a id="1735" class="Bound">issuers</a> <a id="1743" class="Symbol">=</a> <a id="1745" class="Bound">issuers</a> <a id="1753" class="Function">IsAllIssuersFor</a> <a id="1769" class="Bound">issuee</a> <a id="1776" class="Function">In</a> <a id="1779" class="Bound">certs</a>

<a id="AllIssuersFor_In_"></a><a id="1786" href="Armor.Data.X509.Semantic.Chain.TCB.html#1786" class="Function Operator">AllIssuersFor_In_</a> <a id="1804" class="Symbol">:</a> <a id="1806" class="Symbol">{@</a><a id="1808" class="Symbol">0</a> <a id="1810" href="Armor.Data.X509.Semantic.Chain.TCB.html#1810" class="Bound">bs</a> <a id="1813" class="Symbol">:</a> <a id="1815" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1820" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="1825" class="Symbol">}</a> <a id="1827" class="Symbol">(</a><a id="1828" href="Armor.Data.X509.Semantic.Chain.TCB.html#1828" class="Bound">issuee</a> <a id="1835" class="Symbol">:</a> <a id="1837" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="1842" href="Armor.Data.X509.Semantic.Chain.TCB.html#1810" class="Bound">bs</a><a id="1844" class="Symbol">)</a> <a id="1846" class="Symbol">(</a><a id="1847" href="Armor.Data.X509.Semantic.Chain.TCB.html#1847" class="Bound">certs</a> <a id="1853" class="Symbol">:</a> <a id="1855" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1860" class="Symbol">(</a><a id="1861" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="1869" class="Symbol">_</a> <a id="1871" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="1875" class="Symbol">))</a> <a id="1878" class="Symbol">→</a> <a id="1880" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="1884" href="Armor.Data.X509.Semantic.Chain.TCB.html#1786" class="Function Operator">AllIssuersFor</a> <a id="1898" href="Armor.Data.X509.Semantic.Chain.TCB.html#1898" class="Bound">issuee</a> <a id="1905" href="Armor.Data.X509.Semantic.Chain.TCB.html#1786" class="Function Operator">In</a> <a id="1908" href="Armor.Data.X509.Semantic.Chain.TCB.html#1908" class="Bound">certs</a> <a id="1914" class="Symbol">=</a> <a id="1916" href="Agda.Builtin.Sigma.html#166" class="Record">Σ</a> <a id="1918" class="Symbol">(</a><a id="1919" href="Armor.Data.X509.Semantic.Chain.TCB.html#984" class="Function Operator">IssuersFor</a> <a id="1930" href="Armor.Data.X509.Semantic.Chain.TCB.html#1898" class="Bound">issuee</a> <a id="1937" href="Armor.Data.X509.Semantic.Chain.TCB.html#984" class="Function Operator">In</a> <a id="1940" href="Armor.Data.X509.Semantic.Chain.TCB.html#1908" class="Bound">certs</a><a id="1945" class="Symbol">)</a> <a id="1947" class="Symbol">λ</a> <a id="1949" href="Armor.Data.X509.Semantic.Chain.TCB.html#1949" class="Bound">issuers</a> <a id="1957" class="Symbol">→</a> <a id="1959" class="Symbol">(</a><a id="1960" href="Armor.Data.X509.Semantic.Chain.TCB.html#1949" class="Bound">issuers</a> <a id="1968" href="Armor.Data.X509.Semantic.Chain.TCB.html#1422" class="Function">IsAllIssuersFor</a> <a id="1984" href="Armor.Data.X509.Semantic.Chain.TCB.html#1898" class="Bound">issuee</a> <a id="1991" href="Armor.Data.X509.Semantic.Chain.TCB.html#1422" class="Function">In</a> <a id="1994" href="Armor.Data.X509.Semantic.Chain.TCB.html#1908" class="Bound">certs</a><a id="1999" class="Symbol">)</a>


<a id="2003" class="Comment">{- https://datatracker.ietf.org/doc/html/rfc5280#section-6.1
-- The trust anchor is an input to the algorithm.  There is no
-- requirement that the same trust anchor be used to validate all
-- certification paths.  Different trust anchors MAY be used to validate
-- different paths, as discussed further in Section 6.2.
--
-- The primary goal of path validation is to verify the binding between
-- a subject distinguished name or a subject alternative name and
-- subject public key, as represented in the target certificate, based
-- on the public key of the trust anchor.  In most cases, the target
-- certificate will be an end entity certificate, but the target
-- certificate may be a CA certificate as long as the subject public key
-- is to be used for a purpose other than verifying the signature on a
-- public key certificate.  Verifying the binding between the name and
-- subject public key requires obtaining a sequence of certificates that
-- support that binding.  The procedure performed to obtain this
-- sequence of certificates is outside the scope of this specification.
--
-- To meet this goal, the path validation process verifies, among other
-- things, that a prospective certification path (a sequence of n
-- certificates) satisfies the following conditions:
--
--    (a)  for all x in {1, ..., n-1}, the subject of certificate x is
--         the issuer of certificate x+1;
--
--    (b)  certificate 1 is issued by the trust anchor;
--
--    (c)  certificate n is the certificate to be validated (i.e., the
--         target certificate); and
--
--    (d)  for all x in {1, ..., n}, the certificate was valid at the
--         time in question.
--
-- A certificate MUST NOT appear more than once in a prospective
-- certification path.
--
-- When the trust anchor is provided in the form of a self-signed
-- certificate, this self-signed certificate is not included as part of
-- the prospective certification path.  Information about trust anchors
-- is provided as inputs to the certification path validation algorithm
-- (Section 6.1.1).
-}</a>

<a id="4075" class="Keyword">abstract</a>
  <a id="removeCertFromCerts"></a><a id="4086" href="Armor.Data.X509.Semantic.Chain.TCB.html#4086" class="Function">removeCertFromCerts</a> <a id="4106" class="Symbol">:</a> <a id="4108" class="Symbol">∀</a> <a id="4110" class="Symbol">{@</a><a id="4112" class="Symbol">0</a> <a id="4114" href="Armor.Data.X509.Semantic.Chain.TCB.html#4114" class="Bound">bs</a><a id="4116" class="Symbol">}</a> <a id="4118" class="Symbol">→</a> <a id="4120" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="4125" href="Armor.Data.X509.Semantic.Chain.TCB.html#4114" class="Bound">bs</a> <a id="4128" class="Symbol">→</a> <a id="4130" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4135" class="Symbol">(</a><a id="4136" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="4144" class="Symbol">_</a> <a id="4146" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="4150" class="Symbol">)</a> <a id="4152" class="Symbol">→</a> <a id="4154" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4159" class="Symbol">(</a><a id="4160" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="4168" class="Symbol">_</a> <a id="4170" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="4174" class="Symbol">)</a>
  <a id="4178" href="Armor.Data.X509.Semantic.Chain.TCB.html#4086" class="Function">removeCertFromCerts</a> <a id="4198" href="Armor.Data.X509.Semantic.Chain.TCB.html#4198" class="Bound">issuer</a> <a id="4205" href="Armor.Data.X509.Semantic.Chain.TCB.html#4205" class="Bound">certs</a> <a id="4211" class="Symbol">=</a> <a id="4213" href="Data.List.Base.html#8092" class="Function">filter</a> <a id="4220" class="Symbol">(λ</a> <a id="4223" href="Armor.Data.X509.Semantic.Chain.TCB.html#4223" class="Bound">c</a> <a id="4225" class="Symbol">→</a> <a id="4227" href="Armor.Prelude.html#11022" class="Function Operator">_≠_</a> <a id="4231" class="Symbol">⦃</a> <a id="4233" href="Armor.Data.X690-DER.TLV.Properties.html#5667" class="Function">TLV.eqTLV</a> <a id="4243" class="Symbol">⦃</a> <a id="4245" href="Armor.Data.X509.Cert.Eq.html#1063" class="Function">Cert.eq</a> <a id="4253" class="Symbol">⦄</a> <a id="4255" class="Symbol">⦄</a> <a id="4257" href="Armor.Data.X509.Semantic.Chain.TCB.html#4223" class="Bound">c</a> <a id="4259" class="Symbol">(</a><a id="4260" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="4263" href="Armor.Data.X509.Semantic.Chain.TCB.html#4198" class="Bound">issuer</a><a id="4269" class="Symbol">))</a> <a id="4272" href="Armor.Data.X509.Semantic.Chain.TCB.html#4205" class="Bound">certs</a>

  <a id="∈removeCertFromCerts⇒"></a><a id="4281" href="Armor.Data.X509.Semantic.Chain.TCB.html#4281" class="Function">∈removeCertFromCerts⇒</a>
    <a id="4307" class="Symbol">:</a> <a id="4309" class="Symbol">∀</a> <a id="4311" class="Symbol">{@</a><a id="4313" class="Symbol">0</a> <a id="4315" href="Armor.Data.X509.Semantic.Chain.TCB.html#4315" class="Bound">bs₁</a> <a id="4319" href="Armor.Data.X509.Semantic.Chain.TCB.html#4319" class="Bound">bs₂</a><a id="4322" class="Symbol">}</a> <a id="4324" class="Symbol">{</a><a id="4325" href="Armor.Data.X509.Semantic.Chain.TCB.html#4325" class="Bound">c₁</a> <a id="4328" class="Symbol">:</a> <a id="4330" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="4335" href="Armor.Data.X509.Semantic.Chain.TCB.html#4315" class="Bound">bs₁</a><a id="4338" class="Symbol">}</a> <a id="4340" class="Symbol">{</a><a id="4341" href="Armor.Data.X509.Semantic.Chain.TCB.html#4341" class="Bound">c₂</a> <a id="4344" class="Symbol">:</a> <a id="4346" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="4351" href="Armor.Data.X509.Semantic.Chain.TCB.html#4319" class="Bound">bs₂</a><a id="4354" class="Symbol">}</a> <a id="4356" class="Symbol">(</a><a id="4357" href="Armor.Data.X509.Semantic.Chain.TCB.html#4357" class="Bound">certs</a> <a id="4363" class="Symbol">:</a> <a id="4365" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4370" class="Symbol">(</a><a id="4371" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="4379" class="Symbol">_</a> <a id="4381" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="4385" class="Symbol">))</a>
      <a id="4394" class="Symbol">→</a> <a id="4396" class="Symbol">(</a><a id="4397" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="4400" href="Armor.Data.X509.Semantic.Chain.TCB.html#4325" class="Bound">c₁</a><a id="4402" class="Symbol">)</a> <a id="4404" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="4406" href="Armor.Data.X509.Semantic.Chain.TCB.html#4086" class="Function">removeCertFromCerts</a> <a id="4426" href="Armor.Data.X509.Semantic.Chain.TCB.html#4341" class="Bound">c₂</a> <a id="4429" href="Armor.Data.X509.Semantic.Chain.TCB.html#4357" class="Bound">certs</a> <a id="4435" class="Symbol">→</a> <a id="4437" class="Symbol">(</a><a id="4438" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="4441" href="Armor.Data.X509.Semantic.Chain.TCB.html#4325" class="Bound">c₁</a><a id="4443" class="Symbol">)</a> <a id="4445" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="4447" href="Armor.Data.X509.Semantic.Chain.TCB.html#4357" class="Bound">certs</a>
  <a id="4455" href="Armor.Data.X509.Semantic.Chain.TCB.html#4281" class="Function">∈removeCertFromCerts⇒</a><a id="4476" class="Symbol">{</a><a id="4477" class="Argument">c₁</a> <a id="4480" class="Symbol">=</a> <a id="4482" href="Armor.Data.X509.Semantic.Chain.TCB.html#4482" class="Bound">c₁</a><a id="4484" class="Symbol">}{</a><a id="4486" href="Armor.Data.X509.Semantic.Chain.TCB.html#4486" class="Bound">c₂</a><a id="4488" class="Symbol">}</a> <a id="4490" href="Armor.Data.X509.Semantic.Chain.TCB.html#4490" class="Bound">certs</a> <a id="4496" href="Armor.Data.X509.Semantic.Chain.TCB.html#4496" class="Bound">c₁∈</a> <a id="4500" class="Symbol">=</a> <a id="4502" href="Agda.Builtin.Sigma.html#252" class="Field">proj₁</a> <a id="4508" class="Symbol">(</a><a id="4509" href="Data.List.Membership.Propositional.Properties.html#8613" class="Function">∈.∈-filter⁻</a> <a id="4521" class="Symbol">(</a><a id="4522" href="Armor.Prelude.html#11022" class="Function Operator">_≠</a> <a id="4525" class="Symbol">(</a><a id="4526" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="4529" href="Armor.Data.X509.Semantic.Chain.TCB.html#4486" class="Bound">c₂</a><a id="4531" class="Symbol">))</a> <a id="4534" href="Armor.Data.X509.Semantic.Chain.TCB.html#4496" class="Bound">c₁∈</a><a id="4537" class="Symbol">)</a>
    <a id="4543" class="Keyword">where</a>
    <a id="4553" class="Keyword">import</a> <a id="4560" href="Data.List.Membership.Propositional.Properties.html" class="Module">Data.List.Membership.Propositional.Properties</a> <a id="4606" class="Symbol">as</a> <a id="4609" class="Module">∈</a>

  <a id="∉removeCertFromCerts"></a><a id="4614" href="Armor.Data.X509.Semantic.Chain.TCB.html#4614" class="Function">∉removeCertFromCerts</a> <a id="4635" class="Symbol">:</a> <a id="4637" class="Symbol">∀</a> <a id="4639" class="Symbol">{@</a><a id="4641" class="Symbol">0</a> <a id="4643" href="Armor.Data.X509.Semantic.Chain.TCB.html#4643" class="Bound">bs</a><a id="4645" class="Symbol">}</a> <a id="4647" class="Symbol">(</a><a id="4648" href="Armor.Data.X509.Semantic.Chain.TCB.html#4648" class="Bound">c</a> <a id="4650" class="Symbol">:</a> <a id="4652" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="4657" href="Armor.Data.X509.Semantic.Chain.TCB.html#4643" class="Bound">bs</a><a id="4659" class="Symbol">)</a> <a id="4661" class="Symbol">(</a><a id="4662" href="Armor.Data.X509.Semantic.Chain.TCB.html#4662" class="Bound">certs</a> <a id="4668" class="Symbol">:</a> <a id="4670" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4675" class="Symbol">(</a><a id="4676" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="4684" class="Symbol">_</a> <a id="4686" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="4690" class="Symbol">))</a> <a id="4693" class="Symbol">→</a> <a id="4695" class="Symbol">(</a><a id="4696" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="4699" href="Armor.Data.X509.Semantic.Chain.TCB.html#4648" class="Bound">c</a><a id="4700" class="Symbol">)</a> <a id="4702" href="Data.List.Membership.Setoid.html#936" class="Function Operator">∉</a> <a id="4704" href="Armor.Data.X509.Semantic.Chain.TCB.html#4086" class="Function">removeCertFromCerts</a> <a id="4724" href="Armor.Data.X509.Semantic.Chain.TCB.html#4648" class="Bound">c</a> <a id="4726" href="Armor.Data.X509.Semantic.Chain.TCB.html#4662" class="Bound">certs</a>
  <a id="4734" href="Armor.Data.X509.Semantic.Chain.TCB.html#4614" class="Function">∉removeCertFromCerts</a> <a id="4755" href="Armor.Data.X509.Semantic.Chain.TCB.html#4755" class="Bound">c</a> <a id="4757" href="Armor.Data.X509.Semantic.Chain.TCB.html#4757" class="Bound">certs</a> <a id="4763" href="Armor.Data.X509.Semantic.Chain.TCB.html#4763" class="Bound">c∈removed</a> <a id="4773" class="Symbol">=</a>
    <a id="4779" href="Armor.Prelude.html#6155" class="Function">contradiction</a> <a id="4793" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="4798" class="Symbol">(</a><a id="4799" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="4805" class="Symbol">(</a><a id="4806" href="Data.List.Membership.Propositional.Properties.html#8613" class="Function">∈.∈-filter⁻</a> <a id="4818" class="Symbol">(</a><a id="4819" href="Armor.Prelude.html#11022" class="Function Operator">_≠</a> <a id="4822" class="Symbol">(</a><a id="4823" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="4826" href="Armor.Data.X509.Semantic.Chain.TCB.html#4755" class="Bound">c</a><a id="4827" class="Symbol">))</a> <a id="4830" class="Symbol">{</a><a id="4831" class="Argument">xs</a> <a id="4834" class="Symbol">=</a> <a id="4836" href="Armor.Data.X509.Semantic.Chain.TCB.html#4757" class="Bound">certs</a><a id="4841" class="Symbol">}</a> <a id="4843" href="Armor.Data.X509.Semantic.Chain.TCB.html#4763" class="Bound">c∈removed</a><a id="4852" class="Symbol">))</a>
    <a id="4859" class="Keyword">where</a>
    <a id="4869" class="Keyword">import</a> <a id="4876" href="Data.List.Membership.Propositional.Properties.html" class="Module">Data.List.Membership.Propositional.Properties</a> <a id="4922" class="Symbol">as</a> <a id="4925" class="Module">∈</a>

  <a id="removeCertFromCerts&lt;"></a><a id="4930" href="Armor.Data.X509.Semantic.Chain.TCB.html#4930" class="Function">removeCertFromCerts&lt;</a> <a id="4951" class="Symbol">:</a> <a id="4953" class="Symbol">∀</a> <a id="4955" class="Symbol">{@</a><a id="4957" class="Symbol">0</a> <a id="4959" href="Armor.Data.X509.Semantic.Chain.TCB.html#4959" class="Bound">bs</a><a id="4961" class="Symbol">}</a> <a id="4963" class="Symbol">(</a><a id="4964" href="Armor.Data.X509.Semantic.Chain.TCB.html#4964" class="Bound">c</a> <a id="4966" class="Symbol">:</a> <a id="4968" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="4973" href="Armor.Data.X509.Semantic.Chain.TCB.html#4959" class="Bound">bs</a><a id="4975" class="Symbol">)</a> <a id="4977" class="Symbol">(</a><a id="4978" href="Armor.Data.X509.Semantic.Chain.TCB.html#4978" class="Bound">certs</a> <a id="4984" class="Symbol">:</a> <a id="4986" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4991" class="Symbol">(</a><a id="4992" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="5000" class="Symbol">_</a> <a id="5002" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="5006" class="Symbol">))</a> <a id="5009" class="Symbol">→</a> <a id="5011" class="Symbol">(</a><a id="5012" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="5015" href="Armor.Data.X509.Semantic.Chain.TCB.html#4964" class="Bound">c</a><a id="5016" class="Symbol">)</a> <a id="5018" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="5020" href="Armor.Data.X509.Semantic.Chain.TCB.html#4978" class="Bound">certs</a> <a id="5026" class="Symbol">→</a> <a id="5028" href="Data.List.Base.html#4864" class="Function">length</a> <a id="5035" class="Symbol">(</a><a id="5036" href="Armor.Data.X509.Semantic.Chain.TCB.html#4086" class="Function">removeCertFromCerts</a> <a id="5056" href="Armor.Data.X509.Semantic.Chain.TCB.html#4964" class="Bound">c</a> <a id="5058" href="Armor.Data.X509.Semantic.Chain.TCB.html#4978" class="Bound">certs</a><a id="5063" class="Symbol">)</a> <a id="5065" href="Data.Nat.Base.html#1645" class="Function Operator">&lt;</a> <a id="5067" href="Data.List.Base.html#4864" class="Function">length</a> <a id="5074" href="Armor.Data.X509.Semantic.Chain.TCB.html#4978" class="Bound">certs</a>
  <a id="5082" href="Armor.Data.X509.Semantic.Chain.TCB.html#4930" class="Function">removeCertFromCerts&lt;</a> <a id="5103" href="Armor.Data.X509.Semantic.Chain.TCB.html#5103" class="Bound">c</a> <a id="5105" href="Armor.Data.X509.Semantic.Chain.TCB.html#5105" class="Bound">certs</a> <a id="5111" href="Armor.Data.X509.Semantic.Chain.TCB.html#5111" class="Bound">c∈</a> <a id="5114" class="Symbol">=</a> <a id="5116" href="Data.List.Properties.html#27318" class="Function">filter-notAll</a> <a id="5130" class="Symbol">(</a><a id="5131" href="Armor.Prelude.html#11022" class="Function Operator">_≠</a> <a id="5134" class="Symbol">(</a><a id="5135" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="5138" href="Armor.Data.X509.Semantic.Chain.TCB.html#5103" class="Bound">c</a><a id="5139" class="Symbol">))</a> <a id="5142" href="Armor.Data.X509.Semantic.Chain.TCB.html#5105" class="Bound">certs</a> <a id="5148" class="Symbol">(</a><a id="5149" href="Data.List.Relation.Unary.Any.html#1643" class="Function">Any.map</a> <a id="5157" class="Symbol">(λ</a> <a id="5160" class="Keyword">where</a> <a id="5166" href="Armor.Data.X509.Semantic.Chain.TCB.html#5166" class="Bound">≡c</a> <a id="5169" href="Armor.Data.X509.Semantic.Chain.TCB.html#5169" class="Bound">≢c</a> <a id="5172" class="Symbol">→</a> <a id="5174" href="Armor.Data.X509.Semantic.Chain.TCB.html#5169" class="Bound">≢c</a> <a id="5177" class="Symbol">(</a><a id="5178" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="5182" href="Armor.Data.X509.Semantic.Chain.TCB.html#5166" class="Bound">≡c</a><a id="5184" class="Symbol">))</a> <a id="5187" href="Armor.Data.X509.Semantic.Chain.TCB.html#5111" class="Bound">c∈</a><a id="5189" class="Symbol">)</a>

<a id="5192" class="Keyword">data</a> <a id="Chain"></a><a id="5197" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="5203" class="Symbol">(</a><a id="5204" href="Armor.Data.X509.Semantic.Chain.TCB.html#5204" class="Bound">trustedRoot</a> <a id="5216" href="Armor.Data.X509.Semantic.Chain.TCB.html#5216" class="Bound">candidates</a> <a id="5227" class="Symbol">:</a> <a id="5229" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5234" class="Symbol">(</a><a id="5235" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="5243" class="Symbol">_</a> <a id="5245" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="5249" class="Symbol">))</a> <a id="5252" class="Symbol">:</a> <a id="5254" class="Symbol">∀</a> <a id="5256" class="Symbol">{@</a><a id="5258" class="Symbol">0</a> <a id="5260" href="Armor.Data.X509.Semantic.Chain.TCB.html#5260" class="Bound">bs</a><a id="5262" class="Symbol">}</a> <a id="5264" class="Symbol">→</a> <a id="5266" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="5271" href="Armor.Data.X509.Semantic.Chain.TCB.html#5260" class="Bound">bs</a> <a id="5274" class="Symbol">→</a> <a id="5276" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="5280" class="Keyword">where</a>
  <a id="Chain.root"></a><a id="5288" href="Armor.Data.X509.Semantic.Chain.TCB.html#5288" class="InductiveConstructor">root</a> <a id="5293" class="Symbol">:</a> <a id="5295" class="Symbol">∀</a> <a id="5297" class="Symbol">{@</a><a id="5299" class="Symbol">0</a> <a id="5301" href="Armor.Data.X509.Semantic.Chain.TCB.html#5301" class="Bound">bs</a><a id="5303" class="Symbol">}</a> <a id="5305" class="Symbol">{</a><a id="5306" href="Armor.Data.X509.Semantic.Chain.TCB.html#5306" class="Bound">c</a> <a id="5308" class="Symbol">:</a> <a id="5310" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="5315" href="Armor.Data.X509.Semantic.Chain.TCB.html#5301" class="Bound">bs</a><a id="5317" class="Symbol">}</a> <a id="5319" class="Symbol">→</a> <a id="5321" href="Armor.Data.X509.Semantic.Chain.TCB.html#808" class="Function Operator">IssuerFor</a> <a id="5331" href="Armor.Data.X509.Semantic.Chain.TCB.html#5306" class="Bound">c</a> <a id="5333" href="Armor.Data.X509.Semantic.Chain.TCB.html#808" class="Function Operator">In</a> <a id="5336" href="Armor.Data.X509.Semantic.Chain.TCB.html#5204" class="Bound">trustedRoot</a> <a id="5348" class="Symbol">→</a> <a id="5350" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="5356" href="Armor.Data.X509.Semantic.Chain.TCB.html#5204" class="Bound">trustedRoot</a> <a id="5368" href="Armor.Data.X509.Semantic.Chain.TCB.html#5216" class="Bound">candidates</a> <a id="5379" href="Armor.Data.X509.Semantic.Chain.TCB.html#5306" class="Bound">c</a>
  <a id="Chain.link"></a><a id="5383" href="Armor.Data.X509.Semantic.Chain.TCB.html#5383" class="InductiveConstructor">link</a> <a id="5388" class="Symbol">:</a> <a id="5390" class="Symbol">∀</a> <a id="5392" class="Symbol">{@</a><a id="5394" class="Symbol">0</a> <a id="5396" href="Armor.Data.X509.Semantic.Chain.TCB.html#5396" class="Bound">bs₁</a> <a id="5400" href="Armor.Data.X509.Semantic.Chain.TCB.html#5400" class="Bound">bs₂</a><a id="5403" class="Symbol">}</a> <a id="5405" class="Symbol">(</a><a id="5406" href="Armor.Data.X509.Semantic.Chain.TCB.html#5406" class="Bound">issuer</a> <a id="5413" class="Symbol">:</a> <a id="5415" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="5420" href="Armor.Data.X509.Semantic.Chain.TCB.html#5396" class="Bound">bs₁</a><a id="5423" class="Symbol">)</a> <a id="5425" class="Symbol">{</a><a id="5426" href="Armor.Data.X509.Semantic.Chain.TCB.html#5426" class="Bound">c₂</a> <a id="5429" class="Symbol">:</a> <a id="5431" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="5436" href="Armor.Data.X509.Semantic.Chain.TCB.html#5400" class="Bound">bs₂</a><a id="5439" class="Symbol">}</a>
         <a id="5450" class="Symbol">→</a> <a id="5452" class="Symbol">(</a><a id="5453" href="Armor.Data.X509.Semantic.Chain.TCB.html#5453" class="Bound">isIn</a> <a id="5458" class="Symbol">:</a> <a id="5460" href="Armor.Data.X509.Semantic.Chain.TCB.html#5406" class="Bound">issuer</a> <a id="5467" href="Armor.Data.X509.Semantic.Chain.TCB.html#623" class="Function Operator">IsIssuerFor</a> <a id="5479" href="Armor.Data.X509.Semantic.Chain.TCB.html#5426" class="Bound">c₂</a> <a id="5482" href="Armor.Data.X509.Semantic.Chain.TCB.html#623" class="Function Operator">In</a> <a id="5485" href="Armor.Data.X509.Semantic.Chain.TCB.html#5216" class="Bound">candidates</a><a id="5495" class="Symbol">)</a>
         <a id="5506" class="Symbol">→</a> <a id="5508" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="5514" class="Symbol">(</a><a id="5515" href="Armor.Data.X509.Semantic.Chain.TCB.html#4086" class="Function">removeCertFromCerts</a> <a id="5535" href="Armor.Data.X509.Semantic.Chain.TCB.html#5406" class="Bound">issuer</a> <a id="5542" href="Armor.Data.X509.Semantic.Chain.TCB.html#5204" class="Bound">trustedRoot</a><a id="5553" class="Symbol">)</a>
                 <a id="5572" class="Symbol">(</a><a id="5573" href="Armor.Data.X509.Semantic.Chain.TCB.html#4086" class="Function">removeCertFromCerts</a> <a id="5593" href="Armor.Data.X509.Semantic.Chain.TCB.html#5406" class="Bound">issuer</a> <a id="5600" href="Armor.Data.X509.Semantic.Chain.TCB.html#5216" class="Bound">candidates</a><a id="5610" class="Symbol">)</a>
                 <a id="5629" href="Armor.Data.X509.Semantic.Chain.TCB.html#5406" class="Bound">issuer</a>
         <a id="5645" class="Symbol">→</a> <a id="5647" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="5653" href="Armor.Data.X509.Semantic.Chain.TCB.html#5204" class="Bound">trustedRoot</a> <a id="5665" href="Armor.Data.X509.Semantic.Chain.TCB.html#5216" class="Bound">candidates</a> <a id="5676" href="Armor.Data.X509.Semantic.Chain.TCB.html#5426" class="Bound">c₂</a>

<a id="isLink?"></a><a id="5680" href="Armor.Data.X509.Semantic.Chain.TCB.html#5680" class="Function">isLink?</a> <a id="5688" class="Symbol">:</a> <a id="5690" class="Symbol">∀</a> <a id="5692" class="Symbol">{</a><a id="5693" href="Armor.Data.X509.Semantic.Chain.TCB.html#5693" class="Bound">trustedRoot</a> <a id="5705" href="Armor.Data.X509.Semantic.Chain.TCB.html#5705" class="Bound">candidates</a> <a id="5716" class="Symbol">:</a> <a id="5718" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="5723" class="Symbol">(</a><a id="5724" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="5732" class="Symbol">_</a> <a id="5734" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="5738" class="Symbol">)}</a> <a id="5741" class="Symbol">{@</a><a id="5743" class="Symbol">0</a> <a id="5745" href="Armor.Data.X509.Semantic.Chain.TCB.html#5745" class="Bound">bs</a><a id="5747" class="Symbol">}</a> <a id="5749" class="Symbol">{</a><a id="5750" href="Armor.Data.X509.Semantic.Chain.TCB.html#5750" class="Bound">c</a> <a id="5752" class="Symbol">:</a> <a id="5754" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="5759" href="Armor.Data.X509.Semantic.Chain.TCB.html#5745" class="Bound">bs</a><a id="5761" class="Symbol">}</a>
          <a id="5773" class="Symbol">→</a> <a id="5775" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="5781" href="Armor.Data.X509.Semantic.Chain.TCB.html#5693" class="Bound">trustedRoot</a> <a id="5793" href="Armor.Data.X509.Semantic.Chain.TCB.html#5705" class="Bound">candidates</a> <a id="5804" href="Armor.Data.X509.Semantic.Chain.TCB.html#5750" class="Bound">c</a> <a id="5806" class="Symbol">→</a> <a id="5808" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="5813" href="Armor.Data.X509.Semantic.Chain.TCB.html#5680" class="Function">isLink?</a> <a id="5821" class="Symbol">(</a><a id="5822" href="Armor.Data.X509.Semantic.Chain.TCB.html#5288" class="InductiveConstructor">root</a> <a id="5827" class="Symbol">_)</a> <a id="5830" class="Symbol">=</a> <a id="5832" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="5838" href="Armor.Data.X509.Semantic.Chain.TCB.html#5680" class="Function">isLink?</a> <a id="5846" class="Symbol">(</a><a id="5847" href="Armor.Data.X509.Semantic.Chain.TCB.html#5383" class="InductiveConstructor">link</a> <a id="5852" class="Symbol">_</a> <a id="5854" class="Symbol">_</a> <a id="5856" class="Symbol">_)</a> <a id="5859" class="Symbol">=</a> <a id="5861" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>

<a id="5867" class="Comment">-- produces a list of certs corresponding to the chain, plus the trusted issuer certificate</a>
<a id="toList"></a><a id="5959" href="Armor.Data.X509.Semantic.Chain.TCB.html#5959" class="Function">toList</a> <a id="5966" class="Symbol">:</a> <a id="5968" class="Symbol">∀</a> <a id="5970" class="Symbol">{</a><a id="5971" href="Armor.Data.X509.Semantic.Chain.TCB.html#5971" class="Bound">trustedRoot</a> <a id="5983" href="Armor.Data.X509.Semantic.Chain.TCB.html#5983" class="Bound">candidates</a><a id="5993" class="Symbol">}</a> <a id="5995" class="Symbol">{@</a><a id="5997" class="Symbol">0</a> <a id="5999" href="Armor.Data.X509.Semantic.Chain.TCB.html#5999" class="Bound">bs</a><a id="6001" class="Symbol">}</a> <a id="6003" class="Symbol">{</a><a id="6004" href="Armor.Data.X509.Semantic.Chain.TCB.html#6004" class="Bound">issuee</a> <a id="6011" class="Symbol">:</a> <a id="6013" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="6018" href="Armor.Data.X509.Semantic.Chain.TCB.html#5999" class="Bound">bs</a><a id="6020" class="Symbol">}</a> <a id="6022" class="Symbol">→</a> <a id="6024" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="6030" href="Armor.Data.X509.Semantic.Chain.TCB.html#5971" class="Bound">trustedRoot</a> <a id="6042" href="Armor.Data.X509.Semantic.Chain.TCB.html#5983" class="Bound">candidates</a> <a id="6053" href="Armor.Data.X509.Semantic.Chain.TCB.html#6004" class="Bound">issuee</a> <a id="6060" class="Symbol">→</a> <a id="6062" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6067" class="Symbol">(</a><a id="6068" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="6076" class="Symbol">_</a> <a id="6078" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="6082" class="Symbol">)</a>
<a id="6084" href="Armor.Data.X509.Semantic.Chain.TCB.html#5959" class="Function">toList</a><a id="6090" class="Symbol">{</a><a id="6091" class="Argument">issuee</a> <a id="6098" class="Symbol">=</a> <a id="6100" href="Armor.Data.X509.Semantic.Chain.TCB.html#6100" class="Bound">issuee</a><a id="6106" class="Symbol">}</a> <a id="6108" class="Symbol">(</a><a id="6109" href="Armor.Data.X509.Semantic.Chain.TCB.html#5288" class="InductiveConstructor">root</a> <a id="6114" class="Symbol">(</a><a id="6115" href="Armor.Data.X509.Semantic.Chain.TCB.html#6115" class="Bound">issuer</a> <a id="6122" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="6124" class="Symbol">_))</a> <a id="6128" class="Symbol">=</a> <a id="6130" class="Symbol">(</a><a id="6131" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="6134" href="Armor.Data.X509.Semantic.Chain.TCB.html#6100" class="Bound">issuee</a><a id="6140" class="Symbol">)</a> <a id="6142" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6144" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="6146" href="Armor.Data.X509.Semantic.Chain.TCB.html#6115" class="Bound">issuer</a> <a id="6153" href="Data.List.Base.html#5025" class="Function Operator">]</a>
<a id="6155" href="Armor.Data.X509.Semantic.Chain.TCB.html#5959" class="Function">toList</a><a id="6161" class="Symbol">{</a><a id="6162" href="Armor.Data.X509.Semantic.Chain.TCB.html#6162" class="Bound">trustedRoot</a><a id="6173" class="Symbol">}{</a><a id="6175" class="Argument">issuee</a> <a id="6182" class="Symbol">=</a> <a id="6184" href="Armor.Data.X509.Semantic.Chain.TCB.html#6184" class="Bound">issuee</a><a id="6190" class="Symbol">}</a> <a id="6192" class="Symbol">(</a><a id="6193" href="Armor.Data.X509.Semantic.Chain.TCB.html#5383" class="InductiveConstructor">link</a> <a id="6198" href="Armor.Data.X509.Semantic.Chain.TCB.html#6198" class="Bound">issuer</a> <a id="6205" href="Armor.Data.X509.Semantic.Chain.TCB.html#6205" class="Bound">isIn</a> <a id="6210" href="Armor.Data.X509.Semantic.Chain.TCB.html#6210" class="Bound">chain</a><a id="6215" class="Symbol">)</a> <a id="6217" class="Symbol">=</a> <a id="6219" class="Symbol">(</a><a id="6220" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="6223" href="Armor.Data.X509.Semantic.Chain.TCB.html#6184" class="Bound">issuee</a><a id="6229" class="Symbol">)</a> <a id="6231" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="6233" href="Armor.Data.X509.Semantic.Chain.TCB.html#5959" class="Function">toList</a> <a id="6240" href="Armor.Data.X509.Semantic.Chain.TCB.html#6210" class="Bound">chain</a>

<a id="getPath"></a><a id="6247" href="Armor.Data.X509.Semantic.Chain.TCB.html#6247" class="Function">getPath</a> <a id="6255" class="Symbol">:</a> <a id="6257" class="Symbol">∀</a> <a id="6259" class="Symbol">{</a><a id="6260" href="Armor.Data.X509.Semantic.Chain.TCB.html#6260" class="Bound">trustedRoot</a> <a id="6272" href="Armor.Data.X509.Semantic.Chain.TCB.html#6272" class="Bound">candidates</a><a id="6282" class="Symbol">}</a> <a id="6284" class="Symbol">{@</a><a id="6286" class="Symbol">0</a> <a id="6288" href="Armor.Data.X509.Semantic.Chain.TCB.html#6288" class="Bound">bs</a><a id="6290" class="Symbol">}</a> <a id="6292" class="Symbol">{</a><a id="6293" href="Armor.Data.X509.Semantic.Chain.TCB.html#6293" class="Bound">issuee</a> <a id="6300" class="Symbol">:</a> <a id="6302" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="6307" href="Armor.Data.X509.Semantic.Chain.TCB.html#6288" class="Bound">bs</a><a id="6309" class="Symbol">}</a> <a id="6311" class="Symbol">→</a> <a id="6313" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="6319" href="Armor.Data.X509.Semantic.Chain.TCB.html#6260" class="Bound">trustedRoot</a> <a id="6331" href="Armor.Data.X509.Semantic.Chain.TCB.html#6272" class="Bound">candidates</a> <a id="6342" href="Armor.Data.X509.Semantic.Chain.TCB.html#6293" class="Bound">issuee</a> <a id="6349" class="Symbol">→</a> <a id="6351" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6356" class="Symbol">(</a><a id="6357" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="6365" class="Symbol">_</a> <a id="6367" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="6371" class="Symbol">)</a>
<a id="6373" href="Armor.Data.X509.Semantic.Chain.TCB.html#6247" class="Function">getPath</a> <a id="6381" href="Armor.Data.X509.Semantic.Chain.TCB.html#6381" class="Bound">c</a> <a id="6383" class="Symbol">=</a> <a id="6385" href="Data.List.Base.html#7307" class="Function">take</a> <a id="6390" class="Symbol">(</a><a id="6391" href="Data.List.Base.html#4864" class="Function">length</a> <a id="6398" href="Armor.Data.X509.Semantic.Chain.TCB.html#6425" class="Function">certs</a> <a id="6404" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">-</a> <a id="6406" class="Number">1</a><a id="6407" class="Symbol">)</a> <a id="6409" href="Armor.Data.X509.Semantic.Chain.TCB.html#6425" class="Function">certs</a>
  <a id="6417" class="Keyword">where</a>
  <a id="6425" href="Armor.Data.X509.Semantic.Chain.TCB.html#6425" class="Function">certs</a> <a id="6431" class="Symbol">=</a> <a id="6433" href="Armor.Data.X509.Semantic.Chain.TCB.html#5959" class="Function">toList</a> <a id="6440" href="Armor.Data.X509.Semantic.Chain.TCB.html#6381" class="Bound">c</a>

<a id="getIssuers"></a><a id="6443" href="Armor.Data.X509.Semantic.Chain.TCB.html#6443" class="Function">getIssuers</a> <a id="6454" class="Symbol">:</a> <a id="6456" class="Symbol">∀</a> <a id="6458" class="Symbol">{</a><a id="6459" href="Armor.Data.X509.Semantic.Chain.TCB.html#6459" class="Bound">trustedRoot</a> <a id="6471" href="Armor.Data.X509.Semantic.Chain.TCB.html#6471" class="Bound">candidates</a><a id="6481" class="Symbol">}</a> <a id="6483" class="Symbol">{@</a><a id="6485" class="Symbol">0</a> <a id="6487" href="Armor.Data.X509.Semantic.Chain.TCB.html#6487" class="Bound">bs</a><a id="6489" class="Symbol">}</a> <a id="6491" class="Symbol">{</a><a id="6492" href="Armor.Data.X509.Semantic.Chain.TCB.html#6492" class="Bound">issuee</a> <a id="6499" class="Symbol">:</a> <a id="6501" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="6506" href="Armor.Data.X509.Semantic.Chain.TCB.html#6487" class="Bound">bs</a><a id="6508" class="Symbol">}</a> <a id="6510" class="Symbol">→</a> <a id="6512" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="6518" href="Armor.Data.X509.Semantic.Chain.TCB.html#6459" class="Bound">trustedRoot</a> <a id="6530" href="Armor.Data.X509.Semantic.Chain.TCB.html#6471" class="Bound">candidates</a> <a id="6541" href="Armor.Data.X509.Semantic.Chain.TCB.html#6492" class="Bound">issuee</a> <a id="6548" class="Symbol">→</a> <a id="6550" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6555" class="Symbol">(</a><a id="6556" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="6564" class="Symbol">_</a> <a id="6566" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="6570" class="Symbol">)</a>
<a id="6572" href="Armor.Data.X509.Semantic.Chain.TCB.html#6443" class="Function">getIssuers</a> <a id="6583" href="Armor.Data.X509.Semantic.Chain.TCB.html#6583" class="Bound">c</a> <a id="6585" class="Symbol">=</a> <a id="6587" href="Data.List.Base.html#7427" class="Function">drop</a> <a id="6592" class="Number">1</a> <a id="6594" class="Symbol">(</a><a id="6595" href="Armor.Data.X509.Semantic.Chain.TCB.html#5959" class="Function">toList</a> <a id="6602" href="Armor.Data.X509.Semantic.Chain.TCB.html#6583" class="Bound">c</a><a id="6603" class="Symbol">)</a>

<a id="getIntermediates"></a><a id="6606" href="Armor.Data.X509.Semantic.Chain.TCB.html#6606" class="Function">getIntermediates</a> <a id="6623" class="Symbol">:</a> <a id="6625" class="Symbol">∀</a> <a id="6627" class="Symbol">{</a><a id="6628" href="Armor.Data.X509.Semantic.Chain.TCB.html#6628" class="Bound">trustedRoot</a> <a id="6640" href="Armor.Data.X509.Semantic.Chain.TCB.html#6640" class="Bound">candidates</a><a id="6650" class="Symbol">}</a> <a id="6652" class="Symbol">{@</a><a id="6654" class="Symbol">0</a> <a id="6656" href="Armor.Data.X509.Semantic.Chain.TCB.html#6656" class="Bound">bs</a><a id="6658" class="Symbol">}</a> <a id="6660" class="Symbol">{</a><a id="6661" href="Armor.Data.X509.Semantic.Chain.TCB.html#6661" class="Bound">issuee</a> <a id="6668" class="Symbol">:</a> <a id="6670" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="6675" href="Armor.Data.X509.Semantic.Chain.TCB.html#6656" class="Bound">bs</a><a id="6677" class="Symbol">}</a> <a id="6679" class="Symbol">→</a> <a id="6681" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="6687" href="Armor.Data.X509.Semantic.Chain.TCB.html#6628" class="Bound">trustedRoot</a> <a id="6699" href="Armor.Data.X509.Semantic.Chain.TCB.html#6640" class="Bound">candidates</a> <a id="6710" href="Armor.Data.X509.Semantic.Chain.TCB.html#6661" class="Bound">issuee</a> <a id="6717" class="Symbol">→</a> <a id="6719" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="6724" class="Symbol">(</a><a id="6725" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="6733" class="Symbol">_</a> <a id="6735" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="6739" class="Symbol">)</a>
<a id="6741" href="Armor.Data.X509.Semantic.Chain.TCB.html#6606" class="Function">getIntermediates</a> <a id="6758" href="Armor.Data.X509.Semantic.Chain.TCB.html#6758" class="Bound">c</a> <a id="6760" class="Symbol">=</a> <a id="6762" href="Data.List.Base.html#7307" class="Function">take</a> <a id="6767" class="Symbol">(</a><a id="6768" href="Data.List.Base.html#4864" class="Function">length</a> <a id="6775" href="Armor.Data.X509.Semantic.Chain.TCB.html#6806" class="Function">issuers</a> <a id="6783" href="Agda.Builtin.Nat.html#415" class="Primitive Operator">-</a> <a id="6785" class="Number">1</a><a id="6786" class="Symbol">)</a> <a id="6788" href="Armor.Data.X509.Semantic.Chain.TCB.html#6806" class="Function">issuers</a>
  <a id="6798" class="Keyword">where</a>
  <a id="6806" href="Armor.Data.X509.Semantic.Chain.TCB.html#6806" class="Function">issuers</a> <a id="6814" class="Symbol">=</a> <a id="6816" href="Armor.Data.X509.Semantic.Chain.TCB.html#6443" class="Function">getIssuers</a> <a id="6827" href="Armor.Data.X509.Semantic.Chain.TCB.html#6758" class="Bound">c</a>

<a id="toListLength≥1"></a><a id="6830" href="Armor.Data.X509.Semantic.Chain.TCB.html#6830" class="Function">toListLength≥1</a> <a id="6845" class="Symbol">:</a> <a id="6847" class="Symbol">∀</a> <a id="6849" class="Symbol">{</a><a id="6850" href="Armor.Data.X509.Semantic.Chain.TCB.html#6850" class="Bound">trustedRoot</a> <a id="6862" href="Armor.Data.X509.Semantic.Chain.TCB.html#6862" class="Bound">candidates</a><a id="6872" class="Symbol">}</a> <a id="6874" class="Symbol">{@</a><a id="6876" class="Symbol">0</a> <a id="6878" href="Armor.Data.X509.Semantic.Chain.TCB.html#6878" class="Bound">bs</a><a id="6880" class="Symbol">}</a> <a id="6882" class="Symbol">{</a><a id="6883" href="Armor.Data.X509.Semantic.Chain.TCB.html#6883" class="Bound">issuee</a> <a id="6890" class="Symbol">:</a> <a id="6892" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="6897" href="Armor.Data.X509.Semantic.Chain.TCB.html#6878" class="Bound">bs</a><a id="6899" class="Symbol">}</a> <a id="6901" class="Symbol">→</a> <a id="6903" class="Symbol">(</a><a id="6904" href="Armor.Data.X509.Semantic.Chain.TCB.html#6904" class="Bound">c</a> <a id="6906" class="Symbol">:</a> <a id="6908" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="6914" href="Armor.Data.X509.Semantic.Chain.TCB.html#6850" class="Bound">trustedRoot</a> <a id="6926" href="Armor.Data.X509.Semantic.Chain.TCB.html#6862" class="Bound">candidates</a> <a id="6937" href="Armor.Data.X509.Semantic.Chain.TCB.html#6883" class="Bound">issuee</a><a id="6943" class="Symbol">)</a>
                 <a id="6962" class="Symbol">→</a> <a id="6964" href="Data.List.Base.html#4864" class="Function">length</a> <a id="6971" class="Symbol">(</a><a id="6972" href="Armor.Data.X509.Semantic.Chain.TCB.html#5959" class="Function">toList</a> <a id="6979" href="Armor.Data.X509.Semantic.Chain.TCB.html#6904" class="Bound">c</a><a id="6980" class="Symbol">)</a> <a id="6982" href="Data.Nat.Base.html#1679" class="Function Operator">≥</a> <a id="6984" class="Number">1</a>
<a id="6986" href="Armor.Data.X509.Semantic.Chain.TCB.html#6830" class="Function">toListLength≥1</a> <a id="7001" class="Symbol">(</a><a id="7002" href="Armor.Data.X509.Semantic.Chain.TCB.html#5288" class="InductiveConstructor">root</a> <a id="7007" class="Symbol">_)</a> <a id="7010" class="Symbol">=</a> <a id="7012" href="Data.Nat.Base.html#1600" class="InductiveConstructor">s≤s</a> <a id="7016" href="Data.Nat.Base.html#1558" class="InductiveConstructor">z≤n</a>
<a id="7020" href="Armor.Data.X509.Semantic.Chain.TCB.html#6830" class="Function">toListLength≥1</a> <a id="7035" class="Symbol">(</a><a id="7036" href="Armor.Data.X509.Semantic.Chain.TCB.html#5383" class="InductiveConstructor">link</a> <a id="7041" class="Symbol">_</a> <a id="7043" class="Symbol">_</a> <a id="7045" href="Armor.Data.X509.Semantic.Chain.TCB.html#7045" class="Bound">c</a><a id="7046" class="Symbol">)</a> <a id="7048" class="Symbol">=</a> <a id="7050" href="Data.Nat.Base.html#1600" class="InductiveConstructor">s≤s</a> <a id="7054" href="Data.Nat.Base.html#1558" class="InductiveConstructor">z≤n</a>

<a id="7059" class="Comment">-- certificates in chain are unique</a>
<a id="ChainUnique"></a><a id="7095" href="Armor.Data.X509.Semantic.Chain.TCB.html#7095" class="Function">ChainUnique</a> <a id="7107" class="Symbol">:</a> <a id="7109" class="Symbol">∀</a> <a id="7111" class="Symbol">{</a><a id="7112" href="Armor.Data.X509.Semantic.Chain.TCB.html#7112" class="Bound">trustedRoot</a> <a id="7124" href="Armor.Data.X509.Semantic.Chain.TCB.html#7124" class="Bound">candidates</a><a id="7134" class="Symbol">}</a> <a id="7136" class="Symbol">{@</a><a id="7138" class="Symbol">0</a> <a id="7140" href="Armor.Data.X509.Semantic.Chain.TCB.html#7140" class="Bound">bs</a><a id="7142" class="Symbol">}</a> <a id="7144" class="Symbol">{</a><a id="7145" href="Armor.Data.X509.Semantic.Chain.TCB.html#7145" class="Bound">issuee</a> <a id="7152" class="Symbol">:</a> <a id="7154" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="7159" href="Armor.Data.X509.Semantic.Chain.TCB.html#7140" class="Bound">bs</a><a id="7161" class="Symbol">}</a> <a id="7163" class="Symbol">→</a> <a id="7165" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="7171" href="Armor.Data.X509.Semantic.Chain.TCB.html#7112" class="Bound">trustedRoot</a> <a id="7183" href="Armor.Data.X509.Semantic.Chain.TCB.html#7124" class="Bound">candidates</a> <a id="7194" href="Armor.Data.X509.Semantic.Chain.TCB.html#7145" class="Bound">issuee</a> <a id="7201" class="Symbol">→</a> <a id="7203" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="7207" href="Armor.Data.X509.Semantic.Chain.TCB.html#7095" class="Function">ChainUnique</a> <a id="7219" href="Armor.Data.X509.Semantic.Chain.TCB.html#7219" class="Bound">c</a> <a id="7221" class="Symbol">=</a> <a id="7223" href="Data.List.Relation.Unary.Unique.Setoid.html#719" class="Datatype">List.Unique</a> <a id="7235" href="Armor.Prelude.html#10989" class="Field Operator">_≟_</a> <a id="7239" class="Symbol">(</a><a id="7240" href="Armor.Data.X509.Semantic.Chain.TCB.html#5959" class="Function">toList</a> <a id="7247" href="Armor.Data.X509.Semantic.Chain.TCB.html#7219" class="Bound">c</a><a id="7248" class="Symbol">)</a>

<a id="7251" class="Comment">-- chain equality (modulo proofs of &quot;IsIssuerFor&quot;)</a>
<a id="_≡Chain_"></a><a id="7302" href="Armor.Data.X509.Semantic.Chain.TCB.html#7302" class="Function Operator">_≡Chain_</a> <a id="7311" class="Symbol">:</a> <a id="7313" class="Symbol">{</a><a id="7314" href="Armor.Data.X509.Semantic.Chain.TCB.html#7314" class="Bound">trustedRoot</a> <a id="7326" href="Armor.Data.X509.Semantic.Chain.TCB.html#7326" class="Bound">candidates</a> <a id="7337" class="Symbol">:</a> <a id="7339" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="7344" class="Symbol">(</a><a id="7345" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="7353" class="Symbol">_</a> <a id="7355" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="7359" class="Symbol">)}</a> <a id="7362" class="Symbol">→</a> <a id="7364" class="Symbol">∀</a> <a id="7366" class="Symbol">{@</a><a id="7368" class="Symbol">0</a> <a id="7370" href="Armor.Data.X509.Semantic.Chain.TCB.html#7370" class="Bound">bs</a><a id="7372" class="Symbol">}</a> <a id="7374" class="Symbol">{</a><a id="7375" href="Armor.Data.X509.Semantic.Chain.TCB.html#7375" class="Bound">endEnt</a> <a id="7382" class="Symbol">:</a> <a id="7384" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="7389" href="Armor.Data.X509.Semantic.Chain.TCB.html#7370" class="Bound">bs</a><a id="7391" class="Symbol">}</a> <a id="7393" class="Symbol">→</a> <a id="7395" class="Symbol">(</a><a id="7396" href="Armor.Data.X509.Semantic.Chain.TCB.html#7396" class="Bound">c₁</a> <a id="7399" href="Armor.Data.X509.Semantic.Chain.TCB.html#7399" class="Bound">c₂</a> <a id="7402" class="Symbol">:</a> <a id="7404" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="7410" href="Armor.Data.X509.Semantic.Chain.TCB.html#7314" class="Bound">trustedRoot</a> <a id="7422" href="Armor.Data.X509.Semantic.Chain.TCB.html#7326" class="Bound">candidates</a> <a id="7433" href="Armor.Data.X509.Semantic.Chain.TCB.html#7375" class="Bound">endEnt</a><a id="7439" class="Symbol">)</a> <a id="7441" class="Symbol">→</a> <a id="7443" href="Agda.Primitive.html#326" class="Primitive">Set</a>
<a id="7447" href="Armor.Data.X509.Semantic.Chain.TCB.html#7447" class="Bound">c₁</a> <a id="7450" href="Armor.Data.X509.Semantic.Chain.TCB.html#7302" class="Function Operator">≡Chain</a> <a id="7457" href="Armor.Data.X509.Semantic.Chain.TCB.html#7457" class="Bound">c₂</a> <a id="7460" class="Symbol">=</a> <a id="7462" href="Armor.Data.X509.Semantic.Chain.TCB.html#5959" class="Function">toList</a> <a id="7469" href="Armor.Data.X509.Semantic.Chain.TCB.html#7447" class="Bound">c₁</a> <a id="7472" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="7474" href="Armor.Data.X509.Semantic.Chain.TCB.html#5959" class="Function">toList</a> <a id="7481" href="Armor.Data.X509.Semantic.Chain.TCB.html#7457" class="Bound">c₂</a>
<a id="7484" class="Comment">-- data _≡Chain_ {trustedRoot candidates : List (Exists─ _ Cert)} : ∀ {@0 bs} {endEnt : Cert bs} → (c₁ c₂ : Chain trustedRoot candidates endEnt) → Set where</a>
<a id="7641" class="Comment">--   root : ∀ {@0 bs} {c : Cert bs} → (iss₁ iss₂ : IssuerFor c In trustedRoot)</a>
<a id="7720" class="Comment">--          → proj₁ iss₁ ≡ proj₁ iss₂</a>
<a id="7758" class="Comment">--          → (root{c = c} iss₁) ≡Chain (root{c = c} iss₂)</a>
<a id="7817" class="Comment">--   link : ∀ {@0 bs₁ bs₂} (issuer : Cert bs₁) {c : Cert bs₂}</a>
<a id="7879" class="Comment">--          → (isIssuer₁ isIssuer₂ : issuer IsIssuerFor c)</a>
<a id="7938" class="Comment">--          → (isIn₁ isIn₂ : (-, issuer) ∈ candidates)</a>
<a id="7993" class="Comment">--          → (c₁ c₂ : Chain (removeCertFromCerts issuer trustedRoot) (removeCertFromCerts issuer candidates) issuer) → c₁ ≡Chain c₂</a>
<a id="8126" class="Comment">--          → (link issuer {c} (isIssuer₁ , isIn₁) c₁) ≡Chain (link issuer {c} (isIssuer₂ , isIn₂) c₂)</a>
</pre></body></html>