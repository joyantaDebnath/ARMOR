<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.Semantic.Cert</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Armor.Data.X509.html" class="Module">Armor.Data.X509</a>
<a id="54" class="Keyword">import</a>      <a id="66" href="Armor.Data.X509.Extension.TCB.OIDs.html" class="Module">Armor.Data.X509.Extension.TCB.OIDs</a> <a id="101" class="Symbol">as</a> <a id="104" class="Module">OIDs</a>
<a id="109" class="Keyword">open</a> <a id="114" class="Keyword">import</a> <a id="121" href="Armor.Data.X509.Semantic.Cert.Utils.html" class="Module">Armor.Data.X509.Semantic.Cert.Utils</a>
<a id="157" class="Keyword">import</a>      <a id="169" href="Armor.Data.X509.Semantic.Cert.R1.html" class="Module">Armor.Data.X509.Semantic.Cert.R1</a> <a id="202" class="Symbol">as</a> <a id="205" class="Module">R1</a>
<a id="208" class="Keyword">import</a>      <a id="220" href="Armor.Data.X509.Semantic.Cert.R2.html" class="Module">Armor.Data.X509.Semantic.Cert.R2</a> <a id="253" class="Symbol">as</a> <a id="256" class="Module">R2</a>
<a id="259" class="Keyword">import</a>      <a id="271" href="Armor.Data.X509.Semantic.Cert.R3.html" class="Module">Armor.Data.X509.Semantic.Cert.R3</a> <a id="304" class="Symbol">as</a> <a id="307" class="Module">R3</a>
<a id="310" class="Keyword">import</a>      <a id="322" href="Armor.Data.X509.Semantic.Cert.R4.html" class="Module">Armor.Data.X509.Semantic.Cert.R4</a> <a id="355" class="Symbol">as</a> <a id="358" class="Module">R4</a>
<a id="361" class="Keyword">import</a>      <a id="373" href="Armor.Data.X509.Semantic.Cert.R5.html" class="Module">Armor.Data.X509.Semantic.Cert.R5</a> <a id="406" class="Symbol">as</a> <a id="409" class="Module">R5</a>
<a id="412" class="Keyword">import</a>      <a id="424" href="Armor.Data.X509.Semantic.Cert.R6.html" class="Module">Armor.Data.X509.Semantic.Cert.R6</a> <a id="457" class="Symbol">as</a> <a id="460" class="Module">R6</a>
<a id="463" class="Keyword">import</a>      <a id="475" href="Armor.Data.X509.Semantic.Cert.R7.html" class="Module">Armor.Data.X509.Semantic.Cert.R7</a> <a id="508" class="Symbol">as</a> <a id="511" class="Module">R7</a>
<a id="514" class="Keyword">import</a>      <a id="526" href="Armor.Data.X509.Semantic.Cert.R8.html" class="Module">Armor.Data.X509.Semantic.Cert.R8</a> <a id="559" class="Symbol">as</a> <a id="562" class="Module">R8</a>
<a id="565" class="Keyword">import</a>      <a id="577" href="Armor.Data.X509.Semantic.Cert.R9.html" class="Module">Armor.Data.X509.Semantic.Cert.R9</a> <a id="610" class="Symbol">as</a> <a id="613" class="Module">R9</a>
<a id="616" class="Keyword">import</a>      <a id="628" href="Armor.Data.X509.Semantic.Cert.R10.html" class="Module">Armor.Data.X509.Semantic.Cert.R10</a> <a id="662" class="Symbol">as</a> <a id="665" class="Module">R10</a>
<a id="669" class="Keyword">import</a>      <a id="681" href="Armor.Data.X509.Semantic.Cert.R11.html" class="Module">Armor.Data.X509.Semantic.Cert.R11</a> <a id="715" class="Symbol">as</a> <a id="718" class="Module">R11</a>
<a id="722" class="Keyword">import</a>      <a id="734" href="Armor.Data.X509.Semantic.Cert.R12.html" class="Module">Armor.Data.X509.Semantic.Cert.R12</a> <a id="768" class="Symbol">as</a> <a id="771" class="Module">R12</a>
<a id="775" class="Keyword">import</a>      <a id="787" href="Armor.Data.X509.Semantic.Cert.R13.html" class="Module">Armor.Data.X509.Semantic.Cert.R13</a> <a id="821" class="Symbol">as</a> <a id="824" class="Module">R13</a>
<a id="828" class="Keyword">import</a>      <a id="840" href="Armor.Data.X509.Semantic.Cert.R14.html" class="Module">Armor.Data.X509.Semantic.Cert.R14</a> <a id="874" class="Symbol">as</a> <a id="877" class="Module">R14</a>
<a id="881" class="Keyword">import</a>      <a id="893" href="Armor.Data.X509.Semantic.Cert.R15.html" class="Module">Armor.Data.X509.Semantic.Cert.R15</a> <a id="927" class="Symbol">as</a> <a id="930" class="Module">R15</a>
<a id="934" class="Keyword">import</a>      <a id="946" href="Armor.Data.X509.Semantic.Cert.R16.html" class="Module">Armor.Data.X509.Semantic.Cert.R16</a> <a id="980" class="Symbol">as</a> <a id="983" class="Module">R16</a>
<a id="987" class="Keyword">import</a>      <a id="999" href="Armor.Data.X509.Semantic.Cert.R17.html" class="Module">Armor.Data.X509.Semantic.Cert.R17</a> <a id="1033" class="Symbol">as</a> <a id="1036" class="Module">R17</a>
<a id="1040" class="Keyword">import</a>      <a id="1052" href="Armor.Data.X509.Semantic.Cert.R18.html" class="Module">Armor.Data.X509.Semantic.Cert.R18</a> <a id="1086" class="Symbol">as</a> <a id="1089" class="Module">R18</a>
<a id="1093" class="Keyword">import</a>      <a id="1105" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a>
<a id="1131" class="Keyword">import</a>      <a id="1143" href="Armor.Grammar.Option.html" class="Module">Armor.Grammar.Option</a>
<a id="1164" class="Keyword">open</a> <a id="1169" class="Keyword">import</a> <a id="1176" href="Armor.Grammar.IList.html" class="Module">Armor.Grammar.IList</a> <a id="1196" class="Symbol">as</a> <a id="1199" class="Module">IList</a>
<a id="1205" class="Keyword">open</a> <a id="1210" class="Keyword">import</a> <a id="1217" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="1232" class="Keyword">module</a> <a id="1239" href="Armor.Data.X509.Semantic.Cert.html" class="Module">Armor.Data.X509.Semantic.Cert</a> <a id="1269" class="Keyword">where</a>

<a id="1276" class="Keyword">open</a> <a id="1281" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a> <a id="1307" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="1313" class="Keyword">open</a> <a id="1318" href="Armor.Grammar.Option.html" class="Module">Armor.Grammar.Option</a>      <a id="1344" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>

<a id="1351" class="Comment">---------------------- SCP rules -----------------</a>

<a id="1403" class="Comment">-- SignatureAlgorithm field MUST contain the same algorithm identifier as</a>
<a id="1477" class="Comment">-- the Signature field in the sequence TbsCertificate.</a>
<a id="1532" class="Keyword">open</a> <a id="1537" href="Armor.Data.X509.Semantic.Cert.R1.html" class="Module">R1</a> <a id="1540" class="Keyword">public</a>

<a id="1548" class="Comment">-- Extension field MUST only appear if the Version is 3(2).</a>
<a id="1608" class="Keyword">open</a> <a id="1613" href="Armor.Data.X509.Semantic.Cert.R2.html" class="Module">R2</a> <a id="1616" class="Keyword">public</a>

<a id="1624" class="Comment">-- The Serial number MUST be a positive integer assigned by the CA to each certificate.</a>
<a id="1712" class="Keyword">open</a> <a id="1717" href="Armor.Data.X509.Semantic.Cert.R3.html" class="Module">R3</a> <a id="1720" class="Keyword">public</a>

<a id="1728" class="Comment">-- The Issuer field MUST contain a non-empty distinguished name (DN).</a>
<a id="1798" class="Comment">-- TODO : fix the parser to enforce set length to minimum 1</a>
<a id="1858" class="Keyword">open</a> <a id="1863" href="Armor.Data.X509.Semantic.Cert.R4.html" class="Module">R4</a> <a id="1866" class="Keyword">public</a>


<a id="1875" class="Comment">-- If the Subject is a CA (e.g., the Basic Constraints extension, is present and the value of CA is TRUE),</a>
<a id="1982" class="Comment">-- then the Subject field MUST be populated with a non-empty distinguished name.</a>
<a id="2063" class="Keyword">open</a> <a id="2068" href="Armor.Data.X509.Semantic.Cert.R5.html" class="Module">R5</a> <a id="2071" class="Keyword">public</a>

<a id="2079" class="Comment">-- -- Unique Identifiers fields MUST only appear if the Version is 2 or 3.</a>
<a id="2154" class="Keyword">open</a> <a id="2159" href="Armor.Data.X509.Semantic.Cert.R6.html" class="Module">R6</a> <a id="2162" class="Keyword">public</a>


<a id="2171" class="Comment">-- -- Where it appears, the PathLenConstraint field MUST be greater than or equal to zero.</a>
<a id="2262" class="Keyword">open</a> <a id="2267" href="Armor.Data.X509.Semantic.Cert.R7.html" class="Module">R7</a> <a id="2270" class="Keyword">public</a>

<a id="2278" class="Comment">-- if the Subject is a CRL issuer (e.g., the Key Usage extension, is present and the value of CRLSign is TRUE),</a>
<a id="2390" class="Comment">-- then the Subject field MUST be populated with a non-empty distinguished name.</a>
<a id="2471" class="Keyword">open</a> <a id="2476" href="Armor.Data.X509.Semantic.Cert.R8.html" class="Module">R8</a> <a id="2479" class="Keyword">public</a>

<a id="2487" class="Comment">-- When the Key Usage extension appears in a certificate, at least one of the bits MUST be set to 1.</a>
<a id="2588" class="Keyword">open</a> <a id="2593" href="Armor.Data.X509.Semantic.Cert.R9.html" class="Module">R9</a> <a id="2596" class="Keyword">public</a>

<a id="2604" class="Comment">-- If subject naming information is present only in the Subject Alternative Name extension ,</a>
<a id="2697" class="Comment">-- then the Subject name MUST be an empty sequence and the Subject Alternative Name extension MUST be critical.</a>
<a id="2809" class="Comment">-- If the subject field contains an empty sequence, then the issuing CA MUST include a</a>
<a id="2896" class="Comment">-- subjectAltName extension that is marked as critical.</a>
<a id="2952" class="Keyword">open</a> <a id="2957" href="Armor.Data.X509.Semantic.Cert.R10.html" class="Module">R10</a> <a id="2961" class="Keyword">public</a>

<a id="2969" class="Comment">-- If the Subject Alternative Name extension is present, the sequence MUST contain at least one entry.</a>
<a id="3072" class="Keyword">open</a> <a id="3077" href="Armor.Data.X509.Semantic.Cert.R11.html" class="Module">R11</a> <a id="3081" class="Keyword">public</a>

<a id="3089" class="Comment">-- If the KeyCertSign bit is asserted, then the CA bit in the Basic Constraints extension MUST also be asserted.</a>
<a id="3202" class="Keyword">open</a> <a id="3207" href="Armor.Data.X509.Semantic.Cert.R12.html" class="Module">R12</a> <a id="3211" class="Keyword">public</a>

<a id="3219" class="Comment">-- A certificate MUST NOT include more than one instance of a particular Extension.</a>
<a id="3303" class="Keyword">open</a> <a id="3308" href="Armor.Data.X509.Semantic.Cert.R13.html" class="Module">R13</a> <a id="3312" class="Keyword">public</a>

<a id="3320" class="Comment">-- A certificate-using system MUST reject the certificate if it encounters a critical Extension</a>
<a id="3416" class="Comment">-- it does not recognize or a critical Extension that contains information that it cannot process.</a>
<a id="3515" class="Keyword">open</a> <a id="3520" href="Armor.Data.X509.Semantic.Cert.R14.html" class="Module">R14</a> <a id="3524" class="Keyword">public</a>

<a id="3532" class="Comment">-- A certificate policy OID MUST NOT appear more than once in a Certificate Policies extension.</a>
<a id="3628" class="Keyword">open</a> <a id="3633" href="Armor.Data.X509.Semantic.Cert.R15.html" class="Module">R15</a> <a id="3637" class="Keyword">public</a>

<a id="3645" class="Comment">-- While each of these fields is optional, a DistributionPoint MUST NOT consist of only the Reasons field;</a>
<a id="3752" class="Comment">-- either distributionPoint or CRLIssuer MUST be present.</a>
<a id="3810" class="Keyword">open</a> <a id="3815" href="Armor.Data.X509.Semantic.Cert.R16.html" class="Module">R16</a> <a id="3819" class="Keyword">public</a>

<a id="3827" class="Comment">-- The certificate Validity period includes the current time</a>
<a id="3888" class="Keyword">open</a> <a id="3893" href="Armor.Data.X509.Semantic.Cert.R17.html" class="Module">R17</a> <a id="3897" class="Keyword">public</a>

<a id="3905" class="Comment">--- consistency of certificate purposes based on key usage bits and extended key usage OIDs</a>
<a id="3997" class="Keyword">open</a> <a id="4002" href="Armor.Data.X509.Semantic.Cert.R18.html" class="Module">R18</a> <a id="4006" class="Keyword">public</a>
</pre></body></html>