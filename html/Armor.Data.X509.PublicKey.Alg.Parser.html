<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.PublicKey.Alg.Parser</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="28" class="Keyword">open</a> <a id="33" class="Keyword">import</a> <a id="40" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="53" class="Keyword">open</a> <a id="58" class="Keyword">import</a> <a id="65" href="Armor.Data.X509.PublicKey.Alg.ECPKParameters.html" class="Module">Armor.Data.X509.PublicKey.Alg.ECPKParameters</a>
<a id="110" class="Keyword">open</a> <a id="115" class="Keyword">import</a> <a id="122" href="Armor.Data.X509.PublicKey.Alg.TCB.html" class="Module">Armor.Data.X509.PublicKey.Alg.TCB</a>
<a id="156" class="Keyword">import</a>      <a id="168" href="Armor.Data.X509.PublicKey.Alg.TCB.OIDs.html" class="Module">Armor.Data.X509.PublicKey.Alg.TCB.OIDs</a> <a id="207" class="Symbol">as</a> <a id="210" class="Module">OIDs</a>
<a id="215" class="Keyword">open</a> <a id="220" class="Keyword">import</a> <a id="227" href="Armor.Data.X690-DER.Null.html" class="Module">Armor.Data.X690-DER.Null</a>
<a id="252" class="Keyword">open</a> <a id="257" class="Keyword">import</a> <a id="264" href="Armor.Data.X690-DER.OID.html" class="Module">Armor.Data.X690-DER.OID</a>
<a id="288" class="Keyword">open</a> <a id="293" class="Keyword">import</a> <a id="300" href="Armor.Data.X690-DER.OctetString.html" class="Module">Armor.Data.X690-DER.OctetString</a>
<a id="332" class="Keyword">open</a> <a id="337" class="Keyword">import</a> <a id="344" href="Armor.Data.X690-DER.Sequence.DefinedByOID.html" class="Module">Armor.Data.X690-DER.Sequence.DefinedByOID</a>
<a id="386" class="Keyword">open</a> <a id="391" class="Keyword">import</a> <a id="398" href="Armor.Data.X690-DER.TLV.html" class="Module">Armor.Data.X690-DER.TLV</a>
<a id="422" class="Keyword">import</a>      <a id="434" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a>
<a id="460" class="Keyword">import</a>      <a id="472" href="Armor.Grammar.Parallel.html" class="Module">Armor.Grammar.Parallel</a>
<a id="495" class="Keyword">import</a>      <a id="507" href="Armor.Grammar.Parser.html" class="Module">Armor.Grammar.Parser</a>
<a id="528" class="Keyword">import</a>      <a id="540" href="Armor.Grammar.Properties.html" class="Module">Armor.Grammar.Properties</a>

<a id="566" class="Keyword">module</a> <a id="573" href="Armor.Data.X509.PublicKey.Alg.Parser.html" class="Module">Armor.Data.X509.PublicKey.Alg.Parser</a> <a id="610" class="Keyword">where</a>

<a id="617" class="Keyword">open</a> <a id="622" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a> <a id="648" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="654" class="Keyword">open</a> <a id="659" href="Armor.Grammar.Parallel.html" class="Module">Armor.Grammar.Parallel</a>    <a id="685" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="691" class="Keyword">open</a> <a id="696" href="Armor.Grammar.Parser.html" class="Module">Armor.Grammar.Parser</a>      <a id="722" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="728" class="Comment">-- open Armor.Grammar.Properties  UInt8</a>
<a id="768" class="Comment">-- open Armor.Grammar.Sum         UInt8</a>

<a id="809" class="Keyword">private</a>
  <a id="here&#39;"></a><a id="819" href="Armor.Data.X509.PublicKey.Alg.Parser.html#819" class="Function">here&#39;</a> <a id="825" class="Symbol">=</a> <a id="827" class="String">&quot;X509: PublicKey: Alg&quot;</a>

<a id="parseParams"></a><a id="851" href="Armor.Data.X509.PublicKey.Alg.Parser.html#851" class="Function">parseParams</a> <a id="863" class="Symbol">:</a> <a id="865" class="Symbol">∀</a> <a id="867" href="Armor.Data.X509.PublicKey.Alg.Parser.html#867" class="Bound">n</a> <a id="869" class="Symbol">{@</a><a id="871" class="Symbol">0</a> <a id="873" href="Armor.Data.X509.PublicKey.Alg.Parser.html#873" class="Bound">bs</a><a id="875" class="Symbol">}</a> <a id="877" class="Symbol">→</a> <a id="879" class="Symbol">(</a><a id="880" href="Armor.Data.X509.PublicKey.Alg.Parser.html#880" class="Bound">o</a> <a id="882" class="Symbol">:</a> <a id="884" href="Armor.Data.X690-DER.OID.TCB.html#2963" class="Function">OID</a> <a id="888" href="Armor.Data.X509.PublicKey.Alg.Parser.html#873" class="Bound">bs</a><a id="890" class="Symbol">)</a> <a id="892" class="Symbol">(</a><a id="893" href="Armor.Data.X509.PublicKey.Alg.Parser.html#893" class="Bound">o∈?</a> <a id="897" class="Symbol">:</a> <a id="899" href="Relation.Nullary.html#1511" class="Record">Dec</a> <a id="903" class="Symbol">((</a><a id="905" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="908" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="916" href="Armor.Data.X509.PublicKey.Alg.Parser.html#880" class="Bound">o</a><a id="917" class="Symbol">)</a> <a id="919" href="Data.List.Membership.Setoid.html#887" class="Function Operator">∈</a> <a id="921" href="Armor.Data.X509.PublicKey.Alg.TCB.OIDs.html#2392" class="Function">OIDs.Supported</a><a id="935" class="Symbol">))</a>
              <a id="952" class="Symbol">→</a> <a id="954" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="961" class="Symbol">(</a><a id="962" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="970" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="972" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="975" class="Symbol">)</a> <a id="977" class="Symbol">(</a><a id="978" href="Armor.Grammar.Parallel.TCB.html#1532" class="Function">ExactLength</a> <a id="990" class="Symbol">(</a><a id="991" href="Armor.Data.X509.PublicKey.Alg.TCB.html#844" class="Function">PKParameters&#39;</a> <a id="1005" href="Armor.Data.X509.PublicKey.Alg.Parser.html#880" class="Bound">o</a> <a id="1007" href="Armor.Data.X509.PublicKey.Alg.Parser.html#893" class="Bound">o∈?</a><a id="1010" class="Symbol">)</a> <a id="1012" href="Armor.Data.X509.PublicKey.Alg.Parser.html#867" class="Bound">n</a><a id="1013" class="Symbol">)</a>
<a id="1015" href="Armor.Data.X509.PublicKey.Alg.Parser.html#851" class="Function">parseParams</a> <a id="1027" href="Armor.Data.X509.PublicKey.Alg.Parser.html#1027" class="Bound">n</a> <a id="1029" href="Armor.Data.X509.PublicKey.Alg.Parser.html#1029" class="Bound">o</a> <a id="1031" class="Symbol">(</a><a id="1032" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1035" href="Armor.Data.X509.PublicKey.Alg.Parser.html#1035" class="Bound">¬p</a><a id="1037" class="Symbol">)</a> <a id="1039" class="Symbol">=</a>
  <a id="1043" href="Armor.Data.X690-DER.OctetString.Parser.html#494" class="Function">OctetString.parseValue</a> <a id="1066" href="Armor.Data.X509.PublicKey.Alg.Parser.html#1027" class="Bound">n</a>
<a id="1068" href="Armor.Data.X509.PublicKey.Alg.Parser.html#851" class="Function">parseParams</a> <a id="1080" href="Armor.Data.X509.PublicKey.Alg.Parser.html#1080" class="Bound">n</a> <a id="1082" href="Armor.Data.X509.PublicKey.Alg.Parser.html#1082" class="Bound">o</a> <a id="1084" class="Symbol">(</a><a id="1085" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1089" class="Symbol">(</a><a id="1090" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="1095" href="Armor.Data.X509.PublicKey.Alg.Parser.html#1095" class="Bound">px</a><a id="1097" class="Symbol">))</a> <a id="1100" class="Symbol">=</a>
  <a id="1104" href="Armor.Grammar.Parallel.Parser.html#3682" class="Function">parseExactLength</a> <a id="1121" href="Armor.Data.X690-DER.TLV.Properties.html#592" class="Function">TLV.nosubstrings</a> <a id="1138" class="Symbol">(</a><a id="1139" href="Armor.Prelude.html#14236" class="Field">tell</a> <a id="1144" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1146" href="Armor.Data.X509.PublicKey.Alg.Parser.html#819" class="Function">here&#39;</a> <a id="1152" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1162" class="String">&quot; (params): length mismatch (null)&quot;</a><a id="1197" class="Symbol">)</a> <a id="1199" href="Armor.Data.X690-DER.Null.Parser.html#473" class="Function">Null.parse</a> <a id="1210" href="Armor.Data.X509.PublicKey.Alg.Parser.html#1080" class="Bound">n</a>
<a id="1212" href="Armor.Data.X509.PublicKey.Alg.Parser.html#851" class="Function">parseParams</a> <a id="1224" href="Armor.Data.X509.PublicKey.Alg.Parser.html#1224" class="Bound">n</a> <a id="1226" href="Armor.Data.X509.PublicKey.Alg.Parser.html#1226" class="Bound">o</a> <a id="1228" class="Symbol">(</a><a id="1229" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1233" class="Symbol">(</a><a id="1234" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a> <a id="1240" class="Symbol">(</a><a id="1241" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="1246" href="Armor.Data.X509.PublicKey.Alg.Parser.html#1246" class="Bound">px</a><a id="1248" class="Symbol">)))</a> <a id="1252" class="Symbol">=</a>
  <a id="1256" href="Armor.Grammar.Parallel.Parser.html#3682" class="Function">parseExactLength</a> <a id="1273" href="Armor.Data.X509.PublicKey.Alg.ECPKParameters.Properties.html#984" class="Function">ECPKParameters.nosubstrings</a> <a id="1301" class="Symbol">(</a><a id="1302" href="Armor.Prelude.html#14236" class="Field">tell</a> <a id="1307" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1309" href="Armor.Data.X509.PublicKey.Alg.Parser.html#819" class="Function">here&#39;</a> <a id="1315" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1325" class="String">&quot; (params): length mismatch (EC)&quot;</a><a id="1358" class="Symbol">)</a>
    <a id="1364" href="Armor.Data.X509.PublicKey.Alg.ECPKParameters.Parser.html#648" class="Function">ECPKParameters.parse</a> <a id="1385" href="Armor.Data.X509.PublicKey.Alg.Parser.html#1224" class="Bound">n</a>

<a id="parse"></a><a id="1388" href="Armor.Data.X509.PublicKey.Alg.Parser.html#1388" class="Function">parse</a> <a id="1394" class="Symbol">:</a> <a id="1396" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="1403" class="Symbol">(</a><a id="1404" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="1412" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1414" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="1417" class="Symbol">)</a> <a id="1419" href="Armor.Data.X509.PublicKey.Alg.TCB.html#1955" class="Function">PublicKeyAlg</a>
<a id="1432" href="Armor.Data.X509.PublicKey.Alg.Parser.html#1388" class="Function">parse</a> <a id="1438" class="Symbol">=</a> <a id="1440" href="Armor.Data.X690-DER.Sequence.DefinedByOID.Parser.html#1562" class="Function">DefinedByOID.parse</a> <a id="1459" href="Armor.Data.X509.PublicKey.Alg.Parser.html#819" class="Function">here&#39;</a> <a id="1465" class="Symbol">λ</a> <a id="1467" href="Armor.Data.X509.PublicKey.Alg.Parser.html#1467" class="Bound">n</a> <a id="1469" href="Armor.Data.X509.PublicKey.Alg.Parser.html#1469" class="Bound">o</a> <a id="1471" class="Symbol">→</a> <a id="1473" href="Armor.Data.X509.PublicKey.Alg.Parser.html#851" class="Function">parseParams</a> <a id="1485" href="Armor.Data.X509.PublicKey.Alg.Parser.html#1467" class="Bound">n</a> <a id="1487" href="Armor.Data.X509.PublicKey.Alg.Parser.html#1469" class="Bound">o</a> <a id="1489" class="Symbol">((</a><a id="1491" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="1494" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="1502" href="Armor.Data.X509.PublicKey.Alg.Parser.html#1469" class="Bound">o</a><a id="1503" class="Symbol">)</a> <a id="1505" href="Armor.Prelude.html#11173" class="Function Operator">∈?</a> <a id="1508" href="Armor.Data.X509.PublicKey.Alg.TCB.OIDs.html#2392" class="Function">OIDs.Supported</a><a id="1522" class="Symbol">)</a>
</pre></body></html>