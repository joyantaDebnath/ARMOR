<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.Semantic.StringPrep.Common</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--sized-types</a> <a id="27" class="Symbol">#-}</a>

<a id="32" class="Keyword">open</a> <a id="37" class="Keyword">import</a> <a id="44" href="Data.Nat.DivMod.html" class="Module">Data.Nat.DivMod</a>
<a id="60" class="Keyword">import</a>      <a id="72" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="85" class="Keyword">open</a> <a id="90" class="Keyword">import</a> <a id="97" href="Armor.Data.X509.html" class="Module">Armor.Data.X509</a>
<a id="113" class="Keyword">import</a>      <a id="125" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a>
<a id="151" class="Keyword">open</a> <a id="156" class="Keyword">import</a> <a id="163" href="Armor.Grammar.IList.html" class="Module">Armor.Grammar.IList</a>
<a id="183" class="Keyword">import</a>      <a id="195" href="Armor.Grammar.Sum.html" class="Module">Armor.Grammar.Sum</a>
<a id="213" class="Keyword">open</a> <a id="218" class="Keyword">import</a> <a id="225" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="240" class="Keyword">open</a> <a id="245" class="Keyword">import</a> <a id="252" href="Armor.Data.Unicode.html" class="Module">Armor.Data.Unicode</a>
<a id="271" class="Keyword">open</a> <a id="276" class="Keyword">import</a> <a id="283" href="Armor.Data.Unicode.UTF8.Trie.html" class="Module">Armor.Data.Unicode.UTF8.Trie</a>
<a id="312" class="Keyword">open</a> <a id="317" class="Keyword">import</a> <a id="324" href="Armor.Data.X509.Semantic.StringPrep.CaseFoldNFKC.Helpers.html" class="Module">Armor.Data.X509.Semantic.StringPrep.CaseFoldNFKC.Helpers</a>
<a id="381" class="Keyword">open</a> <a id="386" class="Keyword">import</a> <a id="393" href="Armor.Data.X509.Semantic.StringPrep.InitMap.Helpers.html" class="Module">Armor.Data.X509.Semantic.StringPrep.InitMap.Helpers</a>
<a id="445" class="Keyword">open</a> <a id="450" class="Keyword">import</a> <a id="457" href="Armor.Data.X509.Semantic.StringPrep.InsigCharHandler.Helpers.html" class="Module">Armor.Data.X509.Semantic.StringPrep.InsigCharHandler.Helpers</a>
<a id="518" class="Keyword">open</a> <a id="523" class="Keyword">import</a> <a id="530" href="Armor.Data.X509.Semantic.StringPrep.ProhibitList.Helpers.html" class="Module">Armor.Data.X509.Semantic.StringPrep.ProhibitList.Helpers</a>

<a id="588" class="Keyword">import</a>      <a id="600" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="620" class="Symbol">as</a> <a id="623" class="Module">Nat</a>
<a id="627" class="Keyword">open</a> <a id="632" class="Keyword">import</a> <a id="639" href="Data.These.Base.html" class="Module">Data.These.Base</a>

<a id="656" class="Keyword">open</a> <a id="661" class="Keyword">import</a> <a id="668" href="Armor.Data.X509.Semantic.StringPrep.ExcludeRange.html" class="Module">Armor.Data.X509.Semantic.StringPrep.ExcludeRange</a>

<a id="718" class="Keyword">module</a> <a id="725" href="Armor.Data.X509.Semantic.StringPrep.Common.html" class="Module">Armor.Data.X509.Semantic.StringPrep.Common</a> <a id="768" class="Keyword">where</a>

<a id="775" class="Keyword">open</a> <a id="780" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="793" class="Keyword">open</a> <a id="798" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a> <a id="824" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>

<a id="831" class="Comment">-- Note: Currently, we only transform unicode strings encoded in UTF8.</a>
<a id="902" class="Comment">-- For UTF16 and UTF32, we do not perform any transformation yet.</a>

<a id="appendUTF8"></a><a id="969" href="Armor.Data.X509.Semantic.StringPrep.Common.html#969" class="Function">appendUTF8</a> <a id="980" class="Symbol">:</a> <a id="982" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="990" class="Symbol">(</a><a id="991" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="996" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="1001" class="Symbol">)</a> <a id="1003" href="Armor.Data.Unicode.UTF8.TCB.html#4297" class="Function">UTF8</a> <a id="1008" class="Symbol">→</a> <a id="1010" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="1018" class="Symbol">(</a><a id="1019" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1024" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="1029" class="Symbol">)</a> <a id="1031" href="Armor.Data.Unicode.UTF8.TCB.html#4297" class="Function">UTF8</a> <a id="1036" class="Symbol">→</a> <a id="1038" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="1046" class="Symbol">(</a><a id="1047" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1052" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="1057" class="Symbol">)</a> <a id="1059" href="Armor.Data.Unicode.UTF8.TCB.html#4297" class="Function">UTF8</a>
<a id="1064" href="Armor.Data.X509.Semantic.StringPrep.Common.html#969" class="Function">appendUTF8</a> <a id="1075" class="Symbol">(</a><a id="1076" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1076" class="Bound">fst</a> <a id="1080" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1082" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1082" class="Bound">snd</a><a id="1085" class="Symbol">)</a> <a id="1087" class="Symbol">(</a><a id="1088" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1088" class="Bound">fst₁</a> <a id="1093" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1095" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1095" class="Bound">snd₁</a><a id="1099" class="Symbol">)</a> <a id="1101" class="Symbol">=</a> <a id="1103" class="Symbol">_</a> <a id="1105" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1107" class="Symbol">(</a><a id="1108" href="Armor.Grammar.IList.TCB.html#1143" class="Function">appendIList</a> <a id="1120" class="Symbol">_</a> <a id="1122" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1082" class="Bound">snd</a> <a id="1126" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1095" class="Bound">snd₁</a><a id="1130" class="Symbol">)</a>

<a id="1133" class="Comment">-- https://datatracker.ietf.org/doc/html/rfc4518#section-2.2</a>
<a id="InitialMapping"></a><a id="1194" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1194" class="Function">InitialMapping</a> <a id="1209" class="Symbol">:</a> <a id="1211" class="Symbol">∀</a> <a id="1213" class="Symbol">{@</a><a id="1215" class="Symbol">0</a> <a id="1217" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1217" class="Bound">bs</a><a id="1219" class="Symbol">}</a> <a id="1221" class="Symbol">→</a> <a id="1223" href="Armor.Data.Unicode.TCB.html#260" class="Datatype">Unicode</a> <a id="1231" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1217" class="Bound">bs</a> <a id="1234" class="Symbol">→</a> <a id="1236" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="1244" class="Symbol">(</a><a id="1245" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1250" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="1255" class="Symbol">)</a> <a id="1257" href="Armor.Data.Unicode.TCB.html#260" class="Datatype">Unicode</a>
<a id="1265" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1194" class="Function">InitialMapping</a> <a id="1280" class="Symbol">(</a><a id="1281" href="Armor.Data.Unicode.TCB.html#303" class="InductiveConstructor">utf8</a> <a id="1286" href="Armor.Grammar.IList.TCB.html#639" class="InductiveConstructor">nil</a><a id="1289" class="Symbol">)</a> <a id="1291" class="Symbol">=</a> <a id="1293" class="Symbol">_</a> <a id="1295" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1297" href="Armor.Data.Unicode.TCB.html#303" class="InductiveConstructor">utf8</a> <a id="1302" href="Armor.Grammar.IList.TCB.html#639" class="InductiveConstructor">nil</a>
<a id="1306" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1194" class="Function">InitialMapping</a> <a id="1321" class="Symbol">(</a><a id="1322" href="Armor.Data.Unicode.TCB.html#303" class="InductiveConstructor">utf8</a> <a id="1327" class="Symbol">(</a><a id="1328" href="Armor.Grammar.IList.TCB.html#658" class="InductiveConstructor">cons</a> <a id="1333" class="Symbol">(</a><a id="1334" href="Armor.Grammar.IList.TCB.html#502" class="InductiveConstructor">mkIListCons</a> <a id="1346" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1346" class="Bound">h</a> <a id="1348" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1348" class="Bound">t</a> <a id="1350" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1350" class="Bound">bs≡</a><a id="1353" class="Symbol">)))</a> <a id="1357" class="Symbol">=</a> <a id="1359" class="Symbol">_</a> <a id="1361" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1363" class="Symbol">(</a><a id="1364" href="Armor.Data.Unicode.TCB.html#303" class="InductiveConstructor">utf8</a> <a id="1369" class="Symbol">(</a><a id="1370" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="1376" class="Symbol">(</a><a id="1377" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1401" class="Function">helper</a> <a id="1384" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1346" class="Bound">h</a> <a id="1386" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1348" class="Bound">t</a><a id="1387" class="Symbol">)))</a>
  <a id="1393" class="Keyword">where</a>
  <a id="1401" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1401" class="Function">helper</a> <a id="1408" class="Symbol">:</a> <a id="1410" class="Symbol">∀</a> <a id="1412" class="Symbol">{@</a><a id="1414" class="Symbol">0</a> <a id="1416" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1416" class="Bound">bs₁</a> <a id="1420" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1420" class="Bound">bs₂</a><a id="1423" class="Symbol">}</a> <a id="1425" class="Symbol">→</a> <a id="1427" href="Armor.Data.Unicode.UTF8.TCB.html#2511" class="Datatype">UTF8Char</a> <a id="1436" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1416" class="Bound">bs₁</a> <a id="1440" class="Symbol">→</a> <a id="1442" href="Armor.Grammar.IList.TCB.html#361" class="Datatype">IList</a> <a id="1448" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="1454" href="Armor.Data.Unicode.UTF8.TCB.html#2511" class="Datatype">UTF8Char</a> <a id="1463" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1420" class="Bound">bs₂</a> <a id="1467" class="Symbol">→</a> <a id="1469" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="1477" class="Symbol">(</a><a id="1478" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1483" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="1488" class="Symbol">)</a> <a id="1490" href="Armor.Data.Unicode.UTF8.TCB.html#4297" class="Function">UTF8</a>
  <a id="1497" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1401" class="Function">helper</a> <a id="1504" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1504" class="Bound">x</a> <a id="1506" href="Armor.Grammar.IList.TCB.html#639" class="InductiveConstructor">nil</a> <a id="1510" class="Symbol">=</a> <a id="1512" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="1517" class="Symbol">(</a><a id="1518" href="Armor.Data.X509.Semantic.StringPrep.InitMap.Helpers.html#795" class="Function">checkDeleteList</a> <a id="1534" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1504" class="Bound">x</a><a id="1535" class="Symbol">)</a> <a id="1537" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="1540" class="Symbol">λ</a> <a id="1542" class="Keyword">where</a>
    <a id="1552" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="1557" class="Symbol">→</a> <a id="1559" class="Symbol">_</a> <a id="1561" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1563" href="Armor.Grammar.IList.TCB.html#639" class="InductiveConstructor">nil</a>
    <a id="1571" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="1577" class="Symbol">→</a> <a id="1579" href="Armor.Data.X509.Semantic.StringPrep.InitMap.Helpers.html#488" class="Function">lookupInitMap</a> <a id="1593" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1504" class="Bound">x</a>
  <a id="1597" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1401" class="Function">helper</a> <a id="1604" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1604" class="Bound">x</a> <a id="1606" class="Symbol">(</a><a id="1607" href="Armor.Grammar.IList.TCB.html#658" class="InductiveConstructor">cons</a> <a id="1612" class="Symbol">(</a><a id="1613" href="Armor.Grammar.IList.TCB.html#502" class="InductiveConstructor">mkIListCons</a> <a id="1625" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1625" class="Bound">head₁</a> <a id="1631" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1631" class="Bound">tail₁</a> <a id="1637" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1637" class="Bound">bs≡</a><a id="1640" class="Symbol">))</a> <a id="1643" class="Symbol">=</a> <a id="1645" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="1650" class="Symbol">(</a><a id="1651" href="Armor.Data.X509.Semantic.StringPrep.InitMap.Helpers.html#795" class="Function">checkDeleteList</a> <a id="1667" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1604" class="Bound">x</a><a id="1668" class="Symbol">)</a> <a id="1670" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="1673" class="Symbol">λ</a> <a id="1675" class="Keyword">where</a>
    <a id="1685" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="1690" class="Symbol">→</a> <a id="1692" href="Armor.Data.X509.Semantic.StringPrep.Common.html#969" class="Function">appendUTF8</a> <a id="1703" class="Symbol">(_</a> <a id="1706" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1708" href="Armor.Grammar.IList.TCB.html#639" class="InductiveConstructor">nil</a><a id="1711" class="Symbol">)</a> <a id="1713" class="Symbol">(</a><a id="1714" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1401" class="Function">helper</a> <a id="1721" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1625" class="Bound">head₁</a> <a id="1727" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1631" class="Bound">tail₁</a><a id="1732" class="Symbol">)</a>
    <a id="1738" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="1744" class="Symbol">→</a> <a id="1746" href="Armor.Data.X509.Semantic.StringPrep.Common.html#969" class="Function">appendUTF8</a> <a id="1757" class="Symbol">(</a><a id="1758" href="Armor.Data.X509.Semantic.StringPrep.InitMap.Helpers.html#488" class="Function">lookupInitMap</a> <a id="1772" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1604" class="Bound">x</a><a id="1773" class="Symbol">)</a> <a id="1775" class="Symbol">(</a><a id="1776" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1401" class="Function">helper</a> <a id="1783" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1625" class="Bound">head₁</a> <a id="1789" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1631" class="Bound">tail₁</a><a id="1794" class="Symbol">)</a>
<a id="1796" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1194" class="Function">InitialMapping</a> <a id="1811" class="Symbol">(</a><a id="1812" href="Armor.Data.Unicode.TCB.html#335" class="InductiveConstructor">utf16</a> <a id="1818" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1818" class="Bound">x</a><a id="1819" class="Symbol">)</a> <a id="1821" class="Symbol">=</a> <a id="1823" class="Symbol">_</a> <a id="1825" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1827" class="Symbol">(</a><a id="1828" href="Armor.Data.Unicode.TCB.html#335" class="InductiveConstructor">utf16</a> <a id="1834" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1818" class="Bound">x</a><a id="1835" class="Symbol">)</a> <a id="1837" class="Comment">-- TODO</a>
<a id="1845" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1194" class="Function">InitialMapping</a> <a id="1860" class="Symbol">(</a><a id="1861" href="Armor.Data.Unicode.TCB.html#365" class="InductiveConstructor">utf32</a> <a id="1867" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1867" class="Bound">x</a><a id="1868" class="Symbol">)</a> <a id="1870" class="Symbol">=</a> <a id="1872" class="Symbol">_</a> <a id="1874" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1876" class="Symbol">(</a><a id="1877" href="Armor.Data.Unicode.TCB.html#365" class="InductiveConstructor">utf32</a> <a id="1883" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1867" class="Bound">x</a><a id="1884" class="Symbol">)</a> <a id="1886" class="Comment">-- TODO</a>

<a id="1895" class="Comment">-- https://datatracker.ietf.org/doc/html/rfc4518#section-2.3</a>
<a id="CaseFoldingNFKC"></a><a id="1956" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1956" class="Function">CaseFoldingNFKC</a> <a id="1972" class="Symbol">:</a> <a id="1974" class="Symbol">∀</a> <a id="1976" class="Symbol">{@</a><a id="1978" class="Symbol">0</a> <a id="1980" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1980" class="Bound">bs</a><a id="1982" class="Symbol">}</a> <a id="1984" class="Symbol">→</a> <a id="1986" href="Armor.Data.Unicode.TCB.html#260" class="Datatype">Unicode</a> <a id="1994" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1980" class="Bound">bs</a> <a id="1997" class="Symbol">→</a> <a id="1999" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="2007" class="Symbol">(</a><a id="2008" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2013" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="2018" class="Symbol">)</a> <a id="2020" href="Armor.Data.Unicode.TCB.html#260" class="Datatype">Unicode</a>
<a id="2028" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1956" class="Function">CaseFoldingNFKC</a> <a id="2044" class="Symbol">(</a><a id="2045" href="Armor.Data.Unicode.TCB.html#303" class="InductiveConstructor">utf8</a> <a id="2050" href="Armor.Grammar.IList.TCB.html#639" class="InductiveConstructor">nil</a><a id="2053" class="Symbol">)</a> <a id="2055" class="Symbol">=</a> <a id="2057" class="Symbol">_</a> <a id="2059" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2061" href="Armor.Data.Unicode.TCB.html#303" class="InductiveConstructor">utf8</a> <a id="2066" href="Armor.Grammar.IList.TCB.html#639" class="InductiveConstructor">nil</a>
<a id="2070" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1956" class="Function">CaseFoldingNFKC</a> <a id="2086" class="Symbol">(</a><a id="2087" href="Armor.Data.Unicode.TCB.html#303" class="InductiveConstructor">utf8</a> <a id="2092" class="Symbol">(</a><a id="2093" href="Armor.Grammar.IList.TCB.html#658" class="InductiveConstructor">cons</a> <a id="2098" class="Symbol">(</a><a id="2099" href="Armor.Grammar.IList.TCB.html#502" class="InductiveConstructor">mkIListCons</a> <a id="2111" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2111" class="Bound">h</a> <a id="2113" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2113" class="Bound">t</a> <a id="2115" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2115" class="Bound">bs≡</a><a id="2118" class="Symbol">)))</a> <a id="2122" class="Symbol">=</a>  <a id="2125" class="Symbol">_</a> <a id="2127" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2129" class="Symbol">(</a><a id="2130" href="Armor.Data.Unicode.TCB.html#303" class="InductiveConstructor">utf8</a> <a id="2135" class="Symbol">(</a><a id="2136" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="2142" class="Symbol">(</a><a id="2143" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2167" class="Function">helper</a> <a id="2150" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2111" class="Bound">h</a> <a id="2152" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2113" class="Bound">t</a><a id="2153" class="Symbol">)))</a>
  <a id="2159" class="Keyword">where</a>
  <a id="2167" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2167" class="Function">helper</a> <a id="2174" class="Symbol">:</a>  <a id="2177" class="Symbol">∀</a> <a id="2179" class="Symbol">{@</a><a id="2181" class="Symbol">0</a> <a id="2183" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2183" class="Bound">bs₁</a> <a id="2187" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2187" class="Bound">bs₂</a><a id="2190" class="Symbol">}</a> <a id="2192" class="Symbol">→</a> <a id="2194" href="Armor.Data.Unicode.UTF8.TCB.html#2511" class="Datatype">UTF8Char</a> <a id="2203" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2183" class="Bound">bs₁</a> <a id="2207" class="Symbol">→</a> <a id="2209" href="Armor.Grammar.IList.TCB.html#361" class="Datatype">IList</a> <a id="2215" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="2221" href="Armor.Data.Unicode.UTF8.TCB.html#2511" class="Datatype">UTF8Char</a> <a id="2230" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2187" class="Bound">bs₂</a> <a id="2234" class="Symbol">→</a> <a id="2236" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="2244" class="Symbol">(</a><a id="2245" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="2250" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="2255" class="Symbol">)</a> <a id="2257" href="Armor.Data.Unicode.UTF8.TCB.html#4297" class="Function">UTF8</a>
  <a id="2264" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2167" class="Function">helper</a> <a id="2271" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2271" class="Bound">x</a> <a id="2273" href="Armor.Grammar.IList.TCB.html#639" class="InductiveConstructor">nil</a> <a id="2277" class="Symbol">=</a> <a id="2279" href="Armor.Data.X509.Semantic.StringPrep.CaseFoldNFKC.Helpers.html#530" class="Function">lookupB2Map</a> <a id="2291" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2271" class="Bound">x</a>
  <a id="2295" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2167" class="Function">helper</a> <a id="2302" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2302" class="Bound">x</a> <a id="2304" class="Symbol">(</a><a id="2305" href="Armor.Grammar.IList.TCB.html#658" class="InductiveConstructor">cons</a> <a id="2310" class="Symbol">(</a><a id="2311" href="Armor.Grammar.IList.TCB.html#502" class="InductiveConstructor">mkIListCons</a> <a id="2323" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2323" class="Bound">head₁</a> <a id="2329" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2329" class="Bound">tail₁</a> <a id="2335" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2335" class="Bound">bs≡</a><a id="2338" class="Symbol">))</a> <a id="2341" class="Symbol">=</a> <a id="2343" href="Armor.Data.X509.Semantic.StringPrep.Common.html#969" class="Function">appendUTF8</a> <a id="2354" class="Symbol">(</a><a id="2355" href="Armor.Data.X509.Semantic.StringPrep.CaseFoldNFKC.Helpers.html#530" class="Function">lookupB2Map</a> <a id="2367" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2302" class="Bound">x</a><a id="2368" class="Symbol">)</a> <a id="2370" class="Symbol">(</a><a id="2371" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2167" class="Function">helper</a> <a id="2378" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2323" class="Bound">head₁</a> <a id="2384" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2329" class="Bound">tail₁</a><a id="2389" class="Symbol">)</a>
<a id="2391" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1956" class="Function">CaseFoldingNFKC</a> <a id="2407" class="Symbol">(</a><a id="2408" href="Armor.Data.Unicode.TCB.html#335" class="InductiveConstructor">utf16</a> <a id="2414" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2414" class="Bound">x</a><a id="2415" class="Symbol">)</a> <a id="2417" class="Symbol">=</a> <a id="2419" class="Symbol">_</a> <a id="2421" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2423" class="Symbol">(</a><a id="2424" href="Armor.Data.Unicode.TCB.html#335" class="InductiveConstructor">utf16</a> <a id="2430" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2414" class="Bound">x</a><a id="2431" class="Symbol">)</a> <a id="2433" class="Comment">-- TODO</a>
<a id="2441" href="Armor.Data.X509.Semantic.StringPrep.Common.html#1956" class="Function">CaseFoldingNFKC</a> <a id="2457" class="Symbol">(</a><a id="2458" href="Armor.Data.Unicode.TCB.html#365" class="InductiveConstructor">utf32</a> <a id="2464" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2464" class="Bound">x</a><a id="2465" class="Symbol">)</a> <a id="2467" class="Symbol">=</a> <a id="2469" class="Symbol">_</a> <a id="2471" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2473" class="Symbol">(</a><a id="2474" href="Armor.Data.Unicode.TCB.html#365" class="InductiveConstructor">utf32</a> <a id="2480" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2464" class="Bound">x</a><a id="2481" class="Symbol">)</a> <a id="2483" class="Comment">-- TODO</a>

<a id="2492" class="Comment">-- https://datatracker.ietf.org/doc/html/rfc4518#section-2.4</a>
<a id="Prohibit"></a><a id="2553" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2553" class="Function">Prohibit</a> <a id="2562" class="Symbol">:</a> <a id="2564" class="Symbol">∀</a> <a id="2566" class="Symbol">{@</a><a id="2568" class="Symbol">0</a> <a id="2570" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2570" class="Bound">bs</a><a id="2572" class="Symbol">}</a> <a id="2574" class="Symbol">→</a> <a id="2576" href="Armor.Data.Unicode.TCB.html#260" class="Datatype">Unicode</a> <a id="2584" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2570" class="Bound">bs</a> <a id="2587" class="Symbol">→</a> <a id="2589" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="2594" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2553" class="Function">Prohibit</a> <a id="2603" class="Symbol">(</a><a id="2604" href="Armor.Data.Unicode.TCB.html#303" class="InductiveConstructor">utf8</a> <a id="2609" href="Armor.Grammar.IList.TCB.html#639" class="InductiveConstructor">nil</a><a id="2612" class="Symbol">)</a> <a id="2614" class="Symbol">=</a> <a id="2616" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a>
<a id="2622" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2553" class="Function">Prohibit</a> <a id="2631" class="Symbol">(</a><a id="2632" href="Armor.Data.Unicode.TCB.html#303" class="InductiveConstructor">utf8</a> <a id="2637" class="Symbol">(</a><a id="2638" href="Armor.Grammar.IList.TCB.html#658" class="InductiveConstructor">cons</a> <a id="2643" class="Symbol">(</a><a id="2644" href="Armor.Grammar.IList.TCB.html#502" class="InductiveConstructor">mkIListCons</a> <a id="2656" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2656" class="Bound">h</a> <a id="2658" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2658" class="Bound">t</a> <a id="2660" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2660" class="Bound">bs≡</a><a id="2663" class="Symbol">)))</a> <a id="2667" class="Symbol">=</a> <a id="2669" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2690" class="Function">helper</a> <a id="2676" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2656" class="Bound">h</a> <a id="2678" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2658" class="Bound">t</a>
  <a id="2682" class="Keyword">where</a>
  <a id="2690" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2690" class="Function">helper</a> <a id="2697" class="Symbol">:</a>  <a id="2700" class="Symbol">∀</a> <a id="2702" class="Symbol">{@</a><a id="2704" class="Symbol">0</a> <a id="2706" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2706" class="Bound">bs₁</a> <a id="2710" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2710" class="Bound">bs₂</a><a id="2713" class="Symbol">}</a> <a id="2715" class="Symbol">→</a> <a id="2717" href="Armor.Data.Unicode.UTF8.TCB.html#2511" class="Datatype">UTF8Char</a> <a id="2726" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2706" class="Bound">bs₁</a> <a id="2730" class="Symbol">→</a> <a id="2732" href="Armor.Grammar.IList.TCB.html#361" class="Datatype">IList</a> <a id="2738" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a> <a id="2744" href="Armor.Data.Unicode.UTF8.TCB.html#2511" class="Datatype">UTF8Char</a> <a id="2753" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2710" class="Bound">bs₂</a> <a id="2757" class="Symbol">→</a> <a id="2759" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
  <a id="2766" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2690" class="Function">helper</a> <a id="2773" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2773" class="Bound">x</a> <a id="2775" href="Armor.Grammar.IList.TCB.html#639" class="InductiveConstructor">nil</a> <a id="2779" class="Symbol">=</a> <a id="2781" href="Armor.Data.X509.Semantic.StringPrep.ProhibitList.Helpers.html#113957" class="Function">checkProhibitUTF8Char</a> <a id="2803" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2773" class="Bound">x</a>
  <a id="2807" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2690" class="Function">helper</a> <a id="2814" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2814" class="Bound">x</a> <a id="2816" class="Symbol">(</a><a id="2817" href="Armor.Grammar.IList.TCB.html#658" class="InductiveConstructor">cons</a> <a id="2822" class="Symbol">(</a><a id="2823" href="Armor.Grammar.IList.TCB.html#502" class="InductiveConstructor">mkIListCons</a> <a id="2835" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2835" class="Bound">head₁</a> <a id="2841" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2841" class="Bound">tail₁</a> <a id="2847" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2847" class="Bound">bs≡</a><a id="2850" class="Symbol">))</a> <a id="2853" class="Symbol">=</a> <a id="2855" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="2860" class="Symbol">(</a><a id="2861" href="Armor.Data.X509.Semantic.StringPrep.ProhibitList.Helpers.html#113957" class="Function">checkProhibitUTF8Char</a> <a id="2883" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2814" class="Bound">x</a><a id="2884" class="Symbol">)</a> <a id="2886" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="2889" class="Symbol">λ</a> <a id="2891" class="Keyword">where</a>
    <a id="2901" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="2906" class="Symbol">→</a> <a id="2908" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
    <a id="2917" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="2923" class="Symbol">→</a> <a id="2925" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2690" class="Function">helper</a> <a id="2932" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2835" class="Bound">head₁</a> <a id="2938" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2841" class="Bound">tail₁</a>
<a id="2944" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2553" class="Function">Prohibit</a> <a id="2953" class="Symbol">(</a><a id="2954" href="Armor.Data.Unicode.TCB.html#335" class="InductiveConstructor">utf16</a> <a id="2960" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2960" class="Bound">x</a><a id="2961" class="Symbol">)</a> <a id="2963" class="Symbol">=</a> <a id="2965" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="2971" class="Comment">-- TODO</a>
<a id="2979" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2553" class="Function">Prohibit</a> <a id="2988" class="Symbol">(</a><a id="2989" href="Armor.Data.Unicode.TCB.html#365" class="InductiveConstructor">utf32</a> <a id="2995" href="Armor.Data.X509.Semantic.StringPrep.Common.html#2995" class="Bound">x</a><a id="2996" class="Symbol">)</a> <a id="2998" class="Symbol">=</a> <a id="3000" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="3006" class="Comment">-- TODO</a>

<a id="3015" class="Comment">-- https://datatracker.ietf.org/doc/html/rfc4518#section-2.6</a>
<a id="InsigCharHandling"></a><a id="3076" href="Armor.Data.X509.Semantic.StringPrep.Common.html#3076" class="Function">InsigCharHandling</a> <a id="3094" class="Symbol">:</a> <a id="3096" class="Symbol">∀</a> <a id="3098" class="Symbol">{@</a><a id="3100" class="Symbol">0</a> <a id="3102" href="Armor.Data.X509.Semantic.StringPrep.Common.html#3102" class="Bound">bs</a><a id="3104" class="Symbol">}</a> <a id="3106" class="Symbol">→</a> <a id="3108" href="Armor.Data.Unicode.TCB.html#260" class="Datatype">Unicode</a> <a id="3116" href="Armor.Data.X509.Semantic.StringPrep.Common.html#3102" class="Bound">bs</a> <a id="3119" class="Symbol">→</a> <a id="3121" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="3129" class="Symbol">(</a><a id="3130" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="3135" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a><a id="3140" class="Symbol">)</a> <a id="3142" href="Armor.Data.Unicode.TCB.html#260" class="Datatype">Unicode</a>
<a id="3150" href="Armor.Data.X509.Semantic.StringPrep.Common.html#3076" class="Function">InsigCharHandling</a> <a id="3168" class="Symbol">(</a><a id="3169" href="Armor.Data.Unicode.TCB.html#303" class="InductiveConstructor">utf8</a> <a id="3174" href="Armor.Data.X509.Semantic.StringPrep.Common.html#3174" class="Bound">x</a><a id="3175" class="Symbol">)</a>
  <a id="3179" class="Keyword">with</a> <a id="3184" href="Armor.Data.X509.Semantic.StringPrep.InsigCharHandler.Helpers.html#764" class="Function">checkOnlySpaces</a> <a id="3200" href="Armor.Data.X509.Semantic.StringPrep.Common.html#3174" class="Bound">x</a>
  <a id="3204" class="Comment">---- output only two spaces</a>
<a id="3232" class="Symbol">...</a> <a id="3236" class="Symbol">|</a> <a id="3238" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="3243" class="Symbol">=</a> <a id="3245" class="Symbol">_</a> <a id="3247" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3249" class="Symbol">(</a><a id="3250" href="Armor.Data.Unicode.TCB.html#303" class="InductiveConstructor">utf8</a> <a id="3255" class="Symbol">(</a><a id="3256" href="Armor.Grammar.IList.TCB.html#1143" class="Function">appendIList</a> <a id="3268" class="Symbol">_</a> <a id="3270" class="Symbol">(</a><a id="3271" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="3277" href="Armor.Data.X509.Semantic.StringPrep.InsigCharHandler.Helpers.html#615" class="Function">spaceUTF8</a><a id="3286" class="Symbol">)</a> <a id="3288" class="Symbol">(</a><a id="3289" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="3295" href="Armor.Data.X509.Semantic.StringPrep.InsigCharHandler.Helpers.html#615" class="Function">spaceUTF8</a><a id="3304" class="Symbol">)))</a>
  <a id="3310" class="Comment">---- else, ensure one space at start and end, two space per seq of inner spaces</a>
<a id="3390" class="Symbol">...</a> <a id="3394" class="Symbol">|</a> <a id="3396" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="3402" class="Symbol">=</a> <a id="3404" class="Symbol">_</a> <a id="3406" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3408" class="Symbol">(</a><a id="3409" href="Armor.Data.Unicode.TCB.html#303" class="InductiveConstructor">utf8</a> <a id="3414" class="Symbol">(</a><a id="3415" href="Armor.Grammar.IList.TCB.html#1143" class="Function">appendIList</a> <a id="3427" class="Symbol">_</a> <a id="3429" class="Symbol">(</a><a id="3430" href="Armor.Grammar.IList.TCB.html#1143" class="Function">appendIList</a> <a id="3442" class="Symbol">_</a> <a id="3444" class="Symbol">(</a><a id="3445" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="3451" href="Armor.Data.X509.Semantic.StringPrep.InsigCharHandler.Helpers.html#615" class="Function">spaceUTF8</a><a id="3460" class="Symbol">)</a> <a id="3462" class="Symbol">(</a><a id="3463" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="3469" class="Symbol">(</a><a id="3470" href="Armor.Data.X509.Semantic.StringPrep.InsigCharHandler.Helpers.html#3740" class="Function">innerSeqSpaceHelper</a> <a id="3490" class="Symbol">(</a><a id="3491" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="3497" class="Symbol">(</a><a id="3498" href="Armor.Data.X509.Semantic.StringPrep.InsigCharHandler.Helpers.html#2154" class="Function">stripUTF8</a> <a id="3508" class="Bound">x</a><a id="3509" class="Symbol">))</a> <a id="3512" href="Armor.Grammar.IList.TCB.html#639" class="InductiveConstructor">nil</a><a id="3515" class="Symbol">)))</a> <a id="3519" class="Symbol">(</a><a id="3520" href="Agda.Builtin.Sigma.html#264" class="Field">proj₂</a> <a id="3526" href="Armor.Data.X509.Semantic.StringPrep.InsigCharHandler.Helpers.html#615" class="Function">spaceUTF8</a><a id="3535" class="Symbol">)))</a>
<a id="3539" href="Armor.Data.X509.Semantic.StringPrep.Common.html#3076" class="Function">InsigCharHandling</a> <a id="3557" class="Symbol">(</a><a id="3558" href="Armor.Data.Unicode.TCB.html#335" class="InductiveConstructor">utf16</a> <a id="3564" href="Armor.Data.X509.Semantic.StringPrep.Common.html#3564" class="Bound">x</a><a id="3565" class="Symbol">)</a> <a id="3567" class="Symbol">=</a> <a id="3569" class="Symbol">_</a> <a id="3571" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3573" class="Symbol">(</a><a id="3574" href="Armor.Data.Unicode.TCB.html#335" class="InductiveConstructor">utf16</a> <a id="3580" href="Armor.Data.X509.Semantic.StringPrep.Common.html#3564" class="Bound">x</a><a id="3581" class="Symbol">)</a> <a id="3583" class="Comment">-- TODO</a>
<a id="3591" href="Armor.Data.X509.Semantic.StringPrep.Common.html#3076" class="Function">InsigCharHandling</a> <a id="3609" class="Symbol">(</a><a id="3610" href="Armor.Data.Unicode.TCB.html#365" class="InductiveConstructor">utf32</a> <a id="3616" href="Armor.Data.X509.Semantic.StringPrep.Common.html#3616" class="Bound">x</a><a id="3617" class="Symbol">)</a> <a id="3619" class="Symbol">=</a> <a id="3621" class="Symbol">_</a> <a id="3623" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3625" class="Symbol">(</a><a id="3626" href="Armor.Data.Unicode.TCB.html#365" class="InductiveConstructor">utf32</a> <a id="3632" href="Armor.Data.X509.Semantic.StringPrep.Common.html#3616" class="Bound">x</a><a id="3633" class="Symbol">)</a> <a id="3635" class="Comment">-- TODO</a>
</pre></body></html>