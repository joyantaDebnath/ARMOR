<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.PublicKey.Val.Parser</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Armor.Data.X509.PublicKey.Alg.html" class="Module">Armor.Data.X509.PublicKey.Alg</a>
<a id="68" class="Keyword">import</a>      <a id="80" href="Armor.Data.X509.PublicKey.Alg.TCB.OIDs.html" class="Module">Armor.Data.X509.PublicKey.Alg.TCB.OIDs</a> <a id="119" class="Symbol">as</a> <a id="122" class="Module">OIDs</a>
<a id="127" class="Keyword">open</a> <a id="132" class="Keyword">import</a> <a id="139" href="Armor.Data.X509.PublicKey.Val.EC.html" class="Module">Armor.Data.X509.PublicKey.Val.EC</a>
<a id="172" class="Keyword">open</a> <a id="177" class="Keyword">import</a> <a id="184" href="Armor.Data.X509.PublicKey.Val.RSA.html" class="Module">Armor.Data.X509.PublicKey.Val.RSA</a>
<a id="218" class="Keyword">open</a> <a id="223" class="Keyword">import</a> <a id="230" href="Armor.Data.X509.PublicKey.Val.TCB.html" class="Module">Armor.Data.X509.PublicKey.Val.TCB</a>
<a id="264" class="Keyword">open</a> <a id="269" class="Keyword">import</a> <a id="276" href="Armor.Data.X690-DER.BitString.html" class="Module">Armor.Data.X690-DER.BitString</a>
<a id="306" class="Keyword">open</a> <a id="311" class="Keyword">import</a> <a id="318" href="Armor.Data.X690-DER.OID.html" class="Module">Armor.Data.X690-DER.OID</a>
<a id="342" class="Keyword">open</a> <a id="347" class="Keyword">import</a> <a id="354" href="Armor.Data.X690-DER.TLV.TCB.html" class="Module">Armor.Data.X690-DER.TLV.TCB</a>
<a id="382" class="Keyword">import</a>      <a id="394" href="Armor.Grammar.Parser.html" class="Module">Armor.Grammar.Parser</a>
<a id="415" class="Keyword">open</a> <a id="420" class="Keyword">import</a> <a id="427" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="442" class="Keyword">module</a> <a id="449" href="Armor.Data.X509.PublicKey.Val.Parser.html" class="Module">Armor.Data.X509.PublicKey.Val.Parser</a> <a id="486" class="Keyword">where</a>

<a id="493" class="Keyword">open</a> <a id="498" href="Armor.Grammar.Parser.html" class="Module">Armor.Grammar.Parser</a> <a id="519" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>

<a id="parse"></a><a id="526" href="Armor.Data.X509.PublicKey.Val.Parser.html#526" class="Function">parse</a> <a id="532" class="Symbol">:</a> <a id="534" class="Symbol">∀</a> <a id="536" class="Symbol">{@</a><a id="538" class="Symbol">0</a> <a id="540" href="Armor.Data.X509.PublicKey.Val.Parser.html#540" class="Bound">bs</a><a id="542" class="Symbol">}</a> <a id="544" class="Symbol">→</a> <a id="546" class="Symbol">(</a><a id="547" href="Armor.Data.X509.PublicKey.Val.Parser.html#547" class="Bound">a</a> <a id="549" class="Symbol">:</a> <a id="551" href="Armor.Data.X509.PublicKey.Alg.TCB.html#1955" class="Function">PublicKeyAlg</a> <a id="564" href="Armor.Data.X509.PublicKey.Val.Parser.html#540" class="Bound">bs</a><a id="566" class="Symbol">)</a> <a id="568" class="Symbol">→</a> <a id="570" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="577" class="Symbol">(</a><a id="578" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="586" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="588" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="591" class="Symbol">)</a> <a id="593" class="Symbol">(</a><a id="594" href="Armor.Data.X509.PublicKey.Val.TCB.html#903" class="Function">PublicKeyVal</a> <a id="607" href="Armor.Data.X509.PublicKey.Val.Parser.html#547" class="Bound">a</a><a id="608" class="Symbol">)</a>
<a id="610" href="Armor.Data.X509.PublicKey.Val.Parser.html#526" class="Function">parse</a> <a id="616" href="Armor.Data.X509.PublicKey.Val.Parser.html#616" class="Bound">a</a> <a id="618" class="Symbol">=</a>
  <a id="622" href="Armor.Prelude.html#3493" class="Function Operator">case</a> <a id="627" class="Symbol">(</a><a id="628" href="Data.Product.html#2247" class="Function Operator">-,</a> <a id="631" href="Armor.Data.X690-DER.TLV.TCB.html#686" class="Field">TLV.val</a> <a id="639" class="Symbol">(</a><a id="640" href="Armor.Data.X509.PublicKey.Alg.TCB.html#2118" class="Function">Alg.getOID</a> <a id="651" href="Armor.Data.X509.PublicKey.Val.Parser.html#616" class="Bound">a</a><a id="652" class="Symbol">))</a> <a id="655" href="Armor.Prelude.html#11173" class="Function Operator">∈?</a> <a id="658" href="Armor.Data.X509.PublicKey.Alg.TCB.OIDs.html#2392" class="Function">OIDs.Supported</a>
  <a id="675" href="Armor.Prelude.html#3493" class="Function Operator">ret</a> <a id="679" class="Symbol">(λ</a> <a id="682" href="Armor.Data.X509.PublicKey.Val.Parser.html#682" class="Bound">o∈?</a> <a id="686" class="Symbol">→</a> <a id="688" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="695" class="Symbol">(</a><a id="696" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="704" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="706" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="709" class="Symbol">)</a> <a id="711" class="Symbol">(</a><a id="712" href="Armor.Data.X509.PublicKey.Val.TCB.html#638" class="Function">PublicKeyVal&#39;</a> <a id="726" href="Armor.Data.X509.PublicKey.Val.Parser.html#616" class="Bound">a</a> <a id="728" href="Armor.Data.X509.PublicKey.Val.Parser.html#682" class="Bound">o∈?</a><a id="731" class="Symbol">))</a>
  <a id="736" href="Armor.Prelude.html#3493" class="Function Operator">of</a> <a id="739" class="Symbol">λ</a> <a id="741" class="Keyword">where</a>
    <a id="751" class="Symbol">(</a><a id="752" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="755" href="Armor.Data.X509.PublicKey.Val.Parser.html#755" class="Bound">¬p</a><a id="757" class="Symbol">)</a> <a id="759" class="Symbol">→</a> <a id="761" href="Armor.Data.X690-DER.BitString.Parser.html#2871" class="Function">parseBitstring</a>
    <a id="780" class="Symbol">(</a><a id="781" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="785" class="Symbol">(</a><a id="786" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="791" href="Armor.Data.X509.PublicKey.Val.Parser.html#791" class="Bound">px</a><a id="793" class="Symbol">))</a> <a id="796" class="Symbol">→</a> <a id="798" href="Armor.Data.X509.PublicKey.Val.RSA.Parser.html#1102" class="Function">RSA.parse</a>
    <a id="812" class="Symbol">(</a><a id="813" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="817" class="Symbol">(</a><a id="818" href="Data.List.Relation.Unary.Any.html#1272" class="InductiveConstructor">there</a> <a id="824" class="Symbol">(</a><a id="825" href="Data.List.Relation.Unary.Any.html#1219" class="InductiveConstructor">here</a> <a id="830" href="Armor.Data.X509.PublicKey.Val.Parser.html#830" class="Bound">px</a><a id="832" class="Symbol">)))</a> <a id="836" class="Symbol">→</a> <a id="838" href="Armor.Data.X509.PublicKey.Val.EC.Parser.html#1437" class="Function">EC.parse</a>
</pre></body></html>