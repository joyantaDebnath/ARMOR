<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Properties.html" class="Module">Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Properties</a>
<a id="114" class="Keyword">open</a> <a id="119" class="Keyword">import</a> <a id="126" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.TCB.html" class="Module">Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.TCB</a>
<a id="195" class="Keyword">import</a>      <a id="207" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.TCB.OIDs.html" class="Module">Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.TCB.OIDs</a> <a id="281" class="Symbol">as</a> <a id="284" class="Module">OIDs</a>
<a id="289" class="Keyword">open</a> <a id="294" class="Keyword">import</a> <a id="301" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.UserNotice.html" class="Module">Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.UserNotice</a>
<a id="377" class="Keyword">open</a> <a id="382" class="Keyword">import</a> <a id="389" href="Armor.Data.X690-DER.OID.html" class="Module">Armor.Data.X690-DER.OID</a>
<a id="413" class="Keyword">open</a> <a id="418" class="Keyword">import</a> <a id="425" href="Armor.Data.X690-DER.Sequence.DefinedByOID.html" class="Module">Armor.Data.X690-DER.Sequence.DefinedByOID</a>
<a id="467" class="Keyword">open</a> <a id="472" class="Keyword">import</a> <a id="479" href="Armor.Data.X690-DER.SequenceOf.html" class="Module">Armor.Data.X690-DER.SequenceOf</a>
<a id="510" class="Keyword">open</a> <a id="515" class="Keyword">import</a> <a id="522" href="Armor.Data.X690-DER.Strings.html" class="Module">Armor.Data.X690-DER.Strings</a>
<a id="550" class="Keyword">open</a> <a id="555" class="Keyword">import</a> <a id="562" href="Armor.Data.X690-DER.TLV.html" class="Module">Armor.Data.X690-DER.TLV</a>
<a id="586" class="Keyword">import</a>      <a id="598" href="Armor.Data.X690-DER.Tag.html" class="Module">Armor.Data.X690-DER.Tag</a> <a id="622" class="Symbol">as</a> <a id="625" class="Module">Tag</a>
<a id="629" class="Keyword">import</a>      <a id="641" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a>
<a id="667" class="Keyword">import</a>      <a id="679" href="Armor.Grammar.Parallel.html" class="Module">Armor.Grammar.Parallel</a>
<a id="702" class="Keyword">import</a>      <a id="714" href="Armor.Grammar.Parser.html" class="Module">Armor.Grammar.Parser</a>
<a id="735" class="Keyword">import</a>      <a id="747" href="Armor.Grammar.Properties.html" class="Module">Armor.Grammar.Properties</a>
<a id="772" class="Keyword">import</a>      <a id="784" href="Armor.Grammar.Sum.html" class="Module">Armor.Grammar.Sum</a>
<a id="802" class="Keyword">open</a> <a id="807" class="Keyword">import</a> <a id="814" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="829" class="Keyword">module</a> <a id="836" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html" class="Module">Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser</a> <a id="908" class="Keyword">where</a>

<a id="915" class="Keyword">open</a> <a id="920" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a> <a id="946" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="952" class="Keyword">open</a> <a id="957" href="Armor.Grammar.Parallel.html" class="Module">Armor.Grammar.Parallel</a>    <a id="983" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="989" class="Keyword">open</a> <a id="994" href="Armor.Grammar.Parser.html" class="Module">Armor.Grammar.Parser</a>      <a id="1020" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="1026" class="Keyword">open</a> <a id="1031" href="Armor.Grammar.Properties.html" class="Module">Armor.Grammar.Properties</a>  <a id="1057" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="1063" class="Keyword">open</a> <a id="1068" href="Armor.Grammar.Sum.html" class="Module">Armor.Grammar.Sum</a>         <a id="1094" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>

<a id="1101" class="Keyword">private</a>
  <a id="here&#39;"></a><a id="1111" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1111" class="Function">here&#39;</a> <a id="1117" class="Symbol">=</a> <a id="1119" class="String">&quot;X509: Extension: CertPolicy: PolicyInformation: Qualifier&quot;</a>

<a id="parseCPSURIQualifier"></a><a id="1180" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1180" class="Function">parseCPSURIQualifier</a> <a id="1201" class="Symbol">:</a> <a id="1203" class="Symbol">∀</a> <a id="1205" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1205" class="Bound">n</a> <a id="1207" class="Symbol">→</a> <a id="1209" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="1216" class="Symbol">(</a><a id="1217" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="1225" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1227" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="1230" class="Symbol">)</a> <a id="1232" class="Symbol">(</a><a id="1233" href="Armor.Grammar.Parallel.TCB.html#1532" class="Function">ExactLength</a> <a id="1245" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.TCB.html#977" class="Function">CPSURIQualifier</a> <a id="1261" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1205" class="Bound">n</a><a id="1262" class="Symbol">)</a>
<a id="1264" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1180" class="Function">parseCPSURIQualifier</a> <a id="1285" class="Symbol">=</a>
  <a id="1289" href="Armor.Data.X690-DER.Sequence.DefinedByOID.Parser.html#714" class="Function">DefinedByOID.parseFields</a> <a id="1314" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1111" class="Function">here&#39;</a> <a id="1320" class="Symbol">λ</a> <a id="1322" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1322" class="Bound">n</a> <a id="1324" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1324" class="Bound">o</a> <a id="1326" class="Symbol">→</a>
    <a id="1332" href="Armor.Grammar.Parallel.Parser.html#3682" class="Function">parseExactLength</a> <a id="1349" class="Symbol">(</a><a id="1350" href="Armor.Grammar.Parallel.Properties.html#1726" class="Function">Parallel.nosubstrings₁</a> <a id="1373" href="Armor.Data.X690-DER.TLV.Properties.html#592" class="Function">TLV.nosubstrings</a><a id="1389" class="Symbol">)</a>
      <a id="1397" class="Symbol">(</a><a id="1398" href="Armor.Prelude.html#14236" class="Field">tell</a> <a id="1403" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1405" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1111" class="Function">here&#39;</a> <a id="1411" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1421" class="String">&quot;: CPSURI: length mismatch&quot;</a><a id="1448" class="Symbol">)</a>
      <a id="1456" class="Symbol">(</a><a id="1457" href="Armor.Grammar.Parallel.Parser.html#6526" class="Function">parse×Dec</a> <a id="1467" href="Armor.Data.X690-DER.TLV.Properties.html#592" class="Function">TLV.nosubstrings</a> <a id="1484" class="Symbol">(</a><a id="1485" href="Armor.Prelude.html#14236" class="Field">tell</a> <a id="1490" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1492" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1111" class="Function">here&#39;</a> <a id="1498" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1508" class="String">&quot;: CPSURI: wrong OID&quot;</a><a id="1529" class="Symbol">)</a>
        <a id="1539" href="Armor.Data.X690-DER.Strings.IA5String.Parser.html#1747" class="Function">parseIA5String</a>
        <a id="1562" class="Symbol">(λ</a> <a id="1565" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1565" class="Bound">x</a> <a id="1567" class="Symbol">→</a> <a id="1569" class="Symbol">_</a> <a id="1571" href="Armor.Grammar.Definitions.Eq.html#1311" class="Field Operator">≋?</a> <a id="1574" class="Symbol">_))</a>
      <a id="1584" class="Symbol">_</a>

<a id="parseUserNoticeQualifier"></a><a id="1587" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1587" class="Function">parseUserNoticeQualifier</a> <a id="1612" class="Symbol">:</a> <a id="1614" class="Symbol">∀</a> <a id="1616" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1616" class="Bound">n</a> <a id="1618" class="Symbol">→</a> <a id="1620" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="1627" class="Symbol">(</a><a id="1628" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="1636" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1638" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="1641" class="Symbol">)</a> <a id="1643" class="Symbol">(</a><a id="1644" href="Armor.Grammar.Parallel.TCB.html#1532" class="Function">ExactLength</a> <a id="1656" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.TCB.html#1394" class="Function">UserNoticeQualifier</a> <a id="1676" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1616" class="Bound">n</a><a id="1677" class="Symbol">)</a>
<a id="1679" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1587" class="Function">parseUserNoticeQualifier</a> <a id="1704" class="Symbol">=</a>
  <a id="1708" href="Armor.Data.X690-DER.Sequence.DefinedByOID.Parser.html#714" class="Function">DefinedByOID.parseFields</a> <a id="1733" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1111" class="Function">here&#39;</a> <a id="1739" class="Symbol">λ</a> <a id="1741" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1741" class="Bound">n</a> <a id="1743" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1743" class="Bound">o</a> <a id="1745" class="Symbol">→</a>
    <a id="1751" href="Armor.Grammar.Parallel.Parser.html#3682" class="Function">parseExactLength</a> <a id="1768" class="Symbol">(</a><a id="1769" href="Armor.Grammar.Parallel.Properties.html#1726" class="Function">Parallel.nosubstrings₁</a> <a id="1792" href="Armor.Data.X690-DER.TLV.Properties.html#592" class="Function">TLV.nosubstrings</a><a id="1808" class="Symbol">)</a>
      <a id="1816" class="Symbol">(</a><a id="1817" href="Armor.Prelude.html#14236" class="Field">tell</a> <a id="1822" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1824" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1111" class="Function">here&#39;</a> <a id="1830" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1840" class="String">&quot;: UserNoticeQualifier: length mismatch&quot;</a><a id="1880" class="Symbol">)</a>
      <a id="1888" class="Symbol">(</a><a id="1889" href="Armor.Grammar.Parallel.Parser.html#6526" class="Function">parse×Dec</a> <a id="1899" href="Armor.Data.X690-DER.TLV.Properties.html#592" class="Function">TLV.nosubstrings</a>
        <a id="1924" class="Symbol">(</a><a id="1925" href="Armor.Prelude.html#14236" class="Field">tell</a> <a id="1930" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1932" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1111" class="Function">here&#39;</a> <a id="1938" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1948" class="String">&quot;: UserNoticeQualifier: wrong OID&quot;</a><a id="1982" class="Symbol">)</a>
        <a id="1992" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.UserNotice.Parser.html#1490" class="Function">parseUserNotice</a>
        <a id="2016" class="Symbol">(λ</a> <a id="2019" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#2019" class="Bound">x</a> <a id="2021" class="Symbol">→</a> <a id="2023" class="Symbol">_</a> <a id="2025" href="Armor.Grammar.Definitions.Eq.html#1311" class="Field Operator">≋?</a> <a id="2028" class="Symbol">_))</a>
      <a id="2038" class="Symbol">_</a>

<a id="parsePolicyQualifierInfoFields"></a><a id="2041" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#2041" class="Function">parsePolicyQualifierInfoFields</a> <a id="2072" class="Symbol">:</a> <a id="2074" class="Symbol">∀</a> <a id="2076" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#2076" class="Bound">n</a> <a id="2078" class="Symbol">→</a> <a id="2080" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="2087" class="Symbol">(</a><a id="2088" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="2096" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2098" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="2101" class="Symbol">)</a> <a id="2103" class="Symbol">(</a><a id="2104" href="Armor.Grammar.Parallel.TCB.html#1532" class="Function">ExactLength</a> <a id="2116" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.TCB.html#1669" class="Datatype">PolicyQualifierInfoFields</a> <a id="2142" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#2076" class="Bound">n</a><a id="2143" class="Symbol">)</a>
<a id="2145" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#2041" class="Function">parsePolicyQualifierInfoFields</a> <a id="2176" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#2176" class="Bound">n</a> <a id="2178" class="Symbol">=</a>
  <a id="2182" href="Armor.Grammar.Parser.Core.html#977" class="Function">parseEquivalent</a><a id="2197" class="Symbol">{</a><a id="2198" class="Argument">A</a> <a id="2200" class="Symbol">=</a> <a id="2202" href="Armor.Grammar.Sum.TCB.html#177" class="Datatype">Sum</a> <a id="2206" class="Symbol">(</a><a id="2207" href="Armor.Grammar.Parallel.TCB.html#1532" class="Function">ExactLength</a> <a id="2219" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.TCB.html#977" class="Function">CPSURIQualifier</a> <a id="2235" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#2176" class="Bound">n</a><a id="2236" class="Symbol">)</a> <a id="2238" class="Symbol">(</a><a id="2239" href="Armor.Grammar.Parallel.TCB.html#1532" class="Function">ExactLength</a> <a id="2251" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.TCB.html#1394" class="Function">UserNoticeQualifier</a> <a id="2271" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#2176" class="Bound">n</a><a id="2272" class="Symbol">)}</a>
    <a id="2279" class="Symbol">(</a><a id="2280" href="Armor.Grammar.Definitions.Iso.Properties.html#801" class="Function">Iso.transEquivalent</a> <a id="2300" class="Symbol">(</a><a id="2301" href="Armor.Grammar.Definitions.Iso.Properties.html#704" class="Function">Iso.symEquivalent</a> <a id="2319" href="Armor.Grammar.Properties.html#2042" class="Function">Distribute.exactLength-Sum</a><a id="2345" class="Symbol">)</a> <a id="2347" class="Symbol">(</a><a id="2348" href="Armor.Grammar.Parallel.Properties.html#993" class="Function">Parallel.equivalent₁</a> <a id="2369" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.TCB.html#2427" class="Function">equivalentPolicyQualifierInfoFields</a><a id="2404" class="Symbol">))</a>
    <a id="2411" class="Symbol">(</a><a id="2412" href="Armor.Grammar.Sum.Parser.html#485" class="Function">parseSum</a> <a id="2421" class="Symbol">(</a><a id="2422" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1180" class="Function">parseCPSURIQualifier</a> <a id="2443" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#2176" class="Bound">n</a><a id="2444" class="Symbol">)</a> <a id="2446" class="Symbol">(</a><a id="2447" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1587" class="Function">parseUserNoticeQualifier</a> <a id="2472" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#2176" class="Bound">n</a><a id="2473" class="Symbol">))</a>

<a id="parsePolicyQualifierInfo"></a><a id="2477" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#2477" class="Function">parsePolicyQualifierInfo</a> <a id="2502" class="Symbol">:</a> <a id="2504" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="2511" class="Symbol">(</a><a id="2512" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="2520" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2522" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="2525" class="Symbol">)</a> <a id="2527" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.TCB.html#1878" class="Function">PolicyQualifierInfo</a>
<a id="2547" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#2477" class="Function">parsePolicyQualifierInfo</a> <a id="2572" class="Symbol">=</a>
  <a id="2576" href="Armor.Data.X690-DER.TLV.Parser.html#788" class="Function">parseTLV</a> <a id="2585" class="Symbol">_</a> <a id="2587" class="Symbol">(</a><a id="2588" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1111" class="Function">here&#39;</a> <a id="2594" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="2604" class="String">&quot; (fields)&quot;</a><a id="2615" class="Symbol">)</a> <a id="2617" class="Symbol">_</a> <a id="2619" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#2041" class="Function">parsePolicyQualifierInfoFields</a>

<a id="parsePolicyQualifiersSeq"></a><a id="2651" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#2651" class="Function">parsePolicyQualifiersSeq</a> <a id="2676" class="Symbol">:</a> <a id="2678" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="2685" class="Symbol">(</a><a id="2686" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="2694" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="2696" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="2699" class="Symbol">)</a> <a id="2701" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.TCB.html#1992" class="Function">PolicyQualifiersSeq</a>
<a id="2721" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#2651" class="Function">parsePolicyQualifiersSeq</a> <a id="2746" class="Symbol">=</a>
  <a id="2750" href="Armor.Data.X690-DER.SequenceOf.Parser.html#7560" class="Function">parseNonEmptySeq</a> <a id="2767" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#1111" class="Function">here&#39;</a> <a id="2773" class="Symbol">_</a> <a id="2775" href="Armor.Data.X690-DER.TLV.Properties.html#486" class="Function">TLV.nonempty</a> <a id="2788" href="Armor.Data.X690-DER.TLV.Properties.html#592" class="Function">TLV.nosubstrings</a>
    <a id="2809" href="Armor.Data.X509.Extension.CertPolicy.PolicyInformation.Qualifier.Parser.html#2477" class="Function">parsePolicyQualifierInfo</a>
</pre></body></html>