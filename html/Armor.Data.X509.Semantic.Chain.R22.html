<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X509.Semantic.Chain.R22</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--sized-types</a> <a id="27" class="Symbol">#-}</a>

<a id="32" class="Keyword">open</a> <a id="37" class="Keyword">import</a> <a id="44" href="Armor.Data.X509.html" class="Module">Armor.Data.X509</a>
<a id="60" class="Keyword">import</a>      <a id="72" href="Armor.Data.X509.Semantic.Chain.TCB.html" class="Module">Armor.Data.X509.Semantic.Chain.TCB</a> <a id="107" class="Symbol">as</a> <a id="110" class="Module">Chain</a>
<a id="116" class="Keyword">open</a> <a id="121" class="Keyword">import</a> <a id="128" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>

<a id="143" class="Keyword">module</a> <a id="150" href="Armor.Data.X509.Semantic.Chain.R22.html" class="Module">Armor.Data.X509.Semantic.Chain.R22</a> <a id="185" class="Keyword">where</a>

<a id="192" class="Keyword">open</a> <a id="197" href="Armor.Data.X509.Semantic.Chain.TCB.html" class="Module">Chain</a> <a id="203" class="Keyword">using</a> <a id="209" class="Symbol">(</a><a id="210" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a><a id="215" class="Symbol">)</a>

<a id="218" class="Comment">-- https://datatracker.ietf.org/doc/html/rfc5280#section-6.1</a>
<a id="279" class="Comment">-- A certificate MUST NOT appear more than once in a prospective certification path.</a>

<a id="365" class="Keyword">module</a> <a id="372" href="Armor.Data.X509.Semantic.Chain.R22.html#372" class="Module">_</a> <a id="374" class="Symbol">{</a><a id="375" href="Armor.Data.X509.Semantic.Chain.R22.html#375" class="Bound">trust</a> <a id="381" href="Armor.Data.X509.Semantic.Chain.R22.html#381" class="Bound">candidates</a> <a id="392" class="Symbol">:</a> <a id="394" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="399" class="Symbol">(</a><a id="400" href="Armor.Prelude.html#8763" class="Function">Exists─</a> <a id="408" class="Symbol">_</a> <a id="410" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a><a id="414" class="Symbol">)}</a> <a id="417" class="Symbol">{@</a><a id="419" class="Symbol">0</a> <a id="421" href="Armor.Data.X509.Semantic.Chain.R22.html#421" class="Bound">bs</a><a id="423" class="Symbol">}</a> <a id="425" class="Symbol">(</a><a id="426" href="Armor.Data.X509.Semantic.Chain.R22.html#426" class="Bound">issuee</a> <a id="433" class="Symbol">:</a> <a id="435" href="Armor.Data.X509.Cert.TCB.html#5674" class="Function">Cert</a> <a id="440" href="Armor.Data.X509.Semantic.Chain.R22.html#421" class="Bound">bs</a><a id="442" class="Symbol">)</a> <a id="444" class="Keyword">where</a>

  <a id="453" href="Armor.Data.X509.Semantic.Chain.R22.html#453" class="Function">R22</a> <a id="457" class="Symbol">:</a> <a id="459" href="Armor.Data.X509.Semantic.Chain.TCB.html#5197" class="Datatype">Chain</a> <a id="465" href="Armor.Data.X509.Semantic.Chain.R22.html#375" class="Bound">trust</a> <a id="471" href="Armor.Data.X509.Semantic.Chain.R22.html#381" class="Bound">candidates</a> <a id="482" href="Armor.Data.X509.Semantic.Chain.R22.html#426" class="Bound">issuee</a> <a id="489" class="Symbol">→</a> <a id="491" href="Agda.Primitive.html#326" class="Primitive">Set</a>
  <a id="497" href="Armor.Data.X509.Semantic.Chain.R22.html#453" class="Function">R22</a> <a id="501" href="Armor.Data.X509.Semantic.Chain.R22.html#501" class="Bound">c</a> <a id="503" class="Symbol">=</a> <a id="505" href="Data.List.Relation.Unary.Unique.Setoid.html#719" class="Datatype">List.Unique</a> <a id="517" href="Armor.Prelude.html#10989" class="Field Operator">_≟_</a> <a id="521" class="Symbol">(</a><a id="522" href="Armor.Data.X509.Semantic.Chain.TCB.html#5959" class="Function">Chain.toList</a> <a id="535" href="Armor.Data.X509.Semantic.Chain.R22.html#501" class="Bound">c</a><a id="536" class="Symbol">)</a>

  <a id="541" href="Armor.Data.X509.Semantic.Chain.R22.html#541" class="Function">r22</a> <a id="545" class="Symbol">:</a> <a id="547" href="Relation.Unary.html#3536" class="Function">Decidable</a> <a id="557" href="Armor.Data.X509.Semantic.Chain.R22.html#453" class="Function">R22</a>
  <a id="563" href="Armor.Data.X509.Semantic.Chain.R22.html#541" class="Function">r22</a> <a id="567" href="Armor.Data.X509.Semantic.Chain.R22.html#567" class="Bound">c</a> <a id="569" class="Symbol">=</a> <a id="571" href="Data.List.Relation.Unary.Unique.DecSetoid.html#865" class="Function">List.unique?</a> <a id="584" href="Armor.Prelude.html#10989" class="Field Operator">_≟_</a> <a id="588" class="Symbol">(</a><a id="589" href="Armor.Data.X509.Semantic.Chain.TCB.html#5959" class="Function">Chain.toList</a> <a id="602" href="Armor.Data.X509.Semantic.Chain.R22.html#567" class="Bound">c</a><a id="603" class="Symbol">)</a>

</pre></body></html>