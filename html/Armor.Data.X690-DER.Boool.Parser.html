<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Armor.Data.X690-DER.Boool.Parser</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Armor.Binary.html" class="Module">Armor.Binary</a>
<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Armor.Data.X690-DER.Boool.Properties.html" class="Module">Armor.Data.X690-DER.Boool.Properties</a>
<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="Armor.Data.X690-DER.Boool.TCB.html" class="Module">Armor.Data.X690-DER.Boool.TCB</a>
<a id="117" class="Keyword">open</a> <a id="122" class="Keyword">import</a> <a id="129" href="Armor.Data.X690-DER.TLV.html" class="Module">Armor.Data.X690-DER.TLV</a>
<a id="153" class="Keyword">import</a>      <a id="165" href="Armor.Data.X690-DER.Tag.html" class="Module">Armor.Data.X690-DER.Tag</a> <a id="189" class="Symbol">as</a> <a id="192" class="Module">Tag</a>
<a id="196" class="Keyword">import</a>      <a id="208" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a>
<a id="234" class="Keyword">import</a>      <a id="246" href="Armor.Grammar.Parallel.html" class="Module">Armor.Grammar.Parallel</a>
<a id="269" class="Keyword">import</a>      <a id="281" href="Armor.Grammar.Parser.html" class="Module">Armor.Grammar.Parser</a>
<a id="302" class="Keyword">open</a> <a id="307" class="Keyword">import</a> <a id="314" href="Armor.Prelude.html" class="Module">Armor.Prelude</a>
<a id="328" class="Comment">-- open import Data.List.Properties</a>
<a id="364" class="Comment">-- open import Data.Nat.Properties</a>
<a id="399" class="Comment">--   hiding (_≟_)</a>
<a id="417" class="Comment">-- open import Tactic.MonoidSolver using (solve ; solve-macro)</a>

<a id="481" class="Keyword">module</a> <a id="488" href="Armor.Data.X690-DER.Boool.Parser.html" class="Module">Armor.Data.X690-DER.Boool.Parser</a> <a id="521" class="Keyword">where</a>

<a id="528" class="Keyword">open</a> <a id="533" href="Armor.Grammar.Definitions.html" class="Module">Armor.Grammar.Definitions</a> <a id="559" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="565" class="Keyword">open</a> <a id="570" href="Armor.Grammar.Parallel.html" class="Module">Armor.Grammar.Parallel</a>    <a id="596" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>
<a id="602" class="Keyword">open</a> <a id="607" href="Armor.Grammar.Parser.html" class="Module">Armor.Grammar.Parser</a>      <a id="633" href="Armor.Binary.UInt8.TCB.html#158" class="Function">UInt8</a>

<a id="640" class="Keyword">private</a>
  <a id="here&#39;"></a><a id="650" href="Armor.Data.X690-DER.Boool.Parser.html#650" class="Function">here&#39;</a> <a id="656" class="Symbol">=</a> <a id="658" class="String">&quot;X690-DER: Bool&quot;</a>

<a id="parseValue"></a><a id="676" href="Armor.Data.X690-DER.Boool.Parser.html#676" class="Function">parseValue</a> <a id="687" class="Symbol">:</a> <a id="689" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="696" class="Symbol">(</a><a id="697" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="705" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="707" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="710" class="Symbol">)</a> <a id="712" href="Armor.Data.X690-DER.Boool.TCB.html#932" class="Record">BoolValue</a>
<a id="722" href="Armor.Grammar.Parser.Core.html#775" class="Field">runParser</a> <a id="732" href="Armor.Data.X690-DER.Boool.Parser.html#676" class="Function">parseValue</a> <a id="743" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="746" class="Symbol">=</a> <a id="748" class="Keyword">do</a>
  <a id="753" href="Armor.Prelude.html#14236" class="Field">tell</a> <a id="758" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="760" href="Armor.Data.X690-DER.Boool.Parser.html#650" class="Function">here&#39;</a> <a id="766" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="776" class="String">&quot;: underflow&quot;</a>
  <a id="792" href="Category.Monad.Indexed.html#644" class="Field">return</a> <a id="799" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="801" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="804" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="806" class="Symbol">λ</a> <a id="808" class="Keyword">where</a>
    <a id="818" class="Symbol">(</a><a id="819" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="827" href="Armor.Data.X690-DER.Boool.Parser.html#827" class="Bound">prefix</a> <a id="834" href="Armor.Data.X690-DER.Boool.Parser.html#834" class="Bound">read</a> <a id="839" href="Armor.Data.X690-DER.Boool.Parser.html#839" class="Bound">read≡</a> <a id="845" href="Armor.Data.X690-DER.Boool.Parser.html#845" class="Bound">value</a> <a id="851" href="Armor.Data.X690-DER.Boool.Parser.html#851" class="Bound">suffix</a> <a id="858" href="Armor.Data.X690-DER.Boool.Parser.html#858" class="Bound">ps≡</a><a id="861" class="Symbol">)</a> <a id="863" class="Symbol">→</a>
      <a id="871" href="Armor.Prelude.html#6155" class="Function">contradiction</a> <a id="885" class="Symbol">(</a><a id="886" href="Data.List.Properties.html#7291" class="Function">++-conicalˡ</a> <a id="898" class="Symbol">_</a> <a id="900" href="Armor.Data.X690-DER.Boool.Parser.html#851" class="Bound">suffix</a> <a id="907" href="Armor.Data.X690-DER.Boool.Parser.html#858" class="Bound">ps≡</a><a id="910" class="Symbol">)</a> <a id="912" class="Symbol">(</a><a id="913" href="Armor.Data.X690-DER.Boool.Properties.html#329" class="Function">nonempty</a> <a id="922" href="Armor.Data.X690-DER.Boool.Parser.html#845" class="Bound">value</a><a id="927" class="Symbol">)</a>
<a id="929" href="Armor.Grammar.Parser.Core.html#775" class="Field">runParser</a> <a id="939" href="Armor.Data.X690-DER.Boool.Parser.html#676" class="Function">parseValue</a> <a id="950" class="Symbol">(</a><a id="951" href="Armor.Data.X690-DER.Boool.Parser.html#951" class="Bound">x</a> <a id="953" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="955" href="Armor.Data.X690-DER.Boool.Parser.html#955" class="Bound">xs</a><a id="957" class="Symbol">)</a>
  <a id="961" class="Keyword">with</a> <a id="966" href="Armor.Data.X690-DER.Boool.Parser.html#951" class="Bound">x</a> <a id="968" href="Armor.Prelude.html#10989" class="Field Operator">≟</a> <a id="970" href="Armor.Prelude.html#9348" class="Function Operator">#</a> <a id="972" class="Number">0</a>
<a id="974" class="Symbol">...</a> <a id="978" class="Symbol">|</a> <a id="980" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="984" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="989" class="Symbol">=</a>
  <a id="993" href="Category.Monad.Indexed.html#644" class="Field">return</a> <a id="1000" class="Symbol">(</a><a id="1001" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1005" class="Symbol">(</a><a id="1006" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="1014" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1016" href="Armor.Prelude.html#9348" class="Function Operator">#</a> <a id="1018" class="Number">0</a> <a id="1020" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="1022" class="Symbol">_</a> <a id="1024" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1029" class="Symbol">(</a><a id="1030" href="Armor.Data.X690-DER.Boool.TCB.html#989" class="InductiveConstructor">mkBoolValue</a> <a id="1042" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="1048" class="Symbol">(</a><a id="1049" href="Armor.Prelude.html#9348" class="Function Operator">#</a> <a id="1051" class="Number">0</a><a id="1052" class="Symbol">)</a> <a id="1054" href="Armor.Data.X690-DER.Boool.TCB.html#863" class="InductiveConstructor">falseᵣ</a> <a id="1061" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1065" class="Symbol">)</a> <a id="1067" class="Bound">xs</a> <a id="1070" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1074" class="Symbol">))</a>
<a id="1077" class="Symbol">...</a> <a id="1081" class="Symbol">|</a> <a id="1083" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1086" href="Armor.Data.X690-DER.Boool.Parser.html#1086" class="Bound">x≢0</a>
  <a id="1092" class="Keyword">with</a> <a id="1097" class="Bound">x</a> <a id="1099" href="Armor.Prelude.html#10989" class="Field Operator">≟</a> <a id="1101" href="Armor.Prelude.html#9348" class="Function Operator">#</a> <a id="1103" class="Number">255</a>
<a id="1107" class="Symbol">...</a> <a id="1111" class="Symbol">|</a> <a id="1113" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1117" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1122" class="Symbol">=</a>
  <a id="1126" href="Category.Monad.Indexed.html#644" class="Field">return</a> <a id="1133" class="Symbol">(</a><a id="1134" href="Relation.Nullary.html#1648" class="InductiveConstructor">yes</a> <a id="1138" class="Symbol">(</a><a id="1139" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="1147" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1149" href="Armor.Prelude.html#9348" class="Function Operator">#</a> <a id="1151" class="Number">255</a> <a id="1155" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="1157" class="Symbol">_</a> <a id="1159" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1164" class="Symbol">(</a><a id="1165" href="Armor.Data.X690-DER.Boool.TCB.html#989" class="InductiveConstructor">mkBoolValue</a> <a id="1177" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="1182" class="Symbol">(</a><a id="1183" href="Armor.Prelude.html#9348" class="Function Operator">#</a> <a id="1185" class="Number">255</a><a id="1188" class="Symbol">)</a> <a id="1190" href="Armor.Data.X690-DER.Boool.TCB.html#894" class="InductiveConstructor">trueᵣ</a> <a id="1196" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1200" class="Symbol">)</a> <a id="1202" class="Bound">xs</a> <a id="1205" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1209" class="Symbol">))</a>
<a id="1212" class="Symbol">...</a> <a id="1216" class="Symbol">|</a> <a id="1218" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a>  <a id="1222" href="Armor.Data.X690-DER.Boool.Parser.html#1222" class="Bound">x≢255</a> <a id="1228" class="Symbol">=</a> <a id="1230" class="Keyword">do</a>
  <a id="1235" href="Armor.Prelude.html#14236" class="Field">tell</a> <a id="1240" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1242" href="Armor.Data.X690-DER.Boool.Parser.html#650" class="Function">here&#39;</a> <a id="1248" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1258" class="String">&quot;: invalid boolean rep&quot;</a>
  <a id="1284" href="Category.Monad.Indexed.html#644" class="Field">return</a> <a id="1291" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1293" href="Relation.Nullary.html#1685" class="InductiveConstructor">no</a> <a id="1296" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1298" class="Symbol">λ</a> <a id="1300" class="Keyword">where</a>
    <a id="1310" class="Symbol">(</a><a id="1311" href="Armor.Grammar.Parser.Core.html#277" class="InductiveConstructor">success</a> <a id="1319" href="Armor.Data.X690-DER.Boool.Parser.html#1319" class="Bound">prefix</a> <a id="1326" class="Symbol">_</a> <a id="1328" class="Symbol">_</a> <a id="1330" class="Symbol">(</a><a id="1331" href="Armor.Data.X690-DER.Boool.TCB.html#989" class="InductiveConstructor">mkBoolValue</a> <a id="1343" href="Armor.Data.X690-DER.Boool.Parser.html#1343" class="Bound">v</a> <a id="1345" class="Symbol">_</a> <a id="1347" href="Armor.Data.X690-DER.Boool.Parser.html#1347" class="Bound">vᵣ</a> <a id="1350" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="1354" class="Symbol">)</a> <a id="1356" href="Armor.Data.X690-DER.Boool.Parser.html#1356" class="Bound">suffix</a> <a id="1363" href="Armor.Data.X690-DER.Boool.Parser.html#1363" class="Bound">ps≡</a><a id="1366" class="Symbol">)</a> <a id="1368" class="Symbol">→</a> <a id="1370" href="Armor.Prelude.html#12974" class="Function Operator">‼</a>
      <a id="1378" class="Symbol">(</a><a id="1379" href="Function.Base.html#4121" class="Function Operator">case</a> <a id="1384" href="Armor.Data.X690-DER.Boool.Parser.html#1347" class="Bound">vᵣ</a> <a id="1387" href="Function.Base.html#4121" class="Function Operator">of</a> <a id="1390" class="Symbol">λ</a> <a id="1392" class="Keyword">where</a>
        <a id="1406" href="Armor.Data.X690-DER.Boool.TCB.html#863" class="InductiveConstructor">falseᵣ</a> <a id="1413" class="Symbol">→</a> <a id="1415" href="Armor.Prelude.html#6155" class="Function">contradiction</a> <a id="1429" class="Symbol">(</a><a id="1430" href="Data.List.Properties.html#2217" class="Function">∷-injectiveˡ</a> <a id="1443" class="Symbol">(</a><a id="1444" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="1448" href="Armor.Data.X690-DER.Boool.Parser.html#1363" class="Bound">ps≡</a><a id="1451" class="Symbol">))</a> <a id="1454" class="Bound">x≢0</a>
        <a id="1466" href="Armor.Data.X690-DER.Boool.TCB.html#894" class="InductiveConstructor">trueᵣ</a>  <a id="1473" class="Symbol">→</a> <a id="1475" href="Armor.Prelude.html#6155" class="Function">contradiction</a> <a id="1489" class="Symbol">(</a><a id="1490" href="Data.List.Properties.html#2217" class="Function">∷-injectiveˡ</a> <a id="1503" class="Symbol">(</a><a id="1504" href="Relation.Binary.PropositionalEquality.Core.html#1684" class="Function">sym</a> <a id="1508" href="Armor.Data.X690-DER.Boool.Parser.html#1363" class="Bound">ps≡</a><a id="1511" class="Symbol">))</a> <a id="1514" href="Armor.Data.X690-DER.Boool.Parser.html#1222" class="Bound">x≢255</a><a id="1519" class="Symbol">)</a>

<a id="parse"></a><a id="1522" href="Armor.Data.X690-DER.Boool.Parser.html#1522" class="Function">parse</a> <a id="1528" class="Symbol">:</a> <a id="1530" href="Armor.Grammar.Parser.Core.html#844" class="Function">Parser</a> <a id="1537" class="Symbol">(</a><a id="1538" href="Armor.Prelude.html#14302" class="Record">Logging</a> <a id="1546" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1548" href="Relation.Nullary.html#1511" class="Record">Dec</a><a id="1551" class="Symbol">)</a> <a id="1553" href="Armor.Data.X690-DER.Boool.TCB.html#1093" class="Function">Boool</a>
<a id="1559" href="Armor.Data.X690-DER.Boool.Parser.html#1522" class="Function">parse</a> <a id="1565" class="Symbol">=</a> <a id="1567" href="Armor.Data.X690-DER.TLV.Parser.html#788" class="Function">parseTLV</a> <a id="1576" href="Armor.Data.X690-DER.Tag.html#132" class="Function">Tag.Boolean</a> <a id="1588" href="Armor.Data.X690-DER.Boool.Parser.html#650" class="Function">here&#39;</a> <a id="1594" href="Armor.Data.X690-DER.Boool.TCB.html#932" class="Record">BoolValue</a>
              <a id="1618" class="Symbol">(</a><a id="1619" href="Armor.Grammar.Parallel.Parser.html#3682" class="Function">parseExactLength</a> <a id="1636" href="Armor.Data.X690-DER.Boool.Properties.html#380" class="Function">nosubstrings</a> <a id="1649" class="Symbol">(</a><a id="1650" href="Armor.Prelude.html#14236" class="Field">tell</a> <a id="1655" href="Function.Base.html#1919" class="Function Operator">$</a> <a id="1657" href="Armor.Data.X690-DER.Boool.Parser.html#650" class="Function">here&#39;</a> <a id="1663" href="Data.String.Base.html#2366" class="Function Operator">String.++</a> <a id="1673" class="String">&quot;bad length for bool&quot;</a><a id="1694" class="Symbol">)</a> <a id="1696" href="Armor.Data.X690-DER.Boool.Parser.html#676" class="Function">parseValue</a><a id="1706" class="Symbol">)</a>


<a id="1710" class="Comment">-- private</a>
<a id="1721" class="Comment">--   module Test where</a>

<a id="1745" class="Comment">--     tval : List Dig</a>
<a id="1768" class="Comment">--     tval = Tag.Boolean ∷ # 1 ∷ [ # 255 ]</a>

<a id="1813" class="Comment">--     fval : List Dig</a>
<a id="1836" class="Comment">--     fval = Tag.Boolean ∷ # 1 ∷ [ # 0 ]</a>

<a id="1879" class="Comment">--     badval : List Dig</a>
<a id="1904" class="Comment">--     badval = Tag.Boolean ∷ # 1 ∷ [ # 20 ]</a>

<a id="1950" class="Comment">--     test₁ : Boool tval</a>
<a id="1976" class="Comment">--     test₁ = Success.value (toWitness {Q = Logging.val (runParser parseBool tval)} tt)</a>

<a id="2066" class="Comment">--     test₂ : Boool fval</a>
<a id="2092" class="Comment">--     test₂ = Success.value (toWitness {Q = Logging.val (runParser parseBool fval)} tt)</a>

<a id="2182" class="Comment">--     test₃ : ¬ Success _ Boool badval</a>
<a id="2222" class="Comment">--     test₃ = toWitnessFalse {Q = Logging.val (runParser parseBool badval)} tt</a>
</pre></body></html>