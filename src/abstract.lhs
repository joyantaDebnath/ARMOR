\begin{abstract}
Despite the omnipresence of the X.509 Public-Key Infrastructure (PKI) as an authentication method, flaws in X.509 certificate chain validation can expose relying applications to impersonation attacks and interoperability issues. The complex, ambiguous, and occasionally under-specified nature of the X.509 specification often leads to non-compliance issues across many libraries implementing the logic of X.509 certificate chain validation. To improve this situation, this work formally specifies the most-used segment of the X.509 standard using the Agda interactive theorem prover and finally develops a formally-verified implementation ARMOR. ARMOR's soundness and completeness are proven by leveraging Agda's advanced type system and dependent types, thus offering formal assurances of correctness in line with the X.509 standard specification. This rigorously designed implementation is subsequently employed as a benchmark in a differential testing framework to scrutinize 11 open-source X.509 implementations, helping uncover potential vulnerabilities. When tested against 2 million real-world certificate chains, ARMOR demonstrates its effectiveness and robustness by appropriately rejecting non-compliant certificates while maintaining a reasonable runtime and memory overhead.
\end{abstract}