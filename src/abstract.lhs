\begin{abstract}
Despite the omnipresence of the \xfon Public Key Infrastructure (PKI) as an authentication method, flaws in \xfon certificate chain validation can expose relying applications to impersonation attacks and interoperability issues. The complex, ambiguous, and occasionally under-specified nature of the \xfon specification often leads to non-compliance issues across many libraries implementing the logic of \xfon certificate chain validation. To improve this situation, this work formally specifies the most-used segment of the \xfon standard using the \agda interactive theorem prover and finally develops a formally-verified implementation \armor. \armor's \soundness and \completeness are proven by leveraging \agda's advanced type system and dependent types, thus offering formal assurances of correctness in line with the \xfon standard specification. This rigorously designed implementation is subsequently employed as a benchmark in a differential testing framework to scrutinize $11$ open-source \xfon implementations, helping uncover potential vulnerabilities. When tested against $2$ million real-world certificate chains, \armor demonstrates its effectiveness and robustness by appropriately rejecting non-compliant certificates while maintaining a reasonable runtime and memory overhead.
\end{abstract}